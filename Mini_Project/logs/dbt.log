[0m10:46:38.035880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0D924590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0D5F35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0D924230>]}


============================== 10:46:38.035880 | 8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283 ==============================
[0m10:46:38.035880 [info ] [MainThread]: Running with dbt=1.9.3
[0m10:46:38.035880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:46:38.860760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0D924200>]}
[0m10:46:38.923848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0ABED400>]}
[0m10:46:38.923848 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:46:39.465754 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m10:46:39.465754 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:46:39.465754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0E661DC0>]}
[0m10:46:41.783206 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.example
[0m10:46:41.788833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0D5F1940>]}
[0m10:46:41.836051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m10:46:41.854154 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m10:46:41.922618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0F97AE70>]}
[0m10:46:41.922618 [info ] [MainThread]: Found 4 models, 474 macros
[0m10:46:41.922618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0D7ECE30>]}
[0m10:46:41.922618 [info ] [MainThread]: 
[0m10:46:41.922618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:46:41.922618 [info ] [MainThread]: 
[0m10:46:41.922618 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:46:41.930535 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m10:46:44.814372 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m10:46:44.814372 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m10:46:44.814372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:46.664325 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.852 seconds
[0m10:46:46.676925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m10:46:46.689801 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m10:46:46.689801 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m10:46:46.689801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:46.997440 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.308 seconds
[0m10:46:46.999448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0FEF0890>]}
[0m10:46:47.007013 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m10:46:47.009021 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_customers .................................. [RUN]
[0m10:46:47.009021 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m10:46:47.009021 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m10:46:47.013153 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m10:46:47.013153 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m10:46:47.047411 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m10:46:47.047411 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m10:46:47.047411 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    select * from customers
  );
[0m10:46:47.047411 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:46:47.460854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.410 seconds
[0m10:46:47.481375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a7f3f0a-ce2b-46b4-9ff7-4cd6e855f283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0ACF16D0>]}
[0m10:46:47.481375 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_customers ............................. [[32mSUCCESS 1[0m in 0.47s]
[0m10:46:47.481375 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m10:46:47.481375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:47.481375 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m10:46:47.481375 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m10:46:47.570038 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m10:46:47.570038 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m10:46:47.654027 [debug] [MainThread]: Connection 'model.Mini_Project.stg_customers' was left open.
[0m10:46:47.654027 [debug] [MainThread]: On model.Mini_Project.stg_customers: Close
[0m10:46:47.749162 [info ] [MainThread]: 
[0m10:46:47.755422 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.83 seconds (5.83s).
[0m10:46:47.757437 [debug] [MainThread]: Command end result
[0m10:46:47.775897 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m10:46:47.782269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m10:46:47.788640 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m10:46:47.788640 [info ] [MainThread]: 
[0m10:46:47.788640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:46:47.788640 [info ] [MainThread]: 
[0m10:46:47.788640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:46:47.791978 [debug] [MainThread]: Command `dbt run` succeeded at 10:46:47.791978 after 9.97 seconds
[0m10:46:47.791978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0D5F35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0FA5A9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C0FA580E0>]}
[0m10:46:47.791978 [debug] [MainThread]: Flushing usage events
[0m10:46:48.718473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:26.467243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE028E8F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE028E83B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE028E8350>]}


============================== 11:07:26.483260 | 4c438064-2d15-44af-9424-cab1fd0b6a8a ==============================
[0m11:07:26.483260 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:07:26.483260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:07:27.150663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE033A8260>]}
[0m11:07:27.196726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE036CE6F0>]}
[0m11:07:27.196726 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:07:27.638977 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:07:27.703058 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:07:27.703058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02457050>]}
[0m11:07:29.935536 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m11:07:29.937553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0479A8A0>]}
[0m11:07:30.012821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:07:30.028834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:07:30.060607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE028EA120>]}
[0m11:07:30.060607 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:07:30.060607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE04BA8290>]}
[0m11:07:30.060607 [info ] [MainThread]: 
[0m11:07:30.060607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:30.060607 [info ] [MainThread]: 
[0m11:07:30.060607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:07:30.060607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:07:32.715910 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:07:32.715910 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:07:32.715910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:33.638767 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.923 seconds
[0m11:07:33.640776 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:07:33.647085 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:07:33.647085 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:07:33.647085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:34.112367 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.464 seconds
[0m11:07:34.112367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE047992E0>]}
[0m11:07:34.127007 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m11:07:34.127007 [info ] [Thread-1 (]: 1 of 2 START sql view model RAW.stg_customers .................................. [RUN]
[0m11:07:34.127007 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m11:07:34.127007 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m11:07:34.127007 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m11:07:34.127007 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m11:07:34.166705 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m11:07:34.168713 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m11:07:34.168713 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT

        DISTINCT(customer_id) AS customer_id
        , customer_name
        , company
)
SELECT
    *
FROM optimized;
[0m11:07:34.168713 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:34.735902 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef1-0001-429b-0008-511e000173fe
[0m11:07:34.735902 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 14 unexpected ';'.
[0m11:07:34.751688 [debug] [Thread-1 (]: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:07:34.753696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE047BB470>]}
[0m11:07:34.753696 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model RAW.stg_customers ......................... [[31mERROR[0m in 0.62s]
[0m11:07:34.753696 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m11:07:34.753696 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m11:07:34.753696 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql.
[0m11:07:34.753696 [info ] [Thread-1 (]: 2 of 2 START sql view model RAW.stg_products ................................... [RUN]
[0m11:07:34.753696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m11:07:34.753696 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m11:07:34.759870 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m11:07:34.761880 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m11:07:34.765420 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m11:07:34.767428 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m11:07:34.767428 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    WITH 

required_fields AS (
    SELECT
        product_id,
        supplier_id,
        product_name,
        category,
        cost
    FROM MINI_PROJECT.RAW.PRODUCTS
)

SELECT * 
FROM required_fields
  );
[0m11:07:34.877387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef1-0001-429e-0008-511e0001292e
[0m11:07:34.877387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 8
invalid identifier 'SUPPLIER_ID'
[0m11:07:34.877387 [debug] [Thread-1 (]: Database Error in model stg_products (models\Staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'SUPPLIER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_products.sql
[0m11:07:34.893090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c438064-2d15-44af-9424-cab1fd0b6a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE052224B0>]}
[0m11:07:34.895105 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model RAW.stg_products .......................... [[31mERROR[0m in 0.12s]
[0m11:07:34.895105 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m11:07:34.897116 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\Staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'SUPPLIER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_products.sql.
[0m11:07:34.899129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:34.899129 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:07:34.901139 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:07:34.972706 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:07:34.984635 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:07:35.054117 [debug] [MainThread]: Connection 'model.Mini_Project.stg_products' was left open.
[0m11:07:35.054117 [debug] [MainThread]: On model.Mini_Project.stg_products: Close
[0m11:07:35.143443 [info ] [MainThread]: 
[0m11:07:35.143443 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m11:07:35.143443 [debug] [MainThread]: Command end result
[0m11:07:35.170228 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:07:35.172236 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:07:35.172236 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:07:35.172236 [info ] [MainThread]: 
[0m11:07:35.172236 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m11:07:35.180181 [info ] [MainThread]: 
[0m11:07:35.180181 [error] [MainThread]:   Database Error in model stg_customers (models\Staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:07:35.180181 [info ] [MainThread]: 
[0m11:07:35.180181 [error] [MainThread]:   Database Error in model stg_products (models\Staging\stg_products.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'SUPPLIER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_products.sql
[0m11:07:35.180181 [info ] [MainThread]: 
[0m11:07:35.180181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m11:07:35.180181 [debug] [MainThread]: Command `dbt run` failed at 11:07:35.180181 after 8.90 seconds
[0m11:07:35.180181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE04C0A8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE04B06630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE051FB110>]}
[0m11:07:35.180181 [debug] [MainThread]: Flushing usage events
[0m11:07:36.460317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:44.030504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE87016540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE85237200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8485ADB0>]}


============================== 11:07:44.037409 | 43a95476-cc68-4f42-9dda-63e5309b882e ==============================
[0m11:07:44.037409 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:07:44.037409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:07:44.448377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43a95476-cc68-4f42-9dda-63e5309b882e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE88113D10>]}
[0m11:07:44.511256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43a95476-cc68-4f42-9dda-63e5309b882e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE880C62D0>]}
[0m11:07:44.511256 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:07:44.831636 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:07:44.970648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:44.970648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:44.970648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:07:45.002409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43a95476-cc68-4f42-9dda-63e5309b882e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE882DA7B0>]}
[0m11:07:45.065795 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:07:45.081621 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:07:45.109433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43a95476-cc68-4f42-9dda-63e5309b882e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE89625FA0>]}
[0m11:07:45.109433 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:07:45.109433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43a95476-cc68-4f42-9dda-63e5309b882e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE895FA030>]}
[0m11:07:45.113274 [info ] [MainThread]: 
[0m11:07:45.113274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:45.113274 [info ] [MainThread]: 
[0m11:07:45.113274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:07:45.113274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:07:45.192773 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:07:45.192773 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:07:45.192773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:45.672540 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.476 seconds
[0m11:07:45.672540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:07:45.688371 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:07:45.688371 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:07:45.688371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:46.142179 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.454 seconds
[0m11:07:46.154534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43a95476-cc68-4f42-9dda-63e5309b882e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE882D8BF0>]}
[0m11:07:46.154534 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m11:07:46.154534 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_customers .................................. [RUN]
[0m11:07:46.154534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m11:07:46.154534 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m11:07:46.170216 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m11:07:46.186091 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m11:07:46.218113 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m11:07:46.218113 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m11:07:46.218113 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT

        DISTINCT(customer_id) AS customer_id
        , customer_name
        , company
)
SELECT
    *
FROM optimized;
[0m11:07:46.218113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:46.516505 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef1-0001-429e-0008-511e00012936
[0m11:07:46.517543 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 42 at position 14 unexpected ';'.
[0m11:07:46.522729 [debug] [Thread-1 (]: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:07:46.525945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a95476-cc68-4f42-9dda-63e5309b882e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE86970800>]}
[0m11:07:46.526946 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_customers ......................... [[31mERROR[0m in 0.37s]
[0m11:07:46.527493 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m11:07:46.528588 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql.
[0m11:07:46.530657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:46.531928 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:07:46.531928 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:07:46.611445 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:07:46.611445 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:07:46.705613 [debug] [MainThread]: Connection 'model.Mini_Project.stg_customers' was left open.
[0m11:07:46.706731 [debug] [MainThread]: On model.Mini_Project.stg_customers: Close
[0m11:07:46.796167 [info ] [MainThread]: 
[0m11:07:46.797690 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m11:07:46.799426 [debug] [MainThread]: Command end result
[0m11:07:46.816684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:07:46.830366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:07:46.831385 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:07:46.831385 [info ] [MainThread]: 
[0m11:07:46.831385 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:07:46.831385 [info ] [MainThread]: 
[0m11:07:46.831385 [error] [MainThread]:   Database Error in model stg_customers (models\Staging\stg_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 42 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:07:46.831385 [info ] [MainThread]: 
[0m11:07:46.831385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:07:46.831385 [debug] [MainThread]: Command `dbt run` failed at 11:07:46.831385 after 2.97 seconds
[0m11:07:46.831385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE874AAFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE85237200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE88283B60>]}
[0m11:07:46.831385 [debug] [MainThread]: Flushing usage events
[0m11:07:47.731385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:20.441590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FCFF8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FCFFBE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FCFFB4D0>]}


============================== 11:08:20.457415 | 2c9984f7-93ec-4608-b290-f9a43c96671c ==============================
[0m11:08:20.457415 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:08:20.460534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m11:08:20.933154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c9984f7-93ec-4608-b290-f9a43c96671c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FC5362A0>]}
[0m11:08:20.996707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c9984f7-93ec-4608-b290-f9a43c96671c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FD9A5AC0>]}
[0m11:08:20.996707 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:08:21.411142 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:08:22.587967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:22.589976 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m11:08:22.824107 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:08:22.835841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c9984f7-93ec-4608-b290-f9a43c96671c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FF2F7F50>]}
[0m11:08:22.900402 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:08:22.915488 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:08:22.931135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c9984f7-93ec-4608-b290-f9a43c96671c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FEFEA390>]}
[0m11:08:22.931135 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:08:22.931135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9984f7-93ec-4608-b290-f9a43c96671c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FEDFA720>]}
[0m11:08:22.931135 [info ] [MainThread]: 
[0m11:08:22.931135 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:22.931135 [info ] [MainThread]: 
[0m11:08:22.931135 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:08:22.931135 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:08:25.458210 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:08:25.460629 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:08:25.460629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:26.373560 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.913 seconds
[0m11:08:26.376577 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:08:26.390689 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:08:26.390689 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:08:26.390689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:26.842129 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.452 seconds
[0m11:08:26.842129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9984f7-93ec-4608-b290-f9a43c96671c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FA43B4D0>]}
[0m11:08:26.857950 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m11:08:26.857950 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_customers .................................. [RUN]
[0m11:08:26.857950 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m11:08:26.857950 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m11:08:26.857950 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m11:08:26.857950 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m11:08:26.889926 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m11:08:26.889926 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m11:08:26.889926 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT

        DISTINCT(customer_id) AS customer_id
        , customer_name
        , company
)
SELECT
    *
FROM optimized
  );
[0m11:08:26.889926 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:27.365491 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef2-0001-429b-0008-511e00017406
[0m11:08:27.368452 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 36 at position 17
invalid identifier 'CUSTOMER_ID'
[0m11:08:27.380145 [debug] [Thread-1 (]: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 36 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:08:27.384463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9984f7-93ec-4608-b290-f9a43c96671c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FC4A0770>]}
[0m11:08:27.384463 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_customers ......................... [[31mERROR[0m in 0.52s]
[0m11:08:27.384463 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m11:08:27.386329 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 36 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql.
[0m11:08:27.386329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:27.386329 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:08:27.386329 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:08:27.464699 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:08:27.464699 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:08:27.573020 [debug] [MainThread]: Connection 'model.Mini_Project.stg_customers' was left open.
[0m11:08:27.575035 [debug] [MainThread]: On model.Mini_Project.stg_customers: Close
[0m11:08:27.657415 [info ] [MainThread]: 
[0m11:08:27.673215 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m11:08:27.673215 [debug] [MainThread]: Command end result
[0m11:08:27.752598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:08:27.754606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:08:27.759401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:08:27.761409 [info ] [MainThread]: 
[0m11:08:27.761409 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:08:27.761409 [info ] [MainThread]: 
[0m11:08:27.761409 [error] [MainThread]:   Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 36 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:08:27.761409 [info ] [MainThread]: 
[0m11:08:27.761409 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:08:27.761409 [debug] [MainThread]: Command `dbt run` failed at 11:08:27.761409 after 7.49 seconds
[0m11:08:27.761409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FAD9E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FAD9C740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201FF270650>]}
[0m11:08:27.761409 [debug] [MainThread]: Flushing usage events
[0m11:08:28.639777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:08.028493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E01118680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E011186E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E01118560>]}


============================== 11:09:08.028493 | 080d05dd-8ba9-41bf-b676-ee89adf5ce4b ==============================
[0m11:09:08.028493 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:09:08.028493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:09:08.455125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '080d05dd-8ba9-41bf-b676-ee89adf5ce4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E02EDA0C0>]}
[0m11:09:08.518351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '080d05dd-8ba9-41bf-b676-ee89adf5ce4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E7E4228D0>]}
[0m11:09:08.518351 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:09:08.819072 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:09:08.977650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:09:08.977650 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m11:09:09.200283 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:09:09.216342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '080d05dd-8ba9-41bf-b676-ee89adf5ce4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E034681A0>]}
[0m11:09:09.280057 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:09:09.280057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:09:09.312000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '080d05dd-8ba9-41bf-b676-ee89adf5ce4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E0317A750>]}
[0m11:09:09.312000 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:09:09.312000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '080d05dd-8ba9-41bf-b676-ee89adf5ce4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03434FB0>]}
[0m11:09:09.312000 [info ] [MainThread]: 
[0m11:09:09.312000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:09.312000 [info ] [MainThread]: 
[0m11:09:09.312000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:09.312000 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:09:09.407723 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:09:09.407723 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:09:09.407723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:10.188385 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.776 seconds
[0m11:09:10.204144 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:09:10.238094 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:09:10.238094 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:09:10.238094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:10.685827 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.461 seconds
[0m11:09:10.705029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '080d05dd-8ba9-41bf-b676-ee89adf5ce4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E02FAA9F0>]}
[0m11:09:10.705029 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m11:09:10.705029 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_customers .................................. [RUN]
[0m11:09:10.705029 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m11:09:10.705029 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m11:09:10.717831 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m11:09:10.719840 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m11:09:10.733755 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m11:09:10.733755 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m11:09:10.733755 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT(customer_id)
        , customer_name
        , company
)
SELECT
    *
FROM optimized
  );
[0m11:09:10.749592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:09:11.057548 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef3-0001-429b-0008-511e0001740a
[0m11:09:11.057548 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 17
invalid identifier 'CUSTOMER_ID'
[0m11:09:11.070923 [debug] [Thread-1 (]: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 35 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:09:11.070923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '080d05dd-8ba9-41bf-b676-ee89adf5ce4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03899A60>]}
[0m11:09:11.070923 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_customers ......................... [[31mERROR[0m in 0.37s]
[0m11:09:11.070923 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m11:09:11.070923 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 35 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql.
[0m11:09:11.070923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:11.070923 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:09:11.070923 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:09:11.169446 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:09:11.169446 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:09:11.259573 [debug] [MainThread]: Connection 'model.Mini_Project.stg_customers' was left open.
[0m11:09:11.261588 [debug] [MainThread]: On model.Mini_Project.stg_customers: Close
[0m11:09:11.328529 [info ] [MainThread]: 
[0m11:09:11.343744 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m11:09:11.343744 [debug] [MainThread]: Command end result
[0m11:09:11.415621 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:09:11.417629 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:09:11.423611 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:09:11.423611 [info ] [MainThread]: 
[0m11:09:11.423611 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:09:11.423611 [info ] [MainThread]: 
[0m11:09:11.423611 [error] [MainThread]:   Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 35 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:09:11.423611 [info ] [MainThread]: 
[0m11:09:11.423611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:09:11.423611 [debug] [MainThread]: Command `dbt run` failed at 11:09:11.423611 after 3.56 seconds
[0m11:09:11.423611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E03367170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E00629D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018E01AEC9B0>]}
[0m11:09:11.423611 [debug] [MainThread]: Flushing usage events
[0m11:09:12.313184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:10:07.742761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E08E28410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E08E28EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E08E28350>]}


============================== 11:10:07.751611 | fe030f6a-55c4-42c9-843f-c91e9ce38d7c ==============================
[0m11:10:07.751611 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:10:07.751611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:10:08.167026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe030f6a-55c4-42c9-843f-c91e9ce38d7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E09B114F0>]}
[0m11:10:08.229730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe030f6a-55c4-42c9-843f-c91e9ce38d7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E09AC4560>]}
[0m11:10:08.229730 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:10:08.543645 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:10:08.690902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:10:08.690902 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m11:10:08.929645 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:10:08.943709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe030f6a-55c4-42c9-843f-c91e9ce38d7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0AE38950>]}
[0m11:10:09.007704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:10:09.007704 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:10:09.023571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe030f6a-55c4-42c9-843f-c91e9ce38d7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0AE38830>]}
[0m11:10:09.023571 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:10:09.023571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe030f6a-55c4-42c9-843f-c91e9ce38d7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0AE9A000>]}
[0m11:10:09.039336 [info ] [MainThread]: 
[0m11:10:09.039336 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:09.039336 [info ] [MainThread]: 
[0m11:10:09.039336 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:09.039336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:10:09.128923 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:10:09.128923 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:10:09.128923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:09.917093 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.790 seconds
[0m11:10:09.924448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:10:09.937463 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:10:09.939473 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:10:09.939473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:10.347387 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.408 seconds
[0m11:10:10.347387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe030f6a-55c4-42c9-843f-c91e9ce38d7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0B087830>]}
[0m11:10:10.363090 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m11:10:10.363090 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_customers .................................. [RUN]
[0m11:10:10.363090 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m11:10:10.363090 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m11:10:10.363090 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m11:10:10.363090 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m11:10:10.394690 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m11:10:10.394690 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m11:10:10.394690 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company
)
SELECT
    *
FROM optimized
  );
[0m11:10:10.394690 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:10.847924 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafef4-0001-429e-0008-511e00012942
[0m11:10:10.847924 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 17
invalid identifier 'CUSTOMER_ID'
[0m11:10:10.847924 [debug] [Thread-1 (]: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 35 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:10:10.861644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe030f6a-55c4-42c9-843f-c91e9ce38d7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E082F0770>]}
[0m11:10:10.861644 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_customers ......................... [[31mERROR[0m in 0.48s]
[0m11:10:10.861644 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m11:10:10.861644 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 35 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql.
[0m11:10:10.861644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:10.861644 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:10:10.861644 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:10:10.948507 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:10:10.948507 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:10:11.035772 [debug] [MainThread]: Connection 'model.Mini_Project.stg_customers' was left open.
[0m11:10:11.037790 [debug] [MainThread]: On model.Mini_Project.stg_customers: Close
[0m11:10:11.122400 [info ] [MainThread]: 
[0m11:10:11.122400 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m11:10:11.122400 [debug] [MainThread]: Command end result
[0m11:10:11.215130 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:10:11.217138 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:10:11.221303 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:10:11.223323 [info ] [MainThread]: 
[0m11:10:11.223323 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:10:11.223323 [info ] [MainThread]: 
[0m11:10:11.223323 [error] [MainThread]:   Database Error in model stg_customers (models\Staging\stg_customers.sql)
  000904 (42000): SQL compilation error: error line 35 at position 17
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_customers.sql
[0m11:10:11.223323 [info ] [MainThread]: 
[0m11:10:11.223323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:10:11.223323 [debug] [MainThread]: Command `dbt run` failed at 11:10:11.223323 after 3.64 seconds
[0m11:10:11.223323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E08E942F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E08E94A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E06B598B0>]}
[0m11:10:11.223323 [debug] [MainThread]: Flushing usage events
[0m11:10:12.127472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:14:16.333614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2C5375C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2BF535F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2C534EF0>]}


============================== 11:14:16.333614 | daee6f8a-88ac-4fb5-bfff-558c73fe1f2d ==============================
[0m11:14:16.333614 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:14:16.333614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m11:14:16.747060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daee6f8a-88ac-4fb5-bfff-558c73fe1f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2D240FB0>]}
[0m11:14:16.810353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daee6f8a-88ac-4fb5-bfff-558c73fe1f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2BD8F140>]}
[0m11:14:16.810353 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:14:17.139302 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:14:17.286332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:14:17.286332 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m11:14:17.509552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:14:17.525229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daee6f8a-88ac-4fb5-bfff-558c73fe1f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E863E30>]}
[0m11:14:17.588604 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:14:17.604501 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:14:17.620833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daee6f8a-88ac-4fb5-bfff-558c73fe1f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E5F7530>]}
[0m11:14:17.620833 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:14:17.620833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daee6f8a-88ac-4fb5-bfff-558c73fe1f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E4F9DF0>]}
[0m11:14:17.620833 [info ] [MainThread]: 
[0m11:14:17.620833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:17.620833 [info ] [MainThread]: 
[0m11:14:17.620833 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:17.620833 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:14:17.715831 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:14:17.715831 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:14:17.715831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:18.947371 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.230 seconds
[0m11:14:18.954198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:14:18.970046 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:14:18.970046 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:14:18.970046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:19.422669 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.452 seconds
[0m11:14:19.422669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daee6f8a-88ac-4fb5-bfff-558c73fe1f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E35E9C0>]}
[0m11:14:19.436174 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m11:14:19.436174 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_customers .................................. [RUN]
[0m11:14:19.436174 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m11:14:19.436174 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m11:14:19.436174 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m11:14:19.436174 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m11:14:19.467919 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m11:14:19.467919 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m11:14:19.467919 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m11:14:19.467919 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:14:19.887109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.414 seconds
[0m11:14:19.918521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daee6f8a-88ac-4fb5-bfff-558c73fe1f2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2BA00920>]}
[0m11:14:19.918521 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_customers ............................. [[32mSUCCESS 1[0m in 0.47s]
[0m11:14:19.918521 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m11:14:19.918521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:19.918521 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:14:19.918521 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:14:19.999471 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:14:19.999471 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:14:20.080157 [debug] [MainThread]: Connection 'model.Mini_Project.stg_customers' was left open.
[0m11:14:20.080157 [debug] [MainThread]: On model.Mini_Project.stg_customers: Close
[0m11:14:20.176670 [info ] [MainThread]: 
[0m11:14:20.176670 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m11:14:20.176670 [debug] [MainThread]: Command end result
[0m11:14:20.256194 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:14:20.256194 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:14:20.256194 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:14:20.256194 [info ] [MainThread]: 
[0m11:14:20.256194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:20.256194 [info ] [MainThread]: 
[0m11:14:20.271905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:20.271905 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:20.271905 after 4.10 seconds
[0m11:14:20.271905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E765AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E8094F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2E80AA50>]}
[0m11:14:20.271905 [debug] [MainThread]: Flushing usage events
[0m11:14:21.708593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:36.998486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5B234110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5B2340E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5B234E60>]}


============================== 11:18:36.998486 | 2bc74c0f-49fb-4242-bf37-1f15707297fe ==============================
[0m11:18:36.998486 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:18:36.998486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_products', 'send_anonymous_usage_stats': 'True'}
[0m11:18:37.424884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bc74c0f-49fb-4242-bf37-1f15707297fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5A7962D0>]}
[0m11:18:37.472542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bc74c0f-49fb-4242-bf37-1f15707297fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5A23CFE0>]}
[0m11:18:37.472542 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:18:37.804534 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:18:37.946458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:18:37.946458 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_products.sql
[0m11:18:38.137053 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_products (models\Staging\stg_products.sql)
  expected token ',', got '='
    line 3
      --         tags=['basic', 'staging']
[0m11:18:38.137053 [debug] [MainThread]: Command `dbt run` failed at 11:18:38.137053 after 1.31 seconds
[0m11:18:38.137053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5B237D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5D404050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB5D044D40>]}
[0m11:18:38.137053 [debug] [MainThread]: Flushing usage events
[0m11:18:39.446653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:19:48.311451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294633280E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029463328AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029463328E60>]}


============================== 11:19:48.325899 | 4c41481d-8b4f-4837-a9d8-5de6c99f6dcf ==============================
[0m11:19:48.325899 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:19:48.325899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_products', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:19:48.739191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c41481d-8b4f-4837-a9d8-5de6c99f6dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029463D9F140>]}
[0m11:19:48.802700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c41481d-8b4f-4837-a9d8-5de6c99f6dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294635DE270>]}
[0m11:19:48.802700 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:19:49.124528 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:19:49.251877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:49.251877 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_products.sql
[0m11:19:49.500451 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m11:19:49.500451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c41481d-8b4f-4837-a9d8-5de6c99f6dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294654C5760>]}
[0m11:19:49.579585 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:19:49.579585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:19:49.607705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c41481d-8b4f-4837-a9d8-5de6c99f6dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294653F7770>]}
[0m11:19:49.607705 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:19:49.607705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c41481d-8b4f-4837-a9d8-5de6c99f6dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002946406B9E0>]}
[0m11:19:49.611371 [info ] [MainThread]: 
[0m11:19:49.611371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:49.611371 [info ] [MainThread]: 
[0m11:19:49.611371 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:19:49.611371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:19:49.691175 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:19:49.691175 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:19:49.691175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:50.561942 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.861 seconds
[0m11:19:50.561942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:19:50.578035 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:19:50.578035 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:19:50.578035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:51.013413 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.440 seconds
[0m11:19:51.013413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c41481d-8b4f-4837-a9d8-5de6c99f6dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029465635FD0>]}
[0m11:19:51.029425 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m11:19:51.029425 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_products ................................... [RUN]
[0m11:19:51.029425 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_products'
[0m11:19:51.029425 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m11:19:51.029425 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m11:19:51.029425 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m11:19:51.061123 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m11:19:51.061123 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m11:19:51.061123 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
    WHERE
    product_id is not null
)
SELECT
    *
FROM optimized
  );
[0m11:19:51.061123 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:19:51.609222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m11:19:51.655563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c41481d-8b4f-4837-a9d8-5de6c99f6dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294606F1760>]}
[0m11:19:51.655563 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_products .............................. [[32mSUCCESS 1[0m in 0.61s]
[0m11:19:51.655563 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m11:19:51.657335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:51.657335 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:19:51.657335 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:19:51.737421 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:19:51.737421 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:19:51.823895 [debug] [MainThread]: Connection 'model.Mini_Project.stg_products' was left open.
[0m11:19:51.823895 [debug] [MainThread]: On model.Mini_Project.stg_products: Close
[0m11:19:51.913261 [info ] [MainThread]: 
[0m11:19:51.913261 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m11:19:51.913261 [debug] [MainThread]: Command end result
[0m11:19:51.992135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:19:51.998070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:19:52.004324 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:19:52.004324 [info ] [MainThread]: 
[0m11:19:52.004324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:19:52.004324 [info ] [MainThread]: 
[0m11:19:52.004324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:19:52.004324 [debug] [MainThread]: Command `dbt run` succeeded at 11:19:52.004324 after 3.85 seconds
[0m11:19:52.004324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294610E6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029465662DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294630C32F0>]}
[0m11:19:52.007830 [debug] [MainThread]: Flushing usage events
[0m11:19:53.310924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:23:24.124347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F5C14410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F5C14740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F5C144A0>]}


============================== 11:23:24.130545 | fae0d3e6-1012-4c84-bab9-4b857844b7b5 ==============================
[0m11:23:24.130545 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:23:24.130545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_region', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:23:24.589463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae0d3e6-1012-4c84-bab9-4b857844b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F69776E0>]}
[0m11:23:24.652339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae0d3e6-1012-4c84-bab9-4b857844b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F5406660>]}
[0m11:23:24.652339 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:23:25.079488 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:23:26.269641 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:23:26.269641 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Staging\stg_region.sql
[0m11:23:26.269641 [debug] [MainThread]: Partial parsing: deleted file: Mini_Project://models\Staging\stg_reagion.sql
[0m11:23:26.512571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:23:26.520504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae0d3e6-1012-4c84-bab9-4b857844b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F7A79F40>]}
[0m11:23:26.583778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:23:26.599925 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:23:26.623410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae0d3e6-1012-4c84-bab9-4b857844b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F7C07B90>]}
[0m11:23:26.623410 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:23:26.623410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae0d3e6-1012-4c84-bab9-4b857844b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F7F45FA0>]}
[0m11:23:26.631603 [info ] [MainThread]: 
[0m11:23:26.631603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:26.631603 [info ] [MainThread]: 
[0m11:23:26.631603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:23:26.631603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:23:29.189631 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:23:29.189631 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:23:29.189631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:30.018047 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.840 seconds
[0m11:23:30.034117 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:23:30.050098 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:23:30.050098 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:23:30.050098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:30.583835 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.531 seconds
[0m11:23:30.601038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae0d3e6-1012-4c84-bab9-4b857844b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F7F3D490>]}
[0m11:23:30.601038 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m11:23:30.601038 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_region ..................................... [RUN]
[0m11:23:30.601038 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_region'
[0m11:23:30.601038 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m11:23:30.614922 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m11:23:30.614922 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m11:23:30.630632 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m11:23:30.646300 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m11:23:30.646300 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m11:23:30.646300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:23:31.065164 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m11:23:31.097097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fae0d3e6-1012-4c84-bab9-4b857844b7b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F2FF15B0>]}
[0m11:23:31.097097 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_region ................................ [[32mSUCCESS 1[0m in 0.50s]
[0m11:23:31.112956 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m11:23:31.112956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:31.112956 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:23:31.112956 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:23:31.194124 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:23:31.194124 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:23:31.290649 [debug] [MainThread]: Connection 'model.Mini_Project.stg_region' was left open.
[0m11:23:31.290649 [debug] [MainThread]: On model.Mini_Project.stg_region: Close
[0m11:23:31.385916 [info ] [MainThread]: 
[0m11:23:31.385916 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m11:23:31.396397 [debug] [MainThread]: Command end result
[0m11:23:31.471159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:23:31.473167 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:23:31.476985 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:23:31.478994 [info ] [MainThread]: 
[0m11:23:31.478994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:31.478994 [info ] [MainThread]: 
[0m11:23:31.478994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:23:31.481033 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:31.481033 after 7.54 seconds
[0m11:23:31.481033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F66241D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F7F4F620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2F7F4E0C0>]}
[0m11:23:31.481033 [debug] [MainThread]: Flushing usage events
[0m11:23:32.783404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:48.669644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B502DE4F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B502DE4F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B502DE4D70>]}


============================== 11:35:48.669644 | 362d653d-0821-420f-a177-374d9eb4347b ==============================
[0m11:35:48.669644 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:35:48.679754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_transaction', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:35:49.123473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '362d653d-0821-420f-a177-374d9eb4347b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B503B087A0>]}
[0m11:35:49.179708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '362d653d-0821-420f-a177-374d9eb4347b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5026D6120>]}
[0m11:35:49.179708 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:35:49.519536 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:35:49.678586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:35:49.678586 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_trasaction.sql
[0m11:35:49.915437 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:35:49.931409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '362d653d-0821-420f-a177-374d9eb4347b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5050458E0>]}
[0m11:35:49.994813 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:35:49.994813 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:35:50.026342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '362d653d-0821-420f-a177-374d9eb4347b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B505104320>]}
[0m11:35:50.026342 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:35:50.026342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '362d653d-0821-420f-a177-374d9eb4347b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B500B1E900>]}
[0m11:35:50.028384 [warn ] [MainThread]: The selection criterion 'stg_transaction' does not match any enabled nodes
[0m11:35:50.028772 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:35:50.028772 [debug] [MainThread]: Command end result
[0m11:35:50.042104 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:35:50.042104 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:35:50.042104 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:35:50.042104 [debug] [MainThread]: Command `dbt run` succeeded at 11:35:50.042104 after 1.56 seconds
[0m11:35:50.042104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B502857EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B50514ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B5050628A0>]}
[0m11:35:50.058127 [debug] [MainThread]: Flushing usage events
[0m11:35:50.937927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:36:17.024641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC7A4D430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC78B6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC70F6ED0>]}


============================== 11:36:17.032103 | 7361206b-7326-4686-9843-df27c171a612 ==============================
[0m11:36:17.032103 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:36:17.032103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:36:17.474150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7361206b-7326-4686-9843-df27c171a612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC7A4D040>]}
[0m11:36:17.525564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7361206b-7326-4686-9843-df27c171a612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC85BFBF0>]}
[0m11:36:17.525564 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:36:17.871477 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:36:18.014691 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m11:36:18.025783 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Staging\stg_transaction.sql
[0m11:36:18.025783 [debug] [MainThread]: Partial parsing: deleted file: Mini_Project://models\Staging\stg_trasaction.sql
[0m11:36:18.266913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m11:36:18.282954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7361206b-7326-4686-9843-df27c171a612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC9C35760>]}
[0m11:36:18.346803 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:36:18.346803 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:36:18.362561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7361206b-7326-4686-9843-df27c171a612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC9D775C0>]}
[0m11:36:18.362561 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:36:18.362561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7361206b-7326-4686-9843-df27c171a612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC9C364E0>]}
[0m11:36:18.378711 [info ] [MainThread]: 
[0m11:36:18.378711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:18.378711 [info ] [MainThread]: 
[0m11:36:18.378711 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:36:18.378711 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:36:18.473790 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:36:18.473790 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:36:18.473790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:19.288305 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.816 seconds
[0m11:36:19.288305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:36:19.309369 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:36:19.309369 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:36:19.309369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:19.765309 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.462 seconds
[0m11:36:19.765309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7361206b-7326-4686-9843-df27c171a612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC9D94F50>]}
[0m11:36:19.781295 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m11:36:19.781295 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m11:36:19.781295 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m11:36:19.781295 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m11:36:19.781295 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m11:36:19.781295 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m11:36:19.812887 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m11:36:19.812887 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m11:36:19.812887 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        , customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION

),

optimized AS(
    SELECT

        , CAST(customer AS INT)     AS  customer_id
        , product_id 
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS INT)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m11:36:19.812887 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:36:20.255551 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff0e-0001-429b-0008-511e0001753e
[0m11:36:20.255551 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 8 unexpected ','.
syntax error line 14 at position 8 unexpected ','.
syntax error line 15 at position 8 unexpected ','.
syntax error line 16 at position 8 unexpected ','.
syntax error line 17 at position 8 unexpected ','.
syntax error line 18 at position 8 unexpected ','.
syntax error line 19 at position 8 unexpected ','.
syntax error line 20 at position 8 unexpected ','.
syntax error line 21 at position 8 unexpected ','.
syntax error line 22 at position 8 unexpected ','.
syntax error line 23 at position 8 unexpected ','.
syntax error line 24 at position 8 unexpected ','.
syntax error line 25 at position 8 unexpected ','.
syntax error line 26 at position 8 unexpected ','.
syntax error line 27 at position 8 unexpected ','.
syntax error line 28 at position 8 unexpected ','.
syntax error line 29 at position 8 unexpected ','.
syntax error line 31 at position 4 unexpected 'FROM'.
syntax error line 33 at position 1 unexpected ','.
[0m11:36:20.271246 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ','.
  syntax error line 14 at position 8 unexpected ','.
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected ','.
  syntax error line 17 at position 8 unexpected ','.
  syntax error line 18 at position 8 unexpected ','.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 8 unexpected ','.
  syntax error line 28 at position 8 unexpected ','.
  syntax error line 29 at position 8 unexpected ','.
  syntax error line 31 at position 4 unexpected 'FROM'.
  syntax error line 33 at position 1 unexpected ','.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m11:36:20.287234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7361206b-7326-4686-9843-df27c171a612', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC9D95160>]}
[0m11:36:20.287234 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.49s]
[0m11:36:20.287234 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m11:36:20.287234 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ','.
  syntax error line 14 at position 8 unexpected ','.
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected ','.
  syntax error line 17 at position 8 unexpected ','.
  syntax error line 18 at position 8 unexpected ','.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 8 unexpected ','.
  syntax error line 28 at position 8 unexpected ','.
  syntax error line 29 at position 8 unexpected ','.
  syntax error line 31 at position 4 unexpected 'FROM'.
  syntax error line 33 at position 1 unexpected ','.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m11:36:20.287234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:20.287234 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:36:20.287234 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:36:20.366867 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:36:20.366867 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:36:20.463787 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m11:36:20.463787 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m11:36:20.543794 [info ] [MainThread]: 
[0m11:36:20.543794 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m11:36:20.543794 [debug] [MainThread]: Command end result
[0m11:36:20.623479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:36:20.623479 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:36:20.630318 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:36:20.630318 [info ] [MainThread]: 
[0m11:36:20.630318 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:36:20.630318 [info ] [MainThread]: 
[0m11:36:20.630318 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ','.
  syntax error line 14 at position 8 unexpected ','.
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected ','.
  syntax error line 17 at position 8 unexpected ','.
  syntax error line 18 at position 8 unexpected ','.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 8 unexpected ','.
  syntax error line 28 at position 8 unexpected ','.
  syntax error line 29 at position 8 unexpected ','.
  syntax error line 31 at position 4 unexpected 'FROM'.
  syntax error line 33 at position 1 unexpected ','.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m11:36:20.630318 [info ] [MainThread]: 
[0m11:36:20.630318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:36:20.630318 [debug] [MainThread]: Command `dbt run` failed at 11:36:20.630318 after 3.77 seconds
[0m11:36:20.630318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC77EF920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC84CF380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015AC79229F0>]}
[0m11:36:20.630318 [debug] [MainThread]: Flushing usage events
[0m11:36:21.523961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:47:53.024751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDDABB0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDDAB85F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDDAB8B00>]}


============================== 11:47:53.037142 | 134c7d7b-af86-4185-8ff2-33f586cea8ae ==============================
[0m11:47:53.037142 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:47:53.037142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m11:47:53.829807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '134c7d7b-af86-4185-8ff2-33f586cea8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDAEC2660>]}
[0m11:47:53.888906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '134c7d7b-af86-4185-8ff2-33f586cea8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDE675640>]}
[0m11:47:53.888906 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:47:54.354348 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:47:55.641494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:47:55.641494 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m11:47:55.880048 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m11:47:55.896169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '134c7d7b-af86-4185-8ff2-33f586cea8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDFDCC620>]}
[0m11:47:55.960419 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:47:55.976136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:47:56.037124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '134c7d7b-af86-4185-8ff2-33f586cea8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDFB45CD0>]}
[0m11:47:56.039557 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:47:56.039557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '134c7d7b-af86-4185-8ff2-33f586cea8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDFDCF2C0>]}
[0m11:47:56.039557 [info ] [MainThread]: 
[0m11:47:56.039557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:47:56.039557 [info ] [MainThread]: 
[0m11:47:56.039557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:47:56.039557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:47:58.720389 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:47:58.720389 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:47:58.720389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:59.872707 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.159 seconds
[0m11:47:59.888661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:47:59.898238 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:47:59.898238 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:47:59.898238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:00.355883 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.458 seconds
[0m11:48:00.362579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '134c7d7b-af86-4185-8ff2-33f586cea8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDFDB8C50>]}
[0m11:48:00.371899 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m11:48:00.371899 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m11:48:00.371899 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m11:48:00.371899 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m11:48:00.371899 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m11:48:00.371899 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m11:48:00.414276 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m11:48:00.414276 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m11:48:00.414276 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        , customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION

),

optimized AS(
    SELECT

        CAST(customer AS INT)     AS  customer_id
        , product_id 
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS INT)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m11:48:00.414276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:48:00.858627 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff1a-0001-429a-0008-511e0001b2f2
[0m11:48:00.858627 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 8 unexpected ','.
syntax error line 14 at position 8 unexpected ','.
syntax error line 15 at position 8 unexpected ','.
syntax error line 16 at position 8 unexpected ','.
syntax error line 17 at position 8 unexpected ','.
syntax error line 18 at position 8 unexpected ','.
syntax error line 19 at position 8 unexpected ','.
syntax error line 20 at position 8 unexpected ','.
syntax error line 21 at position 8 unexpected ','.
syntax error line 22 at position 8 unexpected ','.
syntax error line 23 at position 8 unexpected ','.
syntax error line 24 at position 8 unexpected ','.
syntax error line 25 at position 8 unexpected ','.
syntax error line 26 at position 8 unexpected ','.
syntax error line 27 at position 8 unexpected ','.
syntax error line 28 at position 8 unexpected ','.
syntax error line 29 at position 8 unexpected ','.
syntax error line 31 at position 4 unexpected 'FROM'.
syntax error line 33 at position 1 unexpected ','.
[0m11:48:00.867899 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ','.
  syntax error line 14 at position 8 unexpected ','.
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected ','.
  syntax error line 17 at position 8 unexpected ','.
  syntax error line 18 at position 8 unexpected ','.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 8 unexpected ','.
  syntax error line 28 at position 8 unexpected ','.
  syntax error line 29 at position 8 unexpected ','.
  syntax error line 31 at position 4 unexpected 'FROM'.
  syntax error line 33 at position 1 unexpected ','.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m11:48:00.867899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '134c7d7b-af86-4185-8ff2-33f586cea8ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDCF706E0>]}
[0m11:48:00.867899 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.50s]
[0m11:48:00.867899 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m11:48:00.867899 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ','.
  syntax error line 14 at position 8 unexpected ','.
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected ','.
  syntax error line 17 at position 8 unexpected ','.
  syntax error line 18 at position 8 unexpected ','.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 8 unexpected ','.
  syntax error line 28 at position 8 unexpected ','.
  syntax error line 29 at position 8 unexpected ','.
  syntax error line 31 at position 4 unexpected 'FROM'.
  syntax error line 33 at position 1 unexpected ','.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m11:48:00.867899 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:00.867899 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:48:00.867899 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:48:00.947642 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:48:00.947642 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:48:01.027654 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m11:48:01.043588 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m11:48:01.123478 [info ] [MainThread]: 
[0m11:48:01.123478 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.08 seconds (5.08s).
[0m11:48:01.136677 [debug] [MainThread]: Command end result
[0m11:48:01.234613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:48:01.234613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:48:01.234613 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:48:01.234613 [info ] [MainThread]: 
[0m11:48:01.234613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:48:01.234613 [info ] [MainThread]: 
[0m11:48:01.234613 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 8 unexpected ','.
  syntax error line 14 at position 8 unexpected ','.
  syntax error line 15 at position 8 unexpected ','.
  syntax error line 16 at position 8 unexpected ','.
  syntax error line 17 at position 8 unexpected ','.
  syntax error line 18 at position 8 unexpected ','.
  syntax error line 19 at position 8 unexpected ','.
  syntax error line 20 at position 8 unexpected ','.
  syntax error line 21 at position 8 unexpected ','.
  syntax error line 22 at position 8 unexpected ','.
  syntax error line 23 at position 8 unexpected ','.
  syntax error line 24 at position 8 unexpected ','.
  syntax error line 25 at position 8 unexpected ','.
  syntax error line 26 at position 8 unexpected ','.
  syntax error line 27 at position 8 unexpected ','.
  syntax error line 28 at position 8 unexpected ','.
  syntax error line 29 at position 8 unexpected ','.
  syntax error line 31 at position 4 unexpected 'FROM'.
  syntax error line 33 at position 1 unexpected ','.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m11:48:01.234613 [info ] [MainThread]: 
[0m11:48:01.234613 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:01.250465 [debug] [MainThread]: Command `dbt run` failed at 11:48:01.250465 after 8.42 seconds
[0m11:48:01.250465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDB7CAA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDD1469F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EDE7161E0>]}
[0m11:48:01.250465 [debug] [MainThread]: Flushing usage events
[0m11:48:02.231970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:50:51.928687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B44DB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B78835F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B7AB2000>]}


============================== 11:50:51.932440 | 065224ce-5ea5-4d70-9bcb-9e9205510d4e ==============================
[0m11:50:51.932440 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:50:51.932440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_transaction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:50:52.371316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '065224ce-5ea5-4d70-9bcb-9e9205510d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B89B2CC0>]}
[0m11:50:52.434601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '065224ce-5ea5-4d70-9bcb-9e9205510d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B7116180>]}
[0m11:50:52.434601 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:50:52.735321 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:50:52.893679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:50:52.893679 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m11:50:53.133678 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m11:50:53.147069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065224ce-5ea5-4d70-9bcb-9e9205510d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B9F7C980>]}
[0m11:50:53.225332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:50:53.229082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:50:53.255131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065224ce-5ea5-4d70-9bcb-9e9205510d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B9F34770>]}
[0m11:50:53.255131 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:50:53.255131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065224ce-5ea5-4d70-9bcb-9e9205510d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B9F7B050>]}
[0m11:50:53.258484 [info ] [MainThread]: 
[0m11:50:53.258484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:50:53.258484 [info ] [MainThread]: 
[0m11:50:53.258484 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:50:53.258484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:50:53.338681 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:50:53.338681 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:50:53.338681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:54.622474 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.275 seconds
[0m11:50:54.626488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:50:54.638399 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:50:54.638399 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:50:54.638399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:55.058407 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.433 seconds
[0m11:50:55.074275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065224ce-5ea5-4d70-9bcb-9e9205510d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B9F7CA40>]}
[0m11:50:55.090076 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m11:50:55.099818 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m11:50:55.099818 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m11:50:55.103679 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m11:50:55.111717 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m11:50:55.111717 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m11:50:55.140006 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m11:50:55.140006 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m11:50:55.140006 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION

),

optimized AS(
    SELECT

        CAST(customer AS INT)     AS  customer_id
        , product_id 
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS INT)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m11:50:55.143730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:50:56.288393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.146 seconds
[0m11:50:56.310224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065224ce-5ea5-4d70-9bcb-9e9205510d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B4F81700>]}
[0m11:50:56.310224 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 1.21s]
[0m11:50:56.310224 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m11:50:56.313880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:56.313880 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:50:56.313880 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:50:56.394267 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:50:56.394267 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:50:56.475247 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m11:50:56.475247 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m11:50:56.558131 [info ] [MainThread]: 
[0m11:50:56.558131 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m11:50:56.563487 [debug] [MainThread]: Command end result
[0m11:50:56.650414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:50:56.650414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:50:56.650414 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:50:56.650414 [info ] [MainThread]: 
[0m11:50:56.650414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:50:56.650414 [info ] [MainThread]: 
[0m11:50:56.650414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:50:56.650414 [debug] [MainThread]: Command `dbt run` succeeded at 11:50:56.650414 after 4.90 seconds
[0m11:50:56.650414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B6B8F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B6B8EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9B9E19880>]}
[0m11:50:56.650414 [debug] [MainThread]: Flushing usage events
[0m11:50:57.616837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:05.912958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638D7C36E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002639057C3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026390D4C380>]}


============================== 11:57:05.926533 | 3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5 ==============================
[0m11:57:05.926533 [info ] [MainThread]: Running with dbt=1.9.3
[0m11:57:05.926533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m11:57:06.387593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026391A71790>]}
[0m11:57:06.453184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026390229E80>]}
[0m11:57:06.453184 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:57:06.881251 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m11:57:08.067421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:57:08.067421 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m11:57:08.306103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m11:57:08.321967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263930DC7A0>]}
[0m11:57:08.389019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:57:08.401878 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:57:08.433753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026393098380>]}
[0m11:57:08.433753 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m11:57:08.433753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263930D7590>]}
[0m11:57:08.433753 [info ] [MainThread]: 
[0m11:57:08.433753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:57:08.433753 [info ] [MainThread]: 
[0m11:57:08.433753 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:57:08.433753 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m11:57:10.985158 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m11:57:10.985158 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m11:57:10.985158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:11.880608 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.903 seconds
[0m11:57:11.896709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m11:57:11.896709 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m11:57:11.896709 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m11:57:11.896709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:57:12.219548 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.320 seconds
[0m11:57:12.219548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026392F7A030>]}
[0m11:57:12.235308 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m11:57:12.235308 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m11:57:12.235308 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m11:57:12.235308 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m11:57:12.235308 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m11:57:12.235308 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m11:57:12.267202 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m11:57:12.267202 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m11:57:12.267202 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT

        CAST(customer AS INT)     AS  customer_id
        , product_id 
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS INT)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m11:57:12.267202 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:57:12.796216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m11:57:12.815920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3508c2b6-f7a2-4fec-9d27-b0cea1c8aee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002638E141610>]}
[0m11:57:12.815920 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.58s]
[0m11:57:12.815920 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m11:57:12.815920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:57:12.815920 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m11:57:12.815920 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m11:57:12.907812 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m11:57:12.907812 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m11:57:12.996699 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m11:57:12.996699 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m11:57:13.087041 [info ] [MainThread]: 
[0m11:57:13.096602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m11:57:13.096602 [debug] [MainThread]: Command end result
[0m11:57:13.167135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m11:57:13.167135 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m11:57:13.167135 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m11:57:13.167135 [info ] [MainThread]: 
[0m11:57:13.167135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:57:13.167135 [info ] [MainThread]: 
[0m11:57:13.167135 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:57:13.167135 [debug] [MainThread]: Command `dbt run` succeeded at 11:57:13.167135 after 7.46 seconds
[0m11:57:13.167135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263906379B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026390AB9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263903E4EC0>]}
[0m11:57:13.167135 [debug] [MainThread]: Flushing usage events
[0m11:57:14.127872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:51.472426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0F3B2C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0E9D7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0F3B2840>]}


============================== 12:02:51.472426 | 94ccbfd4-a651-44f2-afe7-43bf861dae76 ==============================
[0m12:02:51.472426 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:02:51.472426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:02:51.897995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0F3CDBB0>]}
[0m12:02:51.961721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F100A1DC0>]}
[0m12:02:51.961721 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:02:52.280533 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:02:52.421370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:02:52.421370 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m12:02:52.421370 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_products.sql
[0m12:02:52.659331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:02:52.675332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F11534710>]}
[0m12:02:52.738879 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:02:52.738879 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:02:52.770288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F116384D0>]}
[0m12:02:52.770288 [info ] [MainThread]: Found 4 models, 4 sources, 474 macros
[0m12:02:52.770288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0F24DB20>]}
[0m12:02:52.770288 [info ] [MainThread]: 
[0m12:02:52.770288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:02:52.770288 [info ] [MainThread]: 
[0m12:02:52.770288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:02:52.770288 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:02:52.865834 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:02:52.865834 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:02:52.865834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:53.686112 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.829 seconds
[0m12:02:53.698477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:02:53.698477 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:02:53.698477 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:02:53.698477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:54.146394 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.435 seconds
[0m12:02:54.146394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F100A2750>]}
[0m12:02:54.146394 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m12:02:54.146394 [info ] [Thread-1 (]: 1 of 4 START sql view model RAW.stg_customers .................................. [RUN]
[0m12:02:54.146394 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m12:02:54.146394 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m12:02:54.162268 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m12:02:54.162268 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m12:02:54.178038 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m12:02:54.193788 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m12:02:54.193788 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m12:02:54.193788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:54.617752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.425 seconds
[0m12:02:54.635625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0C7517F0>]}
[0m12:02:54.635625 [info ] [Thread-1 (]: 1 of 4 OK created sql view model RAW.stg_customers ............................. [[32mSUCCESS 1[0m in 0.49s]
[0m12:02:54.635625 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m12:02:54.647898 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m12:02:54.647898 [info ] [Thread-1 (]: 2 of 4 START sql view model RAW.stg_products ................................... [RUN]
[0m12:02:54.647898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m12:02:54.647898 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m12:02:54.647898 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m12:02:54.647898 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m12:02:54.696235 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m12:02:54.696235 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m12:02:54.696235 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m12:02:54.909544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m12:02:54.921875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0EEF6810>]}
[0m12:02:54.921875 [info ] [Thread-1 (]: 2 of 4 OK created sql view model RAW.stg_products .............................. [[32mSUCCESS 1[0m in 0.26s]
[0m12:02:54.927318 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m12:02:54.927318 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m12:02:54.927318 [info ] [Thread-1 (]: 3 of 4 START sql view model RAW.stg_region ..................................... [RUN]
[0m12:02:54.927318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m12:02:54.927318 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m12:02:54.937862 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m12:02:54.937862 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m12:02:54.937862 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m12:02:54.937862 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m12:02:54.937862 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:02:55.151070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.206 seconds
[0m12:02:55.151070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0E8507A0>]}
[0m12:02:55.151070 [info ] [Thread-1 (]: 3 of 4 OK created sql view model RAW.stg_region ................................ [[32mSUCCESS 1[0m in 0.22s]
[0m12:02:55.151070 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m12:02:55.151070 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:02:55.151070 [info ] [Thread-1 (]: 4 of 4 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:02:55.151070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m12:02:55.151070 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:02:55.162892 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:02:55.162892 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:02:55.162892 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:02:55.162892 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:02:55.162892 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT

        CAST(customer AS INT)     AS  customer_id
        , product_id 
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS INT)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:02:55.469637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m12:02:55.469637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94ccbfd4-a651-44f2-afe7-43bf861dae76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F113700B0>]}
[0m12:02:55.469637 [info ] [Thread-1 (]: 4 of 4 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.32s]
[0m12:02:55.469637 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:02:55.469637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:55.469637 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:02:55.469637 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:02:55.565151 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:02:55.565151 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:02:55.645975 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:02:55.645975 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:02:55.741002 [info ] [MainThread]: 
[0m12:02:55.741002 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m12:02:55.741002 [debug] [MainThread]: Command end result
[0m12:02:55.764444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:02:55.766451 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:02:55.772210 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:02:55.774218 [info ] [MainThread]: 
[0m12:02:55.774218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:55.774218 [info ] [MainThread]: 
[0m12:02:55.774218 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:02:55.774218 [debug] [MainThread]: Command `dbt run` succeeded at 12:02:55.774218 after 4.47 seconds
[0m12:02:55.774218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0EA91670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F0EAE3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F10003200>]}
[0m12:02:55.774218 [debug] [MainThread]: Flushing usage events
[0m12:02:56.641644 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:06:26.922318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07D24E180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07D24E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07D24E1E0>]}


============================== 12:06:26.938190 | e79a5e5d-03a2-403a-8526-1128c2ed1b57 ==============================
[0m12:06:26.938190 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:06:26.938190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m master', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:06:27.349147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e79a5e5d-03a2-403a-8526-1128c2ed1b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07D24E060>]}
[0m12:06:27.412709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e79a5e5d-03a2-403a-8526-1128c2ed1b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07D0CADE0>]}
[0m12:06:27.412709 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:06:27.729159 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:06:27.876366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m12:06:27.876366 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Intermediate\master.sql
[0m12:06:27.876366 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m12:06:28.110573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:06:28.126701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e79a5e5d-03a2-403a-8526-1128c2ed1b57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07F5E0AD0>]}
[0m12:06:28.189593 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:06:28.205641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:06:28.222144 [error] [MainThread]: Encountered an error:
Found a cycle: model.Mini_Project.stg_customers
[0m12:06:28.277108 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.Mini_Project.stg_customers

[0m12:06:28.277108 [debug] [MainThread]: Command `dbt run` failed at 12:06:28.277108 after 1.51 seconds
[0m12:06:28.277108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07D11CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07F5E3BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07E25A570>]}
[0m12:06:28.277108 [debug] [MainThread]: Flushing usage events
[0m12:06:29.733898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:07.356645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB118883B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB11888200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB118884A0>]}


============================== 12:07:07.356645 | 71bc1120-c257-4bf4-862a-57a4bf6f7d55 ==============================
[0m12:07:07.356645 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:07:07.356645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m master', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:07:07.789395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71bc1120-c257-4bf4-862a-57a4bf6f7d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB124F12E0>]}
[0m12:07:07.845938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71bc1120-c257-4bf4-862a-57a4bf6f7d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB124A4FE0>]}
[0m12:07:07.845938 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:07:08.175987 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:07:08.333348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:08.335356 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m12:07:08.580111 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:07:08.586313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71bc1120-c257-4bf4-862a-57a4bf6f7d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB13B8D3D0>]}
[0m12:07:08.648842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:07:08.664530 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:07:08.680174 [error] [MainThread]: Encountered an error:
Found a cycle: model.Mini_Project.stg_customers
[0m12:07:08.688286 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 574, in run
    self._runtime_initialize()
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\base.py", line 134, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.Mini_Project.stg_customers

[0m12:07:08.688286 [debug] [MainThread]: Command `dbt run` failed at 12:07:08.688286 after 1.50 seconds
[0m12:07:08.688286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB11888DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB13B8D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB13B8F140>]}
[0m12:07:08.688286 [debug] [MainThread]: Flushing usage events
[0m12:07:09.586693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:39.022836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C759B4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C759B44A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C759B42C0>]}


============================== 12:11:39.033655 | 75156c37-ceba-4b7d-a0f8-4c1d6ccae419 ==============================
[0m12:11:39.033655 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:11:39.033655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:39.530250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75156c37-ceba-4b7d-a0f8-4c1d6ccae419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C72D828A0>]}
[0m12:11:39.593357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75156c37-ceba-4b7d-a0f8-4c1d6ccae419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C759DBB90>]}
[0m12:11:39.593357 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:11:40.024666 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:11:41.223520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:41.223520 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_customers.sql
[0m12:11:41.461087 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:11:41.477011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75156c37-ceba-4b7d-a0f8-4c1d6ccae419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C77D2CDD0>]}
[0m12:11:41.541317 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:11:41.554325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:11:41.580589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75156c37-ceba-4b7d-a0f8-4c1d6ccae419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C77CE8D70>]}
[0m12:11:41.580589 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:11:41.580589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75156c37-ceba-4b7d-a0f8-4c1d6ccae419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C778694C0>]}
[0m12:11:41.583642 [info ] [MainThread]: 
[0m12:11:41.583642 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:11:41.583642 [info ] [MainThread]: 
[0m12:11:41.583642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:11:41.583642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:11:44.183334 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:11:44.183334 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:11:44.183334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:45.167768 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.984 seconds
[0m12:11:45.174356 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:11:45.185011 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:11:45.185011 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:11:45.185011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:45.704996 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.518 seconds
[0m12:11:45.708579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75156c37-ceba-4b7d-a0f8-4c1d6ccae419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C7674A7B0>]}
[0m12:11:45.708579 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m12:11:45.708579 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_customers .................................. [RUN]
[0m12:11:45.708579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m12:11:45.708579 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m12:11:45.723222 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m12:11:45.723222 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m12:11:45.758186 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m12:11:45.760482 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m12:11:45.760482 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m12:11:45.761514 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:46.358688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m12:11:46.387465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75156c37-ceba-4b7d-a0f8-4c1d6ccae419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C72D81820>]}
[0m12:11:46.387465 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_customers ............................. [[32mSUCCESS 1[0m in 0.68s]
[0m12:11:46.387465 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m12:11:46.387465 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:46.387465 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:11:46.387465 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:11:46.473302 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:11:46.473302 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:11:46.565019 [debug] [MainThread]: Connection 'model.Mini_Project.stg_customers' was left open.
[0m12:11:46.565019 [debug] [MainThread]: On model.Mini_Project.stg_customers: Close
[0m12:11:46.646834 [info ] [MainThread]: 
[0m12:11:46.646834 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m12:11:46.646834 [debug] [MainThread]: Command end result
[0m12:11:46.721911 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:11:46.721911 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:11:46.738469 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:11:46.740895 [info ] [MainThread]: 
[0m12:11:46.740895 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:46.740895 [info ] [MainThread]: 
[0m12:11:46.740895 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:11:46.740895 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:46.740895 after 7.91 seconds
[0m12:11:46.740895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C7647B140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C76479400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C76690E00>]}
[0m12:11:46.740895 [debug] [MainThread]: Flushing usage events
[0m12:11:47.962191 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:04.299658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170A4044D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170A404440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170A404230>]}


============================== 12:12:04.305960 | 09379473-1c10-431b-abea-0866a2e4ceef ==============================
[0m12:12:04.305960 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:12:04.305960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m master', 'send_anonymous_usage_stats': 'True'}
[0m12:12:04.739685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09379473-1c10-431b-abea-0866a2e4ceef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021709962540>]}
[0m12:12:04.796844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09379473-1c10-431b-abea-0866a2e4ceef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170AE09790>]}
[0m12:12:04.796844 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:12:05.113753 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:12:05.256945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:05.273042 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:12:05.496820 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:12:05.512905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09379473-1c10-431b-abea-0866a2e4ceef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C20AB70>]}
[0m12:12:05.576384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:12:05.576384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:12:05.616999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09379473-1c10-431b-abea-0866a2e4ceef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C6B5040>]}
[0m12:12:05.616999 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:12:05.616999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09379473-1c10-431b-abea-0866a2e4ceef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170B1139E0>]}
[0m12:12:05.616999 [info ] [MainThread]: 
[0m12:12:05.620925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:12:05.620925 [info ] [MainThread]: 
[0m12:12:05.620925 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:12:05.620925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:12:05.708202 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:12:05.708202 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:12:05.708202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:06.955365 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.251 seconds
[0m12:12:06.974482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:12:06.985787 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:12:06.987528 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:12:06.987528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:07.420842 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.433 seconds
[0m12:12:07.422855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09379473-1c10-431b-abea-0866a2e4ceef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170CA7F7A0>]}
[0m12:12:07.422855 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:12:07.422855 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:12:07.422855 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:12:07.422855 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:12:07.436641 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:12:07.436641 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:12:07.468253 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:12:07.468253 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:12:07.468253 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_transaction c
    JOIN
    MINI_PROJECT.RAW.stg_customers t ON c.customer_id = t.customer_id
    JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id



)
select * from required_fields
  );
[0m12:12:07.468253 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:08.121628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff32-0001-429b-0008-511e00017626
[0m12:12:08.121628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 54
invalid identifier 'T.PRODUCT_ID'
[0m12:12:08.139079 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 18 at position 54
  invalid identifier 'T.PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:12:08.141333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09379473-1c10-431b-abea-0866a2e4ceef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217098D09E0>]}
[0m12:12:08.141333 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.72s]
[0m12:12:08.141333 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:12:08.141333 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 18 at position 54
  invalid identifier 'T.PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:12:08.141333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:08.141333 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:12:08.141333 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:12:08.230221 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:12:08.232236 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:12:08.317423 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:12:08.317423 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:12:08.429947 [info ] [MainThread]: 
[0m12:12:08.429947 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m12:12:08.429947 [debug] [MainThread]: Command end result
[0m12:12:08.525190 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:12:08.525190 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:12:08.528184 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:12:08.528184 [info ] [MainThread]: 
[0m12:12:08.528184 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:12:08.528184 [info ] [MainThread]: 
[0m12:12:08.528184 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 18 at position 54
  invalid identifier 'T.PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:12:08.528184 [info ] [MainThread]: 
[0m12:12:08.528184 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:08.528184 [debug] [MainThread]: Command `dbt run` failed at 12:12:08.528184 after 4.40 seconds
[0m12:12:08.528184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170990AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021709E94CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021709962540>]}
[0m12:12:08.528184 [debug] [MainThread]: Flushing usage events
[0m12:12:09.444560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:59.947979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB47F67B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB45A517C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB477EFFE0>]}


============================== 12:12:59.947979 | bad2d86f-eb5d-4470-9426-871958bb915c ==============================
[0m12:12:59.947979 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:12:59.947979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m master', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:13:00.402719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bad2d86f-eb5d-4470-9426-871958bb915c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB457C2930>]}
[0m12:13:00.468750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bad2d86f-eb5d-4470-9426-871958bb915c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB49131FA0>]}
[0m12:13:00.470143 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:13:00.791735 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:13:00.942433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:00.942433 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:13:01.179848 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:13:01.195936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bad2d86f-eb5d-4470-9426-871958bb915c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB4A7E5010>]}
[0m12:13:01.259258 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:13:01.275060 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:13:01.302489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bad2d86f-eb5d-4470-9426-871958bb915c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB4A790F50>]}
[0m12:13:01.302489 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:13:01.302489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad2d86f-eb5d-4470-9426-871958bb915c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB483DB740>]}
[0m12:13:01.302489 [info ] [MainThread]: 
[0m12:13:01.306691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:01.306691 [info ] [MainThread]: 
[0m12:13:01.306691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:01.306691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:13:01.385894 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:13:01.385894 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:13:01.385894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:02.231800 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.840 seconds
[0m12:13:02.240764 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:13:02.251966 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:13:02.251966 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:13:02.251966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:02.686377 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.437 seconds
[0m12:13:02.699305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad2d86f-eb5d-4470-9426-871958bb915c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB4AAE2AE0>]}
[0m12:13:02.699305 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:13:02.699305 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:13:02.699305 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:13:02.699305 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:13:02.699305 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:13:02.715312 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:13:02.743182 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:13:02.743182 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:13:02.743182 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    JOIN
    MINI_PROJECT.RAW.stg_transaction t ON c.customer_id = t.customer_id
    JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id



)
select * from required_fields
  );
[0m12:13:02.743182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:04.057407 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff33-0001-429e-0008-511e00012b66
[0m12:13:04.057407 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_ID'
[0m12:13:04.057407 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:13:04.070804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad2d86f-eb5d-4470-9426-871958bb915c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB478C0830>]}
[0m12:13:04.070804 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 1.36s]
[0m12:13:04.070804 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:13:04.070804 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:13:04.070804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:04.070804 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:13:04.070804 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:13:04.157464 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:13:04.157464 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:13:04.230826 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:13:04.246985 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:13:04.339286 [info ] [MainThread]: 
[0m12:13:04.341302 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m12:13:04.343672 [debug] [MainThread]: Command end result
[0m12:13:04.407050 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:13:04.423188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:13:04.423188 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:13:04.423188 [info ] [MainThread]: 
[0m12:13:04.423188 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:13:04.431184 [info ] [MainThread]: 
[0m12:13:04.431184 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:13:04.431184 [info ] [MainThread]: 
[0m12:13:04.431184 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:13:04.431184 [debug] [MainThread]: Command `dbt run` failed at 12:13:04.431184 after 4.65 seconds
[0m12:13:04.431184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB479ACCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB46129D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BB4A685340>]}
[0m12:13:04.431184 [debug] [MainThread]: Flushing usage events
[0m12:13:05.310141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:35.225826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056BD4D760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056E1BB710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056C84E360>]}


============================== 12:14:35.233292 | a71dcfa3-cb0c-455a-b091-69f5e0a41800 ==============================
[0m12:14:35.233292 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:14:35.233292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m master', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:14:35.647523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a71dcfa3-cb0c-455a-b091-69f5e0a41800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056F489910>]}
[0m12:14:35.710576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a71dcfa3-cb0c-455a-b091-69f5e0a41800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056F7252B0>]}
[0m12:14:35.710576 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:14:36.027741 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:14:36.170453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:36.170453 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:14:36.407305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:14:36.429153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a71dcfa3-cb0c-455a-b091-69f5e0a41800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020570D85460>]}
[0m12:14:36.486243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:14:36.486243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:14:36.518253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a71dcfa3-cb0c-455a-b091-69f5e0a41800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020570D39400>]}
[0m12:14:36.518253 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:14:36.518253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71dcfa3-cb0c-455a-b091-69f5e0a41800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020570BD3A10>]}
[0m12:14:36.518253 [info ] [MainThread]: 
[0m12:14:36.518253 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:14:36.518253 [info ] [MainThread]: 
[0m12:14:36.518253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:14:36.518253 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:14:36.612155 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:14:36.612155 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:14:36.612155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:37.495075 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.883 seconds
[0m12:14:37.504110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:14:37.514017 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:14:37.514017 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:14:37.514017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:37.994267 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.479 seconds
[0m12:14:38.006268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a71dcfa3-cb0c-455a-b091-69f5e0a41800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020571138800>]}
[0m12:14:38.010065 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:14:38.010065 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:14:38.010065 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:14:38.010065 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:14:38.010065 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:14:38.010065 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:14:38.041568 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:14:38.041568 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:14:38.041568 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id



)
select * from required_fields
  );
[0m12:14:38.041568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:14:38.540990 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff34-0001-429e-0008-511e00012b6e
[0m12:14:38.540990 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_ID'
[0m12:14:38.540990 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:14:38.540990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a71dcfa3-cb0c-455a-b091-69f5e0a41800', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020570C622A0>]}
[0m12:14:38.540990 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.53s]
[0m12:14:38.540990 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:14:38.540990 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:14:38.540990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:38.540990 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:14:38.540990 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:14:38.645101 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:14:38.647117 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:14:38.749405 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:14:38.751422 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:14:38.836488 [info ] [MainThread]: 
[0m12:14:38.836488 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m12:14:38.836488 [debug] [MainThread]: Command end result
[0m12:14:38.924452 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:14:38.926226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:14:38.926226 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:14:38.926226 [info ] [MainThread]: 
[0m12:14:38.926226 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:14:38.926226 [info ] [MainThread]: 
[0m12:14:38.926226 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:14:38.926226 [info ] [MainThread]: 
[0m12:14:38.926226 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:14:38.926226 [debug] [MainThread]: Command `dbt run` failed at 12:14:38.926226 after 3.87 seconds
[0m12:14:38.926226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020570ADBDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056F489910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056E03CCE0>]}
[0m12:14:38.926226 [debug] [MainThread]: Flushing usage events
[0m12:14:39.839597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:10.052033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29E3982F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29E3981D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29E398080>]}


============================== 12:15:10.065706 | ce31bbef-29e2-4a48-b837-f2e49a668dd5 ==============================
[0m12:15:10.065706 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:15:10.065706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m master', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:15:10.492762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce31bbef-29e2-4a48-b837-f2e49a668dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29E404B00>]}
[0m12:15:10.558656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce31bbef-29e2-4a48-b837-f2e49a668dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29E3DE150>]}
[0m12:15:10.560664 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:15:10.874918 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:15:11.042440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:11.042440 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:15:11.270799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:15:11.294530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce31bbef-29e2-4a48-b837-f2e49a668dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A0740C20>]}
[0m12:15:11.359995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:15:11.364011 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:15:11.381557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce31bbef-29e2-4a48-b837-f2e49a668dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A06F0F80>]}
[0m12:15:11.381557 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:15:11.381557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce31bbef-29e2-4a48-b837-f2e49a668dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A072BB60>]}
[0m12:15:11.381557 [info ] [MainThread]: 
[0m12:15:11.381557 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:11.381557 [info ] [MainThread]: 
[0m12:15:11.381557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:15:11.381557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:15:11.476785 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:15:11.476785 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:15:11.476785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:12.551646 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.077 seconds
[0m12:15:12.551646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:15:12.575314 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:15:12.575314 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:15:12.575314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:13.018666 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.455 seconds
[0m12:15:13.040998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce31bbef-29e2-4a48-b837-f2e49a668dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A0796510>]}
[0m12:15:13.043290 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:15:13.043290 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:15:13.043290 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:15:13.043290 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:15:13.050447 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:15:13.050447 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:15:13.082119 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:15:13.082119 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:15:13.082119 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id



)
select * from required_fields
  );
[0m12:15:13.082119 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:13.617495 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff35-0001-429a-0008-511e0001b3ae
[0m12:15:13.617495 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'CUSTOMER_ID'
[0m12:15:13.617495 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:15:13.635409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce31bbef-29e2-4a48-b837-f2e49a668dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29D870AD0>]}
[0m12:15:13.635409 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.57s]
[0m12:15:13.637276 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:15:13.637276 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:15:13.637276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:13.637276 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:15:13.637276 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:15:13.713852 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:15:13.713852 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:15:13.809505 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:15:13.809505 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:15:13.906431 [info ] [MainThread]: 
[0m12:15:13.922222 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m12:15:13.922222 [debug] [MainThread]: Command end result
[0m12:15:13.986106 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:15:14.002171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:15:14.002171 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:15:14.002171 [info ] [MainThread]: 
[0m12:15:14.002171 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:15:14.002171 [info ] [MainThread]: 
[0m12:15:14.002171 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:15:14.002171 [info ] [MainThread]: 
[0m12:15:14.002171 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:15:14.002171 [debug] [MainThread]: Command `dbt run` failed at 12:15:14.002171 after 4.11 seconds
[0m12:15:14.002171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A0576AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A0645880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A06441A0>]}
[0m12:15:14.002171 [debug] [MainThread]: Flushing usage events
[0m12:15:14.907075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:22.097209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564CF28EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564CF2B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564CF2AF60>]}


============================== 12:19:22.108180 | 222beeb5-5aa4-42a9-a42f-f987ff615b61 ==============================
[0m12:19:22.108180 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:19:22.108180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m master', 'send_anonymous_usage_stats': 'True'}
[0m12:19:22.523503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '222beeb5-5aa4-42a9-a42f-f987ff615b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564C941190>]}
[0m12:19:22.571458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '222beeb5-5aa4-42a9-a42f-f987ff615b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564ACEC980>]}
[0m12:19:22.571458 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:19:22.888671 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:19:23.050349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:19:23.050349 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m12:19:23.052356 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:19:23.292205 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:19:23.302209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '222beeb5-5aa4-42a9-a42f-f987ff615b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564F198AD0>]}
[0m12:19:23.366139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:19:23.366139 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:19:23.397641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '222beeb5-5aa4-42a9-a42f-f987ff615b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564F260FB0>]}
[0m12:19:23.397641 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:19:23.397641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '222beeb5-5aa4-42a9-a42f-f987ff615b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564F19BA10>]}
[0m12:19:23.397641 [info ] [MainThread]: 
[0m12:19:23.397641 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:23.397641 [info ] [MainThread]: 
[0m12:19:23.397641 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:23.397641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:19:23.476841 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:19:23.476841 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:19:23.476841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:24.332317 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.849 seconds
[0m12:19:24.343209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:19:24.343209 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:19:24.343209 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:19:24.343209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:24.809982 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.456 seconds
[0m12:19:24.809982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '222beeb5-5aa4-42a9-a42f-f987ff615b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564F73ED80>]}
[0m12:19:24.809982 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:19:24.809982 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:19:24.809982 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:19:24.809982 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:19:24.825773 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:19:24.825773 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:19:24.857508 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:19:24.857508 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:19:24.857508 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id



)
select * from required_fields
  );
[0m12:19:24.857508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:25.395773 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff39-0001-429e-0008-511e00012b72
[0m12:19:25.397782 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 42
invalid identifier 'T.T_CUSTOMER_ID'
[0m12:19:25.399791 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 16 at position 42
  invalid identifier 'T.T_CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:19:25.401799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '222beeb5-5aa4-42a9-a42f-f987ff615b61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564F4DF9B0>]}
[0m12:19:25.401799 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.59s]
[0m12:19:25.401799 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:19:25.401799 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 16 at position 42
  invalid identifier 'T.T_CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:19:25.401799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:25.401799 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:19:25.401799 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:19:25.482900 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:19:25.482900 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:19:25.578895 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:19:25.578895 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:19:25.659960 [info ] [MainThread]: 
[0m12:19:25.659960 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m12:19:25.676108 [debug] [MainThread]: Command end result
[0m12:19:25.751246 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:19:25.753254 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:19:25.757335 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:19:25.759344 [info ] [MainThread]: 
[0m12:19:25.759869 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:19:25.759869 [info ] [MainThread]: 
[0m12:19:25.760994 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 16 at position 42
  invalid identifier 'T.T_CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:19:25.760994 [info ] [MainThread]: 
[0m12:19:25.760994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:19:25.760994 [debug] [MainThread]: Command `dbt run` failed at 12:19:25.760994 after 3.82 seconds
[0m12:19:25.760994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564BE8C5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564BF9E210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564F0943E0>]}
[0m12:19:25.760994 [debug] [MainThread]: Flushing usage events
[0m12:19:26.987231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:50.919330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC23CE46B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC23CE47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC23CE4650>]}


============================== 12:19:50.929364 | 13d54de1-e405-444b-9400-af817cb328d5 ==============================
[0m12:19:50.929364 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:19:50.929364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m12:19:51.396793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d54de1-e405-444b-9400-af817cb328d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC23FAE240>]}
[0m12:19:51.460699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d54de1-e405-444b-9400-af817cb328d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC25ACD9A0>]}
[0m12:19:51.462085 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:19:51.785555 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:19:51.940381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:19:51.940381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:19:51.947365 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:19:51.977423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d54de1-e405-444b-9400-af817cb328d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2405B140>]}
[0m12:19:52.041330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:19:52.041330 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:19:52.073587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d54de1-e405-444b-9400-af817cb328d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC25D38470>]}
[0m12:19:52.073587 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:19:52.073587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d54de1-e405-444b-9400-af817cb328d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC25AF2720>]}
[0m12:19:52.073587 [info ] [MainThread]: 
[0m12:19:52.073587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:52.073587 [info ] [MainThread]: 
[0m12:19:52.073587 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:52.091366 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:19:52.178751 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:19:52.180759 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:19:52.180759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:52.975789 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.795 seconds
[0m12:19:52.981436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:19:52.991547 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:19:52.992592 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:19:52.992592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:53.401830 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.410 seconds
[0m12:19:53.406180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d54de1-e405-444b-9400-af817cb328d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC25DD6F60>]}
[0m12:19:53.410585 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:19:53.410585 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:19:53.411511 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m12:19:53.411511 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:19:53.419814 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:19:53.420911 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:19:53.451382 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:19:53.453667 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:19:53.453667 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id 
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS INT)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:19:53.454698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:54.007831 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m12:19:54.033147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d54de1-e405-444b-9400-af817cb328d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC2643F800>]}
[0m12:19:54.033147 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.62s]
[0m12:19:54.034278 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:19:54.035279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:54.036374 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:19:54.036374 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:19:54.110771 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:19:54.111885 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:19:54.187616 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:19:54.187616 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:19:54.270852 [info ] [MainThread]: 
[0m12:19:54.271901 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.20 seconds (2.20s).
[0m12:19:54.272942 [debug] [MainThread]: Command end result
[0m12:19:54.294614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:19:54.295793 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:19:54.302418 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:19:54.302418 [info ] [MainThread]: 
[0m12:19:54.303569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:19:54.303569 [info ] [MainThread]: 
[0m12:19:54.303569 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:19:54.304903 [debug] [MainThread]: Command `dbt run` succeeded at 12:19:54.304903 after 3.56 seconds
[0m12:19:54.304903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC23CE5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC23CE47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC23CE46B0>]}
[0m12:19:54.306006 [debug] [MainThread]: Flushing usage events
[0m12:19:55.203743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:00.009475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21F64410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21F64560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21F64320>]}


============================== 12:20:00.009475 | 4f47e274-416b-4a9b-b4fd-1a963fe51fd8 ==============================
[0m12:20:00.009475 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:20:00.017141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m master', 'send_anonymous_usage_stats': 'True'}
[0m12:20:00.448375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f47e274-416b-4a9b-b4fd-1a963fe51fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E22130170>]}
[0m12:20:00.507369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f47e274-416b-4a9b-b4fd-1a963fe51fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E213EDBE0>]}
[0m12:20:00.507369 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:20:00.825251 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:20:00.951666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:20:00.951666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:20:00.973434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:20:00.999367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f47e274-416b-4a9b-b4fd-1a963fe51fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E23D13EC0>]}
[0m12:20:01.062980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:20:01.062980 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:20:01.099911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f47e274-416b-4a9b-b4fd-1a963fe51fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E23F580B0>]}
[0m12:20:01.099911 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:20:01.099911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f47e274-416b-4a9b-b4fd-1a963fe51fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E23CF1070>]}
[0m12:20:01.099911 [info ] [MainThread]: 
[0m12:20:01.099911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:01.099911 [info ] [MainThread]: 
[0m12:20:01.099911 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:01.099911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:20:01.189650 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:20:01.189650 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:20:01.189650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:01.547339 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.357 seconds
[0m12:20:01.556083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:20:01.568451 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:20:01.568451 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:20:01.568451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:01.877258 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.310 seconds
[0m12:20:01.885297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f47e274-416b-4a9b-b4fd-1a963fe51fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E240F7350>]}
[0m12:20:01.893096 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:20:01.893096 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:20:01.895118 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:20:01.895118 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:20:01.905132 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:20:01.905132 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:20:01.930607 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:20:01.930607 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:20:01.930607 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id



)
select * from required_fields
  );
[0m12:20:01.930607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:02.371617 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff3a-0001-42d7-0008-511e0001c0ce
[0m12:20:02.371617 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'PRODUCT_ID'
[0m12:20:02.371617 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:20:02.371617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f47e274-416b-4a9b-b4fd-1a963fe51fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E246C94C0>]}
[0m12:20:02.387513 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.48s]
[0m12:20:02.387513 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:20:02.387513 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:20:02.391163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:02.391163 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:20:02.391163 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:20:02.468666 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:20:02.468666 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:20:02.550555 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:20:02.550555 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:20:02.651233 [info ] [MainThread]: 
[0m12:20:02.651233 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m12:20:02.651233 [debug] [MainThread]: Command end result
[0m12:20:02.675361 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:20:02.675361 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:20:02.688117 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:20:02.688117 [info ] [MainThread]: 
[0m12:20:02.688117 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:20:02.688117 [info ] [MainThread]: 
[0m12:20:02.691108 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:20:02.691108 [info ] [MainThread]: 
[0m12:20:02.691108 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:20:02.691108 [debug] [MainThread]: Command `dbt run` failed at 12:20:02.691108 after 2.85 seconds
[0m12:20:02.691108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21F64DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21F64560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E21F64410>]}
[0m12:20:02.691108 [debug] [MainThread]: Flushing usage events
[0m12:20:03.598867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:33.965837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2EDFE9430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F09E35F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F0D184D0>]}


============================== 12:20:33.965837 | 445d2fbb-8c3d-446f-8c25-78b1bf62895f ==============================
[0m12:20:33.965837 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:20:33.965837 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_transaction', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:20:34.393473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '445d2fbb-8c3d-446f-8c25-78b1bf62895f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F0D84B00>]}
[0m12:20:34.441418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '445d2fbb-8c3d-446f-8c25-78b1bf62895f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F17263C0>]}
[0m12:20:34.441418 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:20:34.759706 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:20:34.899443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:20:34.899443 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m12:20:35.136762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:20:35.140444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '445d2fbb-8c3d-446f-8c25-78b1bf62895f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F302CEC0>]}
[0m12:20:35.204284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:20:35.204284 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:20:35.236087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '445d2fbb-8c3d-446f-8c25-78b1bf62895f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F2FF0BC0>]}
[0m12:20:35.236087 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:20:35.236087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '445d2fbb-8c3d-446f-8c25-78b1bf62895f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F301A660>]}
[0m12:20:35.236087 [info ] [MainThread]: 
[0m12:20:35.236087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:35.236087 [info ] [MainThread]: 
[0m12:20:35.236087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:35.236087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:20:35.331204 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:20:35.331204 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:20:35.333212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:36.101029 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.771 seconds
[0m12:20:36.110245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:20:36.119421 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:20:36.119421 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:20:36.119421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:36.416108 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.305 seconds
[0m12:20:36.416108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '445d2fbb-8c3d-446f-8c25-78b1bf62895f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F3273830>]}
[0m12:20:36.432090 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:20:36.432090 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:20:36.432090 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m12:20:36.432090 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:20:36.432090 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:20:36.432090 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:20:36.463812 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:20:36.463812 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:20:36.463812 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id    AS t_product_id
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS INT)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:20:36.463812 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:37.086259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m12:20:37.146271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '445d2fbb-8c3d-446f-8c25-78b1bf62895f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2EE0E1640>]}
[0m12:20:37.146271 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.71s]
[0m12:20:37.146271 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:20:37.149893 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:37.149893 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:20:37.149893 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:20:37.230316 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:20:37.230316 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:20:37.309709 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:20:37.309709 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:20:37.372930 [info ] [MainThread]: 
[0m12:20:37.388693 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m12:20:37.388693 [debug] [MainThread]: Command end result
[0m12:20:37.452493 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:20:37.452493 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:20:37.468300 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:20:37.468300 [info ] [MainThread]: 
[0m12:20:37.468300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:20:37.468300 [info ] [MainThread]: 
[0m12:20:37.468300 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:20:37.468300 [debug] [MainThread]: Command `dbt run` succeeded at 12:20:37.468300 after 3.66 seconds
[0m12:20:37.468300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F0A1EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F2E99CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2F2E99B50>]}
[0m12:20:37.468300 [debug] [MainThread]: Flushing usage events
[0m12:20:38.364092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:43.189563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1DFBAA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1DFBAAAB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1DFBA8E60>]}


============================== 12:20:43.195272 | e7d6181e-772b-4691-b137-7b3ed4000e03 ==============================
[0m12:20:43.195272 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:20:43.195654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m master', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:20:43.623282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d6181e-772b-4691-b137-7b3ed4000e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E062E2A0>]}
[0m12:20:43.690617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d6181e-772b-4691-b137-7b3ed4000e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1DFED59A0>]}
[0m12:20:43.690617 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:20:44.013447 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:20:44.151462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:20:44.151462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:20:44.167535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:20:44.183691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d6181e-772b-4691-b137-7b3ed4000e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E1A33EC0>]}
[0m12:20:44.247534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:20:44.263511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:20:44.279162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d6181e-772b-4691-b137-7b3ed4000e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E1BE8320>]}
[0m12:20:44.279162 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:20:44.279162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d6181e-772b-4691-b137-7b3ed4000e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E08F7620>]}
[0m12:20:44.279162 [info ] [MainThread]: 
[0m12:20:44.295149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:20:44.295149 [info ] [MainThread]: 
[0m12:20:44.295149 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:20:44.295149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:20:44.382708 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:20:44.382708 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:20:44.384715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:44.862894 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.480 seconds
[0m12:20:44.872732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:20:44.872732 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:20:44.872732 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:20:44.872732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:45.315206 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.434 seconds
[0m12:20:45.315206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d6181e-772b-4691-b137-7b3ed4000e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E1D508F0>]}
[0m12:20:45.325195 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:20:45.325195 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:20:45.325195 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:20:45.325195 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:20:45.325195 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:20:45.325195 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:20:45.354848 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:20:45.354848 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:20:45.354848 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id



)
select * from required_fields
  );
[0m12:20:45.354848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:45.737758 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff3a-0001-42d7-0008-511e0001c0d6
[0m12:20:45.743767 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 54
invalid identifier 'T.PRODUCT_ID'
[0m12:20:45.745776 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 18 at position 54
  invalid identifier 'T.PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:20:45.749524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d6181e-772b-4691-b137-7b3ed4000e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1DF050740>]}
[0m12:20:45.749524 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.42s]
[0m12:20:45.749524 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:20:45.751531 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 18 at position 54
  invalid identifier 'T.PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:20:45.753540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:45.753540 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:20:45.753540 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:20:45.832575 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:20:45.832575 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:20:45.912082 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:20:45.912082 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:20:46.003952 [info ] [MainThread]: 
[0m12:20:46.003952 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m12:20:46.005692 [debug] [MainThread]: Command end result
[0m12:20:46.026530 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:20:46.026530 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:20:46.026530 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:20:46.026530 [info ] [MainThread]: 
[0m12:20:46.026530 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:20:46.026530 [info ] [MainThread]: 
[0m12:20:46.026530 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  000904 (42000): SQL compilation error: error line 18 at position 54
  invalid identifier 'T.PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:20:46.039239 [info ] [MainThread]: 
[0m12:20:46.039239 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:20:46.039239 [debug] [MainThread]: Command `dbt run` failed at 12:20:46.039239 after 3.02 seconds
[0m12:20:46.039239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1DF7C7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1DF94E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1E19829C0>]}
[0m12:20:46.039239 [debug] [MainThread]: Flushing usage events
[0m12:20:46.914413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:00.774009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026198EF8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026198EF8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026198EF8440>]}


============================== 12:21:00.780350 | 9d31e0ff-a3f9-47f8-b796-bfc28ad1f819 ==============================
[0m12:21:00.780350 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:21:00.780350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m master', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:01.207763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d31e0ff-a3f9-47f8-b796-bfc28ad1f819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619ACBBC50>]}
[0m12:21:01.255227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d31e0ff-a3f9-47f8-b796-bfc28ad1f819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026199B821B0>]}
[0m12:21:01.271036 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:21:01.585801 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:21:01.725748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:21:01.725748 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:21:01.974607 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:21:01.989816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d31e0ff-a3f9-47f8-b796-bfc28ad1f819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619AD58AD0>]}
[0m12:21:02.055007 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:21:02.059022 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:21:02.083949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d31e0ff-a3f9-47f8-b796-bfc28ad1f819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B1E4C50>]}
[0m12:21:02.083949 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:21:02.083949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d31e0ff-a3f9-47f8-b796-bfc28ad1f819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619AF2B9B0>]}
[0m12:21:02.083949 [info ] [MainThread]: 
[0m12:21:02.083949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:02.083949 [info ] [MainThread]: 
[0m12:21:02.083949 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:02.083949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:21:02.174604 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:21:02.174604 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:21:02.174604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:02.967903 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.797 seconds
[0m12:21:02.975499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:21:02.986984 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:21:02.986984 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:21:02.988991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:03.401133 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.414 seconds
[0m12:21:03.401133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d31e0ff-a3f9-47f8-b796-bfc28ad1f819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619638B2F0>]}
[0m12:21:03.401133 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:21:03.412688 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:21:03.412688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:21:03.412688 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:21:03.420219 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:21:03.422227 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:21:03.445788 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:21:03.445788 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:21:03.445788 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id



)
select * from required_fields
  );
[0m12:21:03.445788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:21:04.122368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m12:21:04.154306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d31e0ff-a3f9-47f8-b796-bfc28ad1f819', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261962F14F0>]}
[0m12:21:04.154306 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 0.74s]
[0m12:21:04.154306 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:21:04.154306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:04.154306 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:21:04.154306 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:21:04.235502 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:21:04.235502 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:21:04.324585 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:21:04.324585 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:21:04.396188 [info ] [MainThread]: 
[0m12:21:04.396188 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.31 seconds (2.31s).
[0m12:21:04.396188 [debug] [MainThread]: Command end result
[0m12:21:04.478686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:21:04.478686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:21:04.490975 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:21:04.490975 [info ] [MainThread]: 
[0m12:21:04.490975 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:21:04.490975 [info ] [MainThread]: 
[0m12:21:04.490975 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:21:04.490975 [debug] [MainThread]: Command `dbt run` succeeded at 12:21:04.490975 after 3.87 seconds
[0m12:21:04.490975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261988E8B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026199BD5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026195972750>]}
[0m12:21:04.490975 [debug] [MainThread]: Flushing usage events
[0m12:21:05.409701 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:01.050798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E7EB6B6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E7F8217C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E011F7DA0>]}


============================== 12:24:01.061168 | 89dbf380-bbe3-4442-b9f7-0f8c3431edcf ==============================
[0m12:24:01.061168 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:24:01.061168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_transaction', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:24:01.764244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89dbf380-bbe3-4442-b9f7-0f8c3431edcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E040A58B0>]}
[0m12:24:01.827555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89dbf380-bbe3-4442-b9f7-0f8c3431edcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E02D2F3E0>]}
[0m12:24:01.827555 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:24:02.308471 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:24:03.617042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:24:03.633096 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m12:24:03.870740 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:24:03.890387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89dbf380-bbe3-4442-b9f7-0f8c3431edcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E045DD040>]}
[0m12:24:03.950407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:24:03.976852 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:24:04.016497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89dbf380-bbe3-4442-b9f7-0f8c3431edcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E045A0EC0>]}
[0m12:24:04.016497 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:24:04.016497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89dbf380-bbe3-4442-b9f7-0f8c3431edcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E04133170>]}
[0m12:24:04.016497 [info ] [MainThread]: 
[0m12:24:04.016497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:04.016497 [info ] [MainThread]: 
[0m12:24:04.016497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:04.016497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:24:06.705172 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:24:06.705172 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:24:06.705172 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:07.853952 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.155 seconds
[0m12:24:07.882175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:24:07.908239 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:24:07.908239 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:24:07.908239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:08.343495 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.436 seconds
[0m12:24:08.347524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89dbf380-bbe3-4442-b9f7-0f8c3431edcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E7F6A3710>]}
[0m12:24:08.347524 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:24:08.347524 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:24:08.347524 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m12:24:08.359131 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:24:08.359131 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:24:08.359131 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:24:08.396221 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:24:08.396221 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:24:08.396221 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id    AS t_product_id
        , CAST(payment_month AS DATE)      
        , CAST(revenue_type AS INT) 
        , CAST(revenue AS BOOLEAN)
        , CAST(quantity AS INT)
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:24:08.396221 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:09.070887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.679 seconds
[0m12:24:09.098815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89dbf380-bbe3-4442-b9f7-0f8c3431edcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E049AA0F0>]}
[0m12:24:09.098815 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.75s]
[0m12:24:09.098815 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:24:09.106633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:09.106633 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:24:09.106633 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:24:09.179553 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:24:09.179553 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:24:09.276361 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:24:09.276361 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:24:09.357734 [info ] [MainThread]: 
[0m12:24:09.357734 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m12:24:09.357734 [debug] [MainThread]: Command end result
[0m12:24:09.436581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:24:09.436581 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:24:09.452701 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:24:09.452701 [info ] [MainThread]: 
[0m12:24:09.452701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:09.452701 [info ] [MainThread]: 
[0m12:24:09.452701 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:24:09.452701 [debug] [MainThread]: Command `dbt run` succeeded at 12:24:09.452701 after 8.61 seconds
[0m12:24:09.452701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E7F8FB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E7F8F91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029E04B150A0>]}
[0m12:24:09.452701 [debug] [MainThread]: Flushing usage events
[0m12:24:10.759346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:24:17.996178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E9DCE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E92CCC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E9527320>]}


============================== 12:24:18.002288 | 9d1234b8-18d4-4a21-84ef-30082aca810c ==============================
[0m12:24:18.002288 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:24:18.003294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m master', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:24:18.446949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d1234b8-18d4-4a21-84ef-30082aca810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E9358E00>]}
[0m12:24:18.494084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d1234b8-18d4-4a21-84ef-30082aca810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EBD5BBC0>]}
[0m12:24:18.510056 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:24:18.828267 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:24:18.971354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:24:18.971354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:24:18.971354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:24:19.002829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d1234b8-18d4-4a21-84ef-30082aca810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EBD02240>]}
[0m12:24:19.066385 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:24:19.066385 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:24:19.098151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d1234b8-18d4-4a21-84ef-30082aca810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EBD58890>]}
[0m12:24:19.098151 [info ] [MainThread]: Found 5 models, 4 sources, 474 macros
[0m12:24:19.098151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1234b8-18d4-4a21-84ef-30082aca810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EBD97C20>]}
[0m12:24:19.098151 [info ] [MainThread]: 
[0m12:24:19.098151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:24:19.098151 [info ] [MainThread]: 
[0m12:24:19.098151 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:24:19.098151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:24:19.192757 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:24:19.192757 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:24:19.192757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:19.705772 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.511 seconds
[0m12:24:19.711793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:24:19.721807 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:24:19.721807 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:24:19.721807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:24:20.129116 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.406 seconds
[0m12:24:20.129116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d1234b8-18d4-4a21-84ef-30082aca810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EBD5B290>]}
[0m12:24:20.129116 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:24:20.129116 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:24:20.139860 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:24:20.139860 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:24:20.139860 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:24:20.139860 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:24:20.171679 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:24:20.171679 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:24:20.171679 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id



)
select * from required_fields
  );
[0m12:24:20.171679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:24:21.015090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m12:24:21.030992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d1234b8-18d4-4a21-84ef-30082aca810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E72C16A0>]}
[0m12:24:21.030992 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 0.89s]
[0m12:24:21.030992 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:24:21.030992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:24:21.030992 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:24:21.030992 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:24:21.111601 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:24:21.111601 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:24:21.228090 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:24:21.228090 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:24:21.315777 [info ] [MainThread]: 
[0m12:24:21.315777 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m12:24:21.315777 [debug] [MainThread]: Command end result
[0m12:24:21.336381 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:24:21.336381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:24:21.336381 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:24:21.336381 [info ] [MainThread]: 
[0m12:24:21.336381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:24:21.336381 [info ] [MainThread]: 
[0m12:24:21.352121 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:24:21.352121 [debug] [MainThread]: Command `dbt run` succeeded at 12:24:21.352121 after 3.54 seconds
[0m12:24:21.352121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E9630E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E7C96150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182E7C96180>]}
[0m12:24:21.352121 [debug] [MainThread]: Flushing usage events
[0m12:24:22.237767 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:39.690111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1A63FD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1A9C9C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1A9C96A0>]}


============================== 12:33:39.690111 | cb86d940-5180-41d7-b0b6-9034633189c3 ==============================
[0m12:33:39.690111 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:33:39.690111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m churn', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:40.182852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb86d940-5180-41d7-b0b6-9034633189c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1A003C80>]}
[0m12:33:40.244195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb86d940-5180-41d7-b0b6-9034633189c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1B717FB0>]}
[0m12:33:40.244195 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:33:40.560395 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:33:40.719731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m12:33:40.719731 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\churn.sql
[0m12:33:40.978358 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:33:40.988144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb86d940-5180-41d7-b0b6-9034633189c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1CD6D5B0>]}
[0m12:33:41.051113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:33:41.051113 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:33:41.090466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb86d940-5180-41d7-b0b6-9034633189c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1CD1D460>]}
[0m12:33:41.092475 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:33:41.092475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb86d940-5180-41d7-b0b6-9034633189c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1CC4C440>]}
[0m12:33:41.092475 [info ] [MainThread]: 
[0m12:33:41.092475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:41.092475 [info ] [MainThread]: 
[0m12:33:41.092475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:41.092475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:33:41.181288 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:33:41.181288 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:33:41.181288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:41.993307 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.811 seconds
[0m12:33:41.999374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:33:42.009265 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:33:42.009265 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:33:42.009265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:42.426855 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.431 seconds
[0m12:33:42.454919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb86d940-5180-41d7-b0b6-9034633189c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1D1D8F80>]}
[0m12:33:42.458327 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m12:33:42.458327 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m12:33:42.458327 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m12:33:42.458327 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m12:33:42.458327 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m12:33:42.458327 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m12:33:42.497795 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m12:33:42.497795 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m12:33:42.497795 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT
    JOIN
        LastTransaction lt ON c.customer_id = lt.customer_id
    WHERE
        lt.last_transaction_date < DATEADD(month, -12, GETDATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, GETDATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date;
[0m12:33:42.497795 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:33:42.987340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff47-0001-429a-0008-511e0001b41e
[0m12:33:42.987340 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 28 unexpected ';'.
[0m12:33:43.003361 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 28 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:33:43.005370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb86d940-5180-41d7-b0b6-9034633189c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA19EA0B30>]}
[0m12:33:43.005370 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.55s]
[0m12:33:43.005370 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m12:33:43.005370 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 28 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m12:33:43.005370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:43.005370 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:33:43.005370 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:33:43.087752 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:33:43.087752 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:33:43.176626 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m12:33:43.176626 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m12:33:43.273735 [info ] [MainThread]: 
[0m12:33:43.287948 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m12:33:43.291908 [debug] [MainThread]: Command end result
[0m12:33:43.367211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:33:43.368952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:33:43.368952 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:33:43.368952 [info ] [MainThread]: 
[0m12:33:43.368952 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:33:43.368952 [info ] [MainThread]: 
[0m12:33:43.368952 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 28 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:33:43.368952 [info ] [MainThread]: 
[0m12:33:43.368952 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:33:43.368952 [debug] [MainThread]: Command `dbt run` failed at 12:33:43.368952 after 3.86 seconds
[0m12:33:43.368952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1A12CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1CA5D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA1A63FD10>]}
[0m12:33:43.368952 [debug] [MainThread]: Flushing usage events
[0m12:33:44.623310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:33:55.524548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173B5DD1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173B81E49B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173B93490D0>]}


============================== 12:33:55.533760 | 5da7f7db-af22-4659-8643-8665f1e9f659 ==============================
[0m12:33:55.533760 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:33:55.533760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m churn', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:33:55.950705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5da7f7db-af22-4659-8643-8665f1e9f659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173B9FC19D0>]}
[0m12:33:56.016080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5da7f7db-af22-4659-8643-8665f1e9f659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173B70AE270>]}
[0m12:33:56.019585 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:33:56.319642 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:33:56.474197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:33:56.474197 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m12:33:56.712054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:33:56.728204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5da7f7db-af22-4659-8643-8665f1e9f659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BB511B80>]}
[0m12:33:56.792142 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:33:56.792142 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:33:56.823591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5da7f7db-af22-4659-8643-8665f1e9f659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BB5FD4F0>]}
[0m12:33:56.823591 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:33:56.823591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da7f7db-af22-4659-8643-8665f1e9f659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BB19A7E0>]}
[0m12:33:56.823591 [info ] [MainThread]: 
[0m12:33:56.823591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:56.823591 [info ] [MainThread]: 
[0m12:33:56.823591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:56.823591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:33:56.915027 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:33:56.915027 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:33:56.915027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:57.692608 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.788 seconds
[0m12:33:57.705779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:33:57.721146 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:33:57.721146 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:33:57.721146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:58.141993 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.422 seconds
[0m12:33:58.141993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da7f7db-af22-4659-8643-8665f1e9f659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BB3AF050>]}
[0m12:33:58.141993 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m12:33:58.141993 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m12:33:58.141993 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m12:33:58.141993 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m12:33:58.158037 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m12:33:58.158037 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m12:33:58.189589 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m12:33:58.189589 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m12:33:58.189589 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT
    JOIN
        LastTransaction lt ON c.customer_id = lt.customer_id
    WHERE
        lt.last_transaction_date < DATEADD(month, -12, GETDATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, GETDATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date
  );
[0m12:33:58.189589 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:33:58.560429 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff47-0001-429e-0008-511e00012bde
[0m12:33:58.560429 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'CUSTOMER_ID'
[0m12:33:58.560429 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:33:58.560429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5da7f7db-af22-4659-8643-8665f1e9f659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173B8810920>]}
[0m12:33:58.560429 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.42s]
[0m12:33:58.560429 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m12:33:58.560429 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m12:33:58.560429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:58.560429 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:33:58.560429 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:33:58.640586 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:33:58.640586 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:33:58.736813 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m12:33:58.736813 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m12:33:58.832661 [info ] [MainThread]: 
[0m12:33:58.832661 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m12:33:58.832661 [debug] [MainThread]: Command end result
[0m12:33:58.896527 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:33:58.912646 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:33:58.912646 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:33:58.912646 [info ] [MainThread]: 
[0m12:33:58.912646 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:33:58.912646 [info ] [MainThread]: 
[0m12:33:58.912646 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:33:58.912646 [info ] [MainThread]: 
[0m12:33:58.912646 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:33:58.912646 [debug] [MainThread]: Command `dbt run` failed at 12:33:58.912646 after 3.55 seconds
[0m12:33:58.912646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BB3E7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BB6480B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173BB4BF890>]}
[0m12:33:58.912646 [debug] [MainThread]: Flushing usage events
[0m12:33:59.844845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:35:15.773064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718DC583E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718DC58AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718DC5AC30>]}


============================== 12:35:15.780520 | 09333186-dd37-49f6-9f14-afed900d1ba8 ==============================
[0m12:35:15.780520 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:35:15.780520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m churn', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:35:16.195466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09333186-dd37-49f6-9f14-afed900d1ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718F9897C0>]}
[0m12:35:16.254830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09333186-dd37-49f6-9f14-afed900d1ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718E933650>]}
[0m12:35:16.254830 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:35:16.558491 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:35:16.716288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:35:16.716288 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m12:35:16.954351 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:35:16.970108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09333186-dd37-49f6-9f14-afed900d1ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718FDA5220>]}
[0m12:35:17.033780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:35:17.033780 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:35:17.049643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09333186-dd37-49f6-9f14-afed900d1ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718FEDD3D0>]}
[0m12:35:17.065603 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:35:17.065603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09333186-dd37-49f6-9f14-afed900d1ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718FF0FDA0>]}
[0m12:35:17.065603 [info ] [MainThread]: 
[0m12:35:17.065603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:17.065603 [info ] [MainThread]: 
[0m12:35:17.065603 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:17.065603 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:35:17.145057 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:35:17.145057 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:35:17.145057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:18.430066 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.284 seconds
[0m12:35:18.430066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:35:18.445798 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:35:18.445798 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:35:18.445798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:19.105343 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.661 seconds
[0m12:35:19.126470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09333186-dd37-49f6-9f14-afed900d1ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718FC8A720>]}
[0m12:35:19.126470 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m12:35:19.126470 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m12:35:19.126470 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m12:35:19.126470 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m12:35:19.141719 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m12:35:19.141719 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m12:35:19.168712 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m12:35:19.168712 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m12:35:19.168712 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        t_customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        t_customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT
    JOIN
        LastTransaction lt ON c.customer_id = lt.t_customer_id
    WHERE
        lt.last_transaction_date < DATEADD(month, -12, GETDATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, GETDATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date
  );
[0m12:35:19.168712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:35:19.682681 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff49-0001-429e-0008-511e00012be2
[0m12:35:19.682681 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 12
invalid identifier 'PAYMENT_MONTH'
[0m12:35:19.682681 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:35:19.682681 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09333186-dd37-49f6-9f14-afed900d1ba8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718D100A70>]}
[0m12:35:19.682681 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.56s]
[0m12:35:19.682681 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m12:35:19.682681 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m12:35:19.698626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:19.700144 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:35:19.700144 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:35:19.777781 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:35:19.777781 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:35:19.857090 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m12:35:19.865453 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m12:35:19.968028 [info ] [MainThread]: 
[0m12:35:19.968028 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m12:35:19.968028 [debug] [MainThread]: Command end result
[0m12:35:20.045745 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:35:20.047486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:35:20.053511 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:35:20.053511 [info ] [MainThread]: 
[0m12:35:20.053511 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:35:20.053511 [info ] [MainThread]: 
[0m12:35:20.053511 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 12
  invalid identifier 'PAYMENT_MONTH'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:35:20.053511 [info ] [MainThread]: 
[0m12:35:20.053511 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:35:20.053511 [debug] [MainThread]: Command `dbt run` failed at 12:35:20.053511 after 4.44 seconds
[0m12:35:20.053511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718D9FE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718FBC8A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002718FBC8C50>]}
[0m12:35:20.053511 [debug] [MainThread]: Flushing usage events
[0m12:35:20.996267 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:24.397300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001428CBBB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001428F9EB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001428F9E9940>]}


============================== 12:36:24.397300 | 0d9860cd-dd1a-4bc3-8509-8b64ad368f68 ==============================
[0m12:36:24.397300 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:36:24.397300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m12:36:24.809530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d9860cd-dd1a-4bc3-8509-8b64ad368f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014290298230>]}
[0m12:36:24.872559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d9860cd-dd1a-4bc3-8509-8b64ad368f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001428F7F5DC0>]}
[0m12:36:24.872559 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:36:25.189134 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:36:25.346581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:36:25.346581 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m12:36:25.585036 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:36:25.585036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d9860cd-dd1a-4bc3-8509-8b64ad368f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142924B5220>]}
[0m12:36:25.664945 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:36:25.668155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:36:25.680650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d9860cd-dd1a-4bc3-8509-8b64ad368f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014292581400>]}
[0m12:36:25.680650 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:36:25.680650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d9860cd-dd1a-4bc3-8509-8b64ad368f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142905FA960>]}
[0m12:36:25.680650 [info ] [MainThread]: 
[0m12:36:25.680650 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:25.680650 [info ] [MainThread]: 
[0m12:36:25.696286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:25.697265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:36:25.775716 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:36:25.775716 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:36:25.775716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:27.172939 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.395 seconds
[0m12:36:27.192928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:36:27.204819 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:36:27.220786 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:36:27.220786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:27.654161 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.433 seconds
[0m12:36:27.660202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d9860cd-dd1a-4bc3-8509-8b64ad368f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014292978F50>]}
[0m12:36:27.660202 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:36:27.670075 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:36:27.670075 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m12:36:27.670075 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:36:27.674194 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:36:27.674194 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:36:27.701592 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:36:27.701592 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:36:27.701592 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id    AS t_product_id
        , CAST(payment_month AS DATE)  AS payment_month    
        , CAST(revenue_type AS INT)  AS revenue_type
        , CAST(revenue AS BOOLEAN) AS revenue
        , CAST(quantity AS INT) AS quantity
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:36:27.701592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:28.234305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m12:36:28.258146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d9860cd-dd1a-4bc3-8509-8b64ad368f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001428F760770>]}
[0m12:36:28.258146 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.59s]
[0m12:36:28.258146 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:36:28.258146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:28.258146 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:36:28.264089 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:36:28.352600 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:36:28.352600 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:36:28.440157 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:36:28.440157 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:36:28.521189 [info ] [MainThread]: 
[0m12:36:28.521189 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m12:36:28.537218 [debug] [MainThread]: Command end result
[0m12:36:28.600778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:36:28.600778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:36:28.620482 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:36:28.620482 [info ] [MainThread]: 
[0m12:36:28.620482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:28.620482 [info ] [MainThread]: 
[0m12:36:28.620482 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:28.620482 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:28.620482 after 4.39 seconds
[0m12:36:28.620482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001428FB4DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001428CBBB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001429243E6F0>]}
[0m12:36:28.620482 [debug] [MainThread]: Flushing usage events
[0m12:36:29.843931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:35.139629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024824058500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024824059400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002482405B440>]}


============================== 12:36:35.139629 | 3a12b4f4-9497-45da-ad42-77ef6ed8d6eb ==============================
[0m12:36:35.139629 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:36:35.155273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m master', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:36:35.570095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a12b4f4-9497-45da-ad42-77ef6ed8d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024824D44B00>]}
[0m12:36:35.631783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a12b4f4-9497-45da-ad42-77ef6ed8d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024825DFAE40>]}
[0m12:36:35.631783 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:36:35.949202 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:36:36.091568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:36:36.091568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:36:36.091568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:36:36.129724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a12b4f4-9497-45da-ad42-77ef6ed8d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024825E9E750>]}
[0m12:36:36.197112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:36:36.201129 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:36:36.218741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a12b4f4-9497-45da-ad42-77ef6ed8d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024826201D00>]}
[0m12:36:36.218741 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:36:36.218741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a12b4f4-9497-45da-ad42-77ef6ed8d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024824DAB800>]}
[0m12:36:36.218741 [info ] [MainThread]: 
[0m12:36:36.218741 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:36.218741 [info ] [MainThread]: 
[0m12:36:36.218741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:36.218741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:36:36.317834 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:36:36.317834 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:36:36.317834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:36.810442 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.505 seconds
[0m12:36:36.826507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:36:36.842294 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:36:36.842294 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:36:36.842294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:37.132182 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.290 seconds
[0m12:36:37.138213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a12b4f4-9497-45da-ad42-77ef6ed8d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024826051430>]}
[0m12:36:37.138213 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:36:37.138213 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:36:37.138213 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:36:37.138213 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:36:37.148280 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:36:37.148280 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:36:37.179998 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:36:37.179998 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:36:37.179998 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.* ,
        t.* ,
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id



)
select * from required_fields
  );
[0m12:36:37.179998 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:36:38.165761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m12:36:38.199447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a12b4f4-9497-45da-ad42-77ef6ed8d6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024826293A40>]}
[0m12:36:38.199447 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 1.06s]
[0m12:36:38.199447 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:36:38.199447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:36:38.199447 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:36:38.199447 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:36:38.277455 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:36:38.277455 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:36:38.357676 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:36:38.357676 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:36:38.454114 [info ] [MainThread]: 
[0m12:36:38.454114 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m12:36:38.454114 [debug] [MainThread]: Command end result
[0m12:36:38.485649 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:36:38.485649 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:36:38.485649 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:36:38.485649 [info ] [MainThread]: 
[0m12:36:38.485649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:36:38.485649 [info ] [MainThread]: 
[0m12:36:38.485649 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:36:38.485649 [debug] [MainThread]: Command `dbt run` succeeded at 12:36:38.485649 after 3.51 seconds
[0m12:36:38.485649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024823DCE630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248243B83B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002482603A120>]}
[0m12:36:38.485649 [debug] [MainThread]: Flushing usage events
[0m12:36:39.414271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:37:11.253925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ABE64320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ABE64560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ABE64680>]}


============================== 12:37:11.260443 | bf554ec9-9897-4f64-b1c5-8c6f63b860f5 ==============================
[0m12:37:11.260443 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:37:11.260443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:11.680138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf554ec9-9897-4f64-b1c5-8c6f63b860f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ABEA9370>]}
[0m12:37:11.739305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf554ec9-9897-4f64-b1c5-8c6f63b860f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ABFF0710>]}
[0m12:37:11.741314 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:37:12.049225 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:37:12.181378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:12.181378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:12.187402 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:37:12.216964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf554ec9-9897-4f64-b1c5-8c6f63b860f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ACB87C50>]}
[0m12:37:12.272446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:37:12.272446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:37:12.311924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf554ec9-9897-4f64-b1c5-8c6f63b860f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ADE79640>]}
[0m12:37:12.311924 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:37:12.311924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf554ec9-9897-4f64-b1c5-8c6f63b860f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ACA5BCB0>]}
[0m12:37:12.311924 [info ] [MainThread]: 
[0m12:37:12.311924 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:12.311924 [info ] [MainThread]: 
[0m12:37:12.311924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:37:12.311924 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:37:12.399591 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:37:12.399591 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:37:12.399591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:13.263303 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.861 seconds
[0m12:37:13.273799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:37:13.286996 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:37:13.286996 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:37:13.292563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:13.714940 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.423 seconds
[0m12:37:13.714940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf554ec9-9897-4f64-b1c5-8c6f63b860f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ADED1BB0>]}
[0m12:37:13.714940 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m12:37:13.714940 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m12:37:13.714940 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m12:37:13.714940 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m12:37:13.730877 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m12:37:13.730877 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m12:37:13.761960 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m12:37:13.761960 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m12:37:13.761960 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        t_customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        t_customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT
    JOIN
        LastTransaction lt ON c.customer_id = lt.t_customer_id
    WHERE
        lt.last_transaction_date < DATEADD(month, -12, GETDATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, GETDATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date
  );
[0m12:37:13.761960 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:14.279039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m12:37:14.295026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf554ec9-9897-4f64-b1c5-8c6f63b860f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0A9231910>]}
[0m12:37:14.295026 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.58s]
[0m12:37:14.295026 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m12:37:14.295026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:14.295026 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:37:14.295026 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:37:14.392238 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:37:14.392238 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:37:14.488664 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m12:37:14.488664 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m12:37:14.585925 [info ] [MainThread]: 
[0m12:37:14.585925 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m12:37:14.585925 [debug] [MainThread]: Command end result
[0m12:37:14.602087 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:37:14.617997 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:37:14.617997 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:37:14.617997 [info ] [MainThread]: 
[0m12:37:14.617997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:14.617997 [info ] [MainThread]: 
[0m12:37:14.617997 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:37:14.617997 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:14.617997 after 3.53 seconds
[0m12:37:14.617997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0AB9D74D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ABE64560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0ABE64320>]}
[0m12:37:14.617997 [debug] [MainThread]: Flushing usage events
[0m12:37:15.519323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:39:58.631351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84B1336E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84D2FD4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84D2FCB60>]}


============================== 12:39:58.631351 | 4d98e876-02a6-499a-beb3-ca8edfafe022 ==============================
[0m12:39:58.631351 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:39:58.631351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:39:59.121153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d98e876-02a6-499a-beb3-ca8edfafe022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84B2D26C0>]}
[0m12:39:59.184813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d98e876-02a6-499a-beb3-ca8edfafe022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84EC0CB90>]}
[0m12:39:59.184813 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:39:59.616563 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:40:00.845941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:00.847949 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m12:40:01.083531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:40:01.087219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d98e876-02a6-499a-beb3-ca8edfafe022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B850021640>]}
[0m12:40:01.150432 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:40:01.166498 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:40:01.201114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d98e876-02a6-499a-beb3-ca8edfafe022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B85020D2B0>]}
[0m12:40:01.201114 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:40:01.203123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d98e876-02a6-499a-beb3-ca8edfafe022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B850243CB0>]}
[0m12:40:01.203123 [info ] [MainThread]: 
[0m12:40:01.203123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:01.203123 [info ] [MainThread]: 
[0m12:40:01.203123 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:01.203123 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:40:03.817578 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:40:03.817578 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:40:03.817578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:05.015405 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.204 seconds
[0m12:40:05.028721 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:40:05.028721 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:40:05.028721 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:40:05.028721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:05.331608 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.294 seconds
[0m12:40:05.331608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d98e876-02a6-499a-beb3-ca8edfafe022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84ED40590>]}
[0m12:40:05.331608 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m12:40:05.331608 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m12:40:05.331608 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m12:40:05.331608 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m12:40:05.349692 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m12:40:05.349692 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m12:40:05.379391 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m12:40:05.379391 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m12:40:05.379391 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        t_customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        t_customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT JOIN
        LastTransaction lt ON c.customer_id = lt.t_customer_id
    WHERE
        lt.last_transaction_date IS NOT NULL
        AND lt.last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, CURRENT_DATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date;
[0m12:40:05.382437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:05.799965 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff4e-0001-429e-0008-511e00012c06
[0m12:40:05.799965 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 34 at position 28 unexpected ';'.
[0m12:40:05.814684 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 28 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:40:05.816692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d98e876-02a6-499a-beb3-ca8edfafe022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84D3D09B0>]}
[0m12:40:05.816692 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.48s]
[0m12:40:05.816692 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m12:40:05.816692 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 28 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m12:40:05.816692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:05.816692 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:40:05.816692 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:40:05.906373 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:40:05.906373 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:40:06.003674 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m12:40:06.005687 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m12:40:06.098106 [info ] [MainThread]: 
[0m12:40:06.098106 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m12:40:06.101698 [debug] [MainThread]: Command end result
[0m12:40:06.178025 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:40:06.178025 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:40:06.194092 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:40:06.194092 [info ] [MainThread]: 
[0m12:40:06.194092 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:40:06.194092 [info ] [MainThread]: 
[0m12:40:06.194092 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 34 at position 28 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m12:40:06.194092 [info ] [MainThread]: 
[0m12:40:06.194092 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:40:06.194092 [debug] [MainThread]: Command `dbt run` failed at 12:40:06.194092 after 7.75 seconds
[0m12:40:06.194092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B84D32E120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8500CF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8500CFD70>]}
[0m12:40:06.194092 [debug] [MainThread]: Flushing usage events
[0m12:40:07.211114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:16.481436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664AABD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664C633260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664C632CC0>]}


============================== 12:40:16.481436 | 871b6160-c78a-4614-8742-53227f940c4b ==============================
[0m12:40:16.481436 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:40:16.481436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m churn', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:40:16.892288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '871b6160-c78a-4614-8742-53227f940c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664E31F0E0>]}
[0m12:40:16.956271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '871b6160-c78a-4614-8742-53227f940c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664DAB1880>]}
[0m12:40:16.956271 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:40:17.271923 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:40:17.438291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:17.438291 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m12:40:17.683595 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:40:17.693916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '871b6160-c78a-4614-8742-53227f940c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664F6EAF30>]}
[0m12:40:17.747169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:40:17.762897 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:40:17.788141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '871b6160-c78a-4614-8742-53227f940c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664FB8D3A0>]}
[0m12:40:17.788141 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:40:17.788141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871b6160-c78a-4614-8742-53227f940c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664D7F9C10>]}
[0m12:40:17.788141 [info ] [MainThread]: 
[0m12:40:17.788141 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:40:17.788141 [info ] [MainThread]: 
[0m12:40:17.788141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:40:17.794478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:40:17.877571 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:40:17.877571 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:40:17.877571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:18.371431 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.500 seconds
[0m12:40:18.371431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:40:18.385796 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:40:18.385796 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:40:18.385796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:18.707756 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.313 seconds
[0m12:40:18.709768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '871b6160-c78a-4614-8742-53227f940c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665001A8A0>]}
[0m12:40:18.709768 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m12:40:18.709768 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m12:40:18.709768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m12:40:18.709768 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m12:40:18.720251 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m12:40:18.720251 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m12:40:18.755863 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m12:40:18.757871 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m12:40:18.757871 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        t_customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        t_customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT JOIN
        LastTransaction lt ON c.customer_id = lt.t_customer_id
    WHERE
        lt.last_transaction_date IS NOT NULL
        AND lt.last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, CURRENT_DATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date
  );
[0m12:40:18.757871 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:19.650706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.892 seconds
[0m12:40:19.675551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '871b6160-c78a-4614-8742-53227f940c4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664CCC0AD0>]}
[0m12:40:19.675551 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.97s]
[0m12:40:19.675551 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m12:40:19.675551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:19.675551 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:40:19.675551 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:40:19.762047 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:40:19.762047 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:40:19.841291 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m12:40:19.841291 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m12:40:19.947439 [info ] [MainThread]: 
[0m12:40:19.947439 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m12:40:19.947439 [debug] [MainThread]: Command end result
[0m12:40:20.015804 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:40:20.015804 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:40:20.015804 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:40:20.015804 [info ] [MainThread]: 
[0m12:40:20.015804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:40:20.015804 [info ] [MainThread]: 
[0m12:40:20.015804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:40:20.015804 [debug] [MainThread]: Command `dbt run` succeeded at 12:40:20.015804 after 3.71 seconds
[0m12:40:20.015804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664FBCD880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664FBCD1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001664C7BE000>]}
[0m12:40:20.015804 [debug] [MainThread]: Flushing usage events
[0m12:40:21.250671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:39.346556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6B84C830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6B84FCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6B84F470>]}


============================== 12:42:39.346556 | 1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab ==============================
[0m12:42:39.346556 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:42:39.346556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m master', 'send_anonymous_usage_stats': 'True'}
[0m12:42:39.758731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6C5E0D10>]}
[0m12:42:39.824169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B68BF2960>]}
[0m12:42:39.824169 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:42:40.139990 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:42:40.282443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:42:40.282443 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:42:40.520913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:42:40.540112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6DBB1550>]}
[0m12:42:40.600318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:42:40.616160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:42:40.640182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6DB654C0>]}
[0m12:42:40.640182 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:42:40.640182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6DB972C0>]}
[0m12:42:40.640182 [info ] [MainThread]: 
[0m12:42:40.640182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:42:40.640182 [info ] [MainThread]: 
[0m12:42:40.640182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:42:40.647567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:42:40.730955 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:42:40.730955 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:42:40.732963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:41.582020 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.859 seconds
[0m12:42:41.593418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:42:41.593418 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:42:41.593418 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:42:41.593418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:42:42.029580 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.434 seconds
[0m12:42:42.042440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6C3229F0>]}
[0m12:42:42.042440 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:42:42.042440 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:42:42.042440 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:42:42.042440 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:42:42.058217 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:42:42.058217 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:42:42.089471 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:42:42.089471 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:42:42.091480 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.*
        , t.t_product_id
        , t.t_product_id
        , t.payment_month
        , t.revenue_type
        , t.revenue
        , t.quantity
        , t.companies
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id



)
select * from required_fields
  );
[0m12:42:42.091480 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:42:42.395774 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff50-0001-42d7-0008-511e0001c19e
[0m12:42:42.395774 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 9 unexpected '.'.
syntax error line 29 at position 0 unexpected 'select'.
[0m12:42:42.395774 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 9 unexpected '.'.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:42:42.411596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f6bf8c3-0ad0-4063-a9a4-c62ebfeb56ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6ACFC5F0>]}
[0m12:42:42.411596 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.35s]
[0m12:42:42.411596 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:42:42.411596 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 9 unexpected '.'.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:42:42.411596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:42:42.411596 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:42:42.411596 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:42:42.490660 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:42:42.490660 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:42:42.571867 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:42:42.571867 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:42:42.684721 [info ] [MainThread]: 
[0m12:42:42.684721 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m12:42:42.695262 [debug] [MainThread]: Command end result
[0m12:42:42.764184 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:42:42.764184 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:42:42.764184 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:42:42.764184 [info ] [MainThread]: 
[0m12:42:42.764184 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:42:42.764184 [info ] [MainThread]: 
[0m12:42:42.779898 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 9 unexpected '.'.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:42:42.779898 [info ] [MainThread]: 
[0m12:42:42.779898 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:42:42.779898 [debug] [MainThread]: Command `dbt run` failed at 12:42:42.779898 after 3.60 seconds
[0m12:42:42.779898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6B464E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6DAE3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6DA1ED80>]}
[0m12:42:42.779898 [debug] [MainThread]: Flushing usage events
[0m12:42:43.713075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:00.289388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85C48D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85CF8E3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85ED363C0>]}


============================== 12:44:00.289388 | c03ead97-865e-44e8-ac93-501ee04985a5 ==============================
[0m12:44:00.289388 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:44:00.289388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m master', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:44:00.719129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c03ead97-865e-44e8-ac93-501ee04985a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860F4ABD0>]}
[0m12:44:00.782785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c03ead97-865e-44e8-ac93-501ee04985a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85E693D10>]}
[0m12:44:00.782785 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:44:01.083791 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:44:01.226290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:44:01.242364 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:44:01.480020 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:44:01.480020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c03ead97-865e-44e8-ac93-501ee04985a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8612B3950>]}
[0m12:44:01.554113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:44:01.560029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:44:01.585056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c03ead97-865e-44e8-ac93-501ee04985a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86149D1C0>]}
[0m12:44:01.585056 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:44:01.585056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c03ead97-865e-44e8-ac93-501ee04985a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8614D6090>]}
[0m12:44:01.585056 [info ] [MainThread]: 
[0m12:44:01.585056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:44:01.585056 [info ] [MainThread]: 
[0m12:44:01.585056 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:44:01.585056 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:44:01.671350 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:44:01.671350 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:44:01.671350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:02.555770 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.887 seconds
[0m12:44:02.568528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:44:02.568528 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:44:02.568528 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:44:02.568528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:44:03.071563 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.501 seconds
[0m12:44:03.084150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c03ead97-865e-44e8-ac93-501ee04985a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8614CFFE0>]}
[0m12:44:03.084150 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:44:03.084150 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:44:03.084150 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:44:03.084150 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:44:03.098181 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:44:03.098181 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:44:03.115610 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:44:03.115610 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:44:03.115610 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH

required_fields AS (

    SELECT
     
        c.*
        , t.t_customer_id
        , t.t_product_id
        , t.payment_month
        , t.revenue_type
        , t.revenue
        , t.quantity
        , t.companies
        p.* 

    FROM MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
    MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
    MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id



)
select * from required_fields
  );
[0m12:44:03.115610 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:44:03.614694 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff52-0001-42d7-0008-511e0001c1a2
[0m12:44:03.614694 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 9 unexpected '.'.
syntax error line 29 at position 0 unexpected 'select'.
[0m12:44:03.614694 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 9 unexpected '.'.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:44:03.630845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c03ead97-865e-44e8-ac93-501ee04985a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E860FFABD0>]}
[0m12:44:03.630845 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.53s]
[0m12:44:03.630845 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:44:03.630845 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 9 unexpected '.'.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:44:03.630845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:03.630845 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:44:03.630845 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:44:03.726343 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:44:03.726343 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:44:03.806153 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:44:03.806153 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:44:03.910691 [info ] [MainThread]: 
[0m12:44:03.912714 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.33 seconds (2.33s).
[0m12:44:03.912714 [debug] [MainThread]: Command end result
[0m12:44:03.982973 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:44:03.982973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:44:03.994026 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:44:03.996034 [info ] [MainThread]: 
[0m12:44:03.996034 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:44:03.996034 [info ] [MainThread]: 
[0m12:44:03.996034 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 9 unexpected '.'.
  syntax error line 29 at position 0 unexpected 'select'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:44:03.996034 [info ] [MainThread]: 
[0m12:44:03.998691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:44:03.998691 [debug] [MainThread]: Command `dbt run` failed at 12:44:03.998691 after 3.87 seconds
[0m12:44:03.998691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85E77CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85E725F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85E725E80>]}
[0m12:44:03.998691 [debug] [MainThread]: Flushing usage events
[0m12:44:04.901700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:05.334658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C380118BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C380118B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C380118EF0>]}


============================== 12:45:05.339760 | 0bf67d35-16d3-4ff9-a9c2-6a202183da4d ==============================
[0m12:45:05.339760 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:05.339760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m master', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:45:05.763595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bf67d35-16d3-4ff9-a9c2-6a202183da4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3FFBD4980>]}
[0m12:45:05.822761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bf67d35-16d3-4ff9-a9c2-6a202183da4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C380DD4B90>]}
[0m12:45:05.822761 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:45:06.135108 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:45:06.279219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:06.279219 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:45:06.524210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:45:06.536041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bf67d35-16d3-4ff9-a9c2-6a202183da4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C382431610>]}
[0m12:45:06.595398 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:45:06.595398 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:45:06.627265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bf67d35-16d3-4ff9-a9c2-6a202183da4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3823E13A0>]}
[0m12:45:06.627265 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:45:06.627265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf67d35-16d3-4ff9-a9c2-6a202183da4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C381F594C0>]}
[0m12:45:06.627265 [info ] [MainThread]: 
[0m12:45:06.627265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:06.627265 [info ] [MainThread]: 
[0m12:45:06.627265 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:06.636310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:45:06.706293 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:45:06.722344 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:45:06.722344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:07.526552 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.809 seconds
[0m12:45:07.542141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:45:07.547693 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:45:07.552484 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:45:07.552484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:07.866386 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.315 seconds
[0m12:45:07.873556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf67d35-16d3-4ff9-a9c2-6a202183da4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C380139C10>]}
[0m12:45:07.880222 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:45:07.880726 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:45:07.881122 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:45:07.881122 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:45:07.881122 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:45:07.881122 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:45:07.917742 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:45:07.919750 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:45:07.919750 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH required_fields AS (
    SELECT
        c.*,
        t.t_customer_id,
        t.t_product_id,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        t.companies,
        p.*
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM required_fields;
[0m12:45:07.919750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:08.329135 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff53-0001-42d7-0008-511e0001c1a6
[0m12:45:08.329135 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 20 unexpected ';'.
[0m12:45:08.329135 [debug] [Thread-1 (]: Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 20 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:45:08.344087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf67d35-16d3-4ff9-a9c2-6a202183da4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3829B3F50>]}
[0m12:45:08.344087 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master ................................ [[31mERROR[0m in 0.45s]
[0m12:45:08.344087 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:45:08.344087 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master' to be skipped because of status 'error'.  Reason: Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 20 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql.
[0m12:45:08.348188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:08.348188 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:45:08.348188 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:45:08.442911 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:45:08.442911 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:45:08.520250 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:45:08.520250 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:45:08.601027 [info ] [MainThread]: 
[0m12:45:08.601027 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m12:45:08.617147 [debug] [MainThread]: Command end result
[0m12:45:08.680686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:45:08.680686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:45:08.696660 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:45:08.696660 [info ] [MainThread]: 
[0m12:45:08.696660 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:45:08.696660 [info ] [MainThread]: 
[0m12:45:08.696660 [error] [MainThread]:   Database Error in model master (models\Intermediate\master.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 20 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Intermediate\master.sql
[0m12:45:08.696660 [info ] [MainThread]: 
[0m12:45:08.696660 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:45:08.696660 [debug] [MainThread]: Command `dbt run` failed at 12:45:08.696660 after 3.53 seconds
[0m12:45:08.696660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38229F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38229EC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C38229F440>]}
[0m12:45:08.696660 [debug] [MainThread]: Flushing usage events
[0m12:45:09.647416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:45:17.572088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA235DD760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2087D5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA225DEA20>]}


============================== 12:45:17.577764 | dc096c08-8e3b-4c74-8e2d-27c635445a58 ==============================
[0m12:45:17.577764 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:45:17.579505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m master', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:18.001249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc096c08-8e3b-4c74-8e2d-27c635445a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA241FED50>]}
[0m12:45:18.046400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc096c08-8e3b-4c74-8e2d-27c635445a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA25488470>]}
[0m12:45:18.046400 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:45:18.363132 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:45:18.505676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:45:18.505676 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:45:18.742431 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:45:18.758157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc096c08-8e3b-4c74-8e2d-27c635445a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA253D8AD0>]}
[0m12:45:18.821810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:45:18.821810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:45:18.859799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc096c08-8e3b-4c74-8e2d-27c635445a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2592D430>]}
[0m12:45:18.859799 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:45:18.861808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc096c08-8e3b-4c74-8e2d-27c635445a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA212339E0>]}
[0m12:45:18.861808 [info ] [MainThread]: 
[0m12:45:18.861808 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:45:18.861808 [info ] [MainThread]: 
[0m12:45:18.861808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:45:18.861808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:45:18.950917 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:45:18.950917 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:45:18.952925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:19.508299 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.556 seconds
[0m12:45:19.508299 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:45:19.523803 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:45:19.525811 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:45:19.525811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:19.999369 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.474 seconds
[0m12:45:20.003394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc096c08-8e3b-4c74-8e2d-27c635445a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA256DA7E0>]}
[0m12:45:20.003394 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:45:20.003394 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:45:20.003394 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:45:20.003394 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:45:20.003394 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:45:20.019379 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:45:20.035433 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:45:20.035433 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:45:20.035433 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH required_fields AS (
    SELECT
        c.*,
        t.t_customer_id,
        t.t_product_id,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        t.companies,
        p.*
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM required_fields
  );
[0m12:45:20.035433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:20.635795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m12:45:20.664091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc096c08-8e3b-4c74-8e2d-27c635445a58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA22A807D0>]}
[0m12:45:20.664091 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 0.64s]
[0m12:45:20.664091 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:45:20.664091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:20.664091 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:45:20.664091 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:45:20.744160 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:45:20.744160 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:45:20.841314 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:45:20.841314 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:45:20.938705 [info ] [MainThread]: 
[0m12:45:20.938705 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m12:45:20.938705 [debug] [MainThread]: Command end result
[0m12:45:21.034252 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:45:21.034252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:45:21.034252 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:45:21.034252 [info ] [MainThread]: 
[0m12:45:21.034252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:21.034252 [info ] [MainThread]: 
[0m12:45:21.034252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:45:21.034252 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:21.034252 after 3.63 seconds
[0m12:45:21.034252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA212339E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2596FE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA2596FFE0>]}
[0m12:45:21.034252 [debug] [MainThread]: Flushing usage events
[0m12:45:21.972326 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:46:55.597258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D07A7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D07A7BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D07A7A70>]}


============================== 12:46:55.597258 | db367140-22cb-486e-a905-77f25a07d882 ==============================
[0m12:46:55.597258 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:46:55.597258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_transaction', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:46:56.021436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db367140-22cb-486e-a905-77f25a07d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D1A80B30>]}
[0m12:46:56.084759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db367140-22cb-486e-a905-77f25a07d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D17065D0>]}
[0m12:46:56.084759 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:46:56.402433 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:46:56.544900 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:46:56.544900 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m12:46:56.783364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:46:56.799029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db367140-22cb-486e-a905-77f25a07d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D3021430>]}
[0m12:46:56.863217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:46:56.878489 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:46:56.894229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db367140-22cb-486e-a905-77f25a07d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D2FD12E0>]}
[0m12:46:56.894229 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:46:56.894229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db367140-22cb-486e-a905-77f25a07d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D300A450>]}
[0m12:46:56.894229 [info ] [MainThread]: 
[0m12:46:56.894229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:56.894229 [info ] [MainThread]: 
[0m12:46:56.894229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:56.910732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:46:56.989573 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:46:56.989573 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:46:56.989573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:57.792537 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.801 seconds
[0m12:46:57.801975 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:46:57.808599 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:46:57.808599 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:46:57.808599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:58.145493 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.327 seconds
[0m12:46:58.145493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db367140-22cb-486e-a905-77f25a07d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D2CB8410>]}
[0m12:46:58.145493 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:46:58.145493 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:46:58.145493 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m12:46:58.145493 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:46:58.161158 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:46:58.161158 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:46:58.192816 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:46:58.192816 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:46:58.192816 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id    AS t_product_id
        , CAST(payment_month AS DATE)  AS payment_month    
        , CAST(revenue_type AS INT)  AS revenue_type
        , CAST(revenue AS INT) AS revenue
        , CAST(quantity AS BOOLEAN) AS quantity
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:46:58.192816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:46:58.696401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m12:46:58.728170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db367140-22cb-486e-a905-77f25a07d882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D01106E0>]}
[0m12:46:58.728170 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.57s]
[0m12:46:58.728170 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:46:58.728170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:58.728170 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:46:58.728170 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:46:58.823660 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:46:58.823660 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:46:58.909623 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:46:58.909623 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:46:58.999826 [info ] [MainThread]: 
[0m12:46:59.000841 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m12:46:59.000841 [debug] [MainThread]: Command end result
[0m12:46:59.079721 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:46:59.079721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:46:59.079721 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:46:59.079721 [info ] [MainThread]: 
[0m12:46:59.079721 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:59.079721 [info ] [MainThread]: 
[0m12:46:59.079721 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:46:59.079721 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:59.079721 after 3.65 seconds
[0m12:46:59.079721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D00C9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D00C8E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232D09D19A0>]}
[0m12:46:59.079721 [debug] [MainThread]: Flushing usage events
[0m12:47:00.032908 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:04.790906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351B1AC680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351B1AC620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351B1AE1E0>]}


============================== 12:47:04.790906 | 9f570288-3196-4fce-98f3-21768b816f3d ==============================
[0m12:47:04.790906 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:47:04.790906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m master', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:05.231034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f570288-3196-4fce-98f3-21768b816f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351BFD0DA0>]}
[0m12:47:05.289204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f570288-3196-4fce-98f3-21768b816f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023518F607A0>]}
[0m12:47:05.289204 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:47:05.608866 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:47:05.755087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:05.757095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:05.763120 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:47:05.790107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f570288-3196-4fce-98f3-21768b816f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351D18A240>]}
[0m12:47:05.857574 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:47:05.859582 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:47:05.885340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f570288-3196-4fce-98f3-21768b816f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351D37B860>]}
[0m12:47:05.885340 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:47:05.885340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f570288-3196-4fce-98f3-21768b816f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351D5002C0>]}
[0m12:47:05.888224 [info ] [MainThread]: 
[0m12:47:05.888224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:05.888224 [info ] [MainThread]: 
[0m12:47:05.888224 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:05.888224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:47:05.960054 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:47:05.976071 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:47:05.976071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:06.456826 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.494 seconds
[0m12:47:06.472949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:47:06.472949 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:47:06.472949 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:47:06.472949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:06.891446 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.412 seconds
[0m12:47:06.891446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f570288-3196-4fce-98f3-21768b816f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351D37AF60>]}
[0m12:47:06.907357 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:47:06.907357 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:47:06.907357 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:47:06.907357 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:47:06.923205 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:47:06.925215 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:47:06.956816 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:47:06.958825 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:47:06.958825 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH required_fields AS (
    SELECT
        c.*,
        t.t_customer_id,
        t.t_product_id,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        t.companies,
        p.*
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM required_fields
  );
[0m12:47:06.958825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:07.556636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m12:47:07.585076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f570288-3196-4fce-98f3-21768b816f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351A780A70>]}
[0m12:47:07.585076 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 0.66s]
[0m12:47:07.585076 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:47:07.585076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:07.585076 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:47:07.585076 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:47:07.664838 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:47:07.664838 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:47:07.760932 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:47:07.762944 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:47:07.857360 [info ] [MainThread]: 
[0m12:47:07.859379 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m12:47:07.859379 [debug] [MainThread]: Command end result
[0m12:47:07.892050 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:47:07.905153 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:47:07.905153 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:47:07.905153 [info ] [MainThread]: 
[0m12:47:07.905153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:07.905153 [info ] [MainThread]: 
[0m12:47:07.905153 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:47:07.905153 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:07.905153 after 3.28 seconds
[0m12:47:07.905153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235152421B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002351A930B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235184EACF0>]}
[0m12:47:07.905153 [debug] [MainThread]: Flushing usage events
[0m12:47:08.840388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:54.708903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BE0C5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BE0C4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BE0C45F0>]}


============================== 12:47:54.714296 | bb88788a-8091-4e37-8880-8b8cec3c0f6d ==============================
[0m12:47:54.714296 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:47:54.714296 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:55.390377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb88788a-8091-4e37-8880-8b8cec3c0f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BDDCB1D0>]}
[0m12:47:55.450495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb88788a-8091-4e37-8880-8b8cec3c0f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BBC7CF80>]}
[0m12:47:55.450495 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:47:55.770531 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:47:55.909258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:55.909258 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m12:47:56.161442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:47:56.161442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb88788a-8091-4e37-8880-8b8cec3c0f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C03BD730>]}
[0m12:47:56.240062 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:47:56.240062 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:47:56.271531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb88788a-8091-4e37-8880-8b8cec3c0f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C036D3D0>]}
[0m12:47:56.271531 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:47:56.271531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb88788a-8091-4e37-8880-8b8cec3c0f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C035BFE0>]}
[0m12:47:56.271531 [info ] [MainThread]: 
[0m12:47:56.271531 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:56.271531 [info ] [MainThread]: 
[0m12:47:56.271531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:56.271531 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:47:56.366516 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:47:56.366516 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:47:56.366516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:57.172271 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.800 seconds
[0m12:47:57.178296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:47:57.188068 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:47:57.190077 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:47:57.190581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:57.613474 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.426 seconds
[0m12:47:57.613474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb88788a-8091-4e37-8880-8b8cec3c0f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BEDD2870>]}
[0m12:47:57.613474 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:47:57.613474 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:47:57.613474 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m12:47:57.613474 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:47:57.634459 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:47:57.634459 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:47:57.662040 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:47:57.666056 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:47:57.666056 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id    AS t_product_id
        , CAST(payment_month AS DATE)  AS payment_month    
        , CAST(revenue_type AS INT)  AS revenue_type
        , CAST(revenue AS INT) AS revenue
        , CAST(quantity AS INT) AS quantity
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:47:57.666056 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:47:58.203660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m12:47:58.235386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb88788a-8091-4e37-8880-8b8cec3c0f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BD590890>]}
[0m12:47:58.235386 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.62s]
[0m12:47:58.235386 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:47:58.235386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:58.235386 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:47:58.235386 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:47:58.329833 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:47:58.329833 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:47:58.410450 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:47:58.410450 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:47:58.503317 [info ] [MainThread]: 
[0m12:47:58.503317 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m12:47:58.515772 [debug] [MainThread]: Command end result
[0m12:47:58.583287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:47:58.583287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:47:58.599290 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:47:58.599290 [info ] [MainThread]: 
[0m12:47:58.599290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:47:58.599290 [info ] [MainThread]: 
[0m12:47:58.599290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:47:58.599290 [debug] [MainThread]: Command `dbt run` succeeded at 12:47:58.599290 after 4.08 seconds
[0m12:47:58.599290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174BED11490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C023D9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C023CB00>]}
[0m12:47:58.599290 [debug] [MainThread]: Flushing usage events
[0m12:47:59.885365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:05.385755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A467EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A4EA0D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A467FC20>]}


============================== 12:48:05.385755 | 99371427-0e24-4615-8fd6-8c5d228cdf9a ==============================
[0m12:48:05.385755 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:48:05.385755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m master', 'send_anonymous_usage_stats': 'True'}
[0m12:48:05.795842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99371427-0e24-4615-8fd6-8c5d228cdf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A5BBCB00>]}
[0m12:48:05.869571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99371427-0e24-4615-8fd6-8c5d228cdf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A5C3F3E0>]}
[0m12:48:05.872266 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:48:06.175676 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:48:06.333613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:06.333613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:06.333613 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m12:48:06.365803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99371427-0e24-4615-8fd6-8c5d228cdf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A6D22CF0>]}
[0m12:48:06.429384 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:48:06.429384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:48:06.461002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99371427-0e24-4615-8fd6-8c5d228cdf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A6ED88F0>]}
[0m12:48:06.461002 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:48:06.461002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99371427-0e24-4615-8fd6-8c5d228cdf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A47F93A0>]}
[0m12:48:06.461002 [info ] [MainThread]: 
[0m12:48:06.461002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:06.461002 [info ] [MainThread]: 
[0m12:48:06.461002 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:48:06.461002 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:48:06.556350 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:48:06.556350 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:48:06.556350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:06.926325 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.378 seconds
[0m12:48:06.926325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:48:06.942368 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:48:06.942368 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:48:06.942368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:07.248656 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.298 seconds
[0m12:48:07.248656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99371427-0e24-4615-8fd6-8c5d228cdf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A59C82C0>]}
[0m12:48:07.248656 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:48:07.248656 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:48:07.248656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:48:07.248656 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:48:07.264749 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:48:07.264749 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:48:07.296768 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:48:07.296768 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:48:07.296768 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH required_fields AS (
    SELECT
        c.*,
        t.t_customer_id,
        t.t_product_id,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        t.companies,
        p.*
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM required_fields
  );
[0m12:48:07.296768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:07.958549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m12:48:07.982520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99371427-0e24-4615-8fd6-8c5d228cdf9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A22416A0>]}
[0m12:48:07.982520 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 0.73s]
[0m12:48:07.982520 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:48:07.982520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:07.982520 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:48:07.982520 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:48:08.067760 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:48:08.067760 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:48:08.148410 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:48:08.148410 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:48:08.244913 [info ] [MainThread]: 
[0m12:48:08.244913 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m12:48:08.250008 [debug] [MainThread]: Command end result
[0m12:48:08.260711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:48:08.260711 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:48:08.276411 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:48:08.276411 [info ] [MainThread]: 
[0m12:48:08.276411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:08.276411 [info ] [MainThread]: 
[0m12:48:08.276411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:48:08.276411 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:08.276411 after 3.05 seconds
[0m12:48:08.276411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2B8E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A297DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000231A2C420F0>]}
[0m12:48:08.276411 [debug] [MainThread]: Flushing usage events
[0m12:48:09.152729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:36.052050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC81D8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC81D8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC81D8D10>]}


============================== 12:49:36.052050 | bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4 ==============================
[0m12:49:36.052050 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:36.052050 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m master', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:49:36.480979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC8EDBAD0>]}
[0m12:49:36.529087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC81B7C80>]}
[0m12:49:36.529087 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:49:36.845811 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:36.972243 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:36.972243 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master.sql
[0m12:49:37.223768 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:49:37.226780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC9FF9640>]}
[0m12:49:37.290077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:49:37.305779 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:49:37.331130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCA4853A0>]}
[0m12:49:37.331130 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:49:37.333140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCA013170>]}
[0m12:49:37.333140 [info ] [MainThread]: 
[0m12:49:37.333140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:37.333140 [info ] [MainThread]: 
[0m12:49:37.333140 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:37.337433 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:49:37.420597 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:49:37.420597 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:49:37.420597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:38.248500 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.837 seconds
[0m12:49:38.264309 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:49:38.264309 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:49:38.264309 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:49:38.264309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:38.730187 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.456 seconds
[0m12:49:38.745824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC8EDB290>]}
[0m12:49:38.753541 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:49:38.761738 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:49:38.761738 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:49:38.761738 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:49:38.761738 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:49:38.761738 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:49:38.793522 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:49:38.793522 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:49:38.793522 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH required_fields AS (
    SELECT
        c.*,
        t.t_customer_id,
        t.t_product_id,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.*
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM required_fields
  );
[0m12:49:38.793522 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:39.486549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m12:49:39.502293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd5c9d8-6231-4519-8cb8-ad0b1b24a9b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC76A0920>]}
[0m12:49:39.502293 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 0.74s]
[0m12:49:39.502293 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:49:39.518689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:39.518689 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:49:39.518689 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:49:39.598608 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:49:39.598608 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:49:39.695175 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:49:39.695175 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:49:39.791630 [info ] [MainThread]: 
[0m12:49:39.791630 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m12:49:39.807641 [debug] [MainThread]: Command end result
[0m12:49:39.871318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:49:39.871318 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:49:39.887018 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:49:39.887018 [info ] [MainThread]: 
[0m12:49:39.887018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:39.887018 [info ] [MainThread]: 
[0m12:49:39.887018 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:39.887018 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:39.887018 after 3.99 seconds
[0m12:49:39.887018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBCA264080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC7BF1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC5763E00>]}
[0m12:49:39.887018 [debug] [MainThread]: Flushing usage events
[0m12:49:40.811762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:45.767931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D89914620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D892BB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D89914380>]}


============================== 12:49:45.776185 | c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec ==============================
[0m12:49:45.776185 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:45.776185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_transaction', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:46.187619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D898F7650>]}
[0m12:49:46.250265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8A2F7860>]}
[0m12:49:46.250265 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:49:46.567301 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:46.710063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:46.710063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:46.710063 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:49:46.741978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D89B18440>]}
[0m12:49:46.805714 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:49:46.805714 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:49:46.842012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8B908560>]}
[0m12:49:46.842012 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:49:46.842012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8B968F80>]}
[0m12:49:46.842012 [info ] [MainThread]: 
[0m12:49:46.842012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:46.842012 [info ] [MainThread]: 
[0m12:49:46.842012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:46.842012 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:49:46.931866 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:49:46.931866 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:49:46.931866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:47.316632 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.393 seconds
[0m12:49:47.331376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:49:47.331376 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:49:47.347079 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:49:47.347079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:47.654583 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.311 seconds
[0m12:49:47.654583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D8B6C3B00>]}
[0m12:49:47.654583 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m12:49:47.654583 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m12:49:47.654583 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m12:49:47.654583 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m12:49:47.670275 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m12:49:47.670275 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m12:49:47.702039 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m12:49:47.702039 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m12:49:47.702039 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id    AS t_product_id
        , CAST(payment_month AS DATE)  AS payment_month    
        , CAST(revenue_type AS INT)  AS revenue_type
        , CAST(revenue AS INT) AS revenue
        , CAST(quantity AS INT) AS quantity
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m12:49:47.702039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:48.249126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m12:49:48.265163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c22acbfd-8e51-4a4d-b3d1-1b66856ef2ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D86CE1670>]}
[0m12:49:48.265163 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.61s]
[0m12:49:48.265163 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m12:49:48.265163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:48.265163 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:49:48.265163 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:49:48.360715 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:49:48.360715 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:49:48.440183 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m12:49:48.440183 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m12:49:48.535330 [info ] [MainThread]: 
[0m12:49:48.535330 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m12:49:48.535330 [debug] [MainThread]: Command end result
[0m12:49:48.558199 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:49:48.560208 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:49:48.567237 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:49:48.567237 [info ] [MainThread]: 
[0m12:49:48.567237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:48.567237 [info ] [MainThread]: 
[0m12:49:48.567237 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:48.567237 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:48.567237 after 2.96 seconds
[0m12:49:48.567237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D892BB5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D899151C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D89914620>]}
[0m12:49:48.567237 [debug] [MainThread]: Flushing usage events
[0m12:49:49.459674 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:55.177790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F4080B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F4082F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F408590>]}


============================== 12:49:55.177790 | 55335075-9c7d-4eef-aaad-9b95c68ee7e1 ==============================
[0m12:49:55.177790 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:49:55.177790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m master', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:55.617081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55335075-9c7d-4eef-aaad-9b95c68ee7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623E962450>]}
[0m12:49:55.676250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55335075-9c7d-4eef-aaad-9b95c68ee7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002624127E510>]}
[0m12:49:55.678259 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:49:55.991492 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:49:56.130800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:49:56.130800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:49:56.136824 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:49:56.156495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55335075-9c7d-4eef-aaad-9b95c68ee7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623FFE3680>]}
[0m12:49:56.220311 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:49:56.220311 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:49:56.259328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55335075-9c7d-4eef-aaad-9b95c68ee7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026241479D30>]}
[0m12:49:56.259328 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:49:56.259328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55335075-9c7d-4eef-aaad-9b95c68ee7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000262414C80E0>]}
[0m12:49:56.259328 [info ] [MainThread]: 
[0m12:49:56.263449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:49:56.263449 [info ] [MainThread]: 
[0m12:49:56.263449 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:49:56.263449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:49:56.347414 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:49:56.347414 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:49:56.347414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:57.366832 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.025 seconds
[0m12:49:57.382874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:49:57.382874 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:49:57.382874 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:49:57.393341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:57.835918 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.446 seconds
[0m12:49:57.835918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55335075-9c7d-4eef-aaad-9b95c68ee7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623C86B320>]}
[0m12:49:57.848618 [debug] [Thread-1 (]: Began running node model.Mini_Project.master
[0m12:49:57.848618 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master ......................................... [RUN]
[0m12:49:57.848618 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master'
[0m12:49:57.848618 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master
[0m12:49:57.848618 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master"
[0m12:49:57.848618 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master
[0m12:49:57.880592 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master"
[0m12:49:57.880592 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master"
[0m12:49:57.880592 [debug] [Thread-1 (]: On model.Mini_Project.master: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master"} */
create or replace   view MINI_PROJECT.RAW.master
  
   as (
    WITH required_fields AS (
    SELECT
        c.*,
        t.t_customer_id,
        t.t_product_id,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.*
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM required_fields
  );
[0m12:49:57.880592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:58.424425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m12:49:58.444329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55335075-9c7d-4eef-aaad-9b95c68ee7e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623C7D1610>]}
[0m12:49:58.444329 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master .................................... [[32mSUCCESS 1[0m in 0.60s]
[0m12:49:58.444329 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master
[0m12:49:58.444329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:58.444329 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:49:58.444329 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:49:58.541923 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:49:58.541923 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:49:58.622854 [debug] [MainThread]: Connection 'model.Mini_Project.master' was left open.
[0m12:49:58.622854 [debug] [MainThread]: On model.Mini_Project.master: Close
[0m12:49:58.705973 [info ] [MainThread]: 
[0m12:49:58.705973 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m12:49:58.705973 [debug] [MainThread]: Command end result
[0m12:49:58.718291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:49:58.734230 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:49:58.740993 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:49:58.740993 [info ] [MainThread]: 
[0m12:49:58.740993 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:49:58.740993 [info ] [MainThread]: 
[0m12:49:58.740993 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:49:58.740993 [debug] [MainThread]: Command `dbt run` succeeded at 12:49:58.740993 after 3.72 seconds
[0m12:49:58.740993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F408E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F4082F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002623F4080B0>]}
[0m12:49:58.740993 [debug] [MainThread]: Flushing usage events
[0m12:49:59.635314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:12.819980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50588D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C507B220C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C507B22060>]}


============================== 12:50:12.824947 | e06eb220-4038-460f-8f77-0a1406e1092d ==============================
[0m12:50:12.824947 [info ] [MainThread]: Running with dbt=1.9.3
[0m12:50:12.824947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m churn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:13.253136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e06eb220-4038-460f-8f77-0a1406e1092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50A32AF00>]}
[0m12:50:13.312578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e06eb220-4038-460f-8f77-0a1406e1092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C507B21FA0>]}
[0m12:50:13.314586 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:50:13.629814 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m12:50:13.764841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:50:13.764841 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:50:13.770861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m12:50:13.800446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e06eb220-4038-460f-8f77-0a1406e1092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50A492780>]}
[0m12:50:13.869661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:50:13.871669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:50:13.885804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e06eb220-4038-460f-8f77-0a1406e1092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50A7BEFF0>]}
[0m12:50:13.885804 [info ] [MainThread]: Found 6 models, 4 sources, 474 macros
[0m12:50:13.885804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06eb220-4038-460f-8f77-0a1406e1092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50A3ABE00>]}
[0m12:50:13.885804 [info ] [MainThread]: 
[0m12:50:13.898596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:50:13.898596 [info ] [MainThread]: 
[0m12:50:13.898596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:50:13.898596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m12:50:13.980476 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m12:50:13.980476 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m12:50:13.980476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:14.764960 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.780 seconds
[0m12:50:14.766971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m12:50:14.782836 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m12:50:14.782836 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m12:50:14.782836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:50:15.201487 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.423 seconds
[0m12:50:15.201487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06eb220-4038-460f-8f77-0a1406e1092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5062D8890>]}
[0m12:50:15.201487 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m12:50:15.201487 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m12:50:15.217182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m12:50:15.217182 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m12:50:15.217182 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m12:50:15.217182 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m12:50:15.249258 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m12:50:15.249258 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m12:50:15.249258 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        t_customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        t_customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT JOIN
        LastTransaction lt ON c.customer_id = lt.t_customer_id
    WHERE
        lt.last_transaction_date IS NOT NULL
        AND lt.last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, CURRENT_DATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date
  );
[0m12:50:15.257607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:50:15.720047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m12:50:15.765527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06eb220-4038-460f-8f77-0a1406e1092d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5059915B0>]}
[0m12:50:15.765527 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.56s]
[0m12:50:15.765527 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m12:50:15.765527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:50:15.765527 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m12:50:15.765527 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m12:50:15.846197 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m12:50:15.846197 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m12:50:15.926834 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m12:50:15.926834 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m12:50:16.007793 [info ] [MainThread]: 
[0m12:50:16.007793 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m12:50:16.007793 [debug] [MainThread]: Command end result
[0m12:50:16.056094 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m12:50:16.056094 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m12:50:16.071805 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m12:50:16.071805 [info ] [MainThread]: 
[0m12:50:16.071805 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:50:16.071805 [info ] [MainThread]: 
[0m12:50:16.071805 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:50:16.071805 [debug] [MainThread]: Command `dbt run` succeeded at 12:50:16.071805 after 3.42 seconds
[0m12:50:16.071805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50588D610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C504F8AD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C504F898E0>]}
[0m12:50:16.071805 [debug] [MainThread]: Flushing usage events
[0m12:50:16.991110 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:00.199021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162282B8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162282B82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162282B80E0>]}


============================== 13:04:00.204058 | 67aacb4b-b8d4-4797-a8c5-fd2187e283d2 ==============================
[0m13:04:00.204058 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:04:00.204058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m master1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:04:00.946229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67aacb4b-b8d4-4797-a8c5-fd2187e283d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016228D4BE00>]}
[0m13:04:01.009871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67aacb4b-b8d4-4797-a8c5-fd2187e283d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622771BE00>]}
[0m13:04:01.009871 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:04:01.453440 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:04:02.708089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m13:04:02.708089 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\rank_customer.sql
[0m13:04:02.708089 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Intermediate\master1.sql
[0m13:04:02.961938 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:04:02.977482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67aacb4b-b8d4-4797-a8c5-fd2187e283d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622A529AC0>]}
[0m13:04:03.040742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:04:03.056517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:04:03.103897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67aacb4b-b8d4-4797-a8c5-fd2187e283d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622A601FA0>]}
[0m13:04:03.103897 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:04:03.103897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67aacb4b-b8d4-4797-a8c5-fd2187e283d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622A1869C0>]}
[0m13:04:03.103897 [info ] [MainThread]: 
[0m13:04:03.103897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:04:03.103897 [info ] [MainThread]: 
[0m13:04:03.103897 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:04:03.103897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:04:05.660642 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:04:05.670459 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:04:05.670459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:07.168029 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.505 seconds
[0m13:04:07.177207 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:04:07.183699 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:04:07.183699 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:04:07.183699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:07.650918 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.460 seconds
[0m13:04:07.657784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67aacb4b-b8d4-4797-a8c5-fd2187e283d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622A4E68A0>]}
[0m13:04:07.664821 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:04:07.664821 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:04:07.664821 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:04:07.666831 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:04:07.674869 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:04:07.676611 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:04:07.708573 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:04:07.708573 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:04:07.711222 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM required_fields
  );
[0m13:04:07.711222 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:08.250920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.544 seconds
[0m13:04:08.266848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67aacb4b-b8d4-4797-a8c5-fd2187e283d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000162256815B0>]}
[0m13:04:08.266848 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.60s]
[0m13:04:08.266848 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:04:08.266848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:08.266848 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:04:08.266848 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:04:08.361883 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:04:08.368175 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:04:08.456029 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:04:08.457541 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:04:08.539455 [info ] [MainThread]: 
[0m13:04:08.539455 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.44 seconds (5.44s).
[0m13:04:08.546812 [debug] [MainThread]: Command end result
[0m13:04:08.617755 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:04:08.617755 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:04:08.628731 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:04:08.628731 [info ] [MainThread]: 
[0m13:04:08.628731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:08.628731 [info ] [MainThread]: 
[0m13:04:08.628731 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:04:08.628731 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:08.628731 after 8.67 seconds
[0m13:04:08.628731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622A4C39B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622A4C0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001622A4C12E0>]}
[0m13:04:08.628731 [debug] [MainThread]: Flushing usage events
[0m13:04:09.545697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:08.316846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D8D4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D8D4E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D8D5040>]}


============================== 13:18:08.316846 | da48500b-14b9-4311-959b-fb01cf13fc28 ==============================
[0m13:18:08.316846 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:18:08.316846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m master1', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:09.013081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da48500b-14b9-4311-959b-fb01cf13fc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E199970>]}
[0m13:18:09.076920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da48500b-14b9-4311-959b-fb01cf13fc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023E4CDFA0>]}
[0m13:18:09.076920 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:18:09.629709 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:18:11.088735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:11.088735 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:18:11.339354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:18:11.355014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da48500b-14b9-4311-959b-fb01cf13fc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023FAD0AD0>]}
[0m13:18:11.418738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:18:11.443818 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:18:11.504503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da48500b-14b9-4311-959b-fb01cf13fc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023FBCDB80>]}
[0m13:18:11.504503 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:18:11.505880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da48500b-14b9-4311-959b-fb01cf13fc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023C89D550>]}
[0m13:18:11.505880 [info ] [MainThread]: 
[0m13:18:11.508215 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:11.508215 [info ] [MainThread]: 
[0m13:18:11.508215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:18:11.508215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:18:14.189997 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:18:14.189997 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:18:14.189997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:15.166378 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.983 seconds
[0m13:18:15.166378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:18:15.187880 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:18:15.187880 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:18:15.189888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:15.689732 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.500 seconds
[0m13:18:15.689732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da48500b-14b9-4311-959b-fb01cf13fc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023FF7D580>]}
[0m13:18:15.689732 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:18:15.689732 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:18:15.689732 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:18:15.705556 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:18:15.705556 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:18:15.705556 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:18:15.737293 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:18:15.737293 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:18:15.737293 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        t.t_product_id

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id

),
optimized AS(
    SELECT
        r.*,
        p.product_family,
        p.product_sub_family
    FROM required_fields AS r
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.t_product_id
)
SELECT * 
FROM optimized
  );
[0m13:18:15.737293 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:18:16.343510 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff74-0001-429e-0008-511e00012e46
[0m13:18:16.343510 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 27 at position 58
invalid identifier 'T.T_PRODUCT_ID'
[0m13:18:16.359243 [debug] [Thread-1 (]: Database Error in model master1 (models\Intermediate\master1.sql)
  000904 (42000): SQL compilation error: error line 27 at position 58
  invalid identifier 'T.T_PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql
[0m13:18:16.359243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da48500b-14b9-4311-959b-fb01cf13fc28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202401BD850>]}
[0m13:18:16.359243 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master1 ............................... [[31mERROR[0m in 0.67s]
[0m13:18:16.359243 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:18:16.359243 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master1' to be skipped because of status 'error'.  Reason: Database Error in model master1 (models\Intermediate\master1.sql)
  000904 (42000): SQL compilation error: error line 27 at position 58
  invalid identifier 'T.T_PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql.
[0m13:18:16.359243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:16.359243 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:18:16.359243 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:18:16.456381 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:18:16.456381 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:18:16.533243 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:18:16.533243 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:18:16.612127 [info ] [MainThread]: 
[0m13:18:16.620191 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m13:18:16.620191 [debug] [MainThread]: Command end result
[0m13:18:16.691326 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:18:16.691326 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:18:16.705022 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:18:16.705022 [info ] [MainThread]: 
[0m13:18:16.705022 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:18:16.705022 [info ] [MainThread]: 
[0m13:18:16.705022 [error] [MainThread]:   Database Error in model master1 (models\Intermediate\master1.sql)
  000904 (42000): SQL compilation error: error line 27 at position 58
  invalid identifier 'T.T_PRODUCT_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql
[0m13:18:16.707033 [info ] [MainThread]: 
[0m13:18:16.707033 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:18:16.707033 [debug] [MainThread]: Command `dbt run` failed at 13:18:16.707033 after 8.61 seconds
[0m13:18:16.707033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023C89D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023CF74CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023FC40350>]}
[0m13:18:16.707033 [debug] [MainThread]: Flushing usage events
[0m13:18:17.968646 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:57.512724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E0750DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E08C5B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E08C7050>]}


============================== 13:18:57.528379 | 55efccf0-6582-4860-9c77-0209e0375b20 ==============================
[0m13:18:57.528379 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:18:57.528379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m master1', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:18:57.974400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55efccf0-6582-4860-9c77-0209e0375b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E4C2D580>]}
[0m13:18:58.033840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55efccf0-6582-4860-9c77-0209e0375b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E4C5EF60>]}
[0m13:18:58.036266 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:18:58.357097 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:18:58.510270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:58.510270 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:18:58.758413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:18:58.764011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55efccf0-6582-4860-9c77-0209e0375b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E61FA180>]}
[0m13:18:58.834806 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:18:58.834806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:18:58.859326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55efccf0-6582-4860-9c77-0209e0375b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E61C1D00>]}
[0m13:18:58.859326 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:18:58.859326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55efccf0-6582-4860-9c77-0209e0375b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E61E4350>]}
[0m13:18:58.859326 [info ] [MainThread]: 
[0m13:18:58.859326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:58.859326 [info ] [MainThread]: 
[0m13:18:58.859326 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:18:58.859326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:18:58.967570 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:18:58.967570 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:18:58.967570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:00.085094 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.121 seconds
[0m13:19:00.095134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:19:00.100904 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:19:00.100904 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:19:00.100904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:00.516333 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.414 seconds
[0m13:19:00.516333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55efccf0-6582-4860-9c77-0209e0375b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E4A88B00>]}
[0m13:19:00.516333 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:19:00.516333 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:19:00.516333 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:19:00.516333 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:19:00.532234 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:19:00.538205 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:19:00.566014 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:19:00.568022 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:19:00.568022 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        t.t_product_id

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id

),
optimized AS(
    SELECT
        r.*,
        p.product_family,
        p.product_sub_family
    FROM required_fields AS r
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = r.t_product_id
)
SELECT * 
FROM optimized
  );
[0m13:19:00.568022 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:19:01.588808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.020 seconds
[0m13:19:01.635922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55efccf0-6582-4860-9c77-0209e0375b20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E4C10C20>]}
[0m13:19:01.635922 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 1.12s]
[0m13:19:01.635922 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:19:01.643016 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:01.643016 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:19:01.643016 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:19:01.717133 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:19:01.732002 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:19:01.814599 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:19:01.814599 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:19:01.896563 [info ] [MainThread]: 
[0m13:19:01.896563 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m13:19:01.896563 [debug] [MainThread]: Command end result
[0m13:19:01.972713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:19:01.972713 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:19:01.972713 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:19:01.972713 [info ] [MainThread]: 
[0m13:19:01.972713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:01.972713 [info ] [MainThread]: 
[0m13:19:01.972713 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:01.985599 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:01.972713 after 4.62 seconds
[0m13:19:01.985599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E352FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E380E930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D1E5EF9670>]}
[0m13:19:01.985599 [debug] [MainThread]: Flushing usage events
[0m13:19:02.850464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:19:55.629956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC38780B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC3878D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC3878E60>]}


============================== 13:19:55.629956 | 06efbe3e-ade3-4204-b81b-e80b2d424b27 ==============================
[0m13:19:55.629956 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:19:55.629956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m master1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:19:56.058293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06efbe3e-ade3-4204-b81b-e80b2d424b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC36D8830>]}
[0m13:19:56.121274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06efbe3e-ade3-4204-b81b-e80b2d424b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC38BE450>]}
[0m13:19:56.124204 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:19:56.421415 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:19:56.580913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:56.580913 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:19:56.819352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m13:19:56.835127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06efbe3e-ade3-4204-b81b-e80b2d424b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC5B85F70>]}
[0m13:19:56.898588 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:19:56.911863 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:19:56.930416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06efbe3e-ade3-4204-b81b-e80b2d424b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC5B39BE0>]}
[0m13:19:56.930416 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:19:56.930416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06efbe3e-ade3-4204-b81b-e80b2d424b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC5814C50>]}
[0m13:19:56.930416 [info ] [MainThread]: 
[0m13:19:56.930416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:19:56.930416 [info ] [MainThread]: 
[0m13:19:56.930416 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:19:56.930416 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:19:57.025092 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:19:57.025092 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:19:57.025092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:57.856304 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.825 seconds
[0m13:19:57.860940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:19:57.860940 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:19:57.872089 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:19:57.872089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:58.370851 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.501 seconds
[0m13:19:58.370851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06efbe3e-ade3-4204-b81b-e80b2d424b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC458A7E0>]}
[0m13:19:58.370851 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:19:58.370851 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:19:58.370851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:19:58.370851 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:19:58.386768 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:19:58.386768 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:19:58.418228 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:19:58.418228 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:19:58.418228 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        t.t_product_id

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id

)
-- optimized AS(
--     SELECT
--         r.*,
--         p.product_family,
--         p.product_sub_family
--     FROM required_fields AS r
--     FULL JOIN
--         MINI_PROJECT.RAW.stg_products p ON p.product_id = r.t_product_id
-- )
SELECT * 
FROM required_fields
  );
[0m13:19:58.418228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:19:58.885101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m13:19:58.901015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06efbe3e-ade3-4204-b81b-e80b2d424b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC2D40560>]}
[0m13:19:58.901015 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.53s]
[0m13:19:58.901015 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:19:58.901015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:58.901015 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:19:58.901015 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:19:58.998643 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:19:58.998643 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:19:59.087082 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:19:59.087082 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:19:59.164750 [info ] [MainThread]: 
[0m13:19:59.164750 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.23 seconds (2.23s).
[0m13:19:59.164750 [debug] [MainThread]: Command end result
[0m13:19:59.264064 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:19:59.265627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:19:59.272119 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:19:59.272119 [info ] [MainThread]: 
[0m13:19:59.272119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:19:59.272119 [info ] [MainThread]: 
[0m13:19:59.272119 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:19:59.272119 [debug] [MainThread]: Command `dbt run` succeeded at 13:19:59.272119 after 3.81 seconds
[0m13:19:59.272119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC163C800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC5913650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCC5910290>]}
[0m13:19:59.272119 [debug] [MainThread]: Flushing usage events
[0m13:20:00.505348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:07.760935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020906744C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020906746540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020906747680>]}


============================== 13:20:07.776678 | 0983944f-7ae2-497f-8851-6096013b7761 ==============================
[0m13:20:07.776678 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:20:07.776678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m master1', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:08.204144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0983944f-7ae2-497f-8851-6096013b7761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020907881370>]}
[0m13:20:08.267253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0983944f-7ae2-497f-8851-6096013b7761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020905CBD070>]}
[0m13:20:08.267253 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:20:08.583271 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:20:08.757899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:08.757899 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:20:08.992821 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:20:09.008795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0983944f-7ae2-497f-8851-6096013b7761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020908F15D60>]}
[0m13:20:09.071903 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:20:09.071903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:20:09.103838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0983944f-7ae2-497f-8851-6096013b7761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020908ECD9A0>]}
[0m13:20:09.103838 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:20:09.103838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0983944f-7ae2-497f-8851-6096013b7761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209089C5FA0>]}
[0m13:20:09.103838 [info ] [MainThread]: 
[0m13:20:09.103838 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:09.103838 [info ] [MainThread]: 
[0m13:20:09.103838 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:20:09.103838 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:20:09.199226 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:20:09.199226 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:20:09.199226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:09.695659 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.497 seconds
[0m13:20:09.705119 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:20:09.711643 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:20:09.711643 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:20:09.711643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:10.033325 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.322 seconds
[0m13:20:10.033325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0983944f-7ae2-497f-8851-6096013b7761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020908DD26C0>]}
[0m13:20:10.051352 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:20:10.051352 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:20:10.051352 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:20:10.051352 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:20:10.060230 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:20:10.062239 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:20:10.088758 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:20:10.090766 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:20:10.090766 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        -- t.t_product_id

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id

)
-- optimized AS(
--     SELECT
--         r.*,
--         p.product_family,
--         p.product_sub_family
--     FROM required_fields AS r
--     FULL JOIN
--         MINI_PROJECT.RAW.stg_products p ON p.product_id = r.t_product_id
-- )
SELECT * 
FROM required_fields
  );
[0m13:20:10.090766 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:20:10.554732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.462 seconds
[0m13:20:10.578242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0983944f-7ae2-497f-8851-6096013b7761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020903FE1820>]}
[0m13:20:10.578242 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.53s]
[0m13:20:10.582619 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:20:10.582619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:10.582619 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:20:10.582619 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:20:10.671188 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:20:10.671188 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:20:10.757201 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:20:10.757201 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:20:10.846833 [info ] [MainThread]: 
[0m13:20:10.846833 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m13:20:10.846833 [debug] [MainThread]: Command end result
[0m13:20:10.910860 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:20:10.926641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:20:10.932668 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:20:10.932668 [info ] [MainThread]: 
[0m13:20:10.932668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:10.932668 [info ] [MainThread]: 
[0m13:20:10.932668 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:20:10.932668 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:10.932668 after 3.33 seconds
[0m13:20:10.935854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209060D17F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209060D1280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002090687F560>]}
[0m13:20:10.935854 [debug] [MainThread]: Flushing usage events
[0m13:20:11.824372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:39.820626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022402927D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022402D12C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022402D11070>]}


============================== 13:20:39.828170 | e563b71b-f267-4cc6-a7f7-19ad56e46407 ==============================
[0m13:20:39.828170 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:20:39.828170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m master1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:20:40.251485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e563b71b-f267-4cc6-a7f7-19ad56e46407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022402D10740>]}
[0m13:20:40.314893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e563b71b-f267-4cc6-a7f7-19ad56e46407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022402882630>]}
[0m13:20:40.314893 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:20:40.621707 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:20:40.774574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:40.774574 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:20:41.014148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:20:41.027916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e563b71b-f267-4cc6-a7f7-19ad56e46407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022405005F70>]}
[0m13:20:41.091566 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:20:41.091566 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:20:41.123536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e563b71b-f267-4cc6-a7f7-19ad56e46407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022404FBDBB0>]}
[0m13:20:41.123536 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m13:20:41.123536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e563b71b-f267-4cc6-a7f7-19ad56e46407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022404EA6C60>]}
[0m13:20:41.123536 [info ] [MainThread]: 
[0m13:20:41.123536 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:20:41.123536 [info ] [MainThread]: 
[0m13:20:41.123536 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:20:41.123536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:20:41.212931 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:20:41.212931 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:20:41.212931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:42.226500 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.023 seconds
[0m13:20:42.240842 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:20:42.253071 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:20:42.253071 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:20:42.255079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:42.547742 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.308 seconds
[0m13:20:42.571929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e563b71b-f267-4cc6-a7f7-19ad56e46407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022405456870>]}
[0m13:20:42.571929 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:20:42.571929 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:20:42.571929 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:20:42.571929 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:20:42.579865 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:20:42.579865 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:20:42.611815 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:20:42.611815 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:20:42.611815 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity
        -- t.t_product_id

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id

)
-- optimized AS(
--     SELECT
--         r.*,
--         p.product_family,
--         p.product_sub_family
--     FROM required_fields AS r
--     FULL JOIN
--         MINI_PROJECT.RAW.stg_products p ON p.product_id = r.t_product_id
-- )
SELECT * 
FROM required_fields
  );
[0m13:20:42.611815 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:20:43.135530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m13:20:43.161754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e563b71b-f267-4cc6-a7f7-19ad56e46407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224021C09E0>]}
[0m13:20:43.161754 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.58s]
[0m13:20:43.162876 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:20:43.162876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:43.162876 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:20:43.162876 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:20:43.235543 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:20:43.235543 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:20:43.314025 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:20:43.317375 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:20:43.389266 [info ] [MainThread]: 
[0m13:20:43.389266 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m13:20:43.389266 [debug] [MainThread]: Command end result
[0m13:20:43.452263 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:20:43.452263 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:20:43.469635 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:20:43.469635 [info ] [MainThread]: 
[0m13:20:43.469635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:43.469635 [info ] [MainThread]: 
[0m13:20:43.469635 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:20:43.469635 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:43.469635 after 3.81 seconds
[0m13:20:43.469635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002240295B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022400ACE450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022402927D10>]}
[0m13:20:43.469635 [debug] [MainThread]: Flushing usage events
[0m13:20:44.374635 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:29:12.598491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4413E2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C444F0B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C444F0B6E0>]}


============================== 13:29:12.612533 | b7a91c74-d197-454b-9267-f14b8437e9dd ==============================
[0m13:29:12.612533 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:29:12.612533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s master1', 'send_anonymous_usage_stats': 'True'}
[0m13:29:13.113475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7a91c74-d197-454b-9267-f14b8437e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4423E27E0>]}
[0m13:29:13.161023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7a91c74-d197-454b-9267-f14b8437e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4458EF620>]}
[0m13:29:13.161023 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:29:13.629825 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:29:14.888334 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m13:29:14.888334 [debug] [MainThread]: Partial parsing: deleted file: Mini_Project://models\Intermediate\master.sql
[0m13:29:14.888334 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_customer.sql
[0m13:29:14.888334 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:29:15.134636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:29:15.150350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7a91c74-d197-454b-9267-f14b8437e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C44720FB30>]}
[0m13:29:15.218992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:29:15.233608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:29:15.249276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7a91c74-d197-454b-9267-f14b8437e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4472E9B80>]}
[0m13:29:15.249276 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:29:15.262732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7a91c74-d197-454b-9267-f14b8437e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4471ABD70>]}
[0m13:29:15.262732 [info ] [MainThread]: 
[0m13:29:15.265076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:29:15.265076 [info ] [MainThread]: 
[0m13:29:15.265076 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:29:15.265076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:29:17.896124 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:29:17.896124 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:29:17.896124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:19.460157 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.564 seconds
[0m13:29:19.468377 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:29:19.473285 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:29:19.473285 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:29:19.473285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:29:19.942248 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.464 seconds
[0m13:29:19.942248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7a91c74-d197-454b-9267-f14b8437e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4471EF9B0>]}
[0m13:29:19.942248 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:29:19.942248 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:29:19.942248 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:29:19.942248 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:29:19.960501 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:29:19.960501 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:29:19.990580 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:29:19.993577 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:29:19.994219 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id

)

SELECT * 
FROM required_fields
  );
[0m13:29:19.994219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:29:20.637425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m13:29:20.651142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7a91c74-d197-454b-9267-f14b8437e9dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4423E1790>]}
[0m13:29:20.651142 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.71s]
[0m13:29:20.651142 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:29:20.651142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:29:20.651142 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:29:20.651142 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:29:20.756393 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:29:20.756393 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:29:20.837255 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:29:20.837255 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:29:20.948980 [info ] [MainThread]: 
[0m13:29:20.948980 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.68 seconds (5.68s).
[0m13:29:20.964964 [debug] [MainThread]: Command end result
[0m13:29:21.047679 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:29:21.049962 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:29:21.056076 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:29:21.056076 [info ] [MainThread]: 
[0m13:29:21.056972 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:29:21.056972 [info ] [MainThread]: 
[0m13:29:21.056972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:29:21.056972 [debug] [MainThread]: Command `dbt run` succeeded at 13:29:21.056972 after 8.65 seconds
[0m13:29:21.056972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C44769E600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C442DDE8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C442DDE870>]}
[0m13:29:21.056972 [debug] [MainThread]: Flushing usage events
[0m13:29:22.285030 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:22.344602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0D34680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0D347A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0D34620>]}


============================== 13:35:22.360634 | 85c7431c-535b-4c34-af66-7ec1756e2a14 ==============================
[0m13:35:22.360634 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:35:22.360634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s master1', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:23.129327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85c7431c-535b-4c34-af66-7ec1756e2a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A1075D00>]}
[0m13:35:23.198295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85c7431c-535b-4c34-af66-7ec1756e2a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A2ADB3B0>]}
[0m13:35:23.200245 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:35:23.520071 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:35:23.730451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:35:23.730451 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:35:23.958934 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:35:23.984948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85c7431c-535b-4c34-af66-7ec1756e2a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A309D700>]}
[0m13:35:24.053198 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:35:24.053198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:35:24.100645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85c7431c-535b-4c34-af66-7ec1756e2a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A303D5B0>]}
[0m13:35:24.100645 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:35:24.100645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c7431c-535b-4c34-af66-7ec1756e2a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A2F609B0>]}
[0m13:35:24.100645 [info ] [MainThread]: 
[0m13:35:24.100645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:35:24.100645 [info ] [MainThread]: 
[0m13:35:24.100645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:35:24.100645 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:35:24.206204 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:35:24.206204 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:35:24.207236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:25.177581 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.974 seconds
[0m13:35:25.185513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:35:25.189300 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:35:25.189300 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:35:25.189300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:25.725451 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.538 seconds
[0m13:35:25.751094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c7431c-535b-4c34-af66-7ec1756e2a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A2E40D40>]}
[0m13:35:25.760435 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:35:25.760435 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:35:25.760435 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:35:25.761770 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:35:25.768883 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:35:25.770878 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:35:25.793166 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:35:25.793166 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:35:25.804058 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        CAST(c.customer_id AS STRING) AS customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        CAST(t.revenue AS FLOAT) AS revenue,
        CAST(t.quantity AS INT) AS quantity
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
)
SELECT * 
FROM required_fields;
[0m13:35:25.804564 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:35:26.262439 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff85-0001-429e-0008-511e0001d016
[0m13:35:26.262439 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 20 unexpected ';'.
[0m13:35:26.272313 [debug] [Thread-1 (]: Database Error in model master1 (models\Intermediate\master1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 20 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql
[0m13:35:26.272313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c7431c-535b-4c34-af66-7ec1756e2a14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A02006E0>]}
[0m13:35:26.272313 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master1 ............................... [[31mERROR[0m in 0.51s]
[0m13:35:26.272313 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:35:26.272313 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master1' to be skipped because of status 'error'.  Reason: Database Error in model master1 (models\Intermediate\master1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 20 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql.
[0m13:35:26.272313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:26.272313 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:35:26.272313 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:35:26.373254 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:35:26.382171 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:35:26.491193 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:35:26.491193 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:35:26.571617 [info ] [MainThread]: 
[0m13:35:26.573013 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m13:35:26.573013 [debug] [MainThread]: Command end result
[0m13:35:26.659449 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:35:26.661903 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:35:26.667254 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:35:26.668318 [info ] [MainThread]: 
[0m13:35:26.668318 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:35:26.668318 [info ] [MainThread]: 
[0m13:35:26.669744 [error] [MainThread]:   Database Error in model master1 (models\Intermediate\master1.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 20 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql
[0m13:35:26.669744 [info ] [MainThread]: 
[0m13:35:26.670752 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:35:26.670752 [debug] [MainThread]: Command `dbt run` failed at 13:35:26.670752 after 4.50 seconds
[0m13:35:26.671899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0201100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0565EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A2F22FC0>]}
[0m13:35:26.671899 [debug] [MainThread]: Flushing usage events
[0m13:35:28.093057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:35:51.365693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1ED999A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1ED98D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1ED9B140>]}


============================== 13:35:51.365693 | 4eba977e-53d3-4c7b-80b3-222edb14a6f3 ==============================
[0m13:35:51.365693 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:35:51.365693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s master1', 'send_anonymous_usage_stats': 'True'}
[0m13:35:51.840489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eba977e-53d3-4c7b-80b3-222edb14a6f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1FAA13A0>]}
[0m13:35:51.904235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eba977e-53d3-4c7b-80b3-222edb14a6f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1FB0C410>]}
[0m13:35:51.904235 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:35:52.223992 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:35:52.362872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:35:52.362872 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:35:52.616097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:35:52.632128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eba977e-53d3-4c7b-80b3-222edb14a6f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B21149A90>]}
[0m13:35:52.699318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:35:52.699318 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:35:52.730939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eba977e-53d3-4c7b-80b3-222edb14a6f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B210F19A0>]}
[0m13:35:52.730939 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:35:52.730939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eba977e-53d3-4c7b-80b3-222edb14a6f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B2114E060>]}
[0m13:35:52.730939 [info ] [MainThread]: 
[0m13:35:52.730939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:35:52.730939 [info ] [MainThread]: 
[0m13:35:52.730939 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:35:52.730939 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:35:52.826979 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:35:52.826979 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:35:52.828011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:53.657791 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.831 seconds
[0m13:35:53.657791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:35:53.673824 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:35:53.673824 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:35:53.673824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:53.991872 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.316 seconds
[0m13:35:53.995885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eba977e-53d3-4c7b-80b3-222edb14a6f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B20EF2480>]}
[0m13:35:53.997892 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:35:53.997892 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:35:53.997892 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:35:53.997892 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:35:54.010612 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:35:54.011668 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:35:54.041524 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:35:54.043674 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:35:54.043674 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        CAST(c.customer_id AS STRING) AS customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        CAST(t.revenue AS FLOAT) AS revenue,
        CAST(t.quantity AS INT) AS quantity
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
)
SELECT * 
FROM required_fields
  );
[0m13:35:54.044672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:35:54.610926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m13:35:54.633411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eba977e-53d3-4c7b-80b3-222edb14a6f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1C141640>]}
[0m13:35:54.633411 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.63s]
[0m13:35:54.633411 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:35:54.633411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:54.633411 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:35:54.633411 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:35:54.717587 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:35:54.717587 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:35:54.798398 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:35:54.798398 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:35:54.895200 [info ] [MainThread]: 
[0m13:35:54.895200 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m13:35:54.895200 [debug] [MainThread]: Command end result
[0m13:35:54.985867 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:35:54.988235 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:35:54.993693 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:35:54.995079 [info ] [MainThread]: 
[0m13:35:54.995079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:54.996541 [info ] [MainThread]: 
[0m13:35:54.996541 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:35:54.997887 [debug] [MainThread]: Command `dbt run` succeeded at 13:35:54.997887 after 3.79 seconds
[0m13:35:54.997887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1E9EBDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1CB3E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B1CB3E7E0>]}
[0m13:35:54.998919 [debug] [MainThread]: Flushing usage events
[0m13:35:55.867665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:44.790393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC20FB320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC06FBC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC06F9AC0>]}


============================== 13:42:44.803412 | 7c2c5cf0-a5fb-4057-b28d-057df4776ed7 ==============================
[0m13:42:44.803412 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:42:44.803412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_transaction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:42:45.576838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c2c5cf0-a5fb-4057-b28d-057df4776ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC33A5970>]}
[0m13:42:45.640017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c2c5cf0-a5fb-4057-b28d-057df4776ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC36FB290>]}
[0m13:42:45.640017 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:42:46.092787 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:42:47.564410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:42:47.564410 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m13:42:47.816257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:42:47.835966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c2c5cf0-a5fb-4057-b28d-057df4776ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4D05A30>]}
[0m13:42:47.895590 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:42:47.920098 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:42:47.958477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c2c5cf0-a5fb-4057-b28d-057df4776ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4CB5880>]}
[0m13:42:47.958477 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:42:47.958477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2c5cf0-a5fb-4057-b28d-057df4776ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4D06B70>]}
[0m13:42:47.958477 [info ] [MainThread]: 
[0m13:42:47.958477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:42:47.958477 [info ] [MainThread]: 
[0m13:42:47.958477 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:47.958477 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:42:50.637716 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:42:50.637716 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:42:50.637716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:51.681521 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.044 seconds
[0m13:42:51.683551 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:42:51.694890 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:42:51.694890 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:42:51.694890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:51.963901 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.273 seconds
[0m13:42:51.963901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c2c5cf0-a5fb-4057-b28d-057df4776ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4818410>]}
[0m13:42:51.981814 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m13:42:51.981814 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m13:42:51.981814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m13:42:51.981814 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m13:42:51.981814 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m13:42:51.981814 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m13:42:52.011778 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m13:42:52.025653 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m13:42:52.025653 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer 
        , product_id 
        , payment_month
        , revenue_type 
        , revenue
        , quantity 
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM MINI_PROJECT.RAW.TRANSACTION
    WHERE customer and product_id is not null

),

optimized AS(
    SELECT
                                                        
        CAST(customer AS INT)     AS  t_customer_id
        , product_id    AS t_product_id
        , CAST(payment_month AS DATE)  AS payment_month    
        , CAST(revenue_type AS BOOLEAN)  AS revenue_type
        , CAST(revenue AS INT) AS revenue
        , CAST(quantity AS int) AS quantity
        , dimension1 
        , dimension2
        , dimension3 
        , dimension4 
        , dimension5 
        , dimension6 
        , dimension7 
        , dimension8 
        , dimension9 
        , dimension10 
        , companies 

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m13:42:52.025653 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:42:52.522392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m13:42:52.570038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c2c5cf0-a5fb-4057-b28d-057df4776ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1E907A0>]}
[0m13:42:52.570038 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.57s]
[0m13:42:52.570038 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m13:42:52.570038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:52.570038 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:42:52.570038 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:42:52.651629 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:42:52.651629 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:42:52.728958 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m13:42:52.728958 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m13:42:52.856605 [info ] [MainThread]: 
[0m13:42:52.868323 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m13:42:52.868323 [debug] [MainThread]: Command end result
[0m13:42:52.939896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:42:52.939896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:42:52.939896 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:42:52.939896 [info ] [MainThread]: 
[0m13:42:52.939896 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:42:52.939896 [info ] [MainThread]: 
[0m13:42:52.939896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:42:52.951641 [debug] [MainThread]: Command `dbt run` succeeded at 13:42:52.951641 after 8.35 seconds
[0m13:42:52.951641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4A4A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4C20D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC4C23BF0>]}
[0m13:42:52.951641 [debug] [MainThread]: Flushing usage events
[0m13:42:54.228500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:44.388586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE06EE2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0A3F6480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE09AB3E60>]}


============================== 13:46:44.388586 | b9d8d1f3-33b0-4bc6-9f6c-b7116b7090ae ==============================
[0m13:46:44.388586 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:46:44.388586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s master1CLS', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:46:44.843572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9d8d1f3-33b0-4bc6-9f6c-b7116b7090ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0AAE4050>]}
[0m13:46:44.906761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9d8d1f3-33b0-4bc6-9f6c-b7116b7090ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0B8DC410>]}
[0m13:46:44.906761 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:46:45.221711 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:46:45.377947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:45.377947 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m13:46:45.631827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:46:45.631827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9d8d1f3-33b0-4bc6-9f6c-b7116b7090ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0C902FC0>]}
[0m13:46:45.714260 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:46:45.717494 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:46:45.740326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9d8d1f3-33b0-4bc6-9f6c-b7116b7090ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0CE717F0>]}
[0m13:46:45.740326 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:46:45.740326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9d8d1f3-33b0-4bc6-9f6c-b7116b7090ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0CECEE40>]}
[0m13:46:45.740326 [warn ] [MainThread]: The selection criterion 'master1CLS' does not match any enabled nodes
[0m13:46:45.740326 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:46:45.740326 [debug] [MainThread]: Command end result
[0m13:46:45.772030 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:46:45.773189 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:46:45.775466 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:46:45.775466 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:45.775466 after 1.55 seconds
[0m13:46:45.775466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0A411970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0A362F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AE0A8ADCD0>]}
[0m13:46:45.775466 [debug] [MainThread]: Flushing usage events
[0m13:46:47.048569 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:56.444825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB852E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB852E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB852E5A0>]}


============================== 13:47:56.462381 | 905ed97a-d8c9-4e5c-b59f-d24bc8a99e43 ==============================
[0m13:47:56.462381 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:47:56.462381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_transaction', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:56.915615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '905ed97a-d8c9-4e5c-b59f-d24bc8a99e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB8210C50>]}
[0m13:47:56.978920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '905ed97a-d8c9-4e5c-b59f-d24bc8a99e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB7B91EB0>]}
[0m13:47:56.978920 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:47:57.310150 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:47:57.465026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:47:57.465026 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:47:57.471865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:47:57.506788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '905ed97a-d8c9-4e5c-b59f-d24bc8a99e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBA46BFB0>]}
[0m13:47:57.572158 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:47:57.572158 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:47:57.604276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '905ed97a-d8c9-4e5c-b59f-d24bc8a99e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBA7A1EE0>]}
[0m13:47:57.604276 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:47:57.606286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '905ed97a-d8c9-4e5c-b59f-d24bc8a99e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBA44B020>]}
[0m13:47:57.606286 [info ] [MainThread]: 
[0m13:47:57.606286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:47:57.606286 [info ] [MainThread]: 
[0m13:47:57.606286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:47:57.606286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:47:57.699908 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:47:57.699908 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:47:57.699908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:58.672639 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.972 seconds
[0m13:47:58.678564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:47:58.689213 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:47:58.691221 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:47:58.691221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:59.609377 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.920 seconds
[0m13:47:59.616659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '905ed97a-d8c9-4e5c-b59f-d24bc8a99e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBA48B290>]}
[0m13:47:59.616659 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m13:47:59.616659 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m13:47:59.616659 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m13:47:59.616659 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m13:47:59.632446 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m13:47:59.633476 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m13:47:59.660885 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m13:47:59.660885 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m13:47:59.660885 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with raw_transations as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension_1) as dimension_1,
    trim(dimension_2) as dimension_2,
    trim(dimension_3) as dimension_3,
    trim(dimension_4) as dimension_4,
    trim(dimension_5) as dimension_5,
    trim(dimension_6) as dimension_6,
    trim(dimension_7) as dimension_7,
    trim(dimension_8) as dimension_8,
    trim(dimension_9) as dimension_9,
    trim(dimension_10) as dimension_10,
    trim(companies) as companies
   
  from raw_transations
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m13:47:59.660885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:00.242887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff91-0001-429b-0008-511e000179ea
[0m13:48:00.242887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 9
invalid identifier 'DIMENSION_1'
[0m13:48:00.264396 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier 'DIMENSION_1'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:48:00.266405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '905ed97a-d8c9-4e5c-b59f-d24bc8a99e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBAD71730>]}
[0m13:48:00.266405 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.65s]
[0m13:48:00.266405 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m13:48:00.266405 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier 'DIMENSION_1'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m13:48:00.266405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:00.266405 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:48:00.266405 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:48:00.342723 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:48:00.342723 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:48:00.445093 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m13:48:00.445093 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m13:48:00.523906 [info ] [MainThread]: 
[0m13:48:00.523906 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m13:48:00.523906 [debug] [MainThread]: Command end result
[0m13:48:00.547713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:48:00.549954 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:48:00.556313 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:48:00.556313 [info ] [MainThread]: 
[0m13:48:00.557363 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:48:00.557363 [info ] [MainThread]: 
[0m13:48:00.558362 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 17 at position 9
  invalid identifier 'DIMENSION_1'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:48:00.558362 [info ] [MainThread]: 
[0m13:48:00.559369 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:48:00.559674 [debug] [MainThread]: Command `dbt run` failed at 13:48:00.559674 after 4.26 seconds
[0m13:48:00.559674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB5D6B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB8617680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB7F94CE0>]}
[0m13:48:00.559674 [debug] [MainThread]: Flushing usage events
[0m13:48:01.461041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:44.970332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E1F91EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E1F91EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E07FE3F0>]}


============================== 13:48:44.970332 | b32954f8-02a7-48cb-a6c3-7877a09907a8 ==============================
[0m13:48:44.970332 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:48:44.970332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:48:45.411949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b32954f8-02a7-48cb-a6c3-7877a09907a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E2A61DF0>]}
[0m13:48:45.476346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b32954f8-02a7-48cb-a6c3-7877a09907a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E379BA40>]}
[0m13:48:45.477765 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:48:45.807731 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:48:45.952198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:48:45.952198 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m13:48:46.195429 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m13:48:46.214435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b32954f8-02a7-48cb-a6c3-7877a09907a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E4DA5940>]}
[0m13:48:46.271885 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:48:46.271885 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:48:46.303432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b32954f8-02a7-48cb-a6c3-7877a09907a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E4D4D7C0>]}
[0m13:48:46.303432 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:48:46.303432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b32954f8-02a7-48cb-a6c3-7877a09907a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E484BD40>]}
[0m13:48:46.303432 [info ] [MainThread]: 
[0m13:48:46.303432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:48:46.303432 [info ] [MainThread]: 
[0m13:48:46.303432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:48:46.303432 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:48:46.410570 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:48:46.411729 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:48:46.411729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:47.184074 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.774 seconds
[0m13:48:47.184074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:48:47.200190 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:48:47.200190 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:48:47.200190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:48:48.608793 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.413 seconds
[0m13:48:48.624656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b32954f8-02a7-48cb-a6c3-7877a09907a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E4C02E10>]}
[0m13:48:48.642188 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m13:48:48.642188 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m13:48:48.642188 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m13:48:48.642188 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m13:48:48.642188 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m13:48:48.656573 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m13:48:48.677234 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m13:48:48.677234 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m13:48:48.677234 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with raw_transations as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from raw_transations
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m13:48:48.677234 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:48:49.243050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m13:48:49.269570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32954f8-02a7-48cb-a6c3-7877a09907a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253DFE117C0>]}
[0m13:48:49.269570 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.62s]
[0m13:48:49.269570 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m13:48:49.269570 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:48:49.269570 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:48:49.269570 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:48:49.357207 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:48:49.358222 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:48:49.448859 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m13:48:49.448859 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m13:48:49.517901 [info ] [MainThread]: 
[0m13:48:49.533953 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m13:48:49.533953 [debug] [MainThread]: Command end result
[0m13:48:49.629180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:48:49.631631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:48:49.637123 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:48:49.637123 [info ] [MainThread]: 
[0m13:48:49.638456 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:48:49.638456 [info ] [MainThread]: 
[0m13:48:49.639521 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:48:49.639521 [debug] [MainThread]: Command `dbt run` succeeded at 13:48:49.639521 after 4.83 seconds
[0m13:48:49.640555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E263F080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E1B19F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E1EBDC40>]}
[0m13:48:49.640555 [debug] [MainThread]: Flushing usage events
[0m13:48:51.124954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:39.797769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020258907680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202584C7A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020257E4E540>]}


============================== 13:50:39.810359 | 24928e4b-5c03-4be2-8382-61ece059667c ==============================
[0m13:50:39.810359 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:50:39.810359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s master1', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:50:40.251686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24928e4b-5c03-4be2-8382-61ece059667c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020256162630>]}
[0m13:50:40.314857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24928e4b-5c03-4be2-8382-61ece059667c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020259B8E600>]}
[0m13:50:40.314857 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:50:40.654382 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:50:40.812989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:50:40.812989 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:50:41.060772 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m13:50:41.079936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24928e4b-5c03-4be2-8382-61ece059667c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020259B5D220>]}
[0m13:50:41.150425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:50:41.152730 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:50:41.172412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24928e4b-5c03-4be2-8382-61ece059667c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025B0F1610>]}
[0m13:50:41.172412 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:50:41.182409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24928e4b-5c03-4be2-8382-61ece059667c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025B14EE40>]}
[0m13:50:41.184180 [info ] [MainThread]: 
[0m13:50:41.184180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:50:41.184180 [info ] [MainThread]: 
[0m13:50:41.184180 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:50:41.184180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:50:41.274651 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:50:41.275683 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:50:41.275683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:42.128358 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.862 seconds
[0m13:50:42.144178 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:50:42.149462 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:50:42.149462 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:50:42.149462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:42.479115 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.329 seconds
[0m13:50:42.479115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24928e4b-5c03-4be2-8382-61ece059667c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025B4CE1B0>]}
[0m13:50:42.491003 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:50:42.491003 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:50:42.492245 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:50:42.492245 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:50:42.500190 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:50:42.501191 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:50:42.529064 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:50:42.531073 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:50:42.531073 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        CAST(c.customer_id AS INT) AS customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        CAST(t.revenue AS FLOAT) AS revenue,
        CAST(t.quantity AS INT) AS quantity
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.t_customer_id = c.customer_id
)
SELECT * 
FROM required_fields
  );
[0m13:50:42.531073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:50:43.086145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff94-0001-429a-0008-511e0001b992
[0m13:50:43.086145 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 46
invalid identifier 'T.T_CUSTOMER_ID'
[0m13:50:43.086145 [debug] [Thread-1 (]: Database Error in model master1 (models\Intermediate\master1.sql)
  000904 (42000): SQL compilation error: error line 15 at position 46
  invalid identifier 'T.T_CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql
[0m13:50:43.086145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24928e4b-5c03-4be2-8382-61ece059667c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025B6E3DA0>]}
[0m13:50:43.086145 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.master1 ............................... [[31mERROR[0m in 0.59s]
[0m13:50:43.086145 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:50:43.086145 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.master1' to be skipped because of status 'error'.  Reason: Database Error in model master1 (models\Intermediate\master1.sql)
  000904 (42000): SQL compilation error: error line 15 at position 46
  invalid identifier 'T.T_CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql.
[0m13:50:43.101857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:50:43.101857 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:50:43.101857 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:50:43.186334 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:50:43.186334 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:50:43.270702 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:50:43.284725 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:50:43.365083 [info ] [MainThread]: 
[0m13:50:43.365083 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m13:50:43.365083 [debug] [MainThread]: Command end result
[0m13:50:43.465887 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:50:43.469019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:50:43.472409 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:50:43.472409 [info ] [MainThread]: 
[0m13:50:43.472409 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:50:43.472409 [info ] [MainThread]: 
[0m13:50:43.472409 [error] [MainThread]:   Database Error in model master1 (models\Intermediate\master1.sql)
  000904 (42000): SQL compilation error: error line 15 at position 46
  invalid identifier 'T.T_CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Intermediate\master1.sql
[0m13:50:43.472409 [info ] [MainThread]: 
[0m13:50:43.472409 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:50:43.472409 [debug] [MainThread]: Command `dbt run` failed at 13:50:43.472409 after 3.85 seconds
[0m13:50:43.472409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020256B5E540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020256B5D2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020256B5E3F0>]}
[0m13:50:43.472409 [debug] [MainThread]: Flushing usage events
[0m13:50:44.360620 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:20.457696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A1A67AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F3A78F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A1A67B00>]}


============================== 13:51:20.457696 | 70baba20-0838-4448-9d60-60cde26ce8bb ==============================
[0m13:51:20.457696 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:51:20.457696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s master1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:51:20.890381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70baba20-0838-4448-9d60-60cde26ce8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A2A1E990>]}
[0m13:51:20.939888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70baba20-0838-4448-9d60-60cde26ce8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A181DCA0>]}
[0m13:51:20.939888 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:51:21.266195 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:51:21.408752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:51:21.408752 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:51:21.664060 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m13:51:21.675815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70baba20-0838-4448-9d60-60cde26ce8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A3C7D220>]}
[0m13:51:21.743769 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:51:21.743769 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:51:21.778368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70baba20-0838-4448-9d60-60cde26ce8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A41B5760>]}
[0m13:51:21.778368 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:51:21.778368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70baba20-0838-4448-9d60-60cde26ce8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A41ED1F0>]}
[0m13:51:21.778368 [info ] [MainThread]: 
[0m13:51:21.781539 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:51:21.781539 [info ] [MainThread]: 
[0m13:51:21.781539 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:51:21.784146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:51:21.874603 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:51:21.874603 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:51:21.874603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:23.091623 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.221 seconds
[0m13:51:23.105209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:51:23.107485 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:51:23.107485 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:51:23.107485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:23.543570 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.430 seconds
[0m13:51:23.551508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70baba20-0838-4448-9d60-60cde26ce8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F35B470>]}
[0m13:51:23.559243 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m13:51:23.559243 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m13:51:23.559243 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m13:51:23.559243 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m13:51:23.568707 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m13:51:23.569705 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m13:51:23.599664 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m13:51:23.599664 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m13:51:23.599664 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        CAST(c.customer_id AS INT) AS customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        CAST(t.revenue AS FLOAT) AS revenue,
        CAST(t.quantity AS INT) AS quantity
    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
)
SELECT * 
FROM required_fields
  );
[0m13:51:23.599664 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:24.056581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m13:51:24.080413 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70baba20-0838-4448-9d60-60cde26ce8bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F2C15B0>]}
[0m13:51:24.080413 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.51s]
[0m13:51:24.081455 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m13:51:24.083523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:24.083523 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:51:24.083523 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:51:24.169816 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:51:24.169816 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:51:24.245372 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m13:51:24.245372 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m13:51:24.342366 [info ] [MainThread]: 
[0m13:51:24.358521 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m13:51:24.358521 [debug] [MainThread]: Command end result
[0m13:51:24.449992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:51:24.452701 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:51:24.458144 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:51:24.458144 [info ] [MainThread]: 
[0m13:51:24.459571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:24.460635 [info ] [MainThread]: 
[0m13:51:24.460635 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:51:24.461632 [debug] [MainThread]: Command `dbt run` succeeded at 13:51:24.461632 after 4.16 seconds
[0m13:51:24.462878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A15FF1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A40B5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5A40B4050>]}
[0m13:51:24.462878 [debug] [MainThread]: Flushing usage events
[0m13:51:25.731383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:00.818800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA2BFABA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA2BFA960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA2BFBA10>]}


============================== 13:57:00.818800 | b86c6092-01db-4942-b5bc-0873d7f7b139 ==============================
[0m13:57:00.818800 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:57:00.818800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_transaction', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:57:01.337734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b86c6092-01db-4942-b5bc-0873d7f7b139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA2BFABA0>]}
[0m13:57:01.391197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b86c6092-01db-4942-b5bc-0873d7f7b139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA4263EC0>]}
[0m13:57:01.401119 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:57:01.838590 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:57:03.126865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:57:03.126865 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m13:57:03.136709 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m13:57:03.378815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:57:03.400060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b86c6092-01db-4942-b5bc-0873d7f7b139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA5944560>]}
[0m13:57:03.468139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:57:03.483980 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:57:03.500067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b86c6092-01db-4942-b5bc-0873d7f7b139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA59FDB50>]}
[0m13:57:03.500067 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:57:03.500067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b86c6092-01db-4942-b5bc-0873d7f7b139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA5549B20>]}
[0m13:57:03.500067 [info ] [MainThread]: 
[0m13:57:03.500067 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:03.500067 [info ] [MainThread]: 
[0m13:57:03.500067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:57:03.515826 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:57:06.046487 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:57:06.051614 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:57:06.051614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:07.437429 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.396 seconds
[0m13:57:07.453300 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:57:07.470018 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:57:07.470018 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:57:07.470018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:07.893082 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.422 seconds
[0m13:57:07.897112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b86c6092-01db-4942-b5bc-0873d7f7b139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA556B290>]}
[0m13:57:07.897112 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m13:57:07.897112 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m13:57:07.897112 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m13:57:07.897112 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m13:57:07.912320 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m13:57:07.914161 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m13:57:07.943302 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m13:57:07.944300 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m13:57:07.945669 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fileds AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
optimized AS (
  select DISTINCT
    customer AS customer_id,
    product_id AS product_id,
    CAST(payment_month AS DATE) AS payment_month,
    CAST(revenue_type AS BOOLEAN) AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from optimized
  );
[0m13:57:07.945669 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:57:08.389090 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff9b-0001-429a-0008-511e0001b9b6
[0m13:57:08.390598 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
[0m13:57:08.402290 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:57:08.406513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b86c6092-01db-4942-b5bc-0873d7f7b139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA2C10AD0>]}
[0m13:57:08.406513 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.51s]
[0m13:57:08.408174 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m13:57:08.408174 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m13:57:08.408174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:08.408174 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:57:08.408174 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:57:08.490600 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:57:08.490600 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:57:08.575355 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m13:57:08.575355 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m13:57:08.670423 [info ] [MainThread]: 
[0m13:57:08.670423 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m13:57:08.670423 [debug] [MainThread]: Command end result
[0m13:57:08.766556 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:57:08.768725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:57:08.774746 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:57:08.774746 [info ] [MainThread]: 
[0m13:57:08.775738 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:57:08.776431 [info ] [MainThread]: 
[0m13:57:08.777032 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:57:08.777748 [info ] [MainThread]: 
[0m13:57:08.778344 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:57:08.778984 [debug] [MainThread]: Command `dbt run` failed at 13:57:08.778984 after 8.28 seconds
[0m13:57:08.778984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA58BE390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA58BCFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA58BD850>]}
[0m13:57:08.780019 [debug] [MainThread]: Flushing usage events
[0m13:57:10.019858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:55.488535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001957481B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001957481A510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019574819070>]}


============================== 13:57:55.488535 | ace54269-2b44-4f5e-878d-9dea665c76ea ==============================
[0m13:57:55.488535 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:57:55.488535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_transaction', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:57:55.918137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ace54269-2b44-4f5e-878d-9dea665c76ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019571BE28D0>]}
[0m13:57:55.981545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ace54269-2b44-4f5e-878d-9dea665c76ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019575476630>]}
[0m13:57:55.989140 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:57:56.295985 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:57:56.455003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:56.455003 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m13:57:56.698117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m13:57:56.712536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ace54269-2b44-4f5e-878d-9dea665c76ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019576B69CD0>]}
[0m13:57:56.782061 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:57:56.785052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:57:56.804867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ace54269-2b44-4f5e-878d-9dea665c76ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019576B11AC0>]}
[0m13:57:56.804867 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:57:56.804867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace54269-2b44-4f5e-878d-9dea665c76ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195768A9A00>]}
[0m13:57:56.804867 [info ] [MainThread]: 
[0m13:57:56.814479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:57:56.814479 [info ] [MainThread]: 
[0m13:57:56.814479 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:57:56.814479 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:57:56.905220 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:57:56.905220 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:57:56.906270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:57.700227 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.797 seconds
[0m13:57:57.710418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:57:57.719396 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:57:57.720393 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:57:57.720393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:58.273102 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.560 seconds
[0m13:57:58.273102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace54269-2b44-4f5e-878d-9dea665c76ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019576EEE480>]}
[0m13:57:58.290576 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m13:57:58.290576 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m13:57:58.291520 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m13:57:58.291520 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m13:57:58.297534 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m13:57:58.297534 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m13:57:58.323237 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m13:57:58.323237 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m13:57:58.323237 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fileds AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer_id is not null
),
 
optimized AS (
  select DISTINCT
    customer AS customer_id,
    product_id AS product_id,
    CAST(payment_month AS DATE) AS payment_month,
    CAST(revenue_type AS BOOLEAN) AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m13:57:58.323237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:57:58.632232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff9b-0001-429e-0008-511e0001d186
[0m13:57:58.632232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
[0m13:57:58.648297 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:57:58.648297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ace54269-2b44-4f5e-878d-9dea665c76ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019573CE06E0>]}
[0m13:57:58.648297 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.36s]
[0m13:57:58.648297 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m13:57:58.648297 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m13:57:58.648297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:58.648297 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:57:58.648297 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:57:58.757959 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:57:58.757959 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:57:58.854499 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m13:57:58.854499 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m13:57:58.934664 [info ] [MainThread]: 
[0m13:57:58.945367 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m13:57:58.945367 [debug] [MainThread]: Command end result
[0m13:57:59.031800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:57:59.033126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:57:59.039715 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:57:59.039715 [info ] [MainThread]: 
[0m13:57:59.040991 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:57:59.040991 [info ] [MainThread]: 
[0m13:57:59.042115 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:57:59.043238 [info ] [MainThread]: 
[0m13:57:59.043238 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:57:59.044291 [debug] [MainThread]: Command `dbt run` failed at 13:57:59.044291 after 3.72 seconds
[0m13:57:59.045329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001957528B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195742A4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195769F0B00>]}
[0m13:57:59.045329 [debug] [MainThread]: Flushing usage events
[0m13:57:59.987726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:41.323173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AB6C79E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AB6C7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AB6C7B60>]}


============================== 13:59:41.323173 | 9a6e745d-f5e9-49ef-b55a-4ec1be55ad10 ==============================
[0m13:59:41.323173 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:59:41.323173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_transaction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:41.742519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a6e745d-f5e9-49ef-b55a-4ec1be55ad10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AC8BDF40>]}
[0m13:59:41.810064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a6e745d-f5e9-49ef-b55a-4ec1be55ad10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AC88C260>]}
[0m13:59:41.810064 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:59:42.131463 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:59:42.287906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:42.287906 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m13:59:42.532228 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m13:59:42.546984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a6e745d-f5e9-49ef-b55a-4ec1be55ad10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AD9A6DE0>]}
[0m13:59:42.622433 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:59:42.627358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:59:42.658736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a6e745d-f5e9-49ef-b55a-4ec1be55ad10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185ADE25790>]}
[0m13:59:42.659734 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m13:59:42.663731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a6e745d-f5e9-49ef-b55a-4ec1be55ad10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185ADE660C0>]}
[0m13:59:42.664727 [info ] [MainThread]: 
[0m13:59:42.665728 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:42.666825 [info ] [MainThread]: 
[0m13:59:42.666825 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:42.668092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m13:59:42.764062 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m13:59:42.764062 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m13:59:42.764062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:43.731923 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.973 seconds
[0m13:59:43.744327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m13:59:43.747658 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m13:59:43.747658 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m13:59:43.747658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:44.139444 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.396 seconds
[0m13:59:44.155288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a6e745d-f5e9-49ef-b55a-4ec1be55ad10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AE311C10>]}
[0m13:59:44.155288 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m13:59:44.155288 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m13:59:44.155288 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m13:59:44.155288 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m13:59:44.171363 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m13:59:44.171363 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m13:59:44.196816 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m13:59:44.196816 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m13:59:44.196816 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fileds AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer_id is not null
),
 
optimized AS (
  select 
    DISTINCT customer AS customer_id,
    product_id AS product_id,
    CAST(payment_month AS DATE) AS payment_month,
    CAST(revenue_type AS BOOLEAN) AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m13:59:44.210761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:44.642765 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff9d-0001-429e-0008-511e0001d18e
[0m13:59:44.642765 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
[0m13:59:44.642765 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:59:44.650336 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a6e745d-f5e9-49ef-b55a-4ec1be55ad10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AB030C20>]}
[0m13:59:44.650336 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.49s]
[0m13:59:44.652344 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m13:59:44.652344 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m13:59:44.654085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:44.654085 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m13:59:44.654085 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m13:59:44.746441 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m13:59:44.746441 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m13:59:44.832650 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m13:59:44.832650 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m13:59:44.904632 [info ] [MainThread]: 
[0m13:59:44.904632 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m13:59:44.904632 [debug] [MainThread]: Command end result
[0m13:59:44.995197 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m13:59:44.998133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m13:59:45.003722 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m13:59:45.003722 [info ] [MainThread]: 
[0m13:59:45.004751 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:59:45.005453 [info ] [MainThread]: 
[0m13:59:45.006058 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m13:59:45.006769 [info ] [MainThread]: 
[0m13:59:45.007362 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:59:45.007995 [debug] [MainThread]: Command `dbt run` failed at 13:59:45.007995 after 3.85 seconds
[0m13:59:45.007995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AAF5FAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185AAF5D1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185ADCD32C0>]}
[0m13:59:45.009031 [debug] [MainThread]: Flushing usage events
[0m13:59:46.241889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:12.132228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818B32750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81C7A6C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81C7A63C0>]}


============================== 14:00:12.147939 | ee5285ab-3033-40ef-9d68-b2f3c1731edd ==============================
[0m14:00:12.147939 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:00:12.148703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_transaction', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:00:12.561097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee5285ab-3033-40ef-9d68-b2f3c1731edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81D4492E0>]}
[0m14:00:12.623467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee5285ab-3033-40ef-9d68-b2f3c1731edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81D3C6210>]}
[0m14:00:12.623467 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:00:12.945442 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:00:13.089152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:13.089152 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:00:13.321759 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:00:13.337444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee5285ab-3033-40ef-9d68-b2f3c1731edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E918B00>]}
[0m14:00:13.416626 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:00:13.419797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:00:13.445377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee5285ab-3033-40ef-9d68-b2f3c1731edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81EA61A00>]}
[0m14:00:13.445377 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:00:13.445377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee5285ab-3033-40ef-9d68-b2f3c1731edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E8381D0>]}
[0m14:00:13.445377 [info ] [MainThread]: 
[0m14:00:13.450047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:13.450047 [info ] [MainThread]: 
[0m14:00:13.450047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:00:13.450047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:00:13.539991 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:00:13.541033 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:00:13.541033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:14.821075 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.282 seconds
[0m14:00:14.832594 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:00:14.842620 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:00:14.842620 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:00:14.842620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:15.288939 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.444 seconds
[0m14:00:15.293587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee5285ab-3033-40ef-9d68-b2f3c1731edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E97C8F0>]}
[0m14:00:15.293587 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:00:15.293587 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:00:15.293587 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:00:15.293587 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:00:15.293587 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:00:15.293587 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:00:15.336710 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:00:15.338717 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:00:15.338717 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer_id is not null
),
 
optimized AS (
  select 
    DISTINCT customer AS customer_id,
    product_id AS product_id,
    CAST(payment_month AS DATE) AS payment_month,
    CAST(revenue_type AS BOOLEAN) AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m14:00:15.338717 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:15.665015 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff9e-0001-429e-0008-511e0001d196
[0m14:00:15.665015 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 10
invalid identifier 'CUSTOMER_ID'
[0m14:00:15.671644 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m14:00:15.671644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5285ab-3033-40ef-9d68-b2f3c1731edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81F0A4830>]}
[0m14:00:15.671644 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.38s]
[0m14:00:15.671644 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:00:15.675869 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m14:00:15.677376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:15.677376 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:00:15.677376 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:00:15.760900 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:00:15.760900 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:00:15.839562 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:00:15.839562 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:00:15.909071 [info ] [MainThread]: 
[0m14:00:15.925010 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m14:00:15.925010 [debug] [MainThread]: Command end result
[0m14:00:15.995487 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:00:15.995487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:00:15.995487 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:00:15.995487 [info ] [MainThread]: 
[0m14:00:15.995487 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:00:16.010591 [info ] [MainThread]: 
[0m14:00:16.011812 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m14:00:16.011812 [info ] [MainThread]: 
[0m14:00:16.013057 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:00:16.013696 [debug] [MainThread]: Command `dbt run` failed at 14:00:16.013696 after 4.03 seconds
[0m14:00:16.013696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81B76D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F818B32750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F81E940950>]}
[0m14:00:16.014726 [debug] [MainThread]: Flushing usage events
[0m14:00:16.954627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:00:59.974211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726FF18470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726F7AA570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726FF18170>]}


============================== 14:00:59.974211 | 4c8a7089-0e31-45c3-9906-8ed5262c30ad ==============================
[0m14:00:59.974211 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:00:59.974211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m14:01:00.402290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c8a7089-0e31-45c3-9906-8ed5262c30ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726FEF77D0>]}
[0m14:01:00.472822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c8a7089-0e31-45c3-9906-8ed5262c30ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726D688470>]}
[0m14:01:00.474358 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:01:00.784845 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:01:00.919001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:00.919001 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:01:01.164192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:01:01.186685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c8a7089-0e31-45c3-9906-8ed5262c30ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272722B9D00>]}
[0m14:01:01.256479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:01:01.256479 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:01:01.275555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c8a7089-0e31-45c3-9906-8ed5262c30ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272722619A0>]}
[0m14:01:01.275555 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:01:01.275555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8a7089-0e31-45c3-9906-8ed5262c30ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027272298EC0>]}
[0m14:01:01.288063 [info ] [MainThread]: 
[0m14:01:01.288063 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:01.288063 [info ] [MainThread]: 
[0m14:01:01.288063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:01:01.288063 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:01:01.377765 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:01:01.378799 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:01:01.378799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:02.466300 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.087 seconds
[0m14:01:02.473062 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:01:02.484708 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:01:02.484708 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:01:02.484708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:02.817464 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.333 seconds
[0m14:01:02.817464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c8a7089-0e31-45c3-9906-8ed5262c30ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727215C8F0>]}
[0m14:01:02.817464 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:01:02.817464 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:01:02.817464 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:01:02.817464 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:01:02.839364 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:01:02.839364 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:01:02.859162 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:01:02.859162 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:01:02.859162 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer_id and product_id is not null
),
 
optimized AS (
  select 
    customer AS customer_id,
    product_id AS product_id,
    CAST(payment_month AS DATE) AS payment_month,
    CAST(revenue_type AS BOOLEAN) AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m14:01:02.873334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:01:03.318164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff9f-0001-429a-0008-511e0001b9de
[0m14:01:03.318164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 10
invalid identifier 'CUSTOMER_ID'
[0m14:01:03.318164 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m14:01:03.318164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c8a7089-0e31-45c3-9906-8ed5262c30ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726F3E0A10>]}
[0m14:01:03.318164 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.50s]
[0m14:01:03.333861 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:01:03.333861 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m14:01:03.333861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:03.333861 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:01:03.333861 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:01:03.409300 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:01:03.409300 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:01:03.491368 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:01:03.491368 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:01:03.586555 [info ] [MainThread]: 
[0m14:01:03.586555 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m14:01:03.591546 [debug] [MainThread]: Command end result
[0m14:01:03.659603 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:01:03.659603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:01:03.676980 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:01:03.676980 [info ] [MainThread]: 
[0m14:01:03.677773 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:01:03.678558 [info ] [MainThread]: 
[0m14:01:03.679196 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  000904 (42000): SQL compilation error: error line 7 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m14:01:03.679942 [info ] [MainThread]: 
[0m14:01:03.680573 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:01:03.681246 [debug] [MainThread]: Command `dbt run` failed at 14:01:03.681246 after 3.87 seconds
[0m14:01:03.681246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726DBF7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002726DBF7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727211EF30>]}
[0m14:01:03.682276 [debug] [MainThread]: Flushing usage events
[0m14:01:04.936769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:27.951051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048C1C8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048C1CBE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048C1CA3C0>]}


============================== 14:01:27.965922 | 3f45e9af-4d89-48b8-b327-c9c3566dd538 ==============================
[0m14:01:27.965922 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:01:27.965922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_transaction', 'send_anonymous_usage_stats': 'True'}
[0m14:01:28.398801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f45e9af-4d89-48b8-b327-c9c3566dd538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048CE8C4D0>]}
[0m14:01:28.466291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f45e9af-4d89-48b8-b327-c9c3566dd538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048CDD4F80>]}
[0m14:01:28.466291 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:01:28.788767 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:01:28.932284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:28.932284 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:01:29.174479 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:01:29.190272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f45e9af-4d89-48b8-b327-c9c3566dd538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048CF0D8B0>]}
[0m14:01:29.267502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:01:29.268587 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:01:29.284232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f45e9af-4d89-48b8-b327-c9c3566dd538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048E475EB0>]}
[0m14:01:29.284232 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:01:29.284232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f45e9af-4d89-48b8-b327-c9c3566dd538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048E4B6810>]}
[0m14:01:29.284232 [info ] [MainThread]: 
[0m14:01:29.284232 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:01:29.300164 [info ] [MainThread]: 
[0m14:01:29.300164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:01:29.300164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:01:29.388289 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:01:29.389325 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:01:29.389325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:30.259122 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.876 seconds
[0m14:01:30.274824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:01:30.278819 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:01:30.278819 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:01:30.278819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:30.714154 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.441 seconds
[0m14:01:30.730221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f45e9af-4d89-48b8-b327-c9c3566dd538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048E963A70>]}
[0m14:01:30.730221 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:01:30.730221 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:01:30.730221 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:01:30.730221 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:01:30.746117 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:01:30.748125 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:01:30.770126 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:01:30.780537 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:01:30.780537 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer and product_id is not null
),
 
optimized AS (
  select 
    customer AS customer_id,
    product_id AS product_id,
    CAST(payment_month AS DATE) AS payment_month,
    CAST(revenue_type AS BOOLEAN) AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m14:01:30.780537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:01:31.445913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m14:01:31.471255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f45e9af-4d89-48b8-b327-c9c3566dd538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048B680590>]}
[0m14:01:31.471255 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.74s]
[0m14:01:31.471255 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:01:31.471255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:31.471255 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:01:31.471255 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:01:31.553753 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:01:31.565170 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:01:31.643593 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:01:31.643593 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:01:31.746833 [info ] [MainThread]: 
[0m14:01:31.746833 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m14:01:31.746833 [debug] [MainThread]: Command end result
[0m14:01:31.832423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:01:31.834945 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:01:31.840885 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:01:31.841974 [info ] [MainThread]: 
[0m14:01:31.841974 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:01:31.851151 [info ] [MainThread]: 
[0m14:01:31.852548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:01:31.853749 [debug] [MainThread]: Command `dbt run` succeeded at 14:01:31.852548 after 4.06 seconds
[0m14:01:31.853749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020489DE89E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048E4C7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002048CDD7F50>]}
[0m14:01:31.853749 [debug] [MainThread]: Flushing usage events
[0m14:01:32.735928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:02.489731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F03914EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F03308920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F03914710>]}


============================== 14:03:02.494439 | c376fdc8-4162-4926-84be-e38eff014b14 ==============================
[0m14:03:02.494439 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:03:02.494439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s master1', 'send_anonymous_usage_stats': 'True'}
[0m14:03:02.912183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c376fdc8-4162-4926-84be-e38eff014b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F03914590>]}
[0m14:03:02.975259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c376fdc8-4162-4926-84be-e38eff014b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F045C4B90>]}
[0m14:03:02.975259 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:03:03.287393 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:03:03.429402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:03:03.429402 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Intermediate\master1.sql
[0m14:03:03.681452 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:03:03.693818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c376fdc8-4162-4926-84be-e38eff014b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F03BF5220>]}
[0m14:03:03.763168 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:03:03.766288 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:03:03.791208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c376fdc8-4162-4926-84be-e38eff014b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F05BE1790>]}
[0m14:03:03.791208 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:03:03.791208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c376fdc8-4162-4926-84be-e38eff014b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F045FB140>]}
[0m14:03:03.795651 [info ] [MainThread]: 
[0m14:03:03.795651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:03.795651 [info ] [MainThread]: 
[0m14:03:03.795651 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:03:03.795651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:03:03.886240 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:03:03.886240 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:03:03.887272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:04.841971 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.967 seconds
[0m14:03:04.861942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:03:04.861942 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:03:04.861942 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:03:04.861942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:05.331359 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.461 seconds
[0m14:03:05.340689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c376fdc8-4162-4926-84be-e38eff014b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F04626900>]}
[0m14:03:05.347193 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m14:03:05.347193 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m14:03:05.347193 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m14:03:05.349202 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m14:03:05.351210 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m14:03:05.351210 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m14:03:05.381364 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m14:03:05.381364 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m14:03:05.381364 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m14:03:05.381364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:03:06.135494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m14:03:06.167175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c376fdc8-4162-4926-84be-e38eff014b14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F02DE0B00>]}
[0m14:03:06.167175 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.80s]
[0m14:03:06.167175 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m14:03:06.167175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:06.167175 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:03:06.167175 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:03:06.258069 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:03:06.258069 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:03:06.345811 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m14:03:06.345811 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m14:03:06.442121 [info ] [MainThread]: 
[0m14:03:06.443870 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m14:03:06.449033 [debug] [MainThread]: Command end result
[0m14:03:06.534422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:03:06.536856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:03:06.543144 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:03:06.543144 [info ] [MainThread]: 
[0m14:03:06.544231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:06.544944 [info ] [MainThread]: 
[0m14:03:06.546239 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:03:06.547197 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:06.547197 after 4.22 seconds
[0m14:03:06.547197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F045F94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F03023260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F05BC3FE0>]}
[0m14:03:06.548304 [debug] [MainThread]: Flushing usage events
[0m14:03:07.416636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:44.008818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935BF14590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935BF14410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935BF14350>]}


============================== 14:04:44.011992 | b99289fa-5319-4a41-ae78-d7a1839c6eaa ==============================
[0m14:04:44.011992 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:04:44.011992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s churn', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:44.453855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b99289fa-5319-4a41-ae78-d7a1839c6eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293592F2600>]}
[0m14:04:44.516641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b99289fa-5319-4a41-ae78-d7a1839c6eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935CB36270>]}
[0m14:04:44.517672 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:04:44.817576 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:04:44.975616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:44.975616 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:04:45.204928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:04:45.227284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b99289fa-5319-4a41-ae78-d7a1839c6eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935CBED220>]}
[0m14:04:45.280716 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:04:45.295911 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:04:45.322614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b99289fa-5319-4a41-ae78-d7a1839c6eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935E1C5760>]}
[0m14:04:45.322614 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:04:45.322614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b99289fa-5319-4a41-ae78-d7a1839c6eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935CA8DD90>]}
[0m14:04:45.322614 [info ] [MainThread]: 
[0m14:04:45.326898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:04:45.326898 [info ] [MainThread]: 
[0m14:04:45.326898 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:45.326898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:04:45.418808 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:04:45.419840 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:04:45.419840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:46.371366 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.955 seconds
[0m14:04:46.371366 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:04:46.387059 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:04:46.387059 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:04:46.387059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:46.847317 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.456 seconds
[0m14:04:46.847317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b99289fa-5319-4a41-ae78-d7a1839c6eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935DFD0680>]}
[0m14:04:46.857479 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:04:46.857479 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:04:46.857479 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:04:46.857479 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:04:46.857479 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:04:46.857479 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:04:46.900206 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:04:46.902548 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:04:46.903543 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_transaction
    GROUP BY
        customer_id
),
ChurnedCustomers AS (
    SELECT
        c.customer_id,
        c.customer_name,
        lt.last_transaction_date
    FROM
        MINI_PROJECT.RAW.stg_customers c
    LEFT JOIN
        LastTransaction lt ON c.customer_id = lt.customer_id
    WHERE
        lt.last_transaction_date IS NOT NULL
        AND lt.last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
)
SELECT
    cc.customer_id,
    cc.customer_name,
    cc.last_transaction_date,
    DATEDIFF(month, cc.last_transaction_date, CURRENT_DATE()) AS months_since_last_transaction
FROM
    ChurnedCustomers cc
ORDER BY
    cc.last_transaction_date
  );
[0m14:04:46.903543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:47.649537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m14:04:47.683445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b99289fa-5319-4a41-ae78-d7a1839c6eaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935B3E09B0>]}
[0m14:04:47.683445 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.82s]
[0m14:04:47.685453 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:04:47.685453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:47.685453 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:04:47.685453 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:04:47.766865 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:04:47.766865 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:04:47.861423 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:04:47.861423 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:04:47.940205 [info ] [MainThread]: 
[0m14:04:47.947848 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m14:04:47.947848 [debug] [MainThread]: Command end result
[0m14:04:48.028333 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:04:48.030839 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:04:48.037074 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:04:48.037074 [info ] [MainThread]: 
[0m14:04:48.038313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:04:48.038313 [info ] [MainThread]: 
[0m14:04:48.039737 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:04:48.040340 [debug] [MainThread]: Command `dbt run` succeeded at 14:04:48.040340 after 4.20 seconds
[0m14:04:48.040340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935E1F91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935E0FB950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002935E212DB0>]}
[0m14:04:48.041372 [debug] [MainThread]: Flushing usage events
[0m14:04:48.951758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:57.406885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54CA0E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54E02E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54C2617C0>]}


============================== 14:06:57.406885 | 913eee9a-e570-4cda-b110-f77afedcb595 ==============================
[0m14:06:57.406885 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:06:57.406885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:57.837220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '913eee9a-e570-4cda-b110-f77afedcb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54F6778F0>]}
[0m14:06:57.894914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '913eee9a-e570-4cda-b110-f77afedcb595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54F80DE20>]}
[0m14:06:57.894914 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:06:58.202142 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:06:58.365574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:58.366606 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:06:58.553658 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Mini_Project.churn' (models\Mart\churn.sql) depends on a node named 'stg_master1' which was not found
[0m14:06:58.556636 [debug] [MainThread]: Command `dbt run` failed at 14:06:58.556636 after 1.31 seconds
[0m14:06:58.556636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54E02E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54E0BFCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B54E192570>]}
[0m14:06:58.556636 [debug] [MainThread]: Flushing usage events
[0m14:06:59.998223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:13.902608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8EB74050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8EB74E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8EB750D0>]}


============================== 14:07:13.918478 | 830be247-f72c-4328-a152-f207aa0edc9e ==============================
[0m14:07:13.918478 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:07:13.918478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn\\', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:14.359405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '830be247-f72c-4328-a152-f207aa0edc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8F8148C0>]}
[0m14:07:14.406708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '830be247-f72c-4328-a152-f207aa0edc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8E6E7770>]}
[0m14:07:14.406708 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:07:14.734500 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:07:14.875049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:14.875049 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:07:15.112408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:07:15.135856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '830be247-f72c-4328-a152-f207aa0edc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F90D524B0>]}
[0m14:07:15.207033 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:15.210584 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:15.230107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '830be247-f72c-4328-a152-f207aa0edc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F90E25820>]}
[0m14:07:15.230107 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:07:15.238441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '830be247-f72c-4328-a152-f207aa0edc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F90B680E0>]}
[0m14:07:15.238441 [warn ] [MainThread]: The selection criterion 'churn\' does not match any enabled nodes
[0m14:07:15.238441 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:07:15.238441 [debug] [MainThread]: Command end result
[0m14:07:15.264667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:15.266632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:15.269759 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:07:15.269759 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:15.269759 after 1.52 seconds
[0m14:07:15.269759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F8EB57650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F90B6BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F90B78770>]}
[0m14:07:15.269759 [debug] [MainThread]: Flushing usage events
[0m14:07:16.201865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:20.394564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274133AE720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027414F23260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027412A1BD10>]}


============================== 14:07:20.400656 | 902a1015-c25b-4d17-828d-b8470eae31f0 ==============================
[0m14:07:20.400656 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:07:20.400656 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:20.825796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '902a1015-c25b-4d17-828d-b8470eae31f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027416357140>]}
[0m14:07:20.873498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '902a1015-c25b-4d17-828d-b8470eae31f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027414B42390>]}
[0m14:07:20.889614 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:07:21.199629 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:07:21.342207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:21.342207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:21.351333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:07:21.370870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '902a1015-c25b-4d17-828d-b8470eae31f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274156103E0>]}
[0m14:07:21.436494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:21.452526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:21.468546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '902a1015-c25b-4d17-828d-b8470eae31f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274177C5940>]}
[0m14:07:21.479844 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:07:21.479844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '902a1015-c25b-4d17-828d-b8470eae31f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274162A0E60>]}
[0m14:07:21.479844 [info ] [MainThread]: 
[0m14:07:21.479844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:21.479844 [info ] [MainThread]: 
[0m14:07:21.479844 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:21.484316 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:07:21.572750 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:07:21.573784 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:07:21.573784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:22.684191 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.114 seconds
[0m14:07:22.692910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:07:22.704024 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:07:22.704024 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:07:22.704024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:23.137690 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.442 seconds
[0m14:07:23.151889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '902a1015-c25b-4d17-828d-b8470eae31f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027417BF20F0>]}
[0m14:07:23.155358 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:07:23.155358 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:07:23.155358 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:07:23.155358 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:07:23.174723 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:07:23.174723 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:07:23.204508 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:07:23.205780 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:07:23.206899 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        c.customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
     WHERE
        lt.last_transaction_date IS NOT NULL
        AND lt.last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    GROUP BY
        customer_id, customer_name
    ORDER BY
        last_transaction_date
)
select * from LastTransaction
  );
[0m14:07:23.206899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:23.595266 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa5-0001-429a-0008-511e0001ba06
[0m14:07:23.595266 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 8
invalid identifier 'C.CUSTOMER_NAME'
[0m14:07:23.595266 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:07:23.595266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '902a1015-c25b-4d17-828d-b8470eae31f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027415FBC830>]}
[0m14:07:23.611223 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.44s]
[0m14:07:23.611223 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:07:23.611223 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:07:23.611223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:23.611223 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:07:23.611223 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:07:23.704401 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:07:23.704401 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:07:23.789910 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:07:23.791926 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:07:23.869900 [info ] [MainThread]: 
[0m14:07:23.869900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m14:07:23.869900 [debug] [MainThread]: Command end result
[0m14:07:23.906004 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:23.908908 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:23.914550 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:07:23.914550 [info ] [MainThread]: 
[0m14:07:23.914550 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:23.914550 [info ] [MainThread]: 
[0m14:07:23.914550 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 7 at position 8
  invalid identifier 'C.CUSTOMER_NAME'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:07:23.914550 [info ] [MainThread]: 
[0m14:07:23.914550 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:07:23.914550 [debug] [MainThread]: Command `dbt run` failed at 14:07:23.914550 after 3.68 seconds
[0m14:07:23.914550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027416004410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002741632B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274175E4560>]}
[0m14:07:23.914550 [debug] [MainThread]: Flushing usage events
[0m14:07:24.822652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:36.844603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AC161070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AC160440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AC161850>]}


============================== 14:07:36.844603 | ab1d8b6f-f2e5-4842-989c-6403f67fe3ff ==============================
[0m14:07:36.844603 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:07:36.844603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:37.281999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab1d8b6f-f2e5-4842-989c-6403f67fe3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AC02E570>]}
[0m14:07:37.329868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab1d8b6f-f2e5-4842-989c-6403f67fe3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242ACDCC2C0>]}
[0m14:07:37.329868 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:07:37.657543 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:07:37.785638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:37.785638 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:07:38.022568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:07:38.038202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab1d8b6f-f2e5-4842-989c-6403f67fe3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AE3ED760>]}
[0m14:07:38.116443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:38.119894 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:38.135769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab1d8b6f-f2e5-4842-989c-6403f67fe3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AE4D5790>]}
[0m14:07:38.135769 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:07:38.135769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab1d8b6f-f2e5-4842-989c-6403f67fe3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AE52A150>]}
[0m14:07:38.135769 [info ] [MainThread]: 
[0m14:07:38.135769 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:38.135769 [info ] [MainThread]: 
[0m14:07:38.135769 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:38.151698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:07:38.238465 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:07:38.238465 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:07:38.239496 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:39.095826 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.862 seconds
[0m14:07:39.095826 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:07:39.111713 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:07:39.111713 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:07:39.111713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:39.517371 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.411 seconds
[0m14:07:39.533439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab1d8b6f-f2e5-4842-989c-6403f67fe3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AE50F9E0>]}
[0m14:07:39.549534 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:07:39.549534 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:07:39.549534 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:07:39.565518 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:07:39.565518 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:07:39.565518 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:07:39.608129 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:07:39.610202 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:07:39.610202 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
     WHERE
        lt.last_transaction_date IS NOT NULL
        AND lt.last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    GROUP BY
        customer_id, customer_name
    ORDER BY
        last_transaction_date
)
select * from LastTransaction
  );
[0m14:07:39.610202 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:40.108017 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa5-0001-429a-0008-511e0001ba0a
[0m14:07:40.110026 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 8
invalid identifier 'LT.LAST_TRANSACTION_DATE'
[0m14:07:40.113459 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'LT.LAST_TRANSACTION_DATE'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:07:40.113459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab1d8b6f-f2e5-4842-989c-6403f67fe3ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AE057D10>]}
[0m14:07:40.113459 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.56s]
[0m14:07:40.113459 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:07:40.113459 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'LT.LAST_TRANSACTION_DATE'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:07:40.113459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:40.113459 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:07:40.113459 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:07:40.204958 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:07:40.204958 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:07:40.301454 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:07:40.301454 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:07:40.381864 [info ] [MainThread]: 
[0m14:07:40.398756 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m14:07:40.398756 [debug] [MainThread]: Command end result
[0m14:07:40.475142 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:40.477473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:40.482879 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:07:40.482879 [info ] [MainThread]: 
[0m14:07:40.483942 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:40.484934 [info ] [MainThread]: 
[0m14:07:40.485543 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'LT.LAST_TRANSACTION_DATE'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:07:40.485543 [info ] [MainThread]: 
[0m14:07:40.486938 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:07:40.486938 [debug] [MainThread]: Command `dbt run` failed at 14:07:40.486938 after 3.79 seconds
[0m14:07:40.488734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9CEA1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242A9EC6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242AE2A4980>]}
[0m14:07:40.488734 [debug] [MainThread]: Flushing usage events
[0m14:07:41.412852 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:53.980224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E10044EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E10044FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E100451F0>]}


============================== 14:07:53.984963 | 55d5fab9-48eb-4aa2-8789-b03b8f749703 ==============================
[0m14:07:53.984963 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:07:53.984963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:54.401313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55d5fab9-48eb-4aa2-8789-b03b8f749703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E10D6EBA0>]}
[0m14:07:54.464663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55d5fab9-48eb-4aa2-8789-b03b8f749703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E11D9A150>]}
[0m14:07:54.464663 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:07:54.785281 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:07:54.934464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:54.934464 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:07:55.172051 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:07:55.192857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55d5fab9-48eb-4aa2-8789-b03b8f749703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E12355910>]}
[0m14:07:55.254925 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:55.254925 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:55.286839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55d5fab9-48eb-4aa2-8789-b03b8f749703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E122F56A0>]}
[0m14:07:55.286839 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:07:55.286839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d5fab9-48eb-4aa2-8789-b03b8f749703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E11E696A0>]}
[0m14:07:55.286839 [info ] [MainThread]: 
[0m14:07:55.286839 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:07:55.286839 [info ] [MainThread]: 
[0m14:07:55.286839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:55.286839 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:07:55.381763 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:07:55.381763 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:07:55.382795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:56.248305 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.867 seconds
[0m14:07:56.250049 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:07:56.266104 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:07:56.266104 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:07:56.266104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:56.569005 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.304 seconds
[0m14:07:56.569005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d5fab9-48eb-4aa2-8789-b03b8f749703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E10D4A930>]}
[0m14:07:56.569005 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:07:56.569005 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:07:56.569005 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:07:56.569005 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:07:56.588037 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:07:56.588037 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:07:56.621929 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:07:56.624096 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:07:56.624096 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
     WHERE
        lt.last_transaction_date IS NOT NULL
        AND last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    GROUP BY
        customer_id, customer_name
    ORDER BY
        last_transaction_date
)
select * from LastTransaction
  );
[0m14:07:56.625093 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:57.140498 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa5-0001-429b-0008-511e00017ac2
[0m14:07:57.140498 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 8
invalid identifier 'LT.LAST_TRANSACTION_DATE'
[0m14:07:57.140498 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'LT.LAST_TRANSACTION_DATE'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:07:57.140498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d5fab9-48eb-4aa2-8789-b03b8f749703', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0F510AD0>]}
[0m14:07:57.148406 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.57s]
[0m14:07:57.148406 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:07:57.148406 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'LT.LAST_TRANSACTION_DATE'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:07:57.148406 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:57.148406 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:07:57.148406 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:07:57.230948 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:07:57.230948 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:07:57.303577 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:07:57.303577 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:07:57.405461 [info ] [MainThread]: 
[0m14:07:57.405461 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m14:07:57.405461 [debug] [MainThread]: Command end result
[0m14:07:57.490041 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:07:57.492450 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:07:57.497924 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:07:57.497924 [info ] [MainThread]: 
[0m14:07:57.499108 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:07:57.500105 [info ] [MainThread]: 
[0m14:07:57.500105 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 12 at position 8
  invalid identifier 'LT.LAST_TRANSACTION_DATE'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:07:57.500105 [info ] [MainThread]: 
[0m14:07:57.501510 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:07:57.502518 [debug] [MainThread]: Command `dbt run` failed at 14:07:57.501510 after 3.69 seconds
[0m14:07:57.502518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E10BA14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0F549700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E0F548CE0>]}
[0m14:07:57.502518 [debug] [MainThread]: Flushing usage events
[0m14:07:58.367603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:27.841520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AD9EC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AD327E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AD9EE420>]}


============================== 14:08:27.849870 | 2421fe7e-87b1-4f1e-8587-45a3010b3bf5 ==============================
[0m14:08:27.849870 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:08:27.849870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:28.255129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2421fe7e-87b1-4f1e-8587-45a3010b3bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AE656FC0>]}
[0m14:08:28.318607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2421fe7e-87b1-4f1e-8587-45a3010b3bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AD051FA0>]}
[0m14:08:28.318607 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:08:28.636512 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:08:28.782020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:08:28.782020 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:08:29.026054 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:08:29.043466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2421fe7e-87b1-4f1e-8587-45a3010b3bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AFD51970>]}
[0m14:08:29.103682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:08:29.103682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:08:29.141437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2421fe7e-87b1-4f1e-8587-45a3010b3bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AFE25790>]}
[0m14:08:29.141437 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:08:29.142211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2421fe7e-87b1-4f1e-8587-45a3010b3bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AF9796A0>]}
[0m14:08:29.143297 [info ] [MainThread]: 
[0m14:08:29.144785 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:08:29.144785 [info ] [MainThread]: 
[0m14:08:29.146064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:08:29.146064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:08:29.237141 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:08:29.237141 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:08:29.237141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:30.267321 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.043 seconds
[0m14:08:30.283430 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:08:30.303137 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:08:30.303137 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:08:30.303137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:30.745972 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.442 seconds
[0m14:08:30.755357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2421fe7e-87b1-4f1e-8587-45a3010b3bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AFC78A10>]}
[0m14:08:30.755357 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:08:30.755357 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:08:30.755357 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:08:30.755357 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:08:30.755357 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:08:30.755357 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:08:30.790469 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:08:30.790469 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:08:30.790469 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
     WHERE
        last_transaction_date IS NOT NULL
        AND last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    GROUP BY
        customer_id, customer_name
    ORDER BY
        last_transaction_date
)
select * from LastTransaction
  );
[0m14:08:30.790469 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:08:31.141419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa6-0001-429b-0008-511e00017aca
[0m14:08:31.141419 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000990 (42601): SQL compilation error: error line 12 at position 8
aggregate function alias 'LAST_TRANSACTION_DATE' cannot be used in the WHERE clause
[0m14:08:31.141419 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  000990 (42601): SQL compilation error: error line 12 at position 8
  aggregate function alias 'LAST_TRANSACTION_DATE' cannot be used in the WHERE clause
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:08:31.141419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2421fe7e-87b1-4f1e-8587-45a3010b3bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253ACFC0AD0>]}
[0m14:08:31.141419 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.39s]
[0m14:08:31.155691 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:08:31.157213 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  000990 (42601): SQL compilation error: error line 12 at position 8
  aggregate function alias 'LAST_TRANSACTION_DATE' cannot be used in the WHERE clause
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:08:31.157213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:31.157213 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:08:31.157213 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:08:31.247810 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:08:31.248807 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:08:31.320620 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:08:31.320620 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:08:31.406198 [info ] [MainThread]: 
[0m14:08:31.406198 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m14:08:31.406198 [debug] [MainThread]: Command end result
[0m14:08:31.495933 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:08:31.498455 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:08:31.504236 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:08:31.505425 [info ] [MainThread]: 
[0m14:08:31.506242 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:08:31.506242 [info ] [MainThread]: 
[0m14:08:31.507443 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  000990 (42601): SQL compilation error: error line 12 at position 8
  aggregate function alias 'LAST_TRANSACTION_DATE' cannot be used in the WHERE clause
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:08:31.508498 [info ] [MainThread]: 
[0m14:08:31.508498 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:08:31.509545 [debug] [MainThread]: Command `dbt run` failed at 14:08:31.509545 after 3.82 seconds
[0m14:08:31.509545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AE6D14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AB1A9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253AFB0C950>]}
[0m14:08:31.510819 [debug] [MainThread]: Flushing usage events
[0m14:08:32.392666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:09.101201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DD850D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DD84350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DD847A0>]}


============================== 14:10:09.116823 | be4f3d14-be75-44b5-96de-86eb8ee66d9f ==============================
[0m14:10:09.116823 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:10:09.116823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:09.620753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be4f3d14-be75-44b5-96de-86eb8ee66d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4FB6F890>]}
[0m14:10:09.722876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be4f3d14-be75-44b5-96de-86eb8ee66d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4E81E480>]}
[0m14:10:09.722876 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:10:10.167900 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:10:11.539390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:11.539390 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:10:11.825846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:10:11.851268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be4f3d14-be75-44b5-96de-86eb8ee66d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4FFBD760>]}
[0m14:10:11.930882 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:10:11.947835 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:10:11.981825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be4f3d14-be75-44b5-96de-86eb8ee66d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB50099790>]}
[0m14:10:11.981825 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:10:11.981825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4f3d14-be75-44b5-96de-86eb8ee66d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4FF526F0>]}
[0m14:10:11.981825 [info ] [MainThread]: 
[0m14:10:11.986318 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:11.986318 [info ] [MainThread]: 
[0m14:10:11.986318 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:10:11.986318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:10:14.957652 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:10:14.968031 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:10:14.968031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:15.878512 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.917 seconds
[0m14:10:15.894995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:10:15.928048 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:10:15.928048 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:10:15.928048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:16.397841 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.460 seconds
[0m14:10:16.411042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4f3d14-be75-44b5-96de-86eb8ee66d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4FE74A40>]}
[0m14:10:16.414207 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:10:16.414207 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:10:16.426977 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:10:16.427685 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:10:16.444928 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:10:16.446588 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:10:16.480738 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:10:16.480738 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:10:16.480738 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
     WHERE
        last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    GROUP BY
        customer_id, customer_name
)
WITH Churn(
    SELECT * FROM LastTransaction
    WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    ORDER BY last_transaction_date
        
)
select * from LastTransaction
  );
[0m14:10:16.480738 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:16.912909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa8-0001-429a-0008-511e0001ba16
[0m14:10:16.912909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 0 unexpected 'WITH'.
syntax error line 18 at position 68 unexpected ')'.
[0m14:10:16.928733 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'WITH'.
  syntax error line 18 at position 68 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:10:16.928733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4f3d14-be75-44b5-96de-86eb8ee66d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4D250590>]}
[0m14:10:16.928733 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.51s]
[0m14:10:16.928733 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:10:16.928733 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'WITH'.
  syntax error line 18 at position 68 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:10:16.928733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:16.928733 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:10:16.928733 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:10:17.037342 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:10:17.037342 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:10:17.122605 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:10:17.124619 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:10:17.212867 [info ] [MainThread]: 
[0m14:10:17.212867 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m14:10:17.212867 [debug] [MainThread]: Command end result
[0m14:10:17.295678 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:10:17.295678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:10:17.295678 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:10:17.295678 [info ] [MainThread]: 
[0m14:10:17.295678 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:10:17.295678 [info ] [MainThread]: 
[0m14:10:17.310968 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 0 unexpected 'WITH'.
  syntax error line 18 at position 68 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:10:17.311815 [info ] [MainThread]: 
[0m14:10:17.312288 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:10:17.312288 [debug] [MainThread]: Command `dbt run` failed at 14:10:17.312288 after 8.39 seconds
[0m14:10:17.312288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4D2518E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4E95F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4FEBE510>]}
[0m14:10:17.312288 [debug] [MainThread]: Flushing usage events
[0m14:10:18.536194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:23.264800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9B291E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9BD35190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9BD350D0>]}


============================== 14:10:23.264800 | 0e1bc35d-eb12-411b-95b5-c3be594f8d24 ==============================
[0m14:10:23.264800 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:10:23.264800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s churn', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:23.707581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e1bc35d-eb12-411b-95b5-c3be594f8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9C9FBFE0>]}
[0m14:10:23.772936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e1bc35d-eb12-411b-95b5-c3be594f8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9B1BD010>]}
[0m14:10:23.772936 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:10:24.073240 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:10:24.242207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:24.242207 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:10:24.472719 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:10:24.496597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e1bc35d-eb12-411b-95b5-c3be594f8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9E069C70>]}
[0m14:10:24.566351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:10:24.569746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:10:24.585464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e1bc35d-eb12-411b-95b5-c3be594f8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9E011820>]}
[0m14:10:24.585464 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:10:24.585464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1bc35d-eb12-411b-95b5-c3be594f8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9E056420>]}
[0m14:10:24.585464 [info ] [MainThread]: 
[0m14:10:24.597856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:24.597856 [info ] [MainThread]: 
[0m14:10:24.597856 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:10:24.597856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:10:24.689788 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:10:24.689788 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:10:24.690824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:25.201339 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.520 seconds
[0m14:10:25.216814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:10:25.216814 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:10:25.216814 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:10:25.216814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:25.545867 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.318 seconds
[0m14:10:25.547875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e1bc35d-eb12-411b-95b5-c3be594f8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9E0491C0>]}
[0m14:10:25.554361 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:10:25.554361 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:10:25.554361 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:10:25.554361 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:10:25.554361 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:10:25.554361 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:10:25.588255 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:10:25.588255 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:10:25.588255 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, customer_name
)
WITH Churn(
    SELECT * FROM LastTransaction
    WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    ORDER BY last_transaction_date
        
)
select * from LastTransaction
  );
[0m14:10:25.588255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:25.900054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa8-0001-429e-0008-511e0001d222
[0m14:10:25.900054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'WITH'.
syntax error line 16 at position 68 unexpected ')'.
[0m14:10:25.900054 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 16 at position 68 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:10:25.915836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e1bc35d-eb12-411b-95b5-c3be594f8d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9B200B00>]}
[0m14:10:25.915836 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.35s]
[0m14:10:25.915836 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:10:25.918437 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 16 at position 68 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:10:25.918942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:25.918942 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:10:25.918942 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:10:26.004544 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:10:26.004544 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:10:26.101006 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:10:26.101006 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:10:26.198944 [info ] [MainThread]: 
[0m14:10:26.200960 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m14:10:26.206419 [debug] [MainThread]: Command end result
[0m14:10:26.290807 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:10:26.291988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:10:26.297401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:10:26.298840 [info ] [MainThread]: 
[0m14:10:26.298840 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:10:26.300074 [info ] [MainThread]: 
[0m14:10:26.300679 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 16 at position 68 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:10:26.301393 [info ] [MainThread]: 
[0m14:10:26.301393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:10:26.302423 [debug] [MainThread]: Command `dbt run` failed at 14:10:26.302423 after 3.19 seconds
[0m14:10:26.303562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9DF11100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9DF12090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9DF115E0>]}
[0m14:10:26.303562 [debug] [MainThread]: Flushing usage events
[0m14:10:27.181715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:38.366198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C35D05C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C35D0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C35D14C0>]}


============================== 14:10:38.366198 | 43f200d6-3f24-4ea9-8c58-6171d342f660 ==============================
[0m14:10:38.366198 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:10:38.366198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:10:38.801715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43f200d6-3f24-4ea9-8c58-6171d342f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C43DE990>]}
[0m14:10:38.851165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43f200d6-3f24-4ea9-8c58-6171d342f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C38EC2F0>]}
[0m14:10:38.851165 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:10:39.171545 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:10:39.314815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:39.314815 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:10:39.567852 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:10:39.571308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43f200d6-3f24-4ea9-8c58-6171d342f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C5714A70>]}
[0m14:10:39.651412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:10:39.651412 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:10:39.667756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43f200d6-3f24-4ea9-8c58-6171d342f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C5945490>]}
[0m14:10:39.683240 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:10:39.683240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f200d6-3f24-4ea9-8c58-6171d342f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C30E58E0>]}
[0m14:10:39.683240 [info ] [MainThread]: 
[0m14:10:39.683240 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:10:39.683240 [info ] [MainThread]: 
[0m14:10:39.683240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:10:39.683240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:10:39.777231 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:10:39.777231 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:10:39.778263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:40.579665 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.811 seconds
[0m14:10:40.595427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:10:40.595427 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:10:40.595427 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:10:40.595427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:41.035488 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.430 seconds
[0m14:10:41.035488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43f200d6-3f24-4ea9-8c58-6171d342f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C5DC2C30>]}
[0m14:10:41.035488 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:10:41.035488 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:10:41.035488 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:10:41.035488 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:10:41.055224 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:10:41.057233 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:10:41.088338 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:10:41.090346 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:10:41.090346 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, customer_name
),
WITH Churn(
    SELECT * FROM LastTransaction
    WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    ORDER BY last_transaction_date
        
)
select * from LastTransaction
  );
[0m14:10:41.090346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:10:41.394883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa8-0001-429e-0008-511e0001d22e
[0m14:10:41.394883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'WITH'.
syntax error line 15 at position 4 unexpected 'SELECT'.
syntax error line 16 at position 47 unexpected ','.
syntax error line 16 at position 49 unexpected '-'.
syntax error line 16 at position 67 unexpected ')'.
syntax error line 16 at position 68 unexpected ')'.
syntax error line 19 at position 0 unexpected ')'.
[0m14:10:41.410988 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 15 at position 4 unexpected 'SELECT'.
  syntax error line 16 at position 47 unexpected ','.
  syntax error line 16 at position 49 unexpected '-'.
  syntax error line 16 at position 67 unexpected ')'.
  syntax error line 16 at position 68 unexpected ')'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:10:41.410988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43f200d6-3f24-4ea9-8c58-6171d342f660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C2A70770>]}
[0m14:10:41.410988 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.38s]
[0m14:10:41.410988 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:10:41.410988 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 15 at position 4 unexpected 'SELECT'.
  syntax error line 16 at position 47 unexpected ','.
  syntax error line 16 at position 49 unexpected '-'.
  syntax error line 16 at position 67 unexpected ')'.
  syntax error line 16 at position 68 unexpected ')'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:10:41.422645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:41.422645 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:10:41.422645 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:10:41.506242 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:10:41.506242 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:10:41.582676 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:10:41.582676 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:10:41.679367 [info ] [MainThread]: 
[0m14:10:41.679367 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m14:10:41.679367 [debug] [MainThread]: Command end result
[0m14:10:41.768175 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:10:41.770955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:10:41.775947 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:10:41.776944 [info ] [MainThread]: 
[0m14:10:41.776944 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:10:41.778466 [info ] [MainThread]: 
[0m14:10:41.778972 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 15 at position 4 unexpected 'SELECT'.
  syntax error line 16 at position 47 unexpected ','.
  syntax error line 16 at position 49 unexpected '-'.
  syntax error line 16 at position 67 unexpected ')'.
  syntax error line 16 at position 68 unexpected ')'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:10:41.779787 [info ] [MainThread]: 
[0m14:10:41.780385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:10:41.781050 [debug] [MainThread]: Command `dbt run` failed at 14:10:41.781050 after 3.57 seconds
[0m14:10:41.781050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C5743FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C091C560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173C42A7980>]}
[0m14:10:41.782081 [debug] [MainThread]: Flushing usage events
[0m14:10:42.671079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:44.087622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC47E05F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC47E21E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC47E0680>]}


============================== 14:11:44.103422 | 2002f8ac-7e8b-4dea-9e3b-dbc5992505d1 ==============================
[0m14:11:44.103422 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:11:44.103422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s churn', 'send_anonymous_usage_stats': 'True'}
[0m14:11:44.541198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2002f8ac-7e8b-4dea-9e3b-dbc5992505d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC667C590>]}
[0m14:11:44.604435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2002f8ac-7e8b-4dea-9e3b-dbc5992505d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC4C78260>]}
[0m14:11:44.604435 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:11:44.915585 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:11:45.060051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:45.060051 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:11:45.317031 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:11:45.337585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2002f8ac-7e8b-4dea-9e3b-dbc5992505d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC6C51E20>]}
[0m14:11:45.409332 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:11:45.412324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:11:45.437407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2002f8ac-7e8b-4dea-9e3b-dbc5992505d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC6C05820>]}
[0m14:11:45.437407 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:11:45.439416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2002f8ac-7e8b-4dea-9e3b-dbc5992505d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC69E43E0>]}
[0m14:11:45.439416 [info ] [MainThread]: 
[0m14:11:45.441497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:45.441497 [info ] [MainThread]: 
[0m14:11:45.441497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:45.441497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:11:45.528648 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:11:45.528648 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:11:45.529680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:46.473804 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.949 seconds
[0m14:11:46.485078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:11:46.502528 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:11:46.502528 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:11:46.502528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:46.969167 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.458 seconds
[0m14:11:46.973192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2002f8ac-7e8b-4dea-9e3b-dbc5992505d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC6CADB50>]}
[0m14:11:46.973192 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:11:46.973192 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:11:46.973192 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:11:46.973192 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:11:46.986876 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:11:46.988884 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:11:47.018622 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:11:47.021013 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:11:47.021013 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, customer_name
),
WITH Churn(
    SELECT * FROM LastTransaction
    WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    ORDER BY last_transaction_date
        
)
select * from Churn
  );
[0m14:11:47.022193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:47.341859 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffa9-0001-429e-0008-511e0001d236
[0m14:11:47.341859 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'WITH'.
syntax error line 15 at position 4 unexpected 'SELECT'.
syntax error line 16 at position 47 unexpected ','.
syntax error line 16 at position 49 unexpected '-'.
syntax error line 16 at position 67 unexpected ')'.
syntax error line 16 at position 68 unexpected ')'.
syntax error line 19 at position 0 unexpected ')'.
[0m14:11:47.341859 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 15 at position 4 unexpected 'SELECT'.
  syntax error line 16 at position 47 unexpected ','.
  syntax error line 16 at position 49 unexpected '-'.
  syntax error line 16 at position 67 unexpected ')'.
  syntax error line 16 at position 68 unexpected ')'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:11:47.341859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2002f8ac-7e8b-4dea-9e3b-dbc5992505d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC3DB0770>]}
[0m14:11:47.341859 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.37s]
[0m14:11:47.357794 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:11:47.357794 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 15 at position 4 unexpected 'SELECT'.
  syntax error line 16 at position 47 unexpected ','.
  syntax error line 16 at position 49 unexpected '-'.
  syntax error line 16 at position 67 unexpected ')'.
  syntax error line 16 at position 68 unexpected ')'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:11:47.357794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:47.357794 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:11:47.357794 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:11:47.435970 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:11:47.435970 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:11:47.535380 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:11:47.535380 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:11:47.634189 [info ] [MainThread]: 
[0m14:11:47.634189 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m14:11:47.634189 [debug] [MainThread]: Command end result
[0m14:11:47.703012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:11:47.703012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:11:47.722482 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:11:47.723689 [info ] [MainThread]: 
[0m14:11:47.723689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:11:47.724950 [info ] [MainThread]: 
[0m14:11:47.725554 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  syntax error line 15 at position 4 unexpected 'SELECT'.
  syntax error line 16 at position 47 unexpected ','.
  syntax error line 16 at position 49 unexpected '-'.
  syntax error line 16 at position 67 unexpected ')'.
  syntax error line 16 at position 68 unexpected ')'.
  syntax error line 19 at position 0 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:11:47.726308 [info ] [MainThread]: 
[0m14:11:47.726904 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:11:47.727533 [debug] [MainThread]: Command `dbt run` failed at 14:11:47.727533 after 3.79 seconds
[0m14:11:47.727533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC4300B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC38B1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DC26AE5A0>]}
[0m14:11:47.728565 [debug] [MainThread]: Flushing usage events
[0m14:11:48.958123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:11.395717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A634AF170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A634AD730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A634AD6A0>]}


============================== 14:12:11.411407 | f3b76141-82e9-4229-8572-3c079f932eeb ==============================
[0m14:12:11.411407 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:11.411407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s churn', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:12:11.858074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3b76141-82e9-4229-8572-3c079f932eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A66F6E990>]}
[0m14:12:11.918672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3b76141-82e9-4229-8572-3c079f932eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A66C1BFE0>]}
[0m14:12:11.920405 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:12:12.250315 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:12:12.406948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:12.406948 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:12:12.681506 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:12:12.695098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3b76141-82e9-4229-8572-3c079f932eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A68511940>]}
[0m14:12:12.767504 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:12:12.771543 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:12:12.795191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3b76141-82e9-4229-8572-3c079f932eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A684C5610>]}
[0m14:12:12.795191 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:12:12.795191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3b76141-82e9-4229-8572-3c079f932eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A682D0D40>]}
[0m14:12:12.795191 [info ] [MainThread]: 
[0m14:12:12.795191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:12.795191 [info ] [MainThread]: 
[0m14:12:12.795191 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:12.795191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:12:12.896166 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:12:12.896166 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:12:12.897291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:14.081864 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.190 seconds
[0m14:12:14.097683 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:12:14.110641 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:12:14.111642 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:12:14.111642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:14.529913 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.429 seconds
[0m14:12:14.545007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3b76141-82e9-4229-8572-3c079f932eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6364B410>]}
[0m14:12:14.546721 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:12:14.546721 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:12:14.546721 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:12:14.546721 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:12:14.562381 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:12:14.566122 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:12:14.602701 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:12:14.604712 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:12:14.604712 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, customer_name
),
WITH Churn AS(
    SELECT * FROM LastTransaction
    WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    ORDER BY last_transaction_date
        
)
select * from Churn
  );
[0m14:12:14.604712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:15.016032 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffaa-0001-429e-0008-511e0001d23e
[0m14:12:15.029469 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'WITH'.
[0m14:12:15.031843 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:12:15.031843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3b76141-82e9-4229-8572-3c079f932eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A656B0770>]}
[0m14:12:15.031843 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.49s]
[0m14:12:15.031843 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:12:15.031843 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m14:12:15.031843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:15.031843 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:12:15.031843 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:12:15.115936 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:12:15.115936 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:12:15.201366 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:12:15.201366 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:12:15.281562 [info ] [MainThread]: 
[0m14:12:15.287609 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m14:12:15.287609 [debug] [MainThread]: Command end result
[0m14:12:15.366599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:12:15.368877 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:12:15.373917 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:12:15.374915 [info ] [MainThread]: 
[0m14:12:15.374915 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:12:15.376374 [info ] [MainThread]: 
[0m14:12:15.376862 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'WITH'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m14:12:15.377570 [info ] [MainThread]: 
[0m14:12:15.378157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:12:15.378157 [debug] [MainThread]: Command `dbt run` failed at 14:12:15.378157 after 4.13 seconds
[0m14:12:15.379605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A65AC4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A65E26720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A65E27CE0>]}
[0m14:12:15.379605 [debug] [MainThread]: Flushing usage events
[0m14:12:16.265286 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:41.606597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB103D43E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB103D4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB103D4350>]}


============================== 14:12:41.614359 | 267ae65e-eb09-4503-8847-5eda0ce1015d ==============================
[0m14:12:41.614359 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:12:41.614359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:42.209927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '267ae65e-eb09-4503-8847-5eda0ce1015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB110420C0>]}
[0m14:12:42.282341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '267ae65e-eb09-4503-8847-5eda0ce1015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB10418500>]}
[0m14:12:42.283373 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:12:42.632410 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:12:42.777213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:42.777213 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:12:43.066368 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:12:43.082927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '267ae65e-eb09-4503-8847-5eda0ce1015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB1223AFC0>]}
[0m14:12:43.155731 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:12:43.158966 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:12:43.177758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '267ae65e-eb09-4503-8847-5eda0ce1015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB126A58B0>]}
[0m14:12:43.177758 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:12:43.177758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267ae65e-eb09-4503-8847-5eda0ce1015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB126F14F0>]}
[0m14:12:43.177758 [info ] [MainThread]: 
[0m14:12:43.177758 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:43.190653 [info ] [MainThread]: 
[0m14:12:43.190653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:43.190653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:12:43.279783 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:12:43.279783 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:12:43.280828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:44.173452 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.893 seconds
[0m14:12:44.193042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:12:44.208677 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:12:44.209344 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:12:44.209344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:44.611467 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.414 seconds
[0m14:12:44.627434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '267ae65e-eb09-4503-8847-5eda0ce1015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB12B0E840>]}
[0m14:12:44.627434 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:12:44.627434 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:12:44.627434 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:12:44.627434 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:12:44.645071 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:12:44.646121 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:12:44.665227 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:12:44.680471 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:12:44.680471 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
        customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, customer_name
),
Churn AS (
    SELECT * FROM LastTransaction
    WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    ORDER BY last_transaction_date
)
SELECT * FROM Churn
  );
[0m14:12:44.680471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:45.397179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m14:12:45.436648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '267ae65e-eb09-4503-8847-5eda0ce1015d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0F8B07D0>]}
[0m14:12:45.436648 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.81s]
[0m14:12:45.436648 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:12:45.436648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:45.436648 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:12:45.436648 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:12:45.514108 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:12:45.514108 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:12:45.611028 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:12:45.611028 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:12:45.689767 [info ] [MainThread]: 
[0m14:12:45.689767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m14:12:45.689767 [debug] [MainThread]: Command end result
[0m14:12:45.779751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:12:45.779751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:12:45.779751 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:12:45.779751 [info ] [MainThread]: 
[0m14:12:45.779751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:45.779751 [info ] [MainThread]: 
[0m14:12:45.779751 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:12:45.779751 [debug] [MainThread]: Command `dbt run` succeeded at 14:12:45.779751 after 4.35 seconds
[0m14:12:45.779751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB12488380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB12B0CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB125CD250>]}
[0m14:12:45.779751 [debug] [MainThread]: Flushing usage events
[0m14:12:46.663264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:47.555202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BEB462750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BEBAD0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BEC85F290>]}


============================== 14:14:47.555202 | e7d374b4-9959-4b13-b9b5-f88a911a4a1a ==============================
[0m14:14:47.555202 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:14:47.555202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:48.009461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d374b4-9959-4b13-b9b5-f88a911a4a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BEE6925A0>]}
[0m14:14:48.073195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d374b4-9959-4b13-b9b5-f88a911a4a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BEFEB4B90>]}
[0m14:14:48.073195 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:14:48.386685 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:14:48.527786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:48.527786 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m14:14:48.764842 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:14:48.780709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d374b4-9959-4b13-b9b5-f88a911a4a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BF1511B50>]}
[0m14:14:48.855456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:14:48.858751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:14:48.883696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d374b4-9959-4b13-b9b5-f88a911a4a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BF14D1AF0>]}
[0m14:14:48.883696 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:14:48.883696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d374b4-9959-4b13-b9b5-f88a911a4a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BF101BB60>]}
[0m14:14:48.883696 [info ] [MainThread]: 
[0m14:14:48.888482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:48.888482 [info ] [MainThread]: 
[0m14:14:48.888482 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:14:48.888482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:14:48.976243 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:14:48.977279 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:14:48.977279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:49.780761 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.803 seconds
[0m14:14:49.782772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:14:49.796492 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:14:49.796492 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:14:49.796492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:50.213397 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.425 seconds
[0m14:14:50.227153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d374b4-9959-4b13-b9b5-f88a911a4a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BF13EFB00>]}
[0m14:14:50.227153 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m14:14:50.235223 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m14:14:50.235223 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m14:14:50.235223 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m14:14:50.243691 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m14:14:50.245571 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m14:14:50.274334 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m14:14:50.276461 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m14:14:50.276461 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
       
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
         customer_name
),
Churn AS (
    SELECT * FROM LastTransaction
    WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
    ORDER BY last_transaction_date
)
SELECT * FROM Churn
  );
[0m14:14:50.277491 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:50.728141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.453 seconds
[0m14:14:50.745122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d374b4-9959-4b13-b9b5-f88a911a4a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BEE600890>]}
[0m14:14:50.745122 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.51s]
[0m14:14:50.745122 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m14:14:50.745122 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:50.745122 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:14:50.745122 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:14:50.835686 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:14:50.835686 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:14:50.916823 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m14:14:50.916823 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m14:14:50.999518 [info ] [MainThread]: 
[0m14:14:50.999518 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m14:14:50.999518 [debug] [MainThread]: Command end result
[0m14:14:51.082494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:14:51.084488 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:14:51.089958 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:14:51.089958 [info ] [MainThread]: 
[0m14:14:51.091233 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:51.092096 [info ] [MainThread]: 
[0m14:14:51.092710 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:14:51.093318 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:51.093318 after 3.69 seconds
[0m14:14:51.094364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BECDD2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BECE163C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010BF1528200>]}
[0m14:14:51.094364 [debug] [MainThread]: Flushing usage events
[0m14:14:51.990736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:17:53.206512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5FD3F2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F580ACB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5FE7CFA40>]}


============================== 14:17:53.215694 | ac774135-92f9-4890-81ee-cb05f6ae775e ==============================
[0m14:17:53.215694 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:17:53.215694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:17:53.634528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac774135-92f9-4890-81ee-cb05f6ae775e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F581B77200>]}
[0m14:17:53.705519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac774135-92f9-4890-81ee-cb05f6ae775e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5805F3B90>]}
[0m14:17:53.705519 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:17:54.050753 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:17:54.208294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:54.208294 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:17:54.454580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:17:54.466179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac774135-92f9-4890-81ee-cb05f6ae775e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5834A1730>]}
[0m14:17:54.536510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:17:54.536510 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:17:54.552246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac774135-92f9-4890-81ee-cb05f6ae775e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F583451520>]}
[0m14:17:54.564891 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:17:54.564891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac774135-92f9-4890-81ee-cb05f6ae775e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F581E68680>]}
[0m14:17:54.564891 [info ] [MainThread]: 
[0m14:17:54.567337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:17:54.567337 [info ] [MainThread]: 
[0m14:17:54.568343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:17:54.568343 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:17:54.657467 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:17:54.657467 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:17:54.657467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:55.655831 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.002 seconds
[0m14:17:55.666707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:17:55.666707 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:17:55.666707 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:17:55.666707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:56.024793 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.347 seconds
[0m14:17:56.024793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac774135-92f9-4890-81ee-cb05f6ae775e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F581114A70>]}
[0m14:17:56.024793 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:17:56.024793 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:17:56.024793 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:17:56.024793 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:17:56.043210 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:17:56.044857 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:17:56.072570 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:17:56.074637 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:17:56.075669 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer and product_id is not null
),
 
optimized AS (
  select 
    customer AS customer_id,
    product_id AS product_id,
    payment_month AS payment_month,
    CAST(revenue_type AS BOOLEAN) AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m14:17:56.075669 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:17:56.735135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m14:17:56.751026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac774135-92f9-4890-81ee-cb05f6ae775e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5805F0350>]}
[0m14:17:56.751026 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.73s]
[0m14:17:56.751026 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:17:56.751026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:56.766905 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:17:56.766905 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:17:56.841747 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:17:56.841747 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:17:56.936024 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:17:56.936024 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:17:57.022940 [info ] [MainThread]: 
[0m14:17:57.032325 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m14:17:57.032325 [debug] [MainThread]: Command end result
[0m14:17:57.119490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:17:57.121659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:17:57.127404 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:17:57.128447 [info ] [MainThread]: 
[0m14:17:57.128447 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:57.129512 [info ] [MainThread]: 
[0m14:17:57.129512 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:17:57.130870 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:57.130870 after 4.09 seconds
[0m14:17:57.130870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F583437FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5805F17C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5805F1100>]}
[0m14:17:57.130870 [debug] [MainThread]: Flushing usage events
[0m14:17:58.410011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:46.712374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8C874590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8C874650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8C874530>]}


============================== 14:20:46.719261 | 32bf20d7-e4dd-45f1-8813-5951d60f415c ==============================
[0m14:20:46.719261 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:20:46.719261 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_transaction', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:47.167523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32bf20d7-e4dd-45f1-8813-5951d60f415c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8D63F590>]}
[0m14:20:47.235310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32bf20d7-e4dd-45f1-8813-5951d60f415c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8CAC0080>]}
[0m14:20:47.235310 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:20:47.557427 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:20:47.720592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:20:47.720592 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:20:47.976198 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:20:47.995339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32bf20d7-e4dd-45f1-8813-5951d60f415c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8E6720C0>]}
[0m14:20:48.068939 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:20:48.072073 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:20:48.100225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32bf20d7-e4dd-45f1-8813-5951d60f415c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8EBA59A0>]}
[0m14:20:48.100225 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:20:48.100225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32bf20d7-e4dd-45f1-8813-5951d60f415c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8EBF66F0>]}
[0m14:20:48.100225 [info ] [MainThread]: 
[0m14:20:48.104413 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:20:48.104413 [info ] [MainThread]: 
[0m14:20:48.104413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:20:48.104413 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:20:48.196218 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:20:48.196218 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:20:48.197250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:49.228203 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.031 seconds
[0m14:20:49.244621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:20:49.250755 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:20:49.250755 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:20:49.260253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:49.707993 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.453 seconds
[0m14:20:49.714982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32bf20d7-e4dd-45f1-8813-5951d60f415c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8CAC0A10>]}
[0m14:20:49.714982 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:20:49.714982 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:20:49.714982 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:20:49.714982 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:20:49.730478 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:20:49.730478 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:20:49.763150 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:20:49.764579 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:20:49.765579 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer and product_id is not null
),
 
optimized AS (
  select 
    customer AS customer_id,
    product_id AS product_id,
    payment_month AS payment_month,
    revenue_type AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m14:20:49.765579 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:20:50.309375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m14:20:50.339839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32bf20d7-e4dd-45f1-8813-5951d60f415c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE89C41A90>]}
[0m14:20:50.339839 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.62s]
[0m14:20:50.341103 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:20:50.342141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:50.343141 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:20:50.343141 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:20:50.436616 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:20:50.438611 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:20:50.525768 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:20:50.526785 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:20:50.626316 [info ] [MainThread]: 
[0m14:20:50.626316 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m14:20:50.628316 [debug] [MainThread]: Command end result
[0m14:20:50.696629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:20:50.696629 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:20:50.717064 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:20:50.717064 [info ] [MainThread]: 
[0m14:20:50.718258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:20:50.719150 [info ] [MainThread]: 
[0m14:20:50.719744 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:20:50.720745 [debug] [MainThread]: Command `dbt run` succeeded at 14:20:50.720745 after 4.17 seconds
[0m14:20:50.720745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8E93A540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8E93A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8EAE7B30>]}
[0m14:20:50.720745 [debug] [MainThread]: Flushing usage events
[0m14:20:51.635172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:18.228672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222213B2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022224A2B980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022224A2A420>]}


============================== 14:21:18.228672 | c44502f4-15e7-45b5-8c9f-48f1b6e42305 ==============================
[0m14:21:18.228672 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:21:18.228672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_transaction', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:18.727438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c44502f4-15e7-45b5-8c9f-48f1b6e42305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022225084E60>]}
[0m14:21:18.797099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c44502f4-15e7-45b5-8c9f-48f1b6e42305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022225CF1A30>]}
[0m14:21:18.807716 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:21:19.187628 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:21:19.342389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:19.343668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:19.345877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:21:19.380376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c44502f4-15e7-45b5-8c9f-48f1b6e42305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022225C5BA10>]}
[0m14:21:19.456956 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:21:19.460664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:21:19.486630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c44502f4-15e7-45b5-8c9f-48f1b6e42305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022227078EF0>]}
[0m14:21:19.487866 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:21:19.488878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44502f4-15e7-45b5-8c9f-48f1b6e42305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222270D9B50>]}
[0m14:21:19.488878 [info ] [MainThread]: 
[0m14:21:19.491077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:19.491586 [info ] [MainThread]: 
[0m14:21:19.492177 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:21:19.493325 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:21:19.580643 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:21:19.581674 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:21:19.581674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:20.376172 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.809 seconds
[0m14:21:20.393749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:21:20.409514 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:21:20.409514 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:21:20.409514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:20.816971 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.406 seconds
[0m14:21:20.816971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c44502f4-15e7-45b5-8c9f-48f1b6e42305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022227078A70>]}
[0m14:21:20.826981 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:21:20.826981 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:21:20.826981 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:21:20.828989 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:21:20.834003 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:21:20.837914 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:21:20.862215 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:21:20.862215 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:21:20.862215 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer and product_id is not null
),
 
optimized AS (
  select 
    customer AS customer_id,
    product_id AS product_id,
    payment_month AS payment_month,
    revenue_type AS revenue_type,
    cast(revenue AS NUMERIC) AS revenue,
    CAST(quantity AS NUMERIC) AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m14:21:20.862215 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:21:21.395378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m14:21:21.442533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c44502f4-15e7-45b5-8c9f-48f1b6e42305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022222451A00>]}
[0m14:21:21.442533 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.62s]
[0m14:21:21.442533 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:21:21.442533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:21.442533 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:21:21.442533 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:21:21.548363 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:21:21.548363 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:21:21.625718 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:21:21.625718 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:21:21.710013 [info ] [MainThread]: 
[0m14:21:21.710013 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m14:21:21.710013 [debug] [MainThread]: Command end result
[0m14:21:21.732140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:21:21.732140 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:21:21.745753 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:21:21.745753 [info ] [MainThread]: 
[0m14:21:21.747277 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:21.748142 [info ] [MainThread]: 
[0m14:21:21.748700 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:21:21.749768 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:21.749768 after 3.71 seconds
[0m14:21:21.749768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022224F7EF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222272040E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022225084110>]}
[0m14:21:21.749768 [debug] [MainThread]: Flushing usage events
[0m14:21:22.660356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:29.642663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024342AB4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024342AB4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024342AB4290>]}


============================== 14:22:29.642663 | 2f516fab-bd07-431c-8879-5fa171f1f424 ==============================
[0m14:22:29.642663 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:22:29.658563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_transaction', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:30.077958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f516fab-bd07-431c-8879-5fa171f1f424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024343909640>]}
[0m14:22:30.150062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f516fab-bd07-431c-8879-5fa171f1f424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243438289B0>]}
[0m14:22:30.152203 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:22:30.451821 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:22:30.594660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:30.594660 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:22:30.842231 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:22:30.856374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f516fab-bd07-431c-8879-5fa171f1f424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024344E95820>]}
[0m14:22:30.912673 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:22:30.912673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:22:30.944228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f516fab-bd07-431c-8879-5fa171f1f424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024344E45700>]}
[0m14:22:30.944228 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:22:30.944228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f516fab-bd07-431c-8879-5fa171f1f424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243437F14C0>]}
[0m14:22:30.944228 [info ] [MainThread]: 
[0m14:22:30.944228 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:30.944228 [info ] [MainThread]: 
[0m14:22:30.944228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:30.960089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:22:31.051028 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:22:31.051028 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:22:31.052060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:32.031232 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.982 seconds
[0m14:22:32.037371 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:22:32.053231 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:22:32.053231 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:22:32.053231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:32.402361 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.349 seconds
[0m14:22:32.417041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f516fab-bd07-431c-8879-5fa171f1f424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243437D0A10>]}
[0m14:22:32.417041 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:22:32.417041 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:22:32.417041 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:22:32.424194 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:22:32.424194 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:22:32.424194 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:22:32.448648 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:22:32.448648 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:22:32.463565 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields AS (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
    where customer and product_id is not null
),
 
optimized AS (
  select 
    customer AS customer_id,
    product_id AS product_id,
    payment_month AS payment_month,
    revenue_type AS revenue_type,
    revenue AS revenue,
    quantity AS quantity,
    TRIM(dimension1) AS dimension1,
    TRIM(dimension2) AS dimension2,
    TRIM(dimension3) AS dimension3,
    TRIM(dimension4) AS dimension4,
    TRIM(dimension5) AS dimension5,
    TRIM(dimension6) AS dimension6,
    TRIM(dimension7) AS dimension7,
    TRIM(dimension8) AS dimension8,
    TRIM(dimension9) AS dimension9,
    TRIM(dimension10) AS dimension10,
    TRIM(companies) AS companies
   
  from required_fields

)
 
select *
from optimized
  );
[0m14:22:32.464430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:33.210881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m14:22:33.242645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f516fab-bd07-431c-8879-5fa171f1f424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024341F80830>]}
[0m14:22:33.242645 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 0.83s]
[0m14:22:33.242645 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:22:33.242645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:33.242645 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:22:33.242645 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:22:33.341970 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:22:33.344096 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:22:33.443704 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:22:33.443704 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:22:33.587950 [info ] [MainThread]: 
[0m14:22:33.587950 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m14:22:33.587950 [debug] [MainThread]: Command end result
[0m14:22:33.666899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:22:33.668933 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:22:33.673438 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:22:33.674851 [info ] [MainThread]: 
[0m14:22:33.675384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:33.676147 [info ] [MainThread]: 
[0m14:22:33.676775 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:22:33.677395 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:33.677395 after 4.18 seconds
[0m14:22:33.677395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002434533E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024344EBA900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024344EBA720>]}
[0m14:22:33.678425 [debug] [MainThread]: Flushing usage events
[0m14:22:34.610199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:14.401626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBE161BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBDD952750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBE055A300>]}


============================== 14:23:14.406370 | fb2c0a8c-6b92-444a-b0aa-9b7ed1ebd71b ==============================
[0m14:23:14.406370 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:14.407485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_transaction', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:14.889717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb2c0a8c-6b92-444a-b0aa-9b7ed1ebd71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBE17DF410>]}
[0m14:23:14.939845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb2c0a8c-6b92-444a-b0aa-9b7ed1ebd71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBE2171A30>]}
[0m14:23:14.954819 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:23:15.279639 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:23:15.438084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:15.438084 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:23:15.640038 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Mini_Project.stg_transaction' (models\Staging\stg_transaction.sql) depends on a source named 'raw.transactions' which was not found
[0m14:23:15.640038 [debug] [MainThread]: Command `dbt run` failed at 14:23:15.640038 after 1.42 seconds
[0m14:23:15.640038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBE132E630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBE0A7FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBE15F4B30>]}
[0m14:23:15.640038 [debug] [MainThread]: Flushing usage events
[0m14:23:16.558992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:50.311608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC2E247D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC2E246B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC2E24500>]}


============================== 14:23:50.316907 | e6c8151c-3086-424b-80fe-9788e5fe8134 ==============================
[0m14:23:50.316907 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:23:50.317267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_transaction', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:50.754501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6c8151c-3086-424b-80fe-9788e5fe8134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC4BAD4F0>]}
[0m14:23:50.814804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6c8151c-3086-424b-80fe-9788e5fe8134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC1E29E80>]}
[0m14:23:50.814804 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:23:51.142626 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:23:51.285563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:51.285563 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:23:51.543183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:23:51.555666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6c8151c-3086-424b-80fe-9788e5fe8134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC4C28B00>]}
[0m14:23:51.630637 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:23:51.634027 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:23:51.659822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6c8151c-3086-424b-80fe-9788e5fe8134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC50E1A30>]}
[0m14:23:51.664953 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:23:51.664953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c8151c-3086-424b-80fe-9788e5fe8134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC29969C0>]}
[0m14:23:51.667330 [info ] [MainThread]: 
[0m14:23:51.667330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:51.667330 [info ] [MainThread]: 
[0m14:23:51.667330 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:51.667330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:23:51.762843 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:23:51.764149 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:23:51.764149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:52.694336 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.937 seconds
[0m14:23:52.710365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:23:52.712405 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:23:52.712405 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:23:52.712405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:53.028038 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.313 seconds
[0m14:23:53.042870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6c8151c-3086-424b-80fe-9788e5fe8134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC4C28590>]}
[0m14:23:53.048040 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:23:53.048040 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:23:53.048040 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:23:53.048040 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:23:53.064487 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:23:53.066530 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:23:53.095028 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:23:53.095028 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:23:53.095028 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fileds as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m14:23:53.095028 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:53.395849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffb5-0001-429a-0008-511e0001bbc2
[0m14:23:53.395849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
[0m14:23:53.411939 [debug] [Thread-1 (]: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m14:23:53.411939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6c8151c-3086-424b-80fe-9788e5fe8134', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC22F0500>]}
[0m14:23:53.411939 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.stg_transaction ....................... [[31mERROR[0m in 0.36s]
[0m14:23:53.411939 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:23:53.411939 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.stg_transaction' to be skipped because of status 'error'.  Reason: Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql.
[0m14:23:53.422786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:53.422786 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:23:53.422786 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:23:53.511408 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:23:53.511408 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:23:53.595960 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:23:53.595960 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:23:53.690156 [info ] [MainThread]: 
[0m14:23:53.692360 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m14:23:53.696956 [debug] [MainThread]: Command end result
[0m14:23:53.791274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:23:53.793568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:23:53.800158 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:23:53.800158 [info ] [MainThread]: 
[0m14:23:53.801448 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:23:53.802146 [info ] [MainThread]: 
[0m14:23:53.802751 [error] [MainThread]:   Database Error in model stg_transaction (models\Staging\stg_transaction.sql)
  002003 (42S02): SQL compilation error:
  Object 'MINI_PROJECT.RAW.REQUIRED_FIELDS' does not exist or not authorized.
  compiled code at target\run\Mini_Project\models\Staging\stg_transaction.sql
[0m14:23:53.803449 [info ] [MainThread]: 
[0m14:23:53.804040 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:23:53.804671 [debug] [MainThread]: Command `dbt run` failed at 14:23:53.804671 after 3.66 seconds
[0m14:23:53.804671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC2C8BE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC0BEE810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CC0BEE870>]}
[0m14:23:53.805701 [debug] [MainThread]: Flushing usage events
[0m14:23:55.023991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:21.917132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F28B4680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F28B45C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F28B44D0>]}


============================== 14:24:21.917132 | 89c3ecfb-b402-4117-b6e5-8fdab75957a6 ==============================
[0m14:24:21.917132 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:24:21.917132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s stg_transaction', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:22.402393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89c3ecfb-b402-4117-b6e5-8fdab75957a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F28B4320>]}
[0m14:24:22.465858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89c3ecfb-b402-4117-b6e5-8fdab75957a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F345D7C0>]}
[0m14:24:22.465858 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:24:22.920895 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:24:24.169879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:24:24.169879 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Staging\stg_transaction.sql
[0m14:24:24.413331 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:24:24.427257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c3ecfb-b402-4117-b6e5-8fdab75957a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F4995BB0>]}
[0m14:24:24.492789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:24:24.508810 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:24:24.525164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c3ecfb-b402-4117-b6e5-8fdab75957a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F4B75880>]}
[0m14:24:24.525164 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:24:24.525164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c3ecfb-b402-4117-b6e5-8fdab75957a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F4662420>]}
[0m14:24:24.525164 [info ] [MainThread]: 
[0m14:24:24.540809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:24.540809 [info ] [MainThread]: 
[0m14:24:24.540809 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:24:24.540809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:24:27.811401 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:24:27.811401 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:24:27.811401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:28.918486 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.107 seconds
[0m14:24:28.927424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:24:28.929167 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:24:28.929167 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:24:28.929167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:29.302631 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.366 seconds
[0m14:24:29.302631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c3ecfb-b402-4117-b6e5-8fdab75957a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F46DA570>]}
[0m14:24:29.315376 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m14:24:29.315376 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.stg_transaction ................................ [RUN]
[0m14:24:29.315376 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_transaction'
[0m14:24:29.315376 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m14:24:29.315376 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m14:24:29.315376 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m14:24:29.356440 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m14:24:29.358448 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m14:24:29.358448 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m14:24:29.358448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:24:30.431613 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.077 seconds
[0m14:24:30.454984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c3ecfb-b402-4117-b6e5-8fdab75957a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F1D80B30>]}
[0m14:24:30.454984 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.stg_transaction ........................... [[32mSUCCESS 1[0m in 1.14s]
[0m14:24:30.454984 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m14:24:30.454984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:30.454984 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:24:30.454984 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:24:30.531996 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:24:30.547757 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:24:30.626392 [debug] [MainThread]: Connection 'model.Mini_Project.stg_transaction' was left open.
[0m14:24:30.626392 [debug] [MainThread]: On model.Mini_Project.stg_transaction: Close
[0m14:24:30.738318 [info ] [MainThread]: 
[0m14:24:30.738318 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m14:24:30.738318 [debug] [MainThread]: Command end result
[0m14:24:30.817415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:24:30.819764 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:24:30.824988 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:24:30.826000 [info ] [MainThread]: 
[0m14:24:30.826444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:30.827158 [info ] [MainThread]: 
[0m14:24:30.827749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:24:30.828391 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:30.828391 after 9.10 seconds
[0m14:24:30.828391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F4F2D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F4F2DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168F494F590>]}
[0m14:24:30.829421 [debug] [MainThread]: Flushing usage events
[0m14:24:31.693976 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:15.750186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD03772C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD03236630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD009883B0>]}


============================== 14:25:15.753539 | fdfe632d-ccf0-4fb1-9eed-1318ba9feb53 ==============================
[0m14:25:15.753539 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:25:15.753539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s master1', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:16.172796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdfe632d-ccf0-4fb1-9eed-1318ba9feb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD043773E0>]}
[0m14:25:16.235494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdfe632d-ccf0-4fb1-9eed-1318ba9feb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD04458D70>]}
[0m14:25:16.235494 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:25:16.548371 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:25:16.704390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:16.704390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:16.710148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:25:16.728933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdfe632d-ccf0-4fb1-9eed-1318ba9feb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0557B440>]}
[0m14:25:16.794723 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:25:16.810590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:25:16.836880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdfe632d-ccf0-4fb1-9eed-1318ba9feb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD057491F0>]}
[0m14:25:16.836880 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:25:16.836880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdfe632d-ccf0-4fb1-9eed-1318ba9feb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD03773830>]}
[0m14:25:16.836880 [info ] [MainThread]: 
[0m14:25:16.841058 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:25:16.841058 [info ] [MainThread]: 
[0m14:25:16.842566 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:25:16.842566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:25:16.932642 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:25:16.932642 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:25:16.933673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:17.727808 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.802 seconds
[0m14:25:17.743534 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:25:17.743534 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:25:17.743534 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:25:17.743534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:18.066279 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.319 seconds
[0m14:25:18.066279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdfe632d-ccf0-4fb1-9eed-1318ba9feb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD05C86360>]}
[0m14:25:18.082372 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m14:25:18.082372 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.master1 ........................................ [RUN]
[0m14:25:18.082372 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.master1'
[0m14:25:18.082372 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m14:25:18.082372 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m14:25:18.082372 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m14:25:18.113867 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m14:25:18.113867 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m14:25:18.113867 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m14:25:18.113867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:18.814055 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m14:25:18.840764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdfe632d-ccf0-4fb1-9eed-1318ba9feb53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0559B890>]}
[0m14:25:18.840764 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.master1 ................................... [[32mSUCCESS 1[0m in 0.76s]
[0m14:25:18.842773 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m14:25:18.842773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:18.842773 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:25:18.842773 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:25:18.920173 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:25:18.920173 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:25:19.012873 [debug] [MainThread]: Connection 'model.Mini_Project.master1' was left open.
[0m14:25:19.012873 [debug] [MainThread]: On model.Mini_Project.master1: Close
[0m14:25:19.090130 [info ] [MainThread]: 
[0m14:25:19.106189 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.25 seconds (2.25s).
[0m14:25:19.106189 [debug] [MainThread]: Command end result
[0m14:25:19.134909 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:25:19.137108 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:25:19.138381 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:25:19.138381 [info ] [MainThread]: 
[0m14:25:19.138381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:19.138381 [info ] [MainThread]: 
[0m14:25:19.146821 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:25:19.147839 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:19.147839 after 3.56 seconds
[0m14:25:19.148680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD037446B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD00DD5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD032B7BF0>]}
[0m14:25:19.148680 [debug] [MainThread]: Flushing usage events
[0m14:25:20.399245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:28.498867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020207362750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020AB07920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020AB071A0>]}


============================== 14:31:28.503454 | 411538e1-ee6f-4483-bdda-f0337815e9a8 ==============================
[0m14:31:28.503454 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:31:28.504452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s rank_customer', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:31:28.968072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '411538e1-ee6f-4483-bdda-f0337815e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020BB5E990>]}
[0m14:31:29.033670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '411538e1-ee6f-4483-bdda-f0337815e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020BC51820>]}
[0m14:31:29.033670 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:31:29.362764 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:31:29.489466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:31:29.489466 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_customer.sql
[0m14:31:29.751131 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:31:29.767823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '411538e1-ee6f-4483-bdda-f0337815e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020D19D760>]}
[0m14:31:29.850675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:31:29.856132 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:31:29.878983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '411538e1-ee6f-4483-bdda-f0337815e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020D2956A0>]}
[0m14:31:29.880216 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:31:29.880900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411538e1-ee6f-4483-bdda-f0337815e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020D1E77D0>]}
[0m14:31:29.881988 [info ] [MainThread]: 
[0m14:31:29.882993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:31:29.882993 [info ] [MainThread]: 
[0m14:31:29.884011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:31:29.884565 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:31:29.970533 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:31:29.970533 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:31:29.971565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:30.902216 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.936 seconds
[0m14:31:30.902216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:31:30.918033 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:31:30.918033 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:31:30.918033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:31:31.402398 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.484 seconds
[0m14:31:31.402398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '411538e1-ee6f-4483-bdda-f0337815e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020D19F170>]}
[0m14:31:31.402398 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:31:31.402398 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:31:31.402398 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:31:31.418168 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:31:31.418168 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:31:31.418168 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:31:31.455126 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:31:31.455126 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:31:31.455126 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    with ranking AS(
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT.RAW.master1
    RANK() OVER (PARTITION BY customer_id ORDER BY total_revenue DESC) AS revenue_rank
    GROUP BY customer_id, customer_name

)
  );
[0m14:31:31.458442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:31:32.071453 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbd-0001-429b-0008-511e00017d32
[0m14:31:32.071453 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 9 unexpected ')'.
syntax error line 10 at position 69 unexpected ')'.
[0m14:31:32.098546 [debug] [Thread-1 (]: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:31:32.102800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '411538e1-ee6f-4483-bdda-f0337815e9a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020A460830>]}
[0m14:31:32.103521 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_customer ......................... [[31mERROR[0m in 0.70s]
[0m14:31:32.103521 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:31:32.103521 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_customer' to be skipped because of status 'error'.  Reason: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql.
[0m14:31:32.103521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:32.103521 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:31:32.103521 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:31:32.187585 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:31:32.188741 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:31:32.269846 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:31:32.269846 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:31:32.348025 [info ] [MainThread]: 
[0m14:31:32.348025 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m14:31:32.364040 [debug] [MainThread]: Command end result
[0m14:31:32.453489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:31:32.455590 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:31:32.460641 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:31:32.461638 [info ] [MainThread]: 
[0m14:31:32.461638 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:31:32.462983 [info ] [MainThread]: 
[0m14:31:32.463584 [error] [MainThread]:   Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:31:32.464290 [info ] [MainThread]: 
[0m14:31:32.464882 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:31:32.465627 [debug] [MainThread]: Command `dbt run` failed at 14:31:32.465627 after 4.14 seconds
[0m14:31:32.465627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020A38C1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020A38D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020208C31DC0>]}
[0m14:31:32.466627 [debug] [MainThread]: Flushing usage events
[0m14:31:33.805035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:04.199661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0BF876B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0BF87500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0BF851F0>]}


============================== 14:32:04.199661 | 8850ae7b-0958-4af1-a730-39bab3a41368 ==============================
[0m14:32:04.199661 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:32:04.199661 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s rank_customer', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:32:04.662485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8850ae7b-0958-4af1-a730-39bab3a41368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0B489370>]}
[0m14:32:04.721930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8850ae7b-0958-4af1-a730-39bab3a41368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0AF4F920>]}
[0m14:32:04.721930 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:32:05.030138 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:32:05.195744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:05.197751 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_customer.sql
[0m14:32:05.425999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:32:05.447385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8850ae7b-0958-4af1-a730-39bab3a41368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0E291E80>]}
[0m14:32:05.504012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:32:05.504012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:32:05.535941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8850ae7b-0958-4af1-a730-39bab3a41368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0E245910>]}
[0m14:32:05.535941 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:32:05.545415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8850ae7b-0958-4af1-a730-39bab3a41368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0E284230>]}
[0m14:32:05.545415 [info ] [MainThread]: 
[0m14:32:05.547458 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:05.547458 [info ] [MainThread]: 
[0m14:32:05.547458 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:05.547458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:32:05.638819 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:32:05.639828 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:32:05.639828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:06.454035 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.818 seconds
[0m14:32:06.454035 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:32:06.467805 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:32:06.467805 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:32:06.467805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:06.924197 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.458 seconds
[0m14:32:06.939889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8850ae7b-0958-4af1-a730-39bab3a41368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0DD9AB70>]}
[0m14:32:06.939889 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:32:06.939889 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:32:06.939889 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:32:06.939889 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:32:06.939889 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:32:06.939889 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:32:06.972760 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:32:06.972760 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:32:06.972760 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    with ranking AS(
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT.RAW.master1
    RANK() OVER (PARTITION BY customer_id ORDER BY total_revenue DESC) AS revenue_rank
    GROUP BY customer_id, customer_name

)
SELECT * FROM ranking
  );
[0m14:32:06.972760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:07.302373 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbe-0001-429e-0008-511e0001d51a
[0m14:32:07.302373 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 9 unexpected ')'.
syntax error line 10 at position 69 unexpected ')'.
[0m14:32:07.306390 [debug] [Thread-1 (]: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:32:07.306390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8850ae7b-0958-4af1-a730-39bab3a41368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0E8132C0>]}
[0m14:32:07.306390 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_customer ......................... [[31mERROR[0m in 0.37s]
[0m14:32:07.306390 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:32:07.306390 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_customer' to be skipped because of status 'error'.  Reason: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql.
[0m14:32:07.311212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:07.311212 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:32:07.311212 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:32:07.389602 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:32:07.389602 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:32:07.472146 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:32:07.472146 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:32:07.573204 [info ] [MainThread]: 
[0m14:32:07.576484 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m14:32:07.579833 [debug] [MainThread]: Command end result
[0m14:32:07.672028 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:32:07.674377 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:32:07.681416 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:32:07.681416 [info ] [MainThread]: 
[0m14:32:07.682521 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:07.683590 [info ] [MainThread]: 
[0m14:32:07.683590 [error] [MainThread]:   Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:32:07.684879 [info ] [MainThread]: 
[0m14:32:07.684879 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:07.686222 [debug] [MainThread]: Command `dbt run` failed at 14:32:07.686222 after 3.64 seconds
[0m14:32:07.686222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0E0723F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0E070290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB0E071730>]}
[0m14:32:07.687406 [debug] [MainThread]: Flushing usage events
[0m14:32:08.638933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:53.344185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022704297740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022706117E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022705E0C4A0>]}


============================== 14:32:53.344185 | ec86ccb3-970c-4668-8d47-fc3af3899971 ==============================
[0m14:32:53.344185 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:32:53.344185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s rank_customer', 'send_anonymous_usage_stats': 'True'}
[0m14:32:53.920716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec86ccb3-970c-4668-8d47-fc3af3899971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022706117E30>]}
[0m14:32:53.987174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec86ccb3-970c-4668-8d47-fc3af3899971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227042B67B0>]}
[0m14:32:53.987174 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:32:54.354191 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:32:54.520796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:54.520796 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_customer.sql
[0m14:32:54.770361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:32:54.792120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec86ccb3-970c-4668-8d47-fc3af3899971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022708935D00>]}
[0m14:32:54.867257 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:32:54.871087 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:32:54.897127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec86ccb3-970c-4668-8d47-fc3af3899971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227088E9790>]}
[0m14:32:54.898605 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:32:54.899124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec86ccb3-970c-4668-8d47-fc3af3899971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022707360650>]}
[0m14:32:54.900209 [info ] [MainThread]: 
[0m14:32:54.901238 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:54.901238 [info ] [MainThread]: 
[0m14:32:54.902831 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:32:54.903806 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:32:54.993497 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:32:54.993497 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:32:54.994880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:55.774451 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.780 seconds
[0m14:32:55.780913 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:32:55.791362 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:32:55.791362 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:32:55.791362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:56.228751 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.437 seconds
[0m14:32:56.228751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec86ccb3-970c-4668-8d47-fc3af3899971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227085C8B00>]}
[0m14:32:56.240536 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:32:56.240536 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:32:56.240536 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:32:56.240536 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:32:56.258067 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:32:56.260116 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:32:56.290580 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:32:56.293287 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:32:56.293287 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    with ranking AS(
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue
    FROM MINI_PROJECT.RAW.master1
    RANK() OVER (PARTITION BY customer_id ORDER BY total_revenue DESC) AS revenue_rank
    GROUP BY customer_id, customer_name
)
SELECT * FROM ranking
  );
[0m14:32:56.293287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:56.588534 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbe-0001-429a-0008-511e0001bc4e
[0m14:32:56.588534 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 9 unexpected ')'.
syntax error line 10 at position 69 unexpected ')'.
[0m14:32:56.607157 [debug] [Thread-1 (]: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:32:56.609166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec86ccb3-970c-4668-8d47-fc3af3899971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022708F30500>]}
[0m14:32:56.609166 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_customer ......................... [[31mERROR[0m in 0.37s]
[0m14:32:56.611174 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:32:56.611174 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_customer' to be skipped because of status 'error'.  Reason: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql.
[0m14:32:56.611174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:56.611174 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:32:56.611174 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:32:56.694996 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:32:56.695994 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:32:56.775532 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:32:56.775532 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:32:56.856314 [info ] [MainThread]: 
[0m14:32:56.856314 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m14:32:56.856314 [debug] [MainThread]: Command end result
[0m14:32:56.939345 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:32:56.946458 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:32:56.946458 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:32:56.946458 [info ] [MainThread]: 
[0m14:32:56.946458 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:56.954521 [info ] [MainThread]: 
[0m14:32:56.955710 [error] [MainThread]:   Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 9 unexpected ')'.
  syntax error line 10 at position 69 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:32:56.955710 [info ] [MainThread]: 
[0m14:32:56.956878 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:56.957524 [debug] [MainThread]: Command `dbt run` failed at 14:32:56.957524 after 3.77 seconds
[0m14:32:56.957524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227087ED490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227087ECBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227087EDAC0>]}
[0m14:32:56.958556 [debug] [MainThread]: Flushing usage events
[0m14:32:57.892444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:37.767369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F731287EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F731287920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F731286AB0>]}


============================== 14:33:37.785149 | aa7f2141-9e73-4f5e-902f-565b5cf095d2 ==============================
[0m14:33:37.785149 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:33:37.785149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s rank_customer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:33:38.263957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa7f2141-9e73-4f5e-902f-565b5cf095d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F73228CB00>]}
[0m14:33:38.334634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa7f2141-9e73-4f5e-902f-565b5cf095d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7310BBE30>]}
[0m14:33:38.334634 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:33:38.649210 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:33:38.781189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:38.781189 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_customer.sql
[0m14:33:39.030634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:33:39.049627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa7f2141-9e73-4f5e-902f-565b5cf095d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733A15D90>]}
[0m14:33:39.120290 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:33:39.123635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:33:39.147238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa7f2141-9e73-4f5e-902f-565b5cf095d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7339C9970>]}
[0m14:33:39.149743 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:33:39.149743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa7f2141-9e73-4f5e-902f-565b5cf095d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7339FFB90>]}
[0m14:33:39.152269 [info ] [MainThread]: 
[0m14:33:39.152269 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:39.152269 [info ] [MainThread]: 
[0m14:33:39.152269 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:39.152269 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:33:39.244744 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:33:39.245777 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:33:39.245777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:40.488199 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.244 seconds
[0m14:33:40.496228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:33:40.504512 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:33:40.504512 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:33:40.504512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:40.823181 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.313 seconds
[0m14:33:40.826636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa7f2141-9e73-4f5e-902f-565b5cf095d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733EBC620>]}
[0m14:33:40.830522 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:33:40.831812 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:33:40.832816 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:33:40.833158 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:33:40.839963 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:33:40.840995 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:33:40.872388 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:33:40.875086 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:33:40.875086 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
)
SELECT * FROM ranking;
[0m14:33:40.875086 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:33:41.308070 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffbf-0001-429b-0008-511e00017d36
[0m14:33:41.308070 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 21 unexpected ';'.
[0m14:33:41.308070 [debug] [Thread-1 (]: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:33:41.323965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa7f2141-9e73-4f5e-902f-565b5cf095d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F733A0BEC0>]}
[0m14:33:41.323965 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_customer ......................... [[31mERROR[0m in 0.48s]
[0m14:33:41.325974 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:33:41.325974 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_customer' to be skipped because of status 'error'.  Reason: Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql.
[0m14:33:41.325974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:41.325974 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:33:41.325974 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:33:41.409144 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:33:41.409144 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:33:41.493973 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:33:41.495988 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:33:41.576887 [info ] [MainThread]: 
[0m14:33:41.576887 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m14:33:41.587713 [debug] [MainThread]: Command end result
[0m14:33:41.676227 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:33:41.678611 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:33:41.684921 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:33:41.684921 [info ] [MainThread]: 
[0m14:33:41.685968 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:33:41.686830 [info ] [MainThread]: 
[0m14:33:41.687479 [error] [MainThread]:   Database Error in model rank_customer (models\Mart\rank_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_customer.sql
[0m14:33:41.688195 [info ] [MainThread]: 
[0m14:33:41.688819 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:33:41.689435 [debug] [MainThread]: Command `dbt run` failed at 14:33:41.689435 after 4.11 seconds
[0m14:33:41.689435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7337F16A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7337F0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7337F2570>]}
[0m14:33:41.690465 [debug] [MainThread]: Flushing usage events
[0m14:33:43.082017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:49.924731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FFD241EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F8240F920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F8240F890>]}


============================== 14:33:49.935796 | 55d5655a-a1ef-4814-988c-0718e04f4004 ==============================
[0m14:33:49.935796 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:33:49.935796 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s rank_customer', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:50.380133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55d5655a-a1ef-4814-988c-0718e04f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F8301A900>]}
[0m14:33:50.425887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55d5655a-a1ef-4814-988c-0718e04f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F83DBFC50>]}
[0m14:33:50.441517 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:33:50.905653 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:33:51.069935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:51.069935 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_customer.sql
[0m14:33:51.339312 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:33:51.351727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55d5655a-a1ef-4814-988c-0718e04f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F853E1AF0>]}
[0m14:33:51.410378 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:33:51.426128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:33:51.441970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55d5655a-a1ef-4814-988c-0718e04f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F85395910>]}
[0m14:33:51.441970 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:33:51.441970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d5655a-a1ef-4814-988c-0718e04f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F8529F680>]}
[0m14:33:51.457801 [info ] [MainThread]: 
[0m14:33:51.457801 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:51.457801 [info ] [MainThread]: 
[0m14:33:51.457801 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:33:51.457801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:33:51.563413 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:33:51.563413 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:33:51.564680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:52.047212 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.483 seconds
[0m14:33:52.047212 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:33:52.063064 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:33:52.063064 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:33:52.063064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:52.537341 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.468 seconds
[0m14:33:52.539351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55d5655a-a1ef-4814-988c-0718e04f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F84EEAC90>]}
[0m14:33:52.539351 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:33:52.550797 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:33:52.550797 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:33:52.550797 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:33:52.550797 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:33:52.550797 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:33:52.577817 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:33:52.577817 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:33:52.577817 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
)
SELECT * FROM ranking
  );
[0m14:33:52.577817 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:33:53.118023 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m14:33:53.149901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55d5655a-a1ef-4814-988c-0718e04f4004', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FFFBF19A0>]}
[0m14:33:53.149901 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_customer ............................. [[32mSUCCESS 1[0m in 0.60s]
[0m14:33:53.149901 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:33:53.149901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:53.149901 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:33:53.149901 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:33:53.234325 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:33:53.244417 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:33:53.328994 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:33:53.330031 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:33:53.409415 [info ] [MainThread]: 
[0m14:33:53.409415 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m14:33:53.409415 [debug] [MainThread]: Command end result
[0m14:33:53.496355 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:33:53.497427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:33:53.504294 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:33:53.504294 [info ] [MainThread]: 
[0m14:33:53.505073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:33:53.505881 [info ] [MainThread]: 
[0m14:33:53.506469 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:33:53.507501 [debug] [MainThread]: Command `dbt run` succeeded at 14:33:53.507501 after 3.74 seconds
[0m14:33:53.507501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019FFD241EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F8247A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F82925100>]}
[0m14:33:53.507501 [debug] [MainThread]: Flushing usage events
[0m14:33:54.412248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:26.375562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3E5DE7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3E5DE3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3CF8E630>]}


============================== 14:35:26.385912 | 28e91b11-2b6e-4e86-beb5-4627f3a66971 ==============================
[0m14:35:26.385912 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:35:26.385912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s rank_customer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:26.812271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28e91b11-2b6e-4e86-beb5-4627f3a66971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3FE62390>]}
[0m14:35:26.860105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28e91b11-2b6e-4e86-beb5-4627f3a66971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3CE433B0>]}
[0m14:35:26.860105 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:35:27.188071 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:35:27.345283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:27.345283 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_customer.sql
[0m14:35:27.597999 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:35:27.612211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28e91b11-2b6e-4e86-beb5-4627f3a66971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C40FCAF00>]}
[0m14:35:27.676905 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:35:27.676905 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:35:27.712612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28e91b11-2b6e-4e86-beb5-4627f3a66971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C41475BB0>]}
[0m14:35:27.712612 [info ] [MainThread]: Found 7 models, 4 sources, 474 macros
[0m14:35:27.713461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e91b11-2b6e-4e86-beb5-4627f3a66971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C414C1D90>]}
[0m14:35:27.714546 [info ] [MainThread]: 
[0m14:35:27.715670 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:27.716277 [info ] [MainThread]: 
[0m14:35:27.716861 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:35:27.717990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:35:27.805597 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:35:27.806676 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:35:27.806676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:28.737779 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.937 seconds
[0m14:35:28.752558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:35:28.757407 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:35:28.757407 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:35:28.757407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:29.275537 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.512 seconds
[0m14:35:29.279775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28e91b11-2b6e-4e86-beb5-4627f3a66971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C414B8470>]}
[0m14:35:29.283238 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:35:29.284240 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:35:29.284240 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:35:29.285746 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:35:29.293089 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:35:29.294582 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:35:29.323390 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:35:29.324780 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:35:29.324780 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
  );
[0m14:35:29.324780 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:35:29.856511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m14:35:29.883412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28e91b11-2b6e-4e86-beb5-4627f3a66971', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3E6802F0>]}
[0m14:35:29.883412 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_customer ............................. [[32mSUCCESS 1[0m in 0.60s]
[0m14:35:29.883412 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:35:29.888422 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:29.888422 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:35:29.888422 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:35:29.991292 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:35:29.991292 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:35:30.087897 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:35:30.087897 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:35:30.169173 [info ] [MainThread]: 
[0m14:35:30.169173 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m14:35:30.184374 [debug] [MainThread]: Command end result
[0m14:35:30.275731 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:35:30.277800 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:35:30.283125 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:35:30.283125 [info ] [MainThread]: 
[0m14:35:30.284663 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:30.285678 [info ] [MainThread]: 
[0m14:35:30.286258 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:35:30.286902 [debug] [MainThread]: Command `dbt run` succeeded at 14:35:30.286902 after 4.07 seconds
[0m14:35:30.286902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C3E89DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C41461790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C41460050>]}
[0m14:35:30.287931 [debug] [MainThread]: Flushing usage events
[0m14:35:31.192259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:49.590934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3F4184A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3F4183E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3F418260>]}


============================== 14:38:49.603651 | 1ce58eac-8353-42ff-b521-1ccbd5b7897e ==============================
[0m14:38:49.603651 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:38:49.604657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s rank_customer', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:50.088657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce58eac-8353-42ff-b521-1ccbd5b7897e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB4017F3E0>]}
[0m14:38:50.152802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce58eac-8353-42ff-b521-1ccbd5b7897e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3CB3BE60>]}
[0m14:38:50.152802 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:38:50.510338 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:38:50.671737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:38:50.671737 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\rank_products.sql
[0m14:38:50.941192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:38:50.956875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce58eac-8353-42ff-b521-1ccbd5b7897e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB412E7290>]}
[0m14:38:51.035913 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:38:51.039041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:38:51.090285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce58eac-8353-42ff-b521-1ccbd5b7897e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB41759A90>]}
[0m14:38:51.090285 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:38:51.090285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce58eac-8353-42ff-b521-1ccbd5b7897e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB41791040>]}
[0m14:38:51.097471 [info ] [MainThread]: 
[0m14:38:51.097471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:51.097471 [info ] [MainThread]: 
[0m14:38:51.100195 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:38:51.101500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:38:51.208474 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:38:51.208474 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:38:51.208474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:52.820162 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.603 seconds
[0m14:38:52.825586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:38:52.837986 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:38:52.837986 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:38:52.838984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:53.148192 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.310 seconds
[0m14:38:53.158279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce58eac-8353-42ff-b521-1ccbd5b7897e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB41B3E3F0>]}
[0m14:38:53.165169 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:38:53.166182 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:38:53.166182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:38:53.167400 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:38:53.176311 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:38:53.178370 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:38:53.215266 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:38:53.228142 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:38:53.231137 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
  );
[0m14:38:53.232143 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:38:53.680296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.449 seconds
[0m14:38:53.724056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce58eac-8353-42ff-b521-1ccbd5b7897e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3E8E0AA0>]}
[0m14:38:53.724056 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_customer ............................. [[32mSUCCESS 1[0m in 0.56s]
[0m14:38:53.725177 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:38:53.726582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:53.727583 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:38:53.727583 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:38:53.816065 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:38:53.816065 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:38:53.895609 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:38:53.895609 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:38:53.974467 [info ] [MainThread]: 
[0m14:38:53.974467 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m14:38:53.974467 [debug] [MainThread]: Command end result
[0m14:38:54.067467 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:38:54.069787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:38:54.075771 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:38:54.075771 [info ] [MainThread]: 
[0m14:38:54.077091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:38:54.077091 [info ] [MainThread]: 
[0m14:38:54.078375 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:38:54.079470 [debug] [MainThread]: Command `dbt run` succeeded at 14:38:54.078375 after 4.66 seconds
[0m14:38:54.079470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3E80D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB417932F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB41791040>]}
[0m14:38:54.079470 [debug] [MainThread]: Flushing usage events
[0m14:38:55.371703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:29.081597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E089176F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E089176F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0891744A0>]}


============================== 14:39:29.081597 | 88b9725b-6f16-4b80-8a38-12ac276612bf ==============================
[0m14:39:29.081597 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:39:29.081597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s rank_customer', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:29.567819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b9725b-6f16-4b80-8a38-12ac276612bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E089659BB0>]}
[0m14:39:29.632885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88b9725b-6f16-4b80-8a38-12ac276612bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08A3DE090>]}
[0m14:39:29.632885 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:39:30.061765 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:39:31.375668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:31.375668 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:39:31.622803 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:39:31.639313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b9725b-6f16-4b80-8a38-12ac276612bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08B9B62A0>]}
[0m14:39:31.699792 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:39:31.715495 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:39:31.747337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b9725b-6f16-4b80-8a38-12ac276612bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08B975E20>]}
[0m14:39:31.747337 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:39:31.747337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b9725b-6f16-4b80-8a38-12ac276612bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E088B39F70>]}
[0m14:39:31.747337 [info ] [MainThread]: 
[0m14:39:31.747337 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:39:31.747337 [info ] [MainThread]: 
[0m14:39:31.747337 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:31.747337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:39:34.609605 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:39:34.609605 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:39:34.609605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:35.646995 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.033 seconds
[0m14:39:35.650757 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:39:35.662898 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:39:35.662898 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:39:35.662898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:35.989169 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.333 seconds
[0m14:39:36.005008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b9725b-6f16-4b80-8a38-12ac276612bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08BE40B90>]}
[0m14:39:36.005008 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m14:39:36.005008 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_customer .................................. [RUN]
[0m14:39:36.005008 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m14:39:36.005008 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m14:39:36.005008 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m14:39:36.005008 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m14:39:36.039854 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m14:39:36.039854 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m14:39:36.039854 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace   view MINI_PROJECT.RAW.rank_customer
  
   as (
    WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
  );
[0m14:39:36.039854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:36.683841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m14:39:36.703289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b9725b-6f16-4b80-8a38-12ac276612bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E088B006E0>]}
[0m14:39:36.703289 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_customer ............................. [[32mSUCCESS 1[0m in 0.70s]
[0m14:39:36.703289 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m14:39:36.703289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:36.703289 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:39:36.703289 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:39:36.804361 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:39:36.804361 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:39:36.868375 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m14:39:36.868375 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m14:39:36.962827 [info ] [MainThread]: 
[0m14:39:36.964576 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.22 seconds (5.22s).
[0m14:39:36.968460 [debug] [MainThread]: Command end result
[0m14:39:37.054404 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:39:37.055843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:39:37.061157 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:39:37.062518 [info ] [MainThread]: 
[0m14:39:37.062518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:37.063669 [info ] [MainThread]: 
[0m14:39:37.064455 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:39:37.065091 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:37.065091 after 8.18 seconds
[0m14:39:37.065091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0871C0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0871C1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E089858B00>]}
[0m14:39:37.066121 [debug] [MainThread]: Flushing usage events
[0m14:39:37.967245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:11.056936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB18FE8F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB18FE8EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB18FE8230>]}


============================== 14:40:11.056936 | 1464f48e-3cde-425c-80d2-f0a12fb61933 ==============================
[0m14:40:11.056936 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:40:11.056936 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s rank_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:40:11.507217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1464f48e-3cde-425c-80d2-f0a12fb61933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB192036E0>]}
[0m14:40:11.576336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1464f48e-3cde-425c-80d2-f0a12fb61933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB18966AB0>]}
[0m14:40:11.576336 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:40:11.898896 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:40:12.041348 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:12.041348 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:12.057182 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:40:12.080163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1464f48e-3cde-425c-80d2-f0a12fb61933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB1AE8A9C0>]}
[0m14:40:12.156758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:40:12.156758 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:40:12.184346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1464f48e-3cde-425c-80d2-f0a12fb61933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB1B0CA240>]}
[0m14:40:12.184346 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:40:12.184346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1464f48e-3cde-425c-80d2-f0a12fb61933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB1B018410>]}
[0m14:40:12.188274 [info ] [MainThread]: 
[0m14:40:12.188274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:12.188274 [info ] [MainThread]: 
[0m14:40:12.188274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:12.188274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:40:12.278653 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:40:12.278653 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:40:12.278653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:13.182033 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.906 seconds
[0m14:40:13.191126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:40:13.191126 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:40:13.191126 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:40:13.191126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:13.637053 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.435 seconds
[0m14:40:13.648324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1464f48e-3cde-425c-80d2-f0a12fb61933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB1847E090>]}
[0m14:40:13.657203 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:40:13.658845 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:40:13.661161 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:40:13.662200 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:40:13.663595 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:40:13.663595 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:40:13.696015 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:40:13.696015 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:40:13.696015 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        product_family
        
    
        SUM(revenue) AS total_revenue,
        RANK() OVER (PARTITION BY(product_family) ORDER BY(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, product_family
  
)
SELECT * FROM ranking
  );
[0m14:40:13.696015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:14.153257 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc6-0001-429a-0008-511e0001bd96
[0m14:40:14.153257 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 11 unexpected '('.
syntax error line 10 at position 12 unexpected 'revenue'.
syntax error line 10 at position 21 unexpected 'AS'.
syntax error line 11 at position 72 unexpected ')'.
[0m14:40:14.167614 [debug] [Thread-1 (]: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 11 unexpected '('.
  syntax error line 10 at position 12 unexpected 'revenue'.
  syntax error line 10 at position 21 unexpected 'AS'.
  syntax error line 11 at position 72 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:40:14.169622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1464f48e-3cde-425c-80d2-f0a12fb61933', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB184C0B30>]}
[0m14:40:14.169622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_products ......................... [[31mERROR[0m in 0.51s]
[0m14:40:14.169622 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:40:14.169622 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_products' to be skipped because of status 'error'.  Reason: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 11 unexpected '('.
  syntax error line 10 at position 12 unexpected 'revenue'.
  syntax error line 10 at position 21 unexpected 'AS'.
  syntax error line 11 at position 72 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql.
[0m14:40:14.173741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:14.173741 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:40:14.173741 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:40:14.262992 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:40:14.262992 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:40:14.356283 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:40:14.356283 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:40:14.460715 [info ] [MainThread]: 
[0m14:40:14.461763 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m14:40:14.462260 [debug] [MainThread]: Command end result
[0m14:40:14.485490 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:40:14.488370 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:40:14.494202 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:40:14.494202 [info ] [MainThread]: 
[0m14:40:14.496281 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:40:14.496281 [info ] [MainThread]: 
[0m14:40:14.497315 [error] [MainThread]:   Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 11 unexpected '('.
  syntax error line 10 at position 12 unexpected 'revenue'.
  syntax error line 10 at position 21 unexpected 'AS'.
  syntax error line 11 at position 72 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:40:14.498217 [info ] [MainThread]: 
[0m14:40:14.498217 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:40:14.499236 [debug] [MainThread]: Command `dbt run` failed at 14:40:14.499236 after 3.60 seconds
[0m14:40:14.499236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB19CF3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB19AF0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB1B0CA240>]}
[0m14:40:14.499236 [debug] [MainThread]: Flushing usage events
[0m14:40:15.410248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:34.193021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E06535280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E065341A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E065346B0>]}


============================== 14:40:34.195088 | 33444cbe-ca05-4f75-a535-0ed61f1276ef ==============================
[0m14:40:34.195088 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:40:34.195088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s rank_products', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:34.660942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33444cbe-ca05-4f75-a535-0ed61f1276ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0708FF80>]}
[0m14:40:34.727182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33444cbe-ca05-4f75-a535-0ed61f1276ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E06F6BE00>]}
[0m14:40:34.728803 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:40:35.054003 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:40:35.192037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:35.192037 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:40:35.446596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:40:35.464951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33444cbe-ca05-4f75-a535-0ed61f1276ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0871D760>]}
[0m14:40:35.537299 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:40:35.541345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:40:35.565861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33444cbe-ca05-4f75-a535-0ed61f1276ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E08821E20>]}
[0m14:40:35.567872 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:40:35.567872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33444cbe-ca05-4f75-a535-0ed61f1276ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E0885ADE0>]}
[0m14:40:35.567872 [info ] [MainThread]: 
[0m14:40:35.567872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:35.567872 [info ] [MainThread]: 
[0m14:40:35.567872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:35.567872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:40:35.661359 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:40:35.661359 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:40:35.662356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:36.598239 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.938 seconds
[0m14:40:36.606638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:40:36.614512 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:40:36.614512 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:40:36.614512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:37.048292 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.435 seconds
[0m14:40:37.048292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33444cbe-ca05-4f75-a535-0ed61f1276ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E08C7AE10>]}
[0m14:40:37.061690 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:40:37.061690 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:40:37.061690 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:40:37.061690 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:40:37.061690 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:40:37.061690 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:40:37.099064 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:40:37.099064 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:40:37.099064 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        product_family,
        SUM(revenue) AS total_revenue,
        RANK() OVER (PARTITION BY(product_family) ORDER BY(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, product_family
  
)
SELECT * FROM ranking
  );
[0m14:40:37.099064 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:37.508803 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc6-0001-429b-0008-511e00017e2e
[0m14:40:37.508803 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[MASTER1.REVENUE] is not a valid group by expression
[0m14:40:37.524897 [debug] [Thread-1 (]: Database Error in model rank_products (models\Mart\rank_products.sql)
  000979 (42601): SQL compilation error:
  [MASTER1.REVENUE] is not a valid group by expression
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:40:37.524897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33444cbe-ca05-4f75-a535-0ed61f1276ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E05A00500>]}
[0m14:40:37.524897 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_products ......................... [[31mERROR[0m in 0.46s]
[0m14:40:37.524897 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:40:37.524897 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_products' to be skipped because of status 'error'.  Reason: Database Error in model rank_products (models\Mart\rank_products.sql)
  000979 (42601): SQL compilation error:
  [MASTER1.REVENUE] is not a valid group by expression
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql.
[0m14:40:37.524897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:37.524897 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:40:37.524897 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:40:37.615343 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:40:37.615343 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:40:37.711863 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:40:37.711863 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:40:37.792701 [info ] [MainThread]: 
[0m14:40:37.792701 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m14:40:37.792701 [debug] [MainThread]: Command end result
[0m14:40:37.887944 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:40:37.888976 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:40:37.895471 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:40:37.895471 [info ] [MainThread]: 
[0m14:40:37.896659 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:40:37.897712 [info ] [MainThread]: 
[0m14:40:37.897712 [error] [MainThread]:   Database Error in model rank_products (models\Mart\rank_products.sql)
  000979 (42601): SQL compilation error:
  [MASTER1.REVENUE] is not a valid group by expression
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:40:37.898584 [info ] [MainThread]: 
[0m14:40:37.899695 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:40:37.900347 [debug] [MainThread]: Command `dbt run` failed at 14:40:37.900347 after 3.88 seconds
[0m14:40:37.901377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E059BDF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E086FF260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E086FC890>]}
[0m14:40:37.901377 [debug] [MainThread]: Flushing usage events
[0m14:40:38.800144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:02.971767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8B6CBE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8B6CB560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8B6CA420>]}


============================== 14:41:02.985852 | 376e6b79-a681-42fa-a5e3-753749186f31 ==============================
[0m14:41:02.985852 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:41:02.986678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s rank_products', 'send_anonymous_usage_stats': 'True'}
[0m14:41:03.422983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '376e6b79-a681-42fa-a5e3-753749186f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8B74F740>]}
[0m14:41:03.470441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '376e6b79-a681-42fa-a5e3-753749186f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8C33E2D0>]}
[0m14:41:03.470441 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:41:03.798199 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:41:03.942492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:03.942492 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:41:04.191679 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:41:04.191679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '376e6b79-a681-42fa-a5e3-753749186f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8D5CAF00>]}
[0m14:41:04.272537 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:41:04.276049 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:41:04.291869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '376e6b79-a681-42fa-a5e3-753749186f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8DA41BB0>]}
[0m14:41:04.291869 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:41:04.291869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376e6b79-a681-42fa-a5e3-753749186f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8D840DA0>]}
[0m14:41:04.291869 [info ] [MainThread]: 
[0m14:41:04.291869 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:04.291869 [info ] [MainThread]: 
[0m14:41:04.291869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:04.291869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:41:04.395182 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:41:04.395182 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:41:04.395182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:05.273595 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.879 seconds
[0m14:41:05.279347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:41:05.287375 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:41:05.291051 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:41:05.291051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:05.711484 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.424 seconds
[0m14:41:05.721314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376e6b79-a681-42fa-a5e3-753749186f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B893B6B70>]}
[0m14:41:05.721314 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:41:05.721314 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:41:05.721314 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:41:05.721314 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:41:05.741326 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:41:05.741326 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:41:05.761183 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:41:05.761183 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:41:05.761183 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        product_family,
        SUM(revenue) AS total_revenue,
        RANK() OVER (PARTITION BY(product_family) ORDER BY(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id, product_family
  
)
SELECT * FROM ranking
  );
[0m14:41:05.761183 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:06.186674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc7-0001-429e-0008-511e0001d64e
[0m14:41:06.186674 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[MASTER1.REVENUE] is not a valid group by expression
[0m14:41:06.190690 [debug] [Thread-1 (]: Database Error in model rank_products (models\Mart\rank_products.sql)
  000979 (42601): SQL compilation error:
  [MASTER1.REVENUE] is not a valid group by expression
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:41:06.192698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376e6b79-a681-42fa-a5e3-753749186f31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8AB709E0>]}
[0m14:41:06.192698 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_products ......................... [[31mERROR[0m in 0.47s]
[0m14:41:06.192698 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:41:06.192698 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_products' to be skipped because of status 'error'.  Reason: Database Error in model rank_products (models\Mart\rank_products.sql)
  000979 (42601): SQL compilation error:
  [MASTER1.REVENUE] is not a valid group by expression
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql.
[0m14:41:06.192698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:06.192698 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:41:06.192698 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:41:06.284343 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:41:06.284343 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:41:06.374557 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:41:06.374557 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:41:06.457748 [info ] [MainThread]: 
[0m14:41:06.457748 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.17 seconds (2.17s).
[0m14:41:06.457748 [debug] [MainThread]: Command end result
[0m14:41:06.557656 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:41:06.559230 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:41:06.565097 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:41:06.565097 [info ] [MainThread]: 
[0m14:41:06.566350 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:41:06.567136 [info ] [MainThread]: 
[0m14:41:06.567750 [error] [MainThread]:   Database Error in model rank_products (models\Mart\rank_products.sql)
  000979 (42601): SQL compilation error:
  [MASTER1.REVENUE] is not a valid group by expression
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:41:06.568453 [info ] [MainThread]: 
[0m14:41:06.568998 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:41:06.569681 [debug] [MainThread]: Command `dbt run` failed at 14:41:06.569681 after 3.75 seconds
[0m14:41:06.569681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8D921BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8D920920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B8D922E70>]}
[0m14:41:06.570818 [debug] [MainThread]: Flushing usage events
[0m14:41:07.861911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:11.944039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871C9B2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871FF5E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871FF5F560>]}


============================== 14:42:11.946519 | 57a68b54-4fd6-43f9-a41f-9294543c6a31 ==============================
[0m14:42:11.946519 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:42:11.946519 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s rank_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:12.427092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57a68b54-4fd6-43f9-a41f-9294543c6a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872067BAA0>]}
[0m14:42:12.494820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57a68b54-4fd6-43f9-a41f-9294543c6a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187206379B0>]}
[0m14:42:12.494820 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:42:12.843975 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:42:12.994667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:12.994667 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:42:13.322669 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:42:13.348950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57a68b54-4fd6-43f9-a41f-9294543c6a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187229E60F0>]}
[0m14:42:13.444961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:42:13.447544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:42:13.481246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57a68b54-4fd6-43f9-a41f-9294543c6a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018722991D30>]}
[0m14:42:13.483258 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:42:13.485269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57a68b54-4fd6-43f9-a41f-9294543c6a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187229E7440>]}
[0m14:42:13.487281 [info ] [MainThread]: 
[0m14:42:13.489289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:13.489289 [info ] [MainThread]: 
[0m14:42:13.491297 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:13.493038 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:42:13.595691 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:42:13.596689 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:42:13.596689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:14.451014 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.854 seconds
[0m14:42:14.465428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:42:14.487530 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:42:14.488527 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:42:14.488527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:14.745811 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.267 seconds
[0m14:42:14.745811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57a68b54-4fd6-43f9-a41f-9294543c6a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187228D0410>]}
[0m14:42:14.763124 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:42:14.763124 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:42:14.763124 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:42:14.763124 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:42:14.773217 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:42:14.773217 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:42:14.797801 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:42:14.797801 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:42:14.797801 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        product_family,
        SUM(revenue) AS total_revenue,
        RANK() OVER (PARTITION BY product_family ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id, product_family
)
SELECT * FROM ranking;
[0m14:42:14.797801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:15.262294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffc8-0001-429a-0008-511e0001bd9e
[0m14:42:15.262294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 21 unexpected ';'.
[0m14:42:15.262294 [debug] [Thread-1 (]: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:42:15.273630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57a68b54-4fd6-43f9-a41f-9294543c6a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018722E12330>]}
[0m14:42:15.273630 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_products ......................... [[31mERROR[0m in 0.50s]
[0m14:42:15.273630 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:42:15.273630 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_products' to be skipped because of status 'error'.  Reason: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql.
[0m14:42:15.273630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:15.273630 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:42:15.273630 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:42:15.352140 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:42:15.352140 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:42:15.427680 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:42:15.427680 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:42:15.545800 [info ] [MainThread]: 
[0m14:42:15.551266 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m14:42:15.551266 [debug] [MainThread]: Command end result
[0m14:42:15.631003 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:42:15.633178 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:42:15.639420 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:42:15.639420 [info ] [MainThread]: 
[0m14:42:15.640488 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:42:15.640488 [info ] [MainThread]: 
[0m14:42:15.641659 [error] [MainThread]:   Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:42:15.641659 [info ] [MainThread]: 
[0m14:42:15.642698 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:42:15.642698 [debug] [MainThread]: Command `dbt run` failed at 14:42:15.642698 after 3.89 seconds
[0m14:42:15.643753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001871FE1BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187228513A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187228532C0>]}
[0m14:42:15.643753 [debug] [MainThread]: Flushing usage events
[0m14:42:16.919009 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:23.862981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D94A452B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D94A45040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D94A44560>]}


============================== 14:42:23.870325 | eefb9994-6b5e-4d65-a1f5-128e7aa231ab ==============================
[0m14:42:23.870325 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:42:23.870926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s rank_products', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:24.297516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eefb9994-6b5e-4d65-a1f5-128e7aa231ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D94943860>]}
[0m14:42:24.361666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eefb9994-6b5e-4d65-a1f5-128e7aa231ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D957EB9B0>]}
[0m14:42:24.361666 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:42:24.678420 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:42:24.836221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:24.836221 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:42:25.075059 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:42:25.080116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eefb9994-6b5e-4d65-a1f5-128e7aa231ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D96DE6210>]}
[0m14:42:25.156554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:42:25.156554 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:42:25.175172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eefb9994-6b5e-4d65-a1f5-128e7aa231ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D96DA5C70>]}
[0m14:42:25.175172 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:42:25.175172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefb9994-6b5e-4d65-a1f5-128e7aa231ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D96DDBA40>]}
[0m14:42:25.188092 [info ] [MainThread]: 
[0m14:42:25.188092 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:25.188092 [info ] [MainThread]: 
[0m14:42:25.188092 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:25.188092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:42:25.278670 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:42:25.278670 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:42:25.279702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:25.745897 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.470 seconds
[0m14:42:25.745897 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:42:25.761625 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:42:25.761625 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:42:25.761625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:26.214944 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 0.452 seconds
[0m14:42:26.230072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefb9994-6b5e-4d65-a1f5-128e7aa231ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D9718FF80>]}
[0m14:42:26.230072 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:42:26.230072 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:42:26.230072 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:42:26.230072 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:42:26.245963 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:42:26.247505 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:42:26.277351 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:42:26.278741 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:42:26.278741 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        product_family,
        SUM(revenue) AS total_revenue,
        RANK() OVER (PARTITION BY product_family ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id, product_family
)
SELECT * FROM ranking
  );
[0m14:42:26.278741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:42:26.877404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.598 seconds
[0m14:42:26.892095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefb9994-6b5e-4d65-a1f5-128e7aa231ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D91E11970>]}
[0m14:42:26.892095 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_products ............................. [[32mSUCCESS 1[0m in 0.66s]
[0m14:42:26.892095 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:42:26.892095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:26.892095 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:42:26.892095 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:42:26.982384 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:42:26.983382 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:42:27.066245 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:42:27.066245 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:42:27.139113 [info ] [MainThread]: 
[0m14:42:27.139113 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m14:42:27.147518 [debug] [MainThread]: Command end result
[0m14:42:27.228890 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:42:27.231332 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:42:27.236763 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:42:27.236763 [info ] [MainThread]: 
[0m14:42:27.238094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:27.238799 [info ] [MainThread]: 
[0m14:42:27.239392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:42:27.239983 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:27.239983 after 3.54 seconds
[0m14:42:27.239983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D9551F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D93EA7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017D94620DA0>]}
[0m14:42:27.241556 [debug] [MainThread]: Flushing usage events
[0m14:42:28.146026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:27.741420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EFA392750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EFBCC3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EFD5D06B0>]}


============================== 14:44:27.741420 | 7fe3d437-c587-4118-a90f-01f499ffc7bb ==============================
[0m14:44:27.741420 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:44:27.741420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s rank_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:44:28.188973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fe3d437-c587-4118-a90f-01f499ffc7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EFAA071D0>]}
[0m14:44:28.248415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fe3d437-c587-4118-a90f-01f499ffc7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EFE34DD00>]}
[0m14:44:28.248415 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:44:28.565550 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:44:28.726336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:28.726336 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:44:28.963676 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:44:28.989407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fe3d437-c587-4118-a90f-01f499ffc7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E803B5220>]}
[0m14:44:29.057850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:44:29.061750 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:44:29.080338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fe3d437-c587-4118-a90f-01f499ffc7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8046DE20>]}
[0m14:44:29.080338 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:44:29.080338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe3d437-c587-4118-a90f-01f499ffc7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E80270380>]}
[0m14:44:29.080338 [info ] [MainThread]: 
[0m14:44:29.080338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:29.080338 [info ] [MainThread]: 
[0m14:44:29.080338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:44:29.080338 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:44:29.185722 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:44:29.185722 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:44:29.185722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:30.474638 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.293 seconds
[0m14:44:30.474638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:44:30.490642 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:44:30.490642 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:44:30.490642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:30.898485 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.407 seconds
[0m14:44:30.898485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe3d437-c587-4118-a90f-01f499ffc7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8085F230>]}
[0m14:44:30.898485 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:44:30.910766 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:44:30.910766 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:44:30.910766 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:44:30.919209 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:44:30.919209 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:44:30.949562 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:44:30.950594 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:44:30.951922 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        
        SUM(revenue) AS total_revenue,
        RANK() OVER (PARTITION BY product_id ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id
)
SELECT * FROM ranking
  );
[0m14:44:30.951922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:31.606682 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m14:44:31.638722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fe3d437-c587-4118-a90f-01f499ffc7bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EFD510380>]}
[0m14:44:31.638722 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_products ............................. [[32mSUCCESS 1[0m in 0.71s]
[0m14:44:31.638722 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:44:31.638722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:31.638722 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:44:31.638722 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:44:31.717024 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:44:31.717024 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:44:31.799350 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:44:31.799350 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:44:31.898074 [info ] [MainThread]: 
[0m14:44:31.899584 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m14:44:31.899584 [debug] [MainThread]: Command end result
[0m14:44:31.988091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:44:31.990585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:44:31.995867 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:44:31.995867 [info ] [MainThread]: 
[0m14:44:31.997241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:31.998334 [info ] [MainThread]: 
[0m14:44:31.998334 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:44:31.999684 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:31.999684 after 4.42 seconds
[0m14:44:31.999684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E80518F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8051A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E80518C80>]}
[0m14:44:32.000793 [debug] [MainThread]: Flushing usage events
[0m14:44:32.891101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:20.730028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F1279CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F0E30A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F12791C0>]}


============================== 14:45:20.734730 | d3edf063-b7bd-4527-b2cd-2640054eb0ec ==============================
[0m14:45:20.734730 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:45:20.735020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s rank_products', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:21.149348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3edf063-b7bd-4527-b2cd-2640054eb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F1F993A0>]}
[0m14:45:21.222917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3edf063-b7bd-4527-b2cd-2640054eb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F1F9A720>]}
[0m14:45:21.224252 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:45:21.523951 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:45:21.681993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:21.681993 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:45:21.925503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:45:21.925503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3edf063-b7bd-4527-b2cd-2640054eb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F35F63F0>]}
[0m14:45:22.000217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:45:22.009063 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:45:22.033895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3edf063-b7bd-4527-b2cd-2640054eb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F35B1D00>]}
[0m14:45:22.033895 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:45:22.033895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3edf063-b7bd-4527-b2cd-2640054eb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F35EBEF0>]}
[0m14:45:22.033895 [info ] [MainThread]: 
[0m14:45:22.038544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:22.038544 [info ] [MainThread]: 
[0m14:45:22.038544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:22.038544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:45:22.125525 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:45:22.126557 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:45:22.126557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:23.237458 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.113 seconds
[0m14:45:23.237458 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:45:23.251733 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:45:23.251733 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:45:23.251733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:23.806714 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.547 seconds
[0m14:45:23.806714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3edf063-b7bd-4527-b2cd-2640054eb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F35EA1E0>]}
[0m14:45:23.814759 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:45:23.814759 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:45:23.814759 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:45:23.814759 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:45:23.825576 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:45:23.825576 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:45:23.859849 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:45:23.860848 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:45:23.861844 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id
)
SELECT * FROM ranking
  );
[0m14:45:23.861844 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:24.382160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.526 seconds
[0m14:45:24.413918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3edf063-b7bd-4527-b2cd-2640054eb0ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271F0720530>]}
[0m14:45:24.413918 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_products ............................. [[32mSUCCESS 1[0m in 0.60s]
[0m14:45:24.415165 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:45:24.416165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:24.417252 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:45:24.417252 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:45:24.500443 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:45:24.501534 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:45:24.584844 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:45:24.584844 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:45:24.679163 [info ] [MainThread]: 
[0m14:45:24.679163 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m14:45:24.684835 [debug] [MainThread]: Command end result
[0m14:45:24.760563 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:45:24.763618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:45:24.769120 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:45:24.769120 [info ] [MainThread]: 
[0m14:45:24.770457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:24.771224 [info ] [MainThread]: 
[0m14:45:24.771830 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:24.772474 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:24.772474 after 4.20 seconds
[0m14:45:24.772474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271EF02E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271EF02C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271EF02E840>]}
[0m14:45:24.773504 [debug] [MainThread]: Flushing usage events
[0m14:45:25.663679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:49.385247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B1101EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B6C1DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B6C1F380>]}


============================== 14:47:49.385247 | 7e101c05-5b1f-49d0-abae-9bf8c77c36b2 ==============================
[0m14:47:49.385247 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:47:49.385247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s rank_products', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:47:49.824379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e101c05-5b1f-49d0-abae-9bf8c77c36b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B7D99400>]}
[0m14:47:49.887370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e101c05-5b1f-49d0-abae-9bf8c77c36b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B7057F50>]}
[0m14:47:49.887370 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:47:50.202320 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:47:50.358520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:47:50.358520 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:47:50.615545 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:47:50.630612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e101c05-5b1f-49d0-abae-9bf8c77c36b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B92D3410>]}
[0m14:47:50.698367 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:47:50.698367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:47:50.727237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e101c05-5b1f-49d0-abae-9bf8c77c36b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B93B5D90>]}
[0m14:47:50.727237 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:47:50.729880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e101c05-5b1f-49d0-abae-9bf8c77c36b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B8EFB470>]}
[0m14:47:50.729880 [info ] [MainThread]: 
[0m14:47:50.731889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:47:50.731889 [info ] [MainThread]: 
[0m14:47:50.731889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:47:50.731889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:47:50.820452 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:47:50.821484 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:47:50.821484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:51.719557 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.899 seconds
[0m14:47:51.719557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:47:51.731070 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:47:51.731070 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:47:51.731070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:52.171386 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.443 seconds
[0m14:47:52.187302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e101c05-5b1f-49d0-abae-9bf8c77c36b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B985EFC0>]}
[0m14:47:52.187302 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:47:52.187302 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:47:52.187302 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:47:52.187302 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:47:52.202881 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:47:52.204947 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:47:52.234197 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:47:52.235531 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:47:52.235531 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id
)
SELECT * FROM ranking;
[0m14:47:52.236865 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:52.516613 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffcd-0001-429b-0008-511e00017f22
[0m14:47:52.516613 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 12 at position 21 unexpected ';'.
[0m14:47:52.532726 [debug] [Thread-1 (]: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:47:52.532726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e101c05-5b1f-49d0-abae-9bf8c77c36b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B6540800>]}
[0m14:47:52.532726 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_products ......................... [[31mERROR[0m in 0.35s]
[0m14:47:52.532726 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:47:52.532726 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_products' to be skipped because of status 'error'.  Reason: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql.
[0m14:47:52.532726 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:52.532726 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:47:52.532726 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:47:52.617628 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:47:52.617628 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:47:52.697337 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:47:52.697337 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:47:52.777427 [info ] [MainThread]: 
[0m14:47:52.777427 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m14:47:52.777427 [debug] [MainThread]: Command end result
[0m14:47:52.858587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:47:52.860695 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:47:52.866829 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:47:52.866829 [info ] [MainThread]: 
[0m14:47:52.868070 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:47:52.869160 [info ] [MainThread]: 
[0m14:47:52.869160 [error] [MainThread]:   Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 12 at position 21 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:47:52.870144 [info ] [MainThread]: 
[0m14:47:52.870861 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:47:52.871522 [debug] [MainThread]: Command `dbt run` failed at 14:47:52.871522 after 3.64 seconds
[0m14:47:52.872552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B9380B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B9382E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7B93811F0>]}
[0m14:47:52.872552 [debug] [MainThread]: Flushing usage events
[0m14:47:54.117572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:05.020499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FE5A66F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FB426060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FB4271D0>]}


============================== 14:48:05.020499 | c047f9ce-94f7-4307-be04-c70d6ae0a388 ==============================
[0m14:48:05.020499 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:48:05.020499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s rank_products', 'send_anonymous_usage_stats': 'True'}
[0m14:48:05.474441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c047f9ce-94f7-4307-be04-c70d6ae0a388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FF7EBA70>]}
[0m14:48:05.537338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c047f9ce-94f7-4307-be04-c70d6ae0a388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FEA90E60>]}
[0m14:48:05.537338 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:48:05.874227 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:48:06.036327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:48:06.036327 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:48:06.282190 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:48:06.295427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c047f9ce-94f7-4307-be04-c70d6ae0a388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FFC4E630>]}
[0m14:48:06.348394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:48:06.364109 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:48:06.391239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c047f9ce-94f7-4307-be04-c70d6ae0a388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FFD51AF0>]}
[0m14:48:06.391239 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:48:06.391239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c047f9ce-94f7-4307-be04-c70d6ae0a388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FF46B680>]}
[0m14:48:06.391239 [info ] [MainThread]: 
[0m14:48:06.395562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:06.395562 [info ] [MainThread]: 
[0m14:48:06.395562 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:48:06.395562 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:48:06.481259 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:48:06.481259 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:48:06.481259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:07.379821 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.907 seconds
[0m14:48:07.395472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:48:07.407243 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:48:07.407243 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:48:07.407243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:07.972940 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.577 seconds
[0m14:48:07.988858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c047f9ce-94f7-4307-be04-c70d6ae0a388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FFC4F170>]}
[0m14:48:07.990867 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:48:07.992875 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:48:07.992875 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:48:07.994625 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:48:08.002067 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:48:08.003014 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:48:08.032970 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:48:08.034090 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:48:08.034090 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id
)
SELECT * FROM ranking
  );
[0m14:48:08.034090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:08.880548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m14:48:08.922468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c047f9ce-94f7-4307-be04-c70d6ae0a388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FBE31AC0>]}
[0m14:48:08.922468 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_products ............................. [[32mSUCCESS 1[0m in 0.93s]
[0m14:48:08.922468 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:48:08.922468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:08.922468 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:48:08.922468 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:48:09.008940 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:48:09.014248 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:48:09.114981 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:48:09.114981 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:48:09.195344 [info ] [MainThread]: 
[0m14:48:09.195344 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m14:48:09.195344 [debug] [MainThread]: Command end result
[0m14:48:09.283559 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:48:09.285850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:48:09.291387 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:48:09.291387 [info ] [MainThread]: 
[0m14:48:09.292557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:09.293788 [info ] [MainThread]: 
[0m14:48:09.293788 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:48:09.295233 [debug] [MainThread]: Command `dbt run` succeeded at 14:48:09.295233 after 4.43 seconds
[0m14:48:09.296230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FDF1EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FE26F2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275FFD87C50>]}
[0m14:48:09.296230 [debug] [MainThread]: Flushing usage events
[0m14:48:10.186613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:57.139028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E60E8410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E60E8350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E60E8230>]}


============================== 14:48:57.147118 | fd53fd21-5873-4858-8641-fe592c42e742 ==============================
[0m14:48:57.147118 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:48:57.148854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s rank_products', 'send_anonymous_usage_stats': 'True'}
[0m14:48:57.565985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd53fd21-5873-4858-8641-fe592c42e742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E34B2900>]}
[0m14:48:57.614611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd53fd21-5873-4858-8641-fe592c42e742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E6EAFB60>]}
[0m14:48:57.614611 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:48:57.938192 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:48:58.098373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:48:58.098373 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:48:58.340138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:48:58.340138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd53fd21-5873-4858-8641-fe592c42e742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E83F60C0>]}
[0m14:48:58.416479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:48:58.416479 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:48:58.448239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd53fd21-5873-4858-8641-fe592c42e742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E83B5EE0>]}
[0m14:48:58.448239 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:48:58.448239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd53fd21-5873-4858-8641-fe592c42e742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E82ADBB0>]}
[0m14:48:58.448239 [info ] [MainThread]: 
[0m14:48:58.448239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:48:58.448239 [info ] [MainThread]: 
[0m14:48:58.448239 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:48:58.448239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:48:58.548237 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:48:58.548237 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:48:58.548237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:59.539170 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.990 seconds
[0m14:48:59.540915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:48:59.554591 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:48:59.554591 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:48:59.554591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:59.993331 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.442 seconds
[0m14:48:59.993331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd53fd21-5873-4858-8641-fe592c42e742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E889F3B0>]}
[0m14:49:00.009102 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:49:00.011115 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:49:00.013125 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:49:00.013125 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:49:00.019645 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:49:00.021652 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:49:00.053120 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:49:00.054151 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:49:00.055425 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,product_family
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
  );
[0m14:49:00.055425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:49:00.348541 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffcf-0001-429b-0008-511e00017f76
[0m14:49:00.348541 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '('.
syntax error line 7 at position 17 unexpected 'SUM'.
syntax error line 7 at position 29 unexpected ','.
syntax error line 8 at position 49 unexpected ')'.
[0m14:49:00.364228 [debug] [Thread-1 (]: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '('.
  syntax error line 7 at position 17 unexpected 'SUM'.
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 49 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:49:00.364228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd53fd21-5873-4858-8641-fe592c42e742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E55B0C80>]}
[0m14:49:00.364228 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.rank_products ......................... [[31mERROR[0m in 0.35s]
[0m14:49:00.364228 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:49:00.364228 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.rank_products' to be skipped because of status 'error'.  Reason: Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '('.
  syntax error line 7 at position 17 unexpected 'SUM'.
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 49 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql.
[0m14:49:00.364228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:00.364228 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:49:00.364228 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:49:00.451364 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:49:00.451364 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:49:00.538052 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:49:00.538052 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:49:00.627866 [info ] [MainThread]: 
[0m14:49:00.627866 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m14:49:00.627866 [debug] [MainThread]: Command end result
[0m14:49:00.713699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:49:00.715069 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:49:00.720976 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:49:00.720976 [info ] [MainThread]: 
[0m14:49:00.722454 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:49:00.722454 [info ] [MainThread]: 
[0m14:49:00.723540 [error] [MainThread]:   Database Error in model rank_products (models\Mart\rank_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '('.
  syntax error line 7 at position 17 unexpected 'SUM'.
  syntax error line 7 at position 29 unexpected ','.
  syntax error line 8 at position 49 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\rank_products.sql
[0m14:49:00.724543 [info ] [MainThread]: 
[0m14:49:00.724543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:49:00.725591 [debug] [MainThread]: Command `dbt run` failed at 14:49:00.725591 after 3.75 seconds
[0m14:49:00.725591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E62EF380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E8290D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273E8293350>]}
[0m14:49:00.726666 [debug] [MainThread]: Flushing usage events
[0m14:49:01.983057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:13.357333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDCC91E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDD734500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDD7343E0>]}


============================== 14:49:13.365559 | d6d0b39f-6309-462b-bbf2-46803179343d ==============================
[0m14:49:13.365559 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:49:13.365559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s rank_products', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:49:13.775473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6d0b39f-6309-462b-bbf2-46803179343d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDE291400>]}
[0m14:49:13.839017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6d0b39f-6309-462b-bbf2-46803179343d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDC75EBD0>]}
[0m14:49:13.839017 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:49:14.158130 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:49:14.301158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:14.301158 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m14:49:14.546636 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:49:14.568065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6d0b39f-6309-462b-bbf2-46803179343d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDF935220>]}
[0m14:49:14.634794 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:49:14.637786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:49:14.663922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6d0b39f-6309-462b-bbf2-46803179343d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDF9F1D60>]}
[0m14:49:14.663922 [info ] [MainThread]: Found 8 models, 4 sources, 474 macros
[0m14:49:14.663922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d0b39f-6309-462b-bbf2-46803179343d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDFA10E30>]}
[0m14:49:14.666865 [info ] [MainThread]: 
[0m14:49:14.666865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:14.666865 [info ] [MainThread]: 
[0m14:49:14.666865 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:49:14.666865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:49:14.759485 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:49:14.760672 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:49:14.760672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:15.678911 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.918 seconds
[0m14:49:15.678911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:49:15.696384 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:49:15.696384 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:49:15.696384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:15.996157 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.315 seconds
[0m14:49:16.016078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6d0b39f-6309-462b-bbf2-46803179343d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDE43A990>]}
[0m14:49:16.016078 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m14:49:16.016078 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.rank_products .................................. [RUN]
[0m14:49:16.016078 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m14:49:16.016078 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m14:49:16.030744 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m14:49:16.032303 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m14:49:16.063281 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m14:49:16.064378 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m14:49:16.065836 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace   view MINI_PROJECT.RAW.rank_products
  
   as (
    WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
  );
[0m14:49:16.065836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:49:16.698034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m14:49:16.729683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6d0b39f-6309-462b-bbf2-46803179343d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDCC004D0>]}
[0m14:49:16.729683 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.rank_products ............................. [[32mSUCCESS 1[0m in 0.71s]
[0m14:49:16.729683 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m14:49:16.729683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:16.729683 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:49:16.729683 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:49:16.817862 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:49:16.817862 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:49:16.884720 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m14:49:16.884720 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m14:49:16.963714 [info ] [MainThread]: 
[0m14:49:16.963714 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m14:49:16.963714 [debug] [MainThread]: Command end result
[0m14:49:17.052366 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:49:17.054573 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:49:17.060038 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:49:17.060038 [info ] [MainThread]: 
[0m14:49:17.061410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:17.062112 [info ] [MainThread]: 
[0m14:49:17.062698 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:49:17.063334 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:17.063334 after 3.86 seconds
[0m14:49:17.063334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDB4C6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDB4C6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABDDFAB170>]}
[0m14:49:17.064364 [debug] [MainThread]: Flushing usage events
[0m14:49:17.972058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:57:29.836897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029555072120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029555070500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295550704A0>]}


============================== 14:57:29.836897 | 6dd469b0-d372-4b1e-9a56-3ee4a28ea0a0 ==============================
[0m14:57:29.836897 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:57:29.836897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s new_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:57:30.571300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dd469b0-d372-4b1e-9a56-3ee4a28ea0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029555073E90>]}
[0m14:57:30.634795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dd469b0-d372-4b1e-9a56-3ee4a28ea0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029554DB5100>]}
[0m14:57:30.634795 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:57:31.090001 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:57:32.527879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:57:32.527879 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\new_customer.sql
[0m14:57:32.769681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:57:32.791952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd469b0-d372-4b1e-9a56-3ee4a28ea0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002955747A180>]}
[0m14:57:32.848180 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:57:32.876341 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:57:32.913551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dd469b0-d372-4b1e-9a56-3ee4a28ea0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029557429D90>]}
[0m14:57:32.913551 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:57:32.913551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dd469b0-d372-4b1e-9a56-3ee4a28ea0a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002955710A150>]}
[0m14:57:32.913551 [warn ] [MainThread]: The selection criterion 'new_customers' does not match any enabled nodes
[0m14:57:32.913551 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:57:32.913551 [debug] [MainThread]: Command end result
[0m14:57:32.934270 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:57:32.934270 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:57:32.946817 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:57:32.947963 [debug] [MainThread]: Command `dbt run` succeeded at 14:57:32.947963 after 3.33 seconds
[0m14:57:32.948959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295547D76E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295546511F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029551BB6E10>]}
[0m14:57:32.948959 [debug] [MainThread]: Flushing usage events
[0m14:57:33.888743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:27.545160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221135FB6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022113433350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022113431F70>]}


============================== 14:58:27.545160 | 5faef7e1-b0f6-4576-8464-45a50ab1e0d7 ==============================
[0m14:58:27.545160 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:58:27.545160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s new_customers', 'send_anonymous_usage_stats': 'True'}
[0m14:58:28.009592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5faef7e1-b0f6-4576-8464-45a50ab1e0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022114692B10>]}
[0m14:58:28.059309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5faef7e1-b0f6-4576-8464-45a50ab1e0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022114319EE0>]}
[0m14:58:28.059309 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:58:28.391615 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:58:28.545274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:58:28.545274 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\new_customer.sql
[0m14:58:28.799181 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m14:58:28.813251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5faef7e1-b0f6-4576-8464-45a50ab1e0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022115C1A720>]}
[0m14:58:28.890293 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:58:28.894492 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:58:28.922566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5faef7e1-b0f6-4576-8464-45a50ab1e0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211595EBD0>]}
[0m14:58:28.922566 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:58:28.922566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5faef7e1-b0f6-4576-8464-45a50ab1e0d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022115C0B950>]}
[0m14:58:28.922566 [warn ] [MainThread]: The selection criterion 'new_customers' does not match any enabled nodes
[0m14:58:28.922566 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:58:28.922566 [debug] [MainThread]: Command end result
[0m14:58:28.949443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:58:28.950440 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:58:28.956729 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:58:28.957726 [debug] [MainThread]: Command `dbt run` succeeded at 14:58:28.956729 after 1.60 seconds
[0m14:58:28.957726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002211366B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022112E52150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022112E51EE0>]}
[0m14:58:28.957726 [debug] [MainThread]: Flushing usage events
[0m14:58:29.873784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:34.446917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015708068410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015708068380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157080681A0>]}


============================== 14:58:34.446917 | 80828943-ece2-424f-8e2e-d6a1f6d543d6 ==============================
[0m14:58:34.446917 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:58:34.446917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s new_customer', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:58:34.870589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80828943-ece2-424f-8e2e-d6a1f6d543d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001570810F830>]}
[0m14:58:34.934262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80828943-ece2-424f-8e2e-d6a1f6d543d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015708E5E630>]}
[0m14:58:34.934262 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:58:35.248345 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:58:35.403511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:35.403511 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:35.408567 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:58:35.444799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80828943-ece2-424f-8e2e-d6a1f6d543d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001570A0EFFB0>]}
[0m14:58:35.508808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:58:35.508808 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:58:35.540464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80828943-ece2-424f-8e2e-d6a1f6d543d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001570A2DC470>]}
[0m14:58:35.540464 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:58:35.543988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80828943-ece2-424f-8e2e-d6a1f6d543d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015709E805C0>]}
[0m14:58:35.543988 [info ] [MainThread]: 
[0m14:58:35.546066 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:58:35.546066 [info ] [MainThread]: 
[0m14:58:35.546066 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:58:35.546066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:58:38.183686 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:58:38.183686 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:58:38.183686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:39.205644 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.022 seconds
[0m14:58:39.213045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:58:39.221319 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:58:39.221319 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:58:39.221319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:39.687846 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.463 seconds
[0m14:58:39.687846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80828943-ece2-424f-8e2e-d6a1f6d543d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001570A2908F0>]}
[0m14:58:39.687846 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m14:58:39.687846 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.new_customer ................................... [RUN]
[0m14:58:39.687846 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.new_customer'
[0m14:58:39.687846 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m14:58:39.703890 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m14:58:39.703890 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m14:58:39.736453 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m14:58:39.746994 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m14:58:39.746994 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace   view MINI_PROJECT.RAW.new_customer
  
   as (
    WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        MIN(payment_month) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    year(first_order_date) AS fiscal_year,
    count(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
  );
[0m14:58:39.748092 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:58:40.301829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd8-0001-429e-0008-511e0001d7c2
[0m14:58:40.301829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function EXTRACT does not support VARCHAR(255) argument type
[0m14:58:40.317585 [debug] [Thread-1 (]: Database Error in model new_customer (models\Mart\new_customer.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql
[0m14:58:40.317585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80828943-ece2-424f-8e2e-d6a1f6d543d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157075306E0>]}
[0m14:58:40.317585 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.new_customer .......................... [[31mERROR[0m in 0.63s]
[0m14:58:40.317585 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m14:58:40.317585 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.new_customer' to be skipped because of status 'error'.  Reason: Database Error in model new_customer (models\Mart\new_customer.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql.
[0m14:58:40.317585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:40.317585 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:58:40.317585 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:58:40.414587 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:58:40.414587 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:58:40.510402 [debug] [MainThread]: Connection 'model.Mini_Project.new_customer' was left open.
[0m14:58:40.510402 [debug] [MainThread]: On model.Mini_Project.new_customer: Close
[0m14:58:40.598012 [info ] [MainThread]: 
[0m14:58:40.599026 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m14:58:40.600032 [debug] [MainThread]: Command end result
[0m14:58:40.616218 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:58:40.616218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:58:40.632340 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:58:40.632340 [info ] [MainThread]: 
[0m14:58:40.633552 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:58:40.633552 [info ] [MainThread]: 
[0m14:58:40.633552 [error] [MainThread]:   Database Error in model new_customer (models\Mart\new_customer.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql
[0m14:58:40.633552 [info ] [MainThread]: 
[0m14:58:40.633552 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:58:40.633552 [debug] [MainThread]: Command `dbt run` failed at 14:58:40.633552 after 6.35 seconds
[0m14:58:40.633552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015709F77FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015709F77B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001570A2BFFE0>]}
[0m14:58:40.633552 [debug] [MainThread]: Flushing usage events
[0m14:58:41.549206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:36.068325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D40124440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D40125970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D40124EF0>]}


============================== 14:59:36.078769 | 397470af-0aff-4e9c-be02-aa8166dcb461 ==============================
[0m14:59:36.078769 [info ] [MainThread]: Running with dbt=1.9.3
[0m14:59:36.078769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s new_customer', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:36.501954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397470af-0aff-4e9c-be02-aa8166dcb461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4133D070>]}
[0m14:59:36.576782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397470af-0aff-4e9c-be02-aa8166dcb461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D406575F0>]}
[0m14:59:36.576782 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:59:36.892859 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m14:59:37.050943 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:59:37.050943 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\new_customer.sql
[0m14:59:37.315651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m14:59:37.315651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397470af-0aff-4e9c-be02-aa8166dcb461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D427E58B0>]}
[0m14:59:37.404251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:59:37.404251 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:59:37.420179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397470af-0aff-4e9c-be02-aa8166dcb461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4262CE30>]}
[0m14:59:37.434984 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m14:59:37.434984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397470af-0aff-4e9c-be02-aa8166dcb461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4239B800>]}
[0m14:59:37.435992 [info ] [MainThread]: 
[0m14:59:37.435992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:37.435992 [info ] [MainThread]: 
[0m14:59:37.435992 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:59:37.440272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m14:59:37.537644 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m14:59:37.538642 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m14:59:37.538642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:38.540911 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.006 seconds
[0m14:59:38.547963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m14:59:38.547963 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m14:59:38.547963 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m14:59:38.563726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:38.854507 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.291 seconds
[0m14:59:38.854507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397470af-0aff-4e9c-be02-aa8166dcb461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D426785C0>]}
[0m14:59:38.854507 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m14:59:38.854507 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.new_customer ................................... [RUN]
[0m14:59:38.854507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.new_customer'
[0m14:59:38.854507 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m14:59:38.874599 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m14:59:38.876607 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m14:59:38.906101 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m14:59:38.908624 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m14:59:38.908624 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace   view MINI_PROJECT.RAW.new_customer
  
   as (
    WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        MIN(payment_month) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    EXTRACT(YEAR FROM first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year;
[0m14:59:38.908624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:59:39.198144 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffd9-0001-429a-0008-511e0001bee2
[0m14:59:39.198144 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 15 unexpected ';'.
[0m14:59:39.198144 [debug] [Thread-1 (]: Database Error in model new_customer (models\Mart\new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 15 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql
[0m14:59:39.214019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397470af-0aff-4e9c-be02-aa8166dcb461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D3FAB0800>]}
[0m14:59:39.214019 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.new_customer .......................... [[31mERROR[0m in 0.34s]
[0m14:59:39.214019 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m14:59:39.214019 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.new_customer' to be skipped because of status 'error'.  Reason: Database Error in model new_customer (models\Mart\new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 15 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql.
[0m14:59:39.214019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:39.214019 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m14:59:39.214019 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m14:59:39.328728 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m14:59:39.328728 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m14:59:39.407632 [debug] [MainThread]: Connection 'model.Mini_Project.new_customer' was left open.
[0m14:59:39.407632 [debug] [MainThread]: On model.Mini_Project.new_customer: Close
[0m14:59:39.486838 [info ] [MainThread]: 
[0m14:59:39.486838 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m14:59:39.486838 [debug] [MainThread]: Command end result
[0m14:59:39.575756 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m14:59:39.577832 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m14:59:39.584057 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m14:59:39.584057 [info ] [MainThread]: 
[0m14:59:39.585565 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:59:39.586317 [info ] [MainThread]: 
[0m14:59:39.586958 [error] [MainThread]:   Database Error in model new_customer (models\Mart\new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 15 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql
[0m14:59:39.587701 [info ] [MainThread]: 
[0m14:59:39.587701 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:59:39.588966 [debug] [MainThread]: Command `dbt run` failed at 14:59:39.588966 after 3.68 seconds
[0m14:59:39.588966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D4037B0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D3FD3B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D42899BE0>]}
[0m14:59:39.590118 [debug] [MainThread]: Flushing usage events
[0m14:59:40.845718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:21.143928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCAA12180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCAA12750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCAA135C0>]}


============================== 15:00:21.143928 | 46503b3b-2ede-48f2-a8e0-049e76cc2d19 ==============================
[0m15:00:21.143928 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:21.143928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s new_customer', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:00:21.594292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46503b3b-2ede-48f2-a8e0-049e76cc2d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCB83FA10>]}
[0m15:00:21.645394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46503b3b-2ede-48f2-a8e0-049e76cc2d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCB818F80>]}
[0m15:00:21.645394 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:00:21.970281 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:00:22.127668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:22.128700 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\new_customer.sql
[0m15:00:22.369996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:00:22.371333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46503b3b-2ede-48f2-a8e0-049e76cc2d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCCD15760>]}
[0m15:00:22.450103 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:00:22.451398 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:00:22.468214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46503b3b-2ede-48f2-a8e0-049e76cc2d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCCB09250>]}
[0m15:00:22.468214 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:00:22.468214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46503b3b-2ede-48f2-a8e0-049e76cc2d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCCB63EC0>]}
[0m15:00:22.468214 [info ] [MainThread]: 
[0m15:00:22.482272 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:22.483280 [info ] [MainThread]: 
[0m15:00:22.483280 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:22.483280 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:00:22.571421 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:00:22.571421 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:00:22.572452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:23.548490 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.977 seconds
[0m15:00:23.548490 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:00:23.564292 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:00:23.564292 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:00:23.564292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:24.056009 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.490 seconds
[0m15:00:24.060750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46503b3b-2ede-48f2-a8e0-049e76cc2d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCD266600>]}
[0m15:00:24.060750 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m15:00:24.060750 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.new_customer ................................... [RUN]
[0m15:00:24.060750 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.new_customer'
[0m15:00:24.060750 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m15:00:24.074911 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m15:00:24.076514 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m15:00:24.105703 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m15:00:24.106736 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m15:00:24.107963 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace   view MINI_PROJECT.RAW.new_customer
  
   as (
    WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year;
[0m15:00:24.107963 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:24.477635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffda-0001-429a-0008-511e0001beea
[0m15:00:24.477635 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 15 unexpected ';'.
[0m15:00:24.493641 [debug] [Thread-1 (]: Database Error in model new_customer (models\Mart\new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 15 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql
[0m15:00:24.493641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46503b3b-2ede-48f2-a8e0-049e76cc2d19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC9FE0230>]}
[0m15:00:24.493641 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.new_customer .......................... [[31mERROR[0m in 0.43s]
[0m15:00:24.493641 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m15:00:24.493641 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.new_customer' to be skipped because of status 'error'.  Reason: Database Error in model new_customer (models\Mart\new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 15 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql.
[0m15:00:24.493641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:24.493641 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:00:24.493641 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:00:24.575704 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:00:24.575704 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:00:24.665540 [debug] [MainThread]: Connection 'model.Mini_Project.new_customer' was left open.
[0m15:00:24.665540 [debug] [MainThread]: On model.Mini_Project.new_customer: Close
[0m15:00:24.745868 [info ] [MainThread]: 
[0m15:00:24.755327 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m15:00:24.755327 [debug] [MainThread]: Command end result
[0m15:00:24.820476 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:00:24.835408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:00:24.841609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:00:24.841609 [info ] [MainThread]: 
[0m15:00:24.842985 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:00:24.843719 [info ] [MainThread]: 
[0m15:00:24.844321 [error] [MainThread]:   Database Error in model new_customer (models\Mart\new_customer.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 15 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\new_customer.sql
[0m15:00:24.845023 [info ] [MainThread]: 
[0m15:00:24.845608 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:00:24.846231 [debug] [MainThread]: Command `dbt run` failed at 15:00:24.846231 after 3.86 seconds
[0m15:00:24.846231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCA90D730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FC80217C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015FCCB62810>]}
[0m15:00:24.847261 [debug] [MainThread]: Flushing usage events
[0m15:00:25.723682 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:36.461206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025316874200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025316874C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025316874FB0>]}


============================== 15:00:36.481512 | 90b4a15b-fd8d-4e03-b02a-c5141d285534 ==============================
[0m15:00:36.481512 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:00:36.481512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s new_customer', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:00:36.916408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b4a15b-fd8d-4e03-b02a-c5141d285534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253165402C0>]}
[0m15:00:36.963318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90b4a15b-fd8d-4e03-b02a-c5141d285534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025313F9F8F0>]}
[0m15:00:36.963318 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:00:37.293761 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:00:37.449840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:00:37.449840 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\new_customer.sql
[0m15:00:37.689313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:00:37.705071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90b4a15b-fd8d-4e03-b02a-c5141d285534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025318B7A510>]}
[0m15:00:37.765821 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:00:37.774837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:00:37.801442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90b4a15b-fd8d-4e03-b02a-c5141d285534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025318B2DEE0>]}
[0m15:00:37.801442 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:00:37.801442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b4a15b-fd8d-4e03-b02a-c5141d285534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025318A514C0>]}
[0m15:00:37.801442 [info ] [MainThread]: 
[0m15:00:37.801442 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:37.801442 [info ] [MainThread]: 
[0m15:00:37.801442 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:00:37.801442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:00:37.898447 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:00:37.898447 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:00:37.898447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:38.492367 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.601 seconds
[0m15:00:38.508111 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:00:38.508111 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:00:38.508111 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:00:38.508111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:38.815478 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 0.306 seconds
[0m15:00:38.831618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b4a15b-fd8d-4e03-b02a-c5141d285534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025318B7A1E0>]}
[0m15:00:38.835635 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m15:00:38.837642 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.new_customer ................................... [RUN]
[0m15:00:38.837642 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.new_customer'
[0m15:00:38.837642 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m15:00:38.845669 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m15:00:38.845669 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m15:00:38.874842 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m15:00:38.875876 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m15:00:38.875876 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace   view MINI_PROJECT.RAW.new_customer
  
   as (
    WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
  );
[0m15:00:38.875876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:39.411011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m15:00:39.426709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90b4a15b-fd8d-4e03-b02a-c5141d285534', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025318FC6090>]}
[0m15:00:39.426709 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.new_customer .............................. [[32mSUCCESS 1[0m in 0.59s]
[0m15:00:39.426709 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m15:00:39.426709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:39.426709 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:00:39.426709 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:00:39.508264 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:00:39.508264 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:00:39.598685 [debug] [MainThread]: Connection 'model.Mini_Project.new_customer' was left open.
[0m15:00:39.598685 [debug] [MainThread]: On model.Mini_Project.new_customer: Close
[0m15:00:39.679133 [info ] [MainThread]: 
[0m15:00:39.679133 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m15:00:39.679133 [debug] [MainThread]: Command end result
[0m15:00:39.767321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:00:39.770467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:00:39.775675 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:00:39.775675 [info ] [MainThread]: 
[0m15:00:39.776949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:00:39.777702 [info ] [MainThread]: 
[0m15:00:39.778320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:00:39.778937 [debug] [MainThread]: Command `dbt run` succeeded at 15:00:39.778937 after 3.46 seconds
[0m15:00:39.778937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253164973B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025318B88B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002531754B440>]}
[0m15:00:39.779966 [debug] [MainThread]: Flushing usage events
[0m15:00:41.062969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:34.037618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EDA14710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EDA14440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EDA14380>]}


============================== 15:05:34.049138 | 64724529-b208-44bd-92cd-7dd50f6f800c ==============================
[0m15:05:34.049138 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:05:34.049138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s product_churn', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:05:34.477342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64724529-b208-44bd-92cd-7dd50f6f800c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EE49EEA0>]}
[0m15:05:34.524774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64724529-b208-44bd-92cd-7dd50f6f800c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EE6D1BE0>]}
[0m15:05:34.524774 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:05:34.857088 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:05:35.004849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:05:35.004849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:05:35.011045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:05:35.034194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64724529-b208-44bd-92cd-7dd50f6f800c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EFA1FF80>]}
[0m15:05:35.096428 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:05:35.112166 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:05:35.127907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64724529-b208-44bd-92cd-7dd50f6f800c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EFC0C1A0>]}
[0m15:05:35.127907 [info ] [MainThread]: Found 9 models, 4 sources, 474 macros
[0m15:05:35.127907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64724529-b208-44bd-92cd-7dd50f6f800c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EF868AA0>]}
[0m15:05:35.127907 [warn ] [MainThread]: The selection criterion 'product_churn' does not match any enabled nodes
[0m15:05:35.127907 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:05:35.127907 [debug] [MainThread]: Command end result
[0m15:05:35.162499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:05:35.162499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:05:35.162499 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:05:35.162499 [debug] [MainThread]: Command `dbt run` succeeded at 15:05:35.162499 after 1.29 seconds
[0m15:05:35.162499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EF813C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EF813E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235EDA14BC0>]}
[0m15:05:35.162499 [debug] [MainThread]: Flushing usage events
[0m15:05:36.094888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:13.531801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FE456750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FE7AC3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FE096180>]}


============================== 15:06:13.531801 | 76f49ed3-da87-40fb-bb38-fcdc7f6c35c8 ==============================
[0m15:06:13.531801 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:06:13.531801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s product_churn', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:06:13.966832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76f49ed3-da87-40fb-bb38-fcdc7f6c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FF299EE0>]}
[0m15:06:14.020148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76f49ed3-da87-40fb-bb38-fcdc7f6c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FF60B980>]}
[0m15:06:14.020148 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:06:14.365939 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:06:14.503787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:06:14.503787 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\product_churn.sql
[0m15:06:14.743045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:06:14.758693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f49ed3-da87-40fb-bb38-fcdc7f6c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FFC4AC00>]}
[0m15:06:14.836223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:06:14.836223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:06:14.867500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76f49ed3-da87-40fb-bb38-fcdc7f6c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FF97CA10>]}
[0m15:06:14.867500 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:06:14.867500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f49ed3-da87-40fb-bb38-fcdc7f6c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FC5821E0>]}
[0m15:06:14.867500 [info ] [MainThread]: 
[0m15:06:14.867500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:14.867500 [info ] [MainThread]: 
[0m15:06:14.867500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:14.867500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:06:14.969004 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:06:14.970072 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:06:14.970072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:15.970037 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.003 seconds
[0m15:06:15.973650 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:06:15.989825 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:06:15.989825 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:06:15.989825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:16.348591 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.361 seconds
[0m15:06:16.357629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76f49ed3-da87-40fb-bb38-fcdc7f6c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7811471D0>]}
[0m15:06:16.359368 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m15:06:16.359368 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.product_churn .................................. [RUN]
[0m15:06:16.359368 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.product_churn'
[0m15:06:16.359368 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m15:06:16.359368 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m15:06:16.359368 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m15:06:16.388298 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m15:06:16.403486 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m15:06:16.403486 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace   view MINI_PROJECT.RAW.product_churn
  
   as (
    WITH LastSale AS (
    SELECT
        product_id,
        MAX(payment_month) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id
),
ChurnedProducts AS (
    SELECT
        product_id,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
  );
[0m15:06:16.404942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:06:16.819093 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffe0-0001-429a-0008-511e0001bf56
[0m15:06:16.819093 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function EXTRACT does not support VARCHAR(255) argument type
[0m15:06:16.819093 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\Mart\product_churn.sql
[0m15:06:16.819093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76f49ed3-da87-40fb-bb38-fcdc7f6c35c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FDDB0200>]}
[0m15:06:16.819093 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.product_churn ......................... [[31mERROR[0m in 0.46s]
[0m15:06:16.819093 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m15:06:16.828741 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\Mart\product_churn.sql.
[0m15:06:16.828741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:16.828741 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:06:16.828741 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:06:16.905151 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:06:16.905151 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:06:16.986140 [debug] [MainThread]: Connection 'model.Mini_Project.product_churn' was left open.
[0m15:06:16.986140 [debug] [MainThread]: On model.Mini_Project.product_churn: Close
[0m15:06:17.085948 [info ] [MainThread]: 
[0m15:06:17.085948 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m15:06:17.085948 [debug] [MainThread]: Command end result
[0m15:06:17.167893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:06:17.171177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:06:17.176792 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:06:17.176792 [info ] [MainThread]: 
[0m15:06:17.178006 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:06:17.178791 [info ] [MainThread]: 
[0m15:06:17.179412 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  002016 (22000): SQL compilation error:
  Function EXTRACT does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\Mart\product_churn.sql
[0m15:06:17.180133 [info ] [MainThread]: 
[0m15:06:17.180768 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:06:17.181420 [debug] [MainThread]: Command `dbt run` failed at 15:06:17.181420 after 3.81 seconds
[0m15:06:17.181420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FD9C97C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FDD6D160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E7FDD6D190>]}
[0m15:06:17.182451 [debug] [MainThread]: Flushing usage events
[0m15:06:18.091513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:52.134276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2E6E8500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2E6E84A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2E6E8380>]}


============================== 15:06:52.149927 | 4786b58b-7e7d-4778-bb1f-edd874ee81c7 ==============================
[0m15:06:52.149927 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:06:52.149927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s product_churn', 'send_anonymous_usage_stats': 'True'}
[0m15:06:52.620387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4786b58b-7e7d-4778-bb1f-edd874ee81c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2F447140>]}
[0m15:06:52.682932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4786b58b-7e7d-4778-bb1f-edd874ee81c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2F0DBFE0>]}
[0m15:06:52.683964 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:06:53.022073 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:06:53.195753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:06:53.196756 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\product_churn.sql
[0m15:06:53.473798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:06:53.489596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4786b58b-7e7d-4778-bb1f-edd874ee81c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2F3AD7C0>]}
[0m15:06:53.612251 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:06:53.616267 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:06:53.669710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4786b58b-7e7d-4778-bb1f-edd874ee81c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3078D2B0>]}
[0m15:06:53.669710 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:06:53.671719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4786b58b-7e7d-4778-bb1f-edd874ee81c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C30A5D460>]}
[0m15:06:53.673726 [info ] [MainThread]: 
[0m15:06:53.673726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:06:53.673726 [info ] [MainThread]: 
[0m15:06:53.675734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:06:53.675734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:06:53.775769 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:06:53.777015 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:06:53.777015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:54.673628 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.901 seconds
[0m15:06:54.684392 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:06:54.687572 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:06:54.687572 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:06:54.687572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:55.145003 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 0.453 seconds
[0m15:06:55.145003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4786b58b-7e7d-4778-bb1f-edd874ee81c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C3078D130>]}
[0m15:06:55.145003 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m15:06:55.158214 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.product_churn .................................. [RUN]
[0m15:06:55.158214 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.product_churn'
[0m15:06:55.158214 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m15:06:55.160718 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m15:06:55.160718 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m15:06:55.195502 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m15:06:55.197512 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m15:06:55.197512 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace   view MINI_PROJECT.RAW.product_churn
  
   as (
    WITH LastSale AS (
    SELECT
        product_id,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id
),
ChurnedProducts AS (
    SELECT
        product_id,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
  );
[0m15:06:55.197512 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:06:55.693869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.494 seconds
[0m15:06:55.720629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4786b58b-7e7d-4778-bb1f-edd874ee81c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C2DBC0830>]}
[0m15:06:55.722018 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.product_churn ............................. [[32mSUCCESS 1[0m in 0.56s]
[0m15:06:55.723020 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m15:06:55.725013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:06:55.726492 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:06:55.726492 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:06:55.804095 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:06:55.804095 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:06:55.888395 [debug] [MainThread]: Connection 'model.Mini_Project.product_churn' was left open.
[0m15:06:55.888395 [debug] [MainThread]: On model.Mini_Project.product_churn: Close
[0m15:06:55.970287 [info ] [MainThread]: 
[0m15:06:55.971318 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m15:06:55.972484 [debug] [MainThread]: Command end result
[0m15:06:56.082369 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:06:56.084364 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:06:56.091353 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:06:56.091353 [info ] [MainThread]: 
[0m15:06:56.092351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:06:56.093194 [info ] [MainThread]: 
[0m15:06:56.094291 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:06:56.094291 [debug] [MainThread]: Command `dbt run` succeeded at 15:06:56.094291 after 4.16 seconds
[0m15:06:56.095546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C30A05EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C30A06F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C30A07020>]}
[0m15:06:56.095546 [debug] [MainThread]: Flushing usage events
[0m15:06:56.997334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:28.143284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258098F40B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258098F4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258098F4E60>]}


============================== 15:27:28.154328 | 36f97960-61ac-49d2-b87e-b9ee502a4455 ==============================
[0m15:27:28.154328 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:27:28.154328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s product_churn', 'send_anonymous_usage_stats': 'True'}
[0m15:27:28.989800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36f97960-61ac-49d2-b87e-b9ee502a4455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025808E52600>]}
[0m15:27:29.053404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36f97960-61ac-49d2-b87e-b9ee502a4455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025808DC3E90>]}
[0m15:27:29.053404 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:27:29.586461 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:27:30.941149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:27:30.941149 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\product_churn.sql
[0m15:27:31.190077 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:27:31.205370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36f97960-61ac-49d2-b87e-b9ee502a4455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BB0C260>]}
[0m15:27:31.276628 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:27:31.292336 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:27:31.331602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36f97960-61ac-49d2-b87e-b9ee502a4455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580B92BA40>]}
[0m15:27:31.331602 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:27:31.331602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f97960-61ac-49d2-b87e-b9ee502a4455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BC38C20>]}
[0m15:27:31.331602 [info ] [MainThread]: 
[0m15:27:31.331602 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:27:31.331602 [info ] [MainThread]: 
[0m15:27:31.331602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:27:31.331602 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:27:34.145891 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:27:34.145891 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:27:34.145891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:35.316758 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.181 seconds
[0m15:27:35.332021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:27:35.347781 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:27:35.347781 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:27:35.347781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:35.753516 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.419 seconds
[0m15:27:35.769218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36f97960-61ac-49d2-b87e-b9ee502a4455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580A68C350>]}
[0m15:27:35.769218 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m15:27:35.769218 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.product_churn .................................. [RUN]
[0m15:27:35.769218 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.product_churn'
[0m15:27:35.769218 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m15:27:35.788481 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m15:27:35.789897 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m15:27:35.819183 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m15:27:35.822416 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m15:27:35.822416 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace   view MINI_PROJECT.RAW.product_churn
  
   as (
    WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
  );
[0m15:27:35.823413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:27:36.417078 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafff5-0001-429a-0008-511e0001bfc6
[0m15:27:36.417078 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 33 at position 9 unexpected '('.
syntax error line 40 at position 2 unexpected ')'.
[0m15:27:36.438988 [debug] [Thread-1 (]: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 33 at position 9 unexpected '('.
  syntax error line 40 at position 2 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\product_churn.sql
[0m15:27:36.444702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36f97960-61ac-49d2-b87e-b9ee502a4455', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025808DC0590>]}
[0m15:27:36.444702 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.product_churn ......................... [[31mERROR[0m in 0.67s]
[0m15:27:36.444702 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m15:27:36.444702 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.product_churn' to be skipped because of status 'error'.  Reason: Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 33 at position 9 unexpected '('.
  syntax error line 40 at position 2 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\product_churn.sql.
[0m15:27:36.444702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:36.444702 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:27:36.444702 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:27:36.533528 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:27:36.533528 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:27:36.631909 [debug] [MainThread]: Connection 'model.Mini_Project.product_churn' was left open.
[0m15:27:36.631909 [debug] [MainThread]: On model.Mini_Project.product_churn: Close
[0m15:27:36.728418 [info ] [MainThread]: 
[0m15:27:36.728418 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.40 seconds (5.40s).
[0m15:27:36.728418 [debug] [MainThread]: Command end result
[0m15:27:36.827599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:27:36.829809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:27:36.834553 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:27:36.834553 [info ] [MainThread]: 
[0m15:27:36.834553 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:27:36.834553 [info ] [MainThread]: 
[0m15:27:36.834553 [error] [MainThread]:   Database Error in model product_churn (models\Mart\product_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 33 at position 9 unexpected '('.
  syntax error line 40 at position 2 unexpected ')'.
  compiled code at target\run\Mini_Project\models\Mart\product_churn.sql
[0m15:27:36.834553 [info ] [MainThread]: 
[0m15:27:36.834553 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:27:36.834553 [debug] [MainThread]: Command `dbt run` failed at 15:27:36.834553 after 8.91 seconds
[0m15:27:36.834553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580C0CA480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BC38C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BC39280>]}
[0m15:27:36.834553 [debug] [MainThread]: Flushing usage events
[0m15:27:37.751065 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:14.410337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9DEB95B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9D57F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9BC27920>]}


============================== 15:28:14.410337 | f0f67c34-fae5-444f-8dc9-839a309f400c ==============================
[0m15:28:14.410337 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:28:14.410337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s product_churn', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:28:14.865025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0f67c34-fae5-444f-8dc9-839a309f400c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9B262B70>]}
[0m15:28:14.912656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0f67c34-fae5-444f-8dc9-839a309f400c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9FBF3140>]}
[0m15:28:14.912656 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:28:15.239882 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:28:15.394728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:28:15.395788 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\product_churn.sql
[0m15:28:15.634648 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:28:15.653806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0f67c34-fae5-444f-8dc9-839a309f400c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9FCC8B30>]}
[0m15:28:15.707160 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:28:15.723176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:28:15.744782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0f67c34-fae5-444f-8dc9-839a309f400c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9FEEEBA0>]}
[0m15:28:15.753958 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:28:15.753958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f67c34-fae5-444f-8dc9-839a309f400c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9FCAB4A0>]}
[0m15:28:15.753958 [info ] [MainThread]: 
[0m15:28:15.753958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:15.753958 [info ] [MainThread]: 
[0m15:28:15.753958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:28:15.753958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:28:15.848161 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:28:15.848161 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:28:15.849206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:16.904984 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.064 seconds
[0m15:28:16.922133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:28:16.922133 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:28:16.922133 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:28:16.922133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:17.453952 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.522 seconds
[0m15:28:17.460235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f67c34-fae5-444f-8dc9-839a309f400c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014FA01F40E0>]}
[0m15:28:17.460235 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m15:28:17.460235 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.product_churn .................................. [RUN]
[0m15:28:17.460235 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.product_churn'
[0m15:28:17.460235 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m15:28:17.474822 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m15:28:17.476477 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m15:28:17.505450 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m15:28:17.507655 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m15:28:17.507655 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace   view MINI_PROJECT.RAW.product_churn
  
   as (
    WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
  );
[0m15:28:17.508963 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:18.004770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m15:28:18.090235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0f67c34-fae5-444f-8dc9-839a309f400c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9DA3DA60>]}
[0m15:28:18.090235 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.product_churn ............................. [[32mSUCCESS 1[0m in 0.63s]
[0m15:28:18.091743 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m15:28:18.093070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:18.093070 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:28:18.093070 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:28:18.176896 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:28:18.178911 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:28:18.255610 [debug] [MainThread]: Connection 'model.Mini_Project.product_churn' was left open.
[0m15:28:18.255610 [debug] [MainThread]: On model.Mini_Project.product_churn: Close
[0m15:28:18.336269 [info ] [MainThread]: 
[0m15:28:18.336269 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m15:28:18.336269 [debug] [MainThread]: Command end result
[0m15:28:18.377576 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:28:18.391948 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:28:18.394004 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:28:18.394004 [info ] [MainThread]: 
[0m15:28:18.394004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:18.394004 [info ] [MainThread]: 
[0m15:28:18.394004 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:28:18.394004 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:18.394004 after 4.15 seconds
[0m15:28:18.394004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9DC0B530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9A202750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014F9FF61A60>]}
[0m15:28:18.394004 [debug] [MainThread]: Flushing usage events
[0m15:28:19.271451 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:35.731286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C638230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C63AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C638410>]}


============================== 15:35:35.731286 | 2a3d7752-ae25-4235-b0a0-2b1cb43986e1 ==============================
[0m15:35:35.731286 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:35:35.731286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:35:36.189130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a3d7752-ae25-4235-b0a0-2b1cb43986e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3C30C3E0>]}
[0m15:35:36.250078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a3d7752-ae25-4235-b0a0-2b1cb43986e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3D236390>]}
[0m15:35:36.252085 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:35:36.577374 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:35:36.734065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:36.736073 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m15:35:36.981570 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:35:36.994261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a3d7752-ae25-4235-b0a0-2b1cb43986e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3E92A690>]}
[0m15:35:37.061844 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:35:37.065138 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:35:37.093145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a3d7752-ae25-4235-b0a0-2b1cb43986e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3E8DE450>]}
[0m15:35:37.093145 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:35:37.093145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3d7752-ae25-4235-b0a0-2b1cb43986e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3E814050>]}
[0m15:35:37.096817 [info ] [MainThread]: 
[0m15:35:37.096817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:37.096817 [info ] [MainThread]: 
[0m15:35:37.096817 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:37.096817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:35:37.187339 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:35:37.188587 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:35:37.188587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:38.109320 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.926 seconds
[0m15:35:38.109320 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:35:38.124995 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:35:38.124995 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:35:38.124995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:38.412837 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.290 seconds
[0m15:35:38.425536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a3d7752-ae25-4235-b0a0-2b1cb43986e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3E6D1760>]}
[0m15:35:38.428791 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:35:38.428791 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:35:38.428791 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:35:38.428791 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:35:38.428791 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:35:38.428791 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:35:38.470519 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:35:38.473187 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:35:38.474182 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_year,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_year,
        YEAR(last_transaction_year) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_year < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    COUNT(customer_id) AS No_of_churned_products
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name
ORDER BY
    last_transaction_year
  );
[0m15:35:38.474182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:38.999628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafffd-0001-429a-0008-511e0001e03a
[0m15:35:39.001636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'LAST_TRANSACTION_YEAR'
[0m15:35:39.005652 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LAST_TRANSACTION_YEAR'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:35:39.005652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a3d7752-ae25-4235-b0a0-2b1cb43986e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3BAE0500>]}
[0m15:35:39.005652 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.58s]
[0m15:35:39.005652 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:35:39.005652 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LAST_TRANSACTION_YEAR'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m15:35:39.005652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:39.005652 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:35:39.005652 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:35:39.082260 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:35:39.082260 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:35:39.162573 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:35:39.162573 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:35:39.246231 [info ] [MainThread]: 
[0m15:35:39.246231 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m15:35:39.246231 [debug] [MainThread]: Command end result
[0m15:35:39.334014 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:35:39.336458 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:35:39.342665 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:35:39.342665 [info ] [MainThread]: 
[0m15:35:39.343820 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:35:39.344601 [info ] [MainThread]: 
[0m15:35:39.345208 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LAST_TRANSACTION_YEAR'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:35:39.345910 [info ] [MainThread]: 
[0m15:35:39.346429 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:35:39.347502 [debug] [MainThread]: Command `dbt run` failed at 15:35:39.347502 after 3.78 seconds
[0m15:35:39.347502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD398A7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3BF878C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD3E65CBC0>]}
[0m15:35:39.347502 [debug] [MainThread]: Flushing usage events
[0m15:35:40.250760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:07.025139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001459D4B2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A09B5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A09B4F80>]}


============================== 15:36:07.030375 | f3cb777d-b340-46c3-b694-f162ce08db65 ==============================
[0m15:36:07.030375 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:36:07.030375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:36:07.459918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3cb777d-b340-46c3-b694-f162ce08db65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A1DFC680>]}
[0m15:36:07.507306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3cb777d-b340-46c3-b694-f162ce08db65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A1A842C0>]}
[0m15:36:07.507306 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:36:07.832836 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:36:07.981378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:07.981378 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m15:36:08.220081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:36:08.220081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3cb777d-b340-46c3-b694-f162ce08db65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A33EA750>]}
[0m15:36:08.296558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:36:08.303459 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:36:08.328125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3cb777d-b340-46c3-b694-f162ce08db65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A311CF20>]}
[0m15:36:08.328125 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:36:08.331331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cb777d-b340-46c3-b694-f162ce08db65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A1EBB260>]}
[0m15:36:08.331331 [info ] [MainThread]: 
[0m15:36:08.333455 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:08.333455 [info ] [MainThread]: 
[0m15:36:08.333455 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:36:08.333455 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:36:08.424272 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:36:08.424272 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:36:08.425304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:09.388386 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.967 seconds
[0m15:36:09.404275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:36:09.420388 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:36:09.420388 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:36:09.420388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:09.857854 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.430 seconds
[0m15:36:09.872341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3cb777d-b340-46c3-b694-f162ce08db65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A31959A0>]}
[0m15:36:09.888239 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:36:09.890259 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:36:09.890259 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:36:09.890259 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:36:09.897873 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:36:09.897873 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:36:09.932410 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:36:09.934763 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:36:09.934763 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_year,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_year,
        YEAR(last_transaction_year) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_year < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    COUNT(customer_id) AS No_of_churned_products
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name
  );
[0m15:36:09.934763 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:36:10.471055 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafffe-0001-429e-0008-511e0001d93a
[0m15:36:10.471055 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'LAST_TRANSACTION_YEAR'
[0m15:36:10.471055 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LAST_TRANSACTION_YEAR'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:36:10.471055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3cb777d-b340-46c3-b694-f162ce08db65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A05A0A40>]}
[0m15:36:10.471055 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.58s]
[0m15:36:10.471055 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:36:10.471055 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LAST_TRANSACTION_YEAR'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m15:36:10.471055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:10.471055 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:36:10.471055 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:36:10.570636 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:36:10.572647 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:36:10.647527 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:36:10.647527 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:36:10.730839 [info ] [MainThread]: 
[0m15:36:10.730839 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m15:36:10.746912 [debug] [MainThread]: Command end result
[0m15:36:10.836330 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:36:10.838461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:36:10.843785 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:36:10.843785 [info ] [MainThread]: 
[0m15:36:10.845162 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:36:10.845868 [info ] [MainThread]: 
[0m15:36:10.846469 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LAST_TRANSACTION_YEAR'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:36:10.846469 [info ] [MainThread]: 
[0m15:36:10.847470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:10.848893 [debug] [MainThread]: Command `dbt run` failed at 15:36:10.848893 after 3.99 seconds
[0m15:36:10.848893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001459E3139B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001459EC51D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145A32D60C0>]}
[0m15:36:10.848893 [debug] [MainThread]: Flushing usage events
[0m15:36:11.774480 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:42.526653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020303392360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030390ADB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030390A060>]}


============================== 15:37:42.530742 | d3780667-8044-48ec-9618-aee5f924e43d ==============================
[0m15:37:42.530742 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:37:42.532415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:37:42.990277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3780667-8044-48ec-9618-aee5f924e43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020306F24B60>]}
[0m15:37:43.059513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3780667-8044-48ec-9618-aee5f924e43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020306F24B90>]}
[0m15:37:43.060578 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:37:43.406063 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:37:43.563530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:43.565538 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m15:37:43.807721 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:37:43.824408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3780667-8044-48ec-9618-aee5f924e43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030859A5A0>]}
[0m15:37:43.907776 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:37:43.910771 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:37:43.924012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3780667-8044-48ec-9618-aee5f924e43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203082D58E0>]}
[0m15:37:43.924012 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:37:43.924012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3780667-8044-48ec-9618-aee5f924e43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203084093A0>]}
[0m15:37:43.939202 [info ] [MainThread]: 
[0m15:37:43.941116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:43.941647 [info ] [MainThread]: 
[0m15:37:43.941647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:43.941647 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:37:44.031069 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:37:44.031069 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:37:44.032101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:45.459849 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.439 seconds
[0m15:37:45.476698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:37:45.493085 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:37:45.493085 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:37:45.493085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:45.988458 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.488 seconds
[0m15:37:45.994406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3780667-8044-48ec-9618-aee5f924e43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020307FD8560>]}
[0m15:37:45.998805 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:37:45.998805 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:37:45.999734 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:37:45.999734 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:37:46.007681 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:37:46.010162 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:37:46.030505 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:37:46.030505 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:37:46.030505 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    COUNT(customer_id) AS No_of_churned_products
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name;
[0m15:37:46.030505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:37:46.348122 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffff-0001-429b-0008-511e0001f02a
[0m15:37:46.348122 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 58 at position 53 unexpected ';'.
[0m15:37:46.352419 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 53 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:37:46.354457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3780667-8044-48ec-9618-aee5f924e43d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020308B1A5D0>]}
[0m15:37:46.354457 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.35s]
[0m15:37:46.355675 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:37:46.356680 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 53 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m15:37:46.357714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:46.358749 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:37:46.358749 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:37:46.444448 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:37:46.444448 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:37:46.540074 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:37:46.540074 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:37:46.642787 [info ] [MainThread]: 
[0m15:37:46.642787 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m15:37:46.642787 [debug] [MainThread]: Command end result
[0m15:37:46.732773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:37:46.732773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:37:46.745781 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:37:46.746785 [info ] [MainThread]: 
[0m15:37:46.746785 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:37:46.748112 [info ] [MainThread]: 
[0m15:37:46.748642 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 53 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:37:46.749340 [info ] [MainThread]: 
[0m15:37:46.749931 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:37:46.750561 [debug] [MainThread]: Command `dbt run` failed at 15:37:46.750561 after 4.40 seconds
[0m15:37:46.750561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002030594AA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020308278680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020308278B60>]}
[0m15:37:46.751591 [debug] [MainThread]: Flushing usage events
[0m15:37:47.611729 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:38:10.548848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635AD04440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635AD04380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635AD040B0>]}


============================== 15:38:10.556834 | 51873992-ab77-4d64-9aac-0c3505fadc11 ==============================
[0m15:38:10.556834 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:38:10.556834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:11.008075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51873992-ab77-4d64-9aac-0c3505fadc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635A1D3D10>]}
[0m15:38:11.067837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51873992-ab77-4d64-9aac-0c3505fadc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635AFCC3B0>]}
[0m15:38:11.067837 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:38:11.389076 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:38:11.569341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:11.570376 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\churn.sql
[0m15:38:11.809090 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:38:11.809090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51873992-ab77-4d64-9aac-0c3505fadc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635CF25760>]}
[0m15:38:11.885791 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:38:11.885791 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:38:11.919461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51873992-ab77-4d64-9aac-0c3505fadc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635CD6D0A0>]}
[0m15:38:11.919461 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:38:11.919461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51873992-ab77-4d64-9aac-0c3505fadc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635CB28B30>]}
[0m15:38:11.919461 [info ] [MainThread]: 
[0m15:38:11.924446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:38:11.924446 [info ] [MainThread]: 
[0m15:38:11.924446 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:38:11.924446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:38:12.013066 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:38:12.013066 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:38:12.014098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:12.882012 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.875 seconds
[0m15:38:12.894064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:38:12.910182 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:38:12.910182 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:38:12.910182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:13.379415 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.472 seconds
[0m15:38:13.395400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51873992-ab77-4d64-9aac-0c3505fadc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635D440650>]}
[0m15:38:13.411351 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:38:13.411351 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:38:13.411351 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:38:13.411351 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:38:13.422601 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:38:13.422601 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:38:13.453538 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:38:13.456893 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:38:13.456893 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    COUNT(customer_id) AS No_of_churned_products
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name
  );
[0m15:38:13.457928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:13.970820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m15:38:14.042822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51873992-ab77-4d64-9aac-0c3505fadc11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635A1D07D0>]}
[0m15:38:14.042822 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.63s]
[0m15:38:14.042822 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:38:14.042822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:14.042822 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:38:14.042822 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:38:14.137890 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:38:14.137890 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:38:14.224685 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:38:14.224685 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:38:14.300523 [info ] [MainThread]: 
[0m15:38:14.308299 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m15:38:14.308299 [debug] [MainThread]: Command end result
[0m15:38:14.322448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:38:14.322448 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:38:14.340800 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:38:14.340800 [info ] [MainThread]: 
[0m15:38:14.341707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:38:14.342707 [info ] [MainThread]: 
[0m15:38:14.342707 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:38:14.343838 [debug] [MainThread]: Command `dbt run` succeeded at 15:38:14.343838 after 3.96 seconds
[0m15:38:14.343838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635A1D1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635A1D16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002635A1D07D0>]}
[0m15:38:14.343838 [debug] [MainThread]: Flushing usage events
[0m15:38:15.238958 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:55.738971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290151D520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290151F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290151F9E0>]}


============================== 15:39:55.738971 | 75b74e34-1569-47b2-8ec0-88ae812f3370 ==============================
[0m15:39:55.738971 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:39:55.738971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:39:55.875925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75b74e34-1569-47b2-8ec0-88ae812f3370', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229011F5D00>]}
[0m15:39:55.895403 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:39:55.895403 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:39:55.895403 [debug] [MainThread]: Command `cli deps` succeeded at 15:39:55.895403 after 0.34 seconds
[0m15:39:55.895403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002297E30B680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290151F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002290151F9E0>]}
[0m15:39:55.895403 [debug] [MainThread]: Flushing usage events
[0m15:39:57.178606 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:03.462019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DF9F1E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E04C0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E04C3CE0>]}


============================== 15:40:03.462019 | 771554ff-5f42-497e-8237-9c35c05bbdbf ==============================
[0m15:40:03.462019 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:40:03.462019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:40:03.848258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '771554ff-5f42-497e-8237-9c35c05bbdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E0FCE990>]}
[0m15:40:03.913831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '771554ff-5f42-497e-8237-9c35c05bbdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E105DD60>]}
[0m15:40:03.915840 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:40:04.297702 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:40:04.442095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:04.442095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:04.448733 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:40:04.482152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '771554ff-5f42-497e-8237-9c35c05bbdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E0E87770>]}
[0m15:40:04.548862 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:40:04.573973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:40:04.579225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '771554ff-5f42-497e-8237-9c35c05bbdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E25F82C0>]}
[0m15:40:04.595360 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:40:04.595360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '771554ff-5f42-497e-8237-9c35c05bbdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E12DB830>]}
[0m15:40:04.595360 [info ] [MainThread]: 
[0m15:40:04.595360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:40:04.595360 [info ] [MainThread]: 
[0m15:40:04.595360 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:40:04.595360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:40:07.513720 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:40:07.513720 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:40:07.513720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:08.572525 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.052 seconds
[0m15:40:08.577748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:40:08.584349 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:40:08.584349 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:40:08.584349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:08.911403 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.326 seconds
[0m15:40:08.926556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '771554ff-5f42-497e-8237-9c35c05bbdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E2AB63C0>]}
[0m15:40:08.944190 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:40:08.944190 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:40:08.944190 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:40:08.944190 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:40:08.952497 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:40:08.952497 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:40:08.987750 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:40:08.994176 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:40:08.994176 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    COUNT(customer_id) AS No_of_churned_products
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name
  );
[0m15:40:08.995241 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:40:09.717708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m15:40:09.749780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771554ff-5f42-497e-8237-9c35c05bbdbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227DD8617C0>]}
[0m15:40:09.749780 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.79s]
[0m15:40:09.749780 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:40:09.749780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:09.749780 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:40:09.753653 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:40:09.819887 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:40:09.819887 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:40:09.915068 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:40:09.915068 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:40:10.010239 [info ] [MainThread]: 
[0m15:40:10.010239 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m15:40:10.010239 [debug] [MainThread]: Command end result
[0m15:40:10.045478 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:40:10.045478 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:40:10.055695 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:40:10.055695 [info ] [MainThread]: 
[0m15:40:10.055695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:10.055695 [info ] [MainThread]: 
[0m15:40:10.055695 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:40:10.055695 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:10.055695 after 6.76 seconds
[0m15:40:10.055695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E128B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E12284D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227E04C0380>]}
[0m15:40:10.055695 [debug] [MainThread]: Flushing usage events
[0m15:40:10.969948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:03.148168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15E2146E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15E2145C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15E214650>]}


============================== 15:41:03.163872 | c6f19e95-b64c-4b8a-a800-d8e0184672b0 ==============================
[0m15:41:03.163872 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:41:03.163872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:03.538806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6f19e95-b64c-4b8a-a800-d8e0184672b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15EC06990>]}
[0m15:41:03.602830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6f19e95-b64c-4b8a-a800-d8e0184672b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15EF2B740>]}
[0m15:41:03.602830 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:41:03.923925 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:41:04.057234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:04.057234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:04.057234 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:41:04.101165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6f19e95-b64c-4b8a-a800-d8e0184672b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15D772540>]}
[0m15:41:04.171264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:41:04.174897 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:41:04.190741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6f19e95-b64c-4b8a-a800-d8e0184672b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15FF70EC0>]}
[0m15:41:04.197418 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:41:04.197418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6f19e95-b64c-4b8a-a800-d8e0184672b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A16002EC00>]}
[0m15:41:04.200019 [info ] [MainThread]: 
[0m15:41:04.200019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:41:04.200019 [info ] [MainThread]: 
[0m15:41:04.200019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:41:04.200019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:41:04.300967 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:41:04.300967 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:41:04.300967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:05.267315 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.976 seconds
[0m15:41:05.283374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:41:05.283374 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:41:05.283374 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:41:05.283374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:05.783452 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.497 seconds
[0m15:41:05.799302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6f19e95-b64c-4b8a-a800-d8e0184672b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A160378680>]}
[0m15:41:05.799302 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:41:05.799302 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:41:05.799302 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:41:05.799302 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:41:05.825687 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:41:05.825687 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:41:05.844981 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:41:05.861694 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:41:05.861694 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name
  );
[0m15:41:05.862727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:06.444900 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0003-0001-429e-0008-511e0001d9d2
[0m15:41:06.444900 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001104 (42601): SQL compilation error: error line 54 at position 4
'CHURNEDCUSTOMERS.LAST_TRANSACTION_DATE' in select clause is neither an aggregate nor in the group by clause.
[0m15:41:06.460988 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001104 (42601): SQL compilation error: error line 54 at position 4
  'CHURNEDCUSTOMERS.LAST_TRANSACTION_DATE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:41:06.460988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6f19e95-b64c-4b8a-a800-d8e0184672b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A16042BC20>]}
[0m15:41:06.460988 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.66s]
[0m15:41:06.460988 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:41:06.460988 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001104 (42601): SQL compilation error: error line 54 at position 4
  'CHURNEDCUSTOMERS.LAST_TRANSACTION_DATE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m15:41:06.460988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:06.460988 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:41:06.460988 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:41:06.543600 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:41:06.543600 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:41:06.640892 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:41:06.640892 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:41:06.720717 [info ] [MainThread]: 
[0m15:41:06.722724 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m15:41:06.722724 [debug] [MainThread]: Command end result
[0m15:41:06.747949 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:41:06.750603 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:41:06.752795 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:41:06.752795 [info ] [MainThread]: 
[0m15:41:06.752795 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:41:06.752795 [info ] [MainThread]: 
[0m15:41:06.760070 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001104 (42601): SQL compilation error: error line 54 at position 4
  'CHURNEDCUSTOMERS.LAST_TRANSACTION_DATE' in select clause is neither an aggregate nor in the group by clause.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:41:06.761086 [info ] [MainThread]: 
[0m15:41:06.762293 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:41:06.762293 [debug] [MainThread]: Command `dbt run` failed at 15:41:06.762293 after 3.77 seconds
[0m15:41:06.762293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1601BA2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A15EEC0DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A16006AC00>]}
[0m15:41:06.765748 [debug] [MainThread]: Flushing usage events
[0m15:41:08.000320 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:42:11.103782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDC6403E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDC643A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDC641880>]}


============================== 15:42:11.109118 | 79f20128-d3f4-4263-8afc-c2c8d54051d1 ==============================
[0m15:42:11.109118 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:42:11.109118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s churn', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:11.535609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79f20128-d3f4-4263-8afc-c2c8d54051d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDD34BB30>]}
[0m15:42:11.591653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79f20128-d3f4-4263-8afc-c2c8d54051d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDC936480>]}
[0m15:42:11.591653 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:42:11.940665 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:42:12.093270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:12.093270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:12.099254 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:42:12.129174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79f20128-d3f4-4263-8afc-c2c8d54051d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDE3FA180>]}
[0m15:42:12.212459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:42:12.218443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:42:12.459596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79f20128-d3f4-4263-8afc-c2c8d54051d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDE48B980>]}
[0m15:42:12.459596 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:42:12.459596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f20128-d3f4-4263-8afc-c2c8d54051d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDE44B1A0>]}
[0m15:42:12.474739 [info ] [MainThread]: 
[0m15:42:12.475783 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:42:12.476288 [info ] [MainThread]: 
[0m15:42:12.479772 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:42:12.481098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:42:12.638616 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:42:12.638616 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:42:12.638616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:14.478022 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.838 seconds
[0m15:42:14.489765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:42:14.492883 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:42:14.492883 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:42:14.492883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:14.929240 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.424 seconds
[0m15:42:14.935113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79f20128-d3f4-4263-8afc-c2c8d54051d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDEC05EE0>]}
[0m15:42:14.935113 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:42:14.935113 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:42:14.935113 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:42:14.935113 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:42:14.952192 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:42:14.953805 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:42:14.978840 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:42:14.978840 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:42:14.978840 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name, last_transaction_date
  );
[0m15:42:14.978840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:15.497452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m15:42:15.512822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79f20128-d3f4-4263-8afc-c2c8d54051d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD99E1790>]}
[0m15:42:15.512822 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.58s]
[0m15:42:15.512822 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:42:15.529259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:15.529259 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:42:15.529259 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:42:15.620253 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:42:15.620253 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:42:15.692217 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:42:15.692217 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:42:15.789236 [info ] [MainThread]: 
[0m15:42:15.789236 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m15:42:15.795801 [debug] [MainThread]: Command end result
[0m15:42:15.820248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:42:15.820248 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:42:15.832137 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:42:15.833010 [info ] [MainThread]: 
[0m15:42:15.833010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:15.834224 [info ] [MainThread]: 
[0m15:42:15.834224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:42:15.836320 [debug] [MainThread]: Command `dbt run` succeeded at 15:42:15.835277 after 4.91 seconds
[0m15:42:15.836320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDBF22F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDBF661E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BDC643E30>]}
[0m15:42:15.836320 [debug] [MainThread]: Flushing usage events
[0m15:42:16.814068 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:43:08.878151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A2DF230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A857E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A854F80>]}


============================== 15:43:08.878151 | 5c914d3d-3768-43dd-b14b-7ac566448deb ==============================
[0m15:43:08.878151 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:43:08.878151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:09.265943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c914d3d-3768-43dd-b14b-7ac566448deb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743B7EEF90>]}
[0m15:43:09.327853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c914d3d-3768-43dd-b14b-7ac566448deb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743BA54B90>]}
[0m15:43:09.327853 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:43:09.639871 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:43:09.787102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:43:09.787102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:43:09.793127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:43:09.822575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c914d3d-3768-43dd-b14b-7ac566448deb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743ADD2720>]}
[0m15:43:09.889257 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:43:09.900595 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:43:09.916621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c914d3d-3768-43dd-b14b-7ac566448deb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743CF544D0>]}
[0m15:43:09.920796 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:43:09.920796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c914d3d-3768-43dd-b14b-7ac566448deb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743CBDB830>]}
[0m15:43:09.920796 [info ] [MainThread]: 
[0m15:43:09.920796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:43:09.920796 [info ] [MainThread]: 
[0m15:43:09.920796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:43:09.920796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:43:10.019321 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:43:10.020324 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:43:10.020324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:10.943839 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.923 seconds
[0m15:43:10.950021 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:43:10.951470 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:43:10.951470 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:43:10.951470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:11.392558 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.439 seconds
[0m15:43:11.406369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c914d3d-3768-43dd-b14b-7ac566448deb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743D3C28A0>]}
[0m15:43:11.406369 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:43:11.406369 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:43:11.406369 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:43:11.406369 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:43:11.421936 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:43:11.423062 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:43:11.451978 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:43:11.451978 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:43:11.451978 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
ORDER BY
    last_transaction_year
  );
[0m15:43:11.451978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:43:11.940666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m15:43:11.952903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c914d3d-3768-43dd-b14b-7ac566448deb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174381718B0>]}
[0m15:43:11.968596 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.55s]
[0m15:43:11.969161 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:43:11.969161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:11.969161 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:43:11.969161 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:43:12.052307 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:43:12.052307 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:43:12.143399 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:43:12.145407 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:43:12.212243 [info ] [MainThread]: 
[0m15:43:12.212243 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m15:43:12.228061 [debug] [MainThread]: Command end result
[0m15:43:12.253233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:43:12.256896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:43:12.260890 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:43:12.260890 [info ] [MainThread]: 
[0m15:43:12.260890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:43:12.260890 [info ] [MainThread]: 
[0m15:43:12.260890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:43:12.260890 [debug] [MainThread]: Command `dbt run` succeeded at 15:43:12.260890 after 3.55 seconds
[0m15:43:12.260890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743B764320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A5FCCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001743A9164E0>]}
[0m15:43:12.260890 [debug] [MainThread]: Flushing usage events
[0m15:43:13.170671 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:09.939474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E1998260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E1998D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E19984A0>]}


============================== 15:44:09.943225 | b519dc60-f539-4d48-8d00-bec1bd81dc9e ==============================
[0m15:44:09.943225 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:44:09.943225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:10.312792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b519dc60-f539-4d48-8d00-bec1bd81dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E26BE990>]}
[0m15:44:10.374240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b519dc60-f539-4d48-8d00-bec1bd81dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E37E8470>]}
[0m15:44:10.375271 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:44:10.686594 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:44:10.828145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:10.830153 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:10.834169 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m15:44:10.861708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b519dc60-f539-4d48-8d00-bec1bd81dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E37E9FA0>]}
[0m15:44:10.927407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:44:10.927407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:44:10.955543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b519dc60-f539-4d48-8d00-bec1bd81dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E3B8C260>]}
[0m15:44:10.955543 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:44:10.958514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b519dc60-f539-4d48-8d00-bec1bd81dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E37EAFF0>]}
[0m15:44:10.959518 [info ] [MainThread]: 
[0m15:44:10.959518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:44:10.959518 [info ] [MainThread]: 
[0m15:44:10.959518 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:44:10.959518 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:44:11.055487 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:44:11.056519 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:44:11.056519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:11.962115 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.911 seconds
[0m15:44:11.988097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:44:12.010054 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:44:12.010054 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:44:12.010054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:12.483731 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.470 seconds
[0m15:44:12.496067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b519dc60-f539-4d48-8d00-bec1bd81dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E37E8C80>]}
[0m15:44:12.511787 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:44:12.511787 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:44:12.511787 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:44:12.511787 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:44:12.532827 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:44:12.535021 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:44:12.563299 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:44:12.565308 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:44:12.565308 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name, last_transaction_date
  );
[0m15:44:12.565308 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:44:13.078034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m15:44:13.093976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b519dc60-f539-4d48-8d00-bec1bd81dc9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E0E60950>]}
[0m15:44:13.093976 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.58s]
[0m15:44:13.109626 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:44:13.109626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:13.109626 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:44:13.109626 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:44:13.192491 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:44:13.192491 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:44:13.292622 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:44:13.292622 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:44:13.358215 [info ] [MainThread]: 
[0m15:44:13.358215 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m15:44:13.358215 [debug] [MainThread]: Command end result
[0m15:44:13.397711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:44:13.400917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:44:13.405427 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:44:13.405427 [info ] [MainThread]: 
[0m15:44:13.405427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:13.405427 [info ] [MainThread]: 
[0m15:44:13.405427 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:44:13.410930 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:13.410930 after 3.64 seconds
[0m15:44:13.410930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E1999010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E1998D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201E1998260>]}
[0m15:44:13.410930 [debug] [MainThread]: Flushing usage events
[0m15:44:14.355341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:26.050251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE870F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE8704A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE870350>]}


============================== 15:57:26.063163 | 48741d99-3215-4f76-b728-199fb5a7b433 ==============================
[0m15:57:26.063163 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:57:26.063163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s churn', 'send_anonymous_usage_stats': 'True'}
[0m15:57:26.745690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48741d99-3215-4f76-b728-199fb5a7b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE03F0E0>]}
[0m15:57:26.809452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48741d99-3215-4f76-b728-199fb5a7b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EEB2C2C0>]}
[0m15:57:26.809452 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:57:27.267893 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:57:27.410193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:27.410193 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:27.417444 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:57:27.448261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48741d99-3215-4f76-b728-199fb5a7b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EF733410>]}
[0m15:57:27.508599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:57:27.540058 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:57:27.607565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48741d99-3215-4f76-b728-199fb5a7b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EF733260>]}
[0m15:57:27.607565 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:57:27.609574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48741d99-3215-4f76-b728-199fb5a7b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EF5CB830>]}
[0m15:57:27.609574 [info ] [MainThread]: 
[0m15:57:27.609574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:27.609574 [info ] [MainThread]: 
[0m15:57:27.609574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:27.609574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:57:30.435282 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:57:30.435282 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:57:30.435282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:32.022149 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.587 seconds
[0m15:57:32.033078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:57:32.045157 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:57:32.045684 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:57:32.046014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:32.863998 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.819 seconds
[0m15:57:32.870231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48741d99-3215-4f76-b728-199fb5a7b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F0ACBE60>]}
[0m15:57:32.882535 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:57:32.882535 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:57:32.882535 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:57:32.882535 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:57:32.897125 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:57:32.898172 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:57:32.917330 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:57:32.931437 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:57:32.931437 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--         customer_id, 
--         customer_name,
--         product_sub_family
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year
--     FROM
--         LastTransaction
--     WHERE
--         last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
-- )
-- SELECT
--     last_transaction_year,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, customer_id, customer_name, last_transaction_date








WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id, 
        customer_name
),
ChurnedCustomers AS (
    SELECT
        lt.customer_id, 
        lt.customer_name,
        lt.last_transaction_date,
        YEAR(lt.last_transaction_date) AS last_transaction_year,
        MONTH(lt.last_transaction_date) AS last_transaction_month
    FROM
        LastTransaction lt
    LEFT JOIN
        MINI_PROJECT.RAW.master1 t_next ON lt.customer_id = t_next.customer_id
        AND t_next.payment_month > lt.last_transaction_date
    WHERE
        t_next.customer_id IS NULL
        AND DATEDIFF(month, lt.last_transaction_date, CURRENT_DATE()) <> 0
)
SELECT
    last_transaction_year,
    last_transaction_month,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
ORDER BY
    last_transaction_year, last_transaction_month;
[0m15:57:32.931437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:33.563849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0013-0001-429a-0008-511e0001e172
[0m15:57:33.563849 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 107 at position 49 unexpected ';'.
[0m15:57:33.580591 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 107 at position 49 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:57:33.580591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48741d99-3215-4f76-b728-199fb5a7b433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EDD107A0>]}
[0m15:57:33.580591 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.70s]
[0m15:57:33.580591 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:57:33.580591 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 107 at position 49 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m15:57:33.580591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:33.580591 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:57:33.580591 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:57:33.680147 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:57:33.681467 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:57:33.764338 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:57:33.764338 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:57:33.865019 [info ] [MainThread]: 
[0m15:57:33.867160 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.26 seconds (6.26s).
[0m15:57:33.867160 [debug] [MainThread]: Command end result
[0m15:57:33.882012 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:57:33.882012 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:57:33.903560 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:57:33.903560 [info ] [MainThread]: 
[0m15:57:33.903560 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:57:33.903560 [info ] [MainThread]: 
[0m15:57:33.903560 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 107 at position 49 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m15:57:33.903560 [info ] [MainThread]: 
[0m15:57:33.903560 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:57:33.903560 [debug] [MainThread]: Command `dbt run` failed at 15:57:33.903560 after 8.06 seconds
[0m15:57:33.903560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE88A8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EF5CBB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F0A64800>]}
[0m15:57:33.903560 [debug] [MainThread]: Flushing usage events
[0m15:57:35.182242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:45.724400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE1ED08C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE1ED1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE1ED0AD0>]}


============================== 15:57:45.724400 | e72cd85b-474a-48b7-93c4-ce1bd5b950f3 ==============================
[0m15:57:45.724400 [info ] [MainThread]: Running with dbt=1.9.3
[0m15:57:45.724400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:46.175155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e72cd85b-474a-48b7-93c4-ce1bd5b950f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE299CB60>]}
[0m15:57:46.225441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e72cd85b-474a-48b7-93c4-ce1bd5b950f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE2BB0DA0>]}
[0m15:57:46.225441 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:57:46.552518 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m15:57:46.689186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:46.689186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:46.694943 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training
- models.training.staging
[0m15:57:46.716887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e72cd85b-474a-48b7-93c4-ce1bd5b950f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE2D9B8C0>]}
[0m15:57:46.795682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:57:46.795682 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:57:46.823815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e72cd85b-474a-48b7-93c4-ce1bd5b950f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE40F3800>]}
[0m15:57:46.823815 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m15:57:46.826756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e72cd85b-474a-48b7-93c4-ce1bd5b950f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE2D4B3E0>]}
[0m15:57:46.826756 [info ] [MainThread]: 
[0m15:57:46.828755 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:46.828755 [info ] [MainThread]: 
[0m15:57:46.828755 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:46.828755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m15:57:46.922588 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m15:57:46.923622 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m15:57:46.923622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:48.218704 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.296 seconds
[0m15:57:48.226009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m15:57:48.234533 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m15:57:48.234533 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m15:57:48.234533 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:48.520777 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.295 seconds
[0m15:57:48.536711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e72cd85b-474a-48b7-93c4-ce1bd5b950f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE4488860>]}
[0m15:57:48.536711 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m15:57:48.536711 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m15:57:48.536711 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m15:57:48.536711 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m15:57:48.550458 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m15:57:48.553926 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m15:57:48.579722 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m15:57:48.588778 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m15:57:48.588778 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--         customer_id, 
--         customer_name,
--         product_sub_family
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year
--     FROM
--         LastTransaction
--     WHERE
--         last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
-- )
-- SELECT
--     last_transaction_year,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, customer_id, customer_name, last_transaction_date








WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id, 
        customer_name
),
ChurnedCustomers AS (
    SELECT
        lt.customer_id, 
        lt.customer_name,
        lt.last_transaction_date,
        YEAR(lt.last_transaction_date) AS last_transaction_year,
        MONTH(lt.last_transaction_date) AS last_transaction_month
    FROM
        LastTransaction lt
    LEFT JOIN
        MINI_PROJECT.RAW.master1 t_next ON lt.customer_id = t_next.customer_id
        AND t_next.payment_month > lt.last_transaction_date
    WHERE
        t_next.customer_id IS NULL
        AND DATEDIFF(month, lt.last_transaction_date, CURRENT_DATE()) <> 0
)
SELECT
    last_transaction_year,
    last_transaction_month,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
ORDER BY
    last_transaction_year, last_transaction_month
  );
[0m15:57:48.588778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:49.226933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m15:57:49.252785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72cd85b-474a-48b7-93c4-ce1bd5b950f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDF271550>]}
[0m15:57:49.252785 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.churn ..................................... [[32mSUCCESS 1[0m in 0.71s]
[0m15:57:49.252785 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m15:57:49.256373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:49.256373 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m15:57:49.256373 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m15:57:49.346683 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m15:57:49.346683 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m15:57:49.457556 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m15:57:49.457556 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m15:57:49.538622 [info ] [MainThread]: 
[0m15:57:49.554711 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m15:57:49.554711 [debug] [MainThread]: Command end result
[0m15:57:49.588047 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m15:57:49.598253 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m15:57:49.598253 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m15:57:49.598253 [info ] [MainThread]: 
[0m15:57:49.598253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:57:49.598253 [info ] [MainThread]: 
[0m15:57:49.598253 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:57:49.598253 [debug] [MainThread]: Command `dbt run` succeeded at 15:57:49.598253 after 4.04 seconds
[0m15:57:49.598253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDF5CF7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE2C0BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE4566510>]}
[0m15:57:49.598253 [debug] [MainThread]: Flushing usage events
[0m15:57:50.512549 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:02:36.517952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150E364590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150E364140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150E3645F0>]}


============================== 16:02:36.522637 | 5daf5ccb-765b-4ef9-8074-34b224cb237d ==============================
[0m16:02:36.522637 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:02:36.522637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:02:36.955859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5daf5ccb-765b-4ef9-8074-34b224cb237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215101083E0>]}
[0m16:02:37.035163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5daf5ccb-765b-4ef9-8074-34b224cb237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150F0B8EF0>]}
[0m16:02:37.036627 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:02:37.384181 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:02:37.534894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:02:37.534894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:02:37.534894 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m16:02:37.569033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5daf5ccb-765b-4ef9-8074-34b224cb237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215101FAEA0>]}
[0m16:02:37.634545 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:02:37.650667 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:02:37.668393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5daf5ccb-765b-4ef9-8074-34b224cb237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215101FB830>]}
[0m16:02:37.668393 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m16:02:37.668393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5daf5ccb-765b-4ef9-8074-34b224cb237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215101B8950>]}
[0m16:02:37.668393 [info ] [MainThread]: 
[0m16:02:37.668393 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:02:37.668393 [info ] [MainThread]: 
[0m16:02:37.668393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:02:37.668393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:02:37.780666 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:02:37.780666 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:02:37.780666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:38.868176 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.088 seconds
[0m16:02:38.868176 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:02:38.884920 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:02:38.884920 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:02:38.884920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:39.408860 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.531 seconds
[0m16:02:39.418014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5daf5ccb-765b-4ef9-8074-34b224cb237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002151034A720>]}
[0m16:02:39.418014 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m16:02:39.418014 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m16:02:39.418014 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m16:02:39.418014 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m16:02:39.437506 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m16:02:39.438533 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m16:02:39.453428 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m16:02:39.469950 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m16:02:39.469950 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--         customer_id, 
--         customer_name,
--         product_sub_family
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year
--     FROM
--         LastTransaction
--     WHERE
--         last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
-- )
-- SELECT
--     last_transaction_year,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, customer_id, customer_name, last_transaction_date








WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id, 
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year,
        MONTH(last_transaction_date) AS last_transaction_month
    FROM
        LastTransaction lt
    WHERE
        t_next.customer_id IS NULL
        AND DATEDIFF(month, lt.last_transaction_date, CURRENT_DATE()) <> 0
        AND AND payment_month > last_transaction_dat
)
SELECT
    last_transaction_year,
    last_transaction_month,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
ORDER BY
    last_transaction_year, last_transaction_month
  );
[0m16:02:39.469950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:02:39.804651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0018-0001-429a-0008-511e0001e1d6
[0m16:02:39.804651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 92 at position 12 unexpected 'AND'.
[0m16:02:39.809089 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 92 at position 12 unexpected 'AND'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m16:02:39.811123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5daf5ccb-765b-4ef9-8074-34b224cb237d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215109F1CA0>]}
[0m16:02:39.811123 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.39s]
[0m16:02:39.812319 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m16:02:39.813321 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 92 at position 12 unexpected 'AND'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m16:02:39.815087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:39.815087 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:02:39.816090 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:02:39.904123 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:02:39.904123 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:02:39.987490 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m16:02:39.987490 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m16:02:40.068784 [info ] [MainThread]: 
[0m16:02:40.068784 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m16:02:40.068784 [debug] [MainThread]: Command end result
[0m16:02:40.107650 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:02:40.109900 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:02:40.112101 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:02:40.112101 [info ] [MainThread]: 
[0m16:02:40.112101 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:02:40.112101 [info ] [MainThread]: 
[0m16:02:40.112101 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 92 at position 12 unexpected 'AND'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m16:02:40.112101 [info ] [MainThread]: 
[0m16:02:40.112101 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:02:40.120983 [debug] [MainThread]: Command `dbt run` failed at 16:02:40.120983 after 3.77 seconds
[0m16:02:40.122143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021510976240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150EF6FEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002150E6DA9C0>]}
[0m16:02:40.122143 [debug] [MainThread]: Flushing usage events
[0m16:02:41.372353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:41.924158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EF882750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F2A21CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F2A21E50>]}


============================== 16:03:41.924158 | b0e9bf77-8511-4856-95d2-6d304b36188a ==============================
[0m16:03:41.924158 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:03:41.924158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s churn', 'send_anonymous_usage_stats': 'True'}
[0m16:03:42.361715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0e9bf77-8511-4856-95d2-6d304b36188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F42AE990>]}
[0m16:03:42.425409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0e9bf77-8511-4856-95d2-6d304b36188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F328E570>]}
[0m16:03:42.425409 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:03:42.753242 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:03:42.894188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:42.894188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:42.899946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m16:03:42.917946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0e9bf77-8511-4856-95d2-6d304b36188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F55DEEA0>]}
[0m16:03:42.984048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:03:43.001475 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:03:43.015613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0e9bf77-8511-4856-95d2-6d304b36188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F56F4440>]}
[0m16:03:43.015613 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m16:03:43.015613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0e9bf77-8511-4856-95d2-6d304b36188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F535AB10>]}
[0m16:03:43.032652 [info ] [MainThread]: 
[0m16:03:43.032652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:43.033775 [info ] [MainThread]: 
[0m16:03:43.034372 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:43.035398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:03:43.127220 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:03:43.127220 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:03:43.128522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:44.030033 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.914 seconds
[0m16:03:44.049822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:03:44.061472 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:03:44.061472 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:03:44.061472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:44.515551 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.453 seconds
[0m16:03:44.531515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0e9bf77-8511-4856-95d2-6d304b36188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F092B470>]}
[0m16:03:44.531515 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m16:03:44.531515 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m16:03:44.531515 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m16:03:44.531515 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m16:03:44.531515 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m16:03:44.548353 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m16:03:44.577122 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m16:03:44.579409 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m16:03:44.580442 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--         customer_id, 
--         customer_name,
--         product_sub_family
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year
--     FROM
--         LastTransaction
--     WHERE
--         last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
-- )
-- SELECT
--     last_transaction_year,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, customer_id, customer_name, last_transaction_date








WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id, 
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year,
        MONTH(last_transaction_date) AS last_transaction_month
    FROM
        LastTransaction lt
    WHERE
        t_next.customer_id IS NULL
        AND DATEDIFF(month, lt.last_transaction_date, CURRENT_DATE()) <> 0
        AND payment_month > last_transaction_dat
)
SELECT
    last_transaction_year,
    last_transaction_month,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
ORDER BY
    last_transaction_year, last_transaction_month
  );
[0m16:03:44.580442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:45.000579 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0019-0001-429a-0008-511e0001e1ea
[0m16:03:45.004874 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 90 at position 8
invalid identifier 'T_NEXT.CUSTOMER_ID'
[0m16:03:45.004874 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 90 at position 8
  invalid identifier 'T_NEXT.CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m16:03:45.004874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0e9bf77-8511-4856-95d2-6d304b36188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F29907A0>]}
[0m16:03:45.004874 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.47s]
[0m16:03:45.004874 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m16:03:45.004874 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 90 at position 8
  invalid identifier 'T_NEXT.CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m16:03:45.004874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:45.004874 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:03:45.004874 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:03:45.098565 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:03:45.099622 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:03:45.179383 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m16:03:45.180887 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m16:03:45.249537 [info ] [MainThread]: 
[0m16:03:45.249537 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m16:03:45.249537 [debug] [MainThread]: Command end result
[0m16:03:45.286917 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:03:45.286917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:03:45.286917 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:03:45.286917 [info ] [MainThread]: 
[0m16:03:45.286917 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:03:45.298031 [info ] [MainThread]: 
[0m16:03:45.298651 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  000904 (42000): SQL compilation error: error line 90 at position 8
  invalid identifier 'T_NEXT.CUSTOMER_ID'
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m16:03:45.299340 [info ] [MainThread]: 
[0m16:03:45.299932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:45.300526 [debug] [MainThread]: Command `dbt run` failed at 16:03:45.300526 after 3.54 seconds
[0m16:03:45.301557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8EF882750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F328E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8F28BD130>]}
[0m16:03:45.301557 [debug] [MainThread]: Flushing usage events
[0m16:03:46.183274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:27.536406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920A708170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920A708BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920A70B950>]}


============================== 16:23:27.536406 | a044c02b-301b-4ca4-88d2-f37071746136 ==============================
[0m16:23:27.536406 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:23:27.552382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s churn', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:23:27.927492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a044c02b-301b-4ca4-88d2-f37071746136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920AA0C3B0>]}
[0m16:23:27.995086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a044c02b-301b-4ca4-88d2-f37071746136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920B1D0530>]}
[0m16:23:27.995086 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:23:28.377069 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:23:28.509638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:28.509638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:28.525337 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.training.staging
- models.training
[0m16:23:28.552754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a044c02b-301b-4ca4-88d2-f37071746136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920B5D46B0>]}
[0m16:23:28.618026 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:23:28.634165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:23:28.649872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a044c02b-301b-4ca4-88d2-f37071746136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920C6F6390>]}
[0m16:23:28.649872 [info ] [MainThread]: Found 10 models, 4 sources, 474 macros
[0m16:23:28.649872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a044c02b-301b-4ca4-88d2-f37071746136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920C7EEF60>]}
[0m16:23:28.665511 [info ] [MainThread]: 
[0m16:23:28.665511 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:28.665511 [info ] [MainThread]: 
[0m16:23:28.665511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:28.665511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:23:28.752587 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:23:28.752587 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:23:28.752587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:29.545362 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.789 seconds
[0m16:23:29.545362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:23:29.565064 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:23:29.565064 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:23:29.565064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:29.878002 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.314 seconds
[0m16:23:29.881167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a044c02b-301b-4ca4-88d2-f37071746136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920B5D42C0>]}
[0m16:23:29.881167 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m16:23:29.881167 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.churn .......................................... [RUN]
[0m16:23:29.893765 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.churn'
[0m16:23:29.893765 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m16:23:29.901294 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m16:23:29.903302 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m16:23:29.920368 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m16:23:29.937197 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m16:23:29.937197 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--         customer_id, 
--         customer_name,
--         product_sub_family
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year
--     FROM
--         LastTransaction
--     WHERE
--         last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
-- )
-- SELECT
--     last_transaction_year,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, customer_id, customer_name, last_transaction_date








WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id, 
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year,
        MONTH(last_transaction_date) AS last_transaction_month
    FROM
        LastTransaction
    WHERE
     IS NULL
        AND DATEDIFF(month last_transaction_date, CURRENT_DATE()) <> 0
        AND payment_month > last_transaction_dat
)
SELECT
    last_transaction_year,
    last_transaction_month,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
ORDER BY
    last_transaction_year, last_transaction_month
  );
[0m16:23:29.937197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:30.489347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb002d-0001-429e-0008-511e0001db02
[0m16:23:30.489347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 90 at position 5 unexpected 'IS'.
syntax error line 91 at position 27 unexpected 'last_transaction_date'.
[0m16:23:30.489347 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 5 unexpected 'IS'.
  syntax error line 91 at position 27 unexpected 'last_transaction_date'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m16:23:30.498084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a044c02b-301b-4ca4-88d2-f37071746136', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002920C6F4230>]}
[0m16:23:30.498084 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.churn ................................. [[31mERROR[0m in 0.61s]
[0m16:23:30.498084 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m16:23:30.498084 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 5 unexpected 'IS'.
  syntax error line 91 at position 27 unexpected 'last_transaction_date'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m16:23:30.501407 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:30.501407 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:23:30.501407 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:23:30.585103 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:23:30.585103 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:23:30.665790 [debug] [MainThread]: Connection 'model.Mini_Project.churn' was left open.
[0m16:23:30.667532 [debug] [MainThread]: On model.Mini_Project.churn: Close
[0m16:23:30.747283 [info ] [MainThread]: 
[0m16:23:30.753068 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m16:23:30.753068 [debug] [MainThread]: Command end result
[0m16:23:30.777557 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:23:30.777557 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:23:30.777557 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:23:30.786811 [info ] [MainThread]: 
[0m16:23:30.787912 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:23:30.788621 [info ] [MainThread]: 
[0m16:23:30.788621 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 5 unexpected 'IS'.
  syntax error line 91 at position 27 unexpected 'last_transaction_date'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m16:23:30.788621 [info ] [MainThread]: 
[0m16:23:30.788621 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:23:30.788621 [debug] [MainThread]: Command `dbt run` failed at 16:23:30.788621 after 3.42 seconds
[0m16:23:30.788621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292084AE6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292084AE780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292084AE660>]}
[0m16:23:30.788621 [debug] [MainThread]: Flushing usage events
[0m16:23:31.697351 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:55.919458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EE151550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EE150F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EE1517C0>]}


============================== 16:43:55.936029 | 67d390d0-93df-48c7-ac22-7845c71736a3 ==============================
[0m16:43:55.936029 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:43:55.936403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s CustomerChurn6Mon\\', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:43:56.689908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67d390d0-93df-48c7-ac22-7845c71736a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EE124B00>]}
[0m16:43:56.754421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67d390d0-93df-48c7-ac22-7845c71736a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EE16E1E0>]}
[0m16:43:56.756429 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:43:57.195468 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:43:57.347005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:57.347005 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:57.347005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training.mart
- models.training.intermediate
- models.training.staging
- models.training
[0m16:43:57.384463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67d390d0-93df-48c7-ac22-7845c71736a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EE107B30>]}
[0m16:43:57.460627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:43:57.477356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:43:57.520944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67d390d0-93df-48c7-ac22-7845c71736a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290F012E6C0>]}
[0m16:43:57.520944 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:43:57.520944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67d390d0-93df-48c7-ac22-7845c71736a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290F03003E0>]}
[0m16:43:57.524821 [warn ] [MainThread]: The selection criterion 'CustomerChurn6Mon\' does not match any enabled nodes
[0m16:43:57.524821 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:43:57.530042 [debug] [MainThread]: Command end result
[0m16:43:57.555684 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:43:57.559615 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:43:57.565344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:43:57.567849 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:57.567849 after 1.83 seconds
[0m16:43:57.567849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EDA33530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EDC644D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290EDC67080>]}
[0m16:43:57.567849 [debug] [MainThread]: Flushing usage events
[0m16:43:58.565148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:03.117849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCDEC0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCB291D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCD809220>]}


============================== 16:44:03.117849 | 99d64e93-a6f8-485e-bf59-b2dcf9efe447 ==============================
[0m16:44:03.117849 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:44:03.117849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:44:03.573663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99d64e93-a6f8-485e-bf59-b2dcf9efe447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCE90FFE0>]}
[0m16:44:03.652680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99d64e93-a6f8-485e-bf59-b2dcf9efe447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCE96E1E0>]}
[0m16:44:03.663603 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:44:04.018556 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:44:04.738805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:04.896294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:04.903993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training
- models.training.mart
- models.training.staging
- models.training.intermediate
[0m16:44:04.940598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d64e93-a6f8-485e-bf59-b2dcf9efe447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCFD1A7E0>]}
[0m16:44:05.066021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:44:05.078612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:44:05.257048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d64e93-a6f8-485e-bf59-b2dcf9efe447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BD005E0C0>]}
[0m16:44:05.265840 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:44:05.265840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d64e93-a6f8-485e-bf59-b2dcf9efe447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCFD1B7A0>]}
[0m16:44:05.267850 [info ] [MainThread]: 
[0m16:44:05.269862 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:05.271769 [info ] [MainThread]: 
[0m16:44:05.275786 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:44:05.281817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:44:10.334721 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:44:10.335718 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:44:10.335718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:11.545864 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.214 seconds
[0m16:44:11.545864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:44:11.561298 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:44:11.561298 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:44:11.561298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:12.056645 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.492 seconds
[0m16:44:12.056645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d64e93-a6f8-485e-bf59-b2dcf9efe447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCFCDAB70>]}
[0m16:44:12.072387 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m16:44:12.072387 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.CustomerChurn6Mon .............................. [RUN]
[0m16:44:12.072387 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m16:44:12.072387 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m16:44:12.075723 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:44:12.075723 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m16:44:12.116809 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:44:12.118969 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m16:44:12.118969 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    with churne(
    SELECT 
    customer_id
    , customer_name
    , CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1 AND last_transaction_date < ADD_MONTHS(SYSDATE , -6)
)
SELECT
    *
FROM
    churne
  );
[0m16:44:12.118969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:12.655665 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0042-0001-429e-0008-511e0001db0a
[0m16:44:12.655665 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 4 unexpected 'SELECT'.
syntax error line 8 at position 4 unexpected ','.
syntax error line 8 at position 14 unexpected '('.
syntax error line 8 at position 30 unexpected 'AS'.
syntax error line 8 at position 39 unexpected 'AS'.
[0m16:44:12.675759 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:44:12.678476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d64e93-a6f8-485e-bf59-b2dcf9efe447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCD360740>]}
[0m16:44:12.678476 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.CustomerChurn6Mon ..................... [[31mERROR[0m in 0.60s]
[0m16:44:12.679490 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m16:44:12.680784 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql.
[0m16:44:12.681780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:12.683113 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:44:12.683113 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:44:12.785324 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:44:12.794414 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:44:12.899544 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m16:44:12.899544 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m16:44:12.990571 [info ] [MainThread]: 
[0m16:44:12.990571 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m16:44:12.990571 [debug] [MainThread]: Command end result
[0m16:44:13.013662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:44:13.028785 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:44:13.035533 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:44:13.035533 [info ] [MainThread]: 
[0m16:44:13.035533 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:44:13.035533 [info ] [MainThread]: 
[0m16:44:13.035533 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:44:13.035533 [info ] [MainThread]: 
[0m16:44:13.035533 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:44:13.035533 [debug] [MainThread]: Command `dbt run` failed at 16:44:13.035533 after 10.10 seconds
[0m16:44:13.035533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCD3F5E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCD774CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BCBBA9BB0>]}
[0m16:44:13.035533 [debug] [MainThread]: Flushing usage events
[0m16:44:13.973751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:15.053827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016705EF83E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167022D2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016705DA36B0>]}


============================== 16:45:15.056532 | e1db2804-be44-47e7-aa48-c19d37c19ad6 ==============================
[0m16:45:15.056532 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:45:15.056532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:45:15.727838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1db2804-be44-47e7-aa48-c19d37c19ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016705EB7B90>]}
[0m16:45:15.789460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1db2804-be44-47e7-aa48-c19d37c19ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016704DD3710>]}
[0m16:45:15.791200 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:45:16.146398 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:45:16.278426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:45:16.278426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:45:16.294520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training.staging
- models.training.mart
- models.training
- models.training.intermediate
[0m16:45:16.316930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1db2804-be44-47e7-aa48-c19d37c19ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016706CB2F60>]}
[0m16:45:16.392536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:45:16.392536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:45:16.423889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1db2804-be44-47e7-aa48-c19d37c19ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016706D42870>]}
[0m16:45:16.423889 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:45:16.423889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1db2804-be44-47e7-aa48-c19d37c19ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016706C014C0>]}
[0m16:45:16.423889 [info ] [MainThread]: 
[0m16:45:16.428941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:45:16.428941 [info ] [MainThread]: 
[0m16:45:16.428941 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:45:16.428941 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:45:16.521763 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:45:16.522766 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:45:16.522766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:17.561570 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.038 seconds
[0m16:45:17.561570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:45:17.577413 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:45:17.579420 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:45:17.579420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:18.093550 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.524 seconds
[0m16:45:18.107415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1db2804-be44-47e7-aa48-c19d37c19ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670862D3D0>]}
[0m16:45:18.109423 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m16:45:18.109423 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.CustomerChurn6Mon .............................. [RUN]
[0m16:45:18.109423 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m16:45:18.109423 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m16:45:18.109423 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:45:18.109423 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m16:45:18.144976 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:45:18.144976 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m16:45:18.144976 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    with Churne(
    SELECT 
    customer_id
    , customer_name
    , CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1 AND last_transaction_date < ADD_MONTHS(SYSDATE , -6)
)
SELECT
    *
FROM
    Churne
  );
[0m16:45:18.144976 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:45:18.534084 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0043-0001-429a-0008-511e0001e202
[0m16:45:18.534084 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 4 unexpected 'SELECT'.
syntax error line 8 at position 4 unexpected ','.
syntax error line 8 at position 14 unexpected '('.
syntax error line 8 at position 30 unexpected 'AS'.
syntax error line 8 at position 39 unexpected 'AS'.
[0m16:45:18.550197 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:45:18.554940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1db2804-be44-47e7-aa48-c19d37c19ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167053A04D0>]}
[0m16:45:18.554940 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.CustomerChurn6Mon ..................... [[31mERROR[0m in 0.44s]
[0m16:45:18.554940 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m16:45:18.554940 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql.
[0m16:45:18.554940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:18.554940 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:45:18.554940 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:45:18.652018 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:45:18.652018 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:45:18.743398 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m16:45:18.743398 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m16:45:18.865013 [info ] [MainThread]: 
[0m16:45:18.872212 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m16:45:18.876073 [debug] [MainThread]: Command end result
[0m16:45:18.912969 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:45:18.915128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:45:18.923167 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:45:18.923167 [info ] [MainThread]: 
[0m16:45:18.923167 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:45:18.925176 [info ] [MainThread]: 
[0m16:45:18.925176 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:45:18.925176 [info ] [MainThread]: 
[0m16:45:18.925176 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:45:18.928005 [debug] [MainThread]: Command `dbt run` failed at 16:45:18.928005 after 4.04 seconds
[0m16:45:18.929474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016703B23C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001670829F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016705BCCCE0>]}
[0m16:45:18.929474 [debug] [MainThread]: Flushing usage events
[0m16:45:19.875934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:59.989799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121333F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121333C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121333EB70>]}


============================== 16:45:59.994254 | 7b13bbac-fd36-432b-a320-86974663f5d7 ==============================
[0m16:45:59.994254 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:45:59.995297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:46:00.434875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b13bbac-fd36-432b-a320-86974663f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212135CCB00>]}
[0m16:46:00.488096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b13bbac-fd36-432b-a320-86974663f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212134B4B90>]}
[0m16:46:00.488096 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:46:00.815433 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:46:00.959764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:00.959764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:00.964927 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training
- models.training.mart
- models.training.intermediate
- models.training.staging
[0m16:46:00.994804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b13bbac-fd36-432b-a320-86974663f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021215520C50>]}
[0m16:46:01.054610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:46:01.072490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:46:01.086163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b13bbac-fd36-432b-a320-86974663f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121548FF50>]}
[0m16:46:01.086163 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:46:01.086163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b13bbac-fd36-432b-a320-86974663f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021213473710>]}
[0m16:46:01.102081 [info ] [MainThread]: 
[0m16:46:01.102081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:01.102081 [info ] [MainThread]: 
[0m16:46:01.102081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:46:01.102081 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:46:01.198383 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:46:01.198383 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:46:01.199415 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:02.007683 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.808 seconds
[0m16:46:02.009691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:46:02.014809 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:46:02.014809 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:46:02.014809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:02.467652 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.443 seconds
[0m16:46:02.467652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b13bbac-fd36-432b-a320-86974663f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021215B101A0>]}
[0m16:46:02.467652 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m16:46:02.467652 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.CustomerChurn6Mon .............................. [RUN]
[0m16:46:02.467652 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m16:46:02.467652 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m16:46:02.487803 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:46:02.489814 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m16:46:02.518506 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:46:02.519708 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m16:46:02.519708 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    with Churne(
    SELECT 
    customer_id
    , customer_name
    , CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    , MONTH(last_transaction_date) AS last_transaction_month
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1 AND last_transaction_month < ADD_MONTHS(SYSDATE , -6)
)
SELECT
    *
FROM
    Churne
  );
[0m16:46:02.520857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:02.842008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0044-0001-429a-0008-511e0001e20a
[0m16:46:02.842008 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 4 unexpected 'SELECT'.
syntax error line 8 at position 4 unexpected ','.
syntax error line 8 at position 14 unexpected '('.
syntax error line 8 at position 30 unexpected 'AS'.
syntax error line 8 at position 39 unexpected 'AS'.
[0m16:46:02.851978 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:46:02.851978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b13bbac-fd36-432b-a320-86974663f5d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212129209B0>]}
[0m16:46:02.851978 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.CustomerChurn6Mon ..................... [[31mERROR[0m in 0.38s]
[0m16:46:02.851978 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m16:46:02.857713 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql.
[0m16:46:02.857713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:02.857713 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:46:02.857713 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:46:02.953791 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:46:02.953791 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:46:03.032579 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m16:46:03.032579 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m16:46:03.149314 [info ] [MainThread]: 
[0m16:46:03.149314 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m16:46:03.149314 [debug] [MainThread]: Command end result
[0m16:46:03.175473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:46:03.177940 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:46:03.183802 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:46:03.183802 [info ] [MainThread]: 
[0m16:46:03.183802 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:46:03.183802 [info ] [MainThread]: 
[0m16:46:03.183802 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 4 unexpected 'SELECT'.
  syntax error line 8 at position 4 unexpected ','.
  syntax error line 8 at position 14 unexpected '('.
  syntax error line 8 at position 30 unexpected 'AS'.
  syntax error line 8 at position 39 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:46:03.183802 [info ] [MainThread]: 
[0m16:46:03.183802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:46:03.188936 [debug] [MainThread]: Command `dbt run` failed at 16:46:03.188936 after 3.37 seconds
[0m16:46:03.189940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021212FB6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021212FB7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021212FB7A70>]}
[0m16:46:03.190614 [debug] [MainThread]: Flushing usage events
[0m16:46:04.452194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:59.989670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021887E92E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021886E68BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021887E924B0>]}


============================== 16:47:59.995096 | 3de44d85-5037-4aef-b3f8-e7c3b029af09 ==============================
[0m16:47:59.995096 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:47:59.995096 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:48:00.439469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3de44d85-5037-4aef-b3f8-e7c3b029af09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021887E93080>]}
[0m16:48:00.502567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3de44d85-5037-4aef-b3f8-e7c3b029af09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188782FFB0>]}
[0m16:48:00.502567 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:48:00.821907 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:48:00.965908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:00.965908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:00.971932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training
- models.training.mart
- models.training.staging
- models.training.intermediate
[0m16:48:00.996172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3de44d85-5037-4aef-b3f8-e7c3b029af09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021887E92600>]}
[0m16:48:01.057909 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:48:01.073825 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:48:01.089539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3de44d85-5037-4aef-b3f8-e7c3b029af09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188A0B37D0>]}
[0m16:48:01.089539 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:48:01.089539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3de44d85-5037-4aef-b3f8-e7c3b029af09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188736AF30>]}
[0m16:48:01.089539 [info ] [MainThread]: 
[0m16:48:01.105273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:01.105273 [info ] [MainThread]: 
[0m16:48:01.105273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:01.105273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:48:01.199227 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:48:01.199227 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:48:01.200225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:02.310847 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.116 seconds
[0m16:48:02.330237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:48:02.331839 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:48:02.331839 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:48:02.331839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:02.704336 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.366 seconds
[0m16:48:02.725469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3de44d85-5037-4aef-b3f8-e7c3b029af09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021889D2ABA0>]}
[0m16:48:02.734894 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m16:48:02.734894 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.CustomerChurn6Mon .............................. [RUN]
[0m16:48:02.734894 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m16:48:02.734894 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m16:48:02.765053 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:48:02.767097 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m16:48:02.804334 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:48:02.806342 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m16:48:02.808113 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        MONTH(last_transaction_date) AS last_transaction_month
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_month < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne;
[0m16:48:02.808113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:03.293425 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0046-0001-429b-0008-511e0001f1de
[0m16:48:03.293425 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 23 at position 10 unexpected ';'.
[0m16:48:03.293425 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 10 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:48:03.308582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3de44d85-5037-4aef-b3f8-e7c3b029af09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002188A565E20>]}
[0m16:48:03.309661 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.CustomerChurn6Mon ..................... [[31mERROR[0m in 0.56s]
[0m16:48:03.309661 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m16:48:03.309661 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 10 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql.
[0m16:48:03.309661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:03.309661 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:48:03.309661 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:48:03.413832 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:48:03.413832 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:48:03.521451 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m16:48:03.521451 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m16:48:03.623505 [info ] [MainThread]: 
[0m16:48:03.623505 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m16:48:03.623505 [debug] [MainThread]: Command end result
[0m16:48:03.651102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:48:03.651102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:48:03.661774 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:48:03.661774 [info ] [MainThread]: 
[0m16:48:03.661774 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:48:03.661774 [info ] [MainThread]: 
[0m16:48:03.661774 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 23 at position 10 unexpected ';'.
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:48:03.661774 [info ] [MainThread]: 
[0m16:48:03.661774 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:48:03.661774 [debug] [MainThread]: Command `dbt run` failed at 16:48:03.661774 after 3.87 seconds
[0m16:48:03.661774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021887C5D670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021887E47890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021888BC4BF0>]}
[0m16:48:03.661774 [debug] [MainThread]: Flushing usage events
[0m16:48:04.927539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:32.879153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE53D7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE53D7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE53D7C80>]}


============================== 16:48:32.886616 | 6901f55b-67f3-4b30-bbb0-cb3a39b14989 ==============================
[0m16:48:32.886616 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:48:32.886616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:33.299955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6901f55b-67f3-4b30-bbb0-cb3a39b14989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE5436300>]}
[0m16:48:33.366418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6901f55b-67f3-4b30-bbb0-cb3a39b14989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE5E4B650>]}
[0m16:48:33.366418 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:48:33.682457 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:48:33.817401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:33.817401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:33.817401 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training.mart
- models.training.intermediate
- models.training
- models.training.staging
[0m16:48:33.856020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6901f55b-67f3-4b30-bbb0-cb3a39b14989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE72FB3B0>]}
[0m16:48:33.922686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:48:33.922686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:48:33.951280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6901f55b-67f3-4b30-bbb0-cb3a39b14989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE72BADE0>]}
[0m16:48:33.951280 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:48:33.951280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6901f55b-67f3-4b30-bbb0-cb3a39b14989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE7208950>]}
[0m16:48:33.954828 [info ] [MainThread]: 
[0m16:48:33.954828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:48:33.954828 [info ] [MainThread]: 
[0m16:48:33.954828 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:33.954828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:48:34.046165 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:48:34.047198 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:48:34.047198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:35.026141 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.979 seconds
[0m16:48:35.031921 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:48:35.051119 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:48:35.051119 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:48:35.052151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:35.521134 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.482 seconds
[0m16:48:35.537013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6901f55b-67f3-4b30-bbb0-cb3a39b14989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE751FD10>]}
[0m16:48:35.537013 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m16:48:35.537013 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.CustomerChurn6Mon .............................. [RUN]
[0m16:48:35.537013 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m16:48:35.537013 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m16:48:35.552964 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:48:35.552964 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m16:48:35.576090 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:48:35.592347 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m16:48:35.592347 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        MONTH(last_transaction_date) AS last_transaction_month
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_month < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
  );
[0m16:48:35.593423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:48:36.067100 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0046-0001-429b-0008-511e0001f1e6
[0m16:48:36.067100 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001038 (22023): SQL compilation error:
Can not convert parameter 'DATE_ADDMONTHSEOMTODATE(-6, CURRENT_DATE())' of type [DATE] into expected type [NUMBER(2,0)]
[0m16:48:36.075511 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter 'DATE_ADDMONTHSEOMTODATE(-6, CURRENT_DATE())' of type [DATE] into expected type [NUMBER(2,0)]
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:48:36.075511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6901f55b-67f3-4b30-bbb0-cb3a39b14989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE7A761E0>]}
[0m16:48:36.075511 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model RAW.CustomerChurn6Mon ..................... [[31mERROR[0m in 0.54s]
[0m16:48:36.075511 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m16:48:36.075511 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter 'DATE_ADDMONTHSEOMTODATE(-6, CURRENT_DATE())' of type [DATE] into expected type [NUMBER(2,0)]
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql.
[0m16:48:36.075511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:36.075511 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:48:36.083141 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:48:36.175864 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:48:36.175864 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:48:36.272263 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m16:48:36.276134 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m16:48:36.365834 [info ] [MainThread]: 
[0m16:48:36.367841 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m16:48:36.367841 [debug] [MainThread]: Command end result
[0m16:48:36.394902 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:48:36.398542 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:48:36.400537 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:48:36.400537 [info ] [MainThread]: 
[0m16:48:36.405901 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:48:36.405901 [info ] [MainThread]: 
[0m16:48:36.405901 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\Mart\CustomerChurn6Mon.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter 'DATE_ADDMONTHSEOMTODATE(-6, CURRENT_DATE())' of type [DATE] into expected type [NUMBER(2,0)]
  compiled code at target\run\Mini_Project\models\Mart\CustomerChurn6Mon.sql
[0m16:48:36.408021 [info ] [MainThread]: 
[0m16:48:36.408745 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:48:36.409992 [debug] [MainThread]: Command `dbt run` failed at 16:48:36.409992 after 3.69 seconds
[0m16:48:36.410733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE4AB4CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE53D7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE53D7D70>]}
[0m16:48:36.410733 [debug] [MainThread]: Flushing usage events
[0m16:48:37.305311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:47.639965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023006BE08F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023006BE1F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023006BE3EF0>]}


============================== 16:49:47.639965 | 7fe64ca7-9858-41d0-8e98-77bcccaefc5e ==============================
[0m16:49:47.639965 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:49:47.639965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:48.095169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fe64ca7-9858-41d0-8e98-77bcccaefc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023007A4D760>]}
[0m16:49:48.154342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fe64ca7-9858-41d0-8e98-77bcccaefc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230077F2780>]}
[0m16:49:48.154342 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:49:48.470103 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:49:48.612990 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:48.612990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:48.619825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training.staging
- models.training
- models.training.mart
- models.training.intermediate
[0m16:49:48.648568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fe64ca7-9858-41d0-8e98-77bcccaefc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023008C24830>]}
[0m16:49:48.714689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:49:48.714689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:49:48.746650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fe64ca7-9858-41d0-8e98-77bcccaefc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023007AE8170>]}
[0m16:49:48.756097 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:49:48.756097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe64ca7-9858-41d0-8e98-77bcccaefc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230079C3020>]}
[0m16:49:48.758107 [info ] [MainThread]: 
[0m16:49:48.758107 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:48.758107 [info ] [MainThread]: 
[0m16:49:48.758107 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:48.758107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:49:48.855103 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:49:48.856100 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:49:48.856100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:49.983019 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.128 seconds
[0m16:49:49.983019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:49:49.999606 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:49:49.999606 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:49:49.999606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:50.482928 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.486 seconds
[0m16:49:50.482928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fe64ca7-9858-41d0-8e98-77bcccaefc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023007AE8170>]}
[0m16:49:50.493297 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m16:49:50.493297 [info ] [Thread-1 (]: 1 of 1 START sql view model RAW.CustomerChurn6Mon .............................. [RUN]
[0m16:49:50.493297 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m16:49:50.493297 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m16:49:50.505873 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:49:50.507881 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m16:49:50.533505 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m16:49:50.533505 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m16:49:50.533505 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
  );
[0m16:49:50.533505 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:51.100832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m16:49:51.126925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fe64ca7-9858-41d0-8e98-77bcccaefc5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023003F81730>]}
[0m16:49:51.128935 [info ] [Thread-1 (]: 1 of 1 OK created sql view model RAW.CustomerChurn6Mon ......................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:49:51.128935 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m16:49:51.128935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:51.128935 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:49:51.132622 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:49:51.237749 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:49:51.237749 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:49:51.343240 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m16:49:51.343240 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m16:49:51.435814 [info ] [MainThread]: 
[0m16:49:51.435814 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m16:49:51.435814 [debug] [MainThread]: Command end result
[0m16:49:51.465685 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:49:51.471775 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:49:51.478805 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:49:51.480814 [info ] [MainThread]: 
[0m16:49:51.480814 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:51.482823 [info ] [MainThread]: 
[0m16:49:51.484014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:49:51.486441 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:51.486014 after 4.01 seconds
[0m16:49:51.486441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300497E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230063579E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023006357CE0>]}
[0m16:49:51.486441 [debug] [MainThread]: Flushing usage events
[0m16:49:52.416982 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:26.110582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259632F86E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259632F84A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259632F82C0>]}


============================== 16:54:26.126609 | 98bbcf65-9006-42aa-aaf6-41dd8bac41d8 ==============================
[0m16:54:26.126609 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:54:26.126609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s CustomerChurn1Year', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:26.771526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98bbcf65-9006-42aa-aaf6-41dd8bac41d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259632F8FB0>]}
[0m16:54:26.837707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98bbcf65-9006-42aa-aaf6-41dd8bac41d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025962E15970>]}
[0m16:54:26.837707 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:54:27.162640 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:54:27.290336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:54:27.290336 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\CustomerChurn1Year.sql
[0m16:54:27.504981 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Mini_Project.CustomerChurn1Year' (models\Mart\CustomerChurn1Year.sql) depends on a node named 'model' which was not found
[0m16:54:27.506016 [debug] [MainThread]: Command `dbt run` failed at 16:54:27.506016 after 1.57 seconds
[0m16:54:27.506016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025962952F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259653AD5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259650F85C0>]}
[0m16:54:27.506016 [debug] [MainThread]: Flushing usage events
[0m16:54:28.509864 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:04.546908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A961E5A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AA87FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A961E4B0>]}


============================== 16:55:04.546908 | c1e1cf6e-e700-4b79-b4f3-3e6e57986b3a ==============================
[0m16:55:04.546908 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:55:04.546908 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s CustomerChurn1Year', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:05.064703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1e1cf6e-e700-4b79-b4f3-3e6e57986b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AC61E990>]}
[0m16:55:05.114817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1e1cf6e-e700-4b79-b4f3-3e6e57986b3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AC5CB950>]}
[0m16:55:05.131349 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:55:05.617544 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:55:05.765212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:55:05.765212 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\CustomerChurn1Year.sql
[0m16:55:05.982586 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Mini_Project.CustomerChurn1Year' (models\Mart\CustomerChurn1Year.sql) depends on a node named 'model' which was not found
[0m16:55:05.982586 [debug] [MainThread]: Command `dbt run` failed at 16:55:05.982586 after 1.62 seconds
[0m16:55:05.982586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AA87FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256ADA3E4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256AD8B9550>]}
[0m16:55:05.982586 [debug] [MainThread]: Flushing usage events
[0m16:55:06.965472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:24.343352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C1482750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C4D30DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C458EAB0>]}


============================== 16:58:24.351017 | 21a3ce43-c27c-4418-a62e-442ff2b4cc33 ==============================
[0m16:58:24.351017 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:58:24.354724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s rank_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:58:24.788621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21a3ce43-c27c-4418-a62e-442ff2b4cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C46C2420>]}
[0m16:58:24.848058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21a3ce43-c27c-4418-a62e-442ff2b4cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C5EE1790>]}
[0m16:58:24.848058 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:58:25.165238 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:58:25.291303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:58:25.291303 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\CustomerChurn1Year.sql
[0m16:58:25.291303 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m16:58:25.497701 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Mini_Project.CustomerChurn1Year' (models\Mart\CustomerChurn1Year.sql) depends on a node named 'model' which was not found
[0m16:58:25.497701 [debug] [MainThread]: Command `dbt run` failed at 16:58:25.497701 after 1.33 seconds
[0m16:58:25.497701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C4A8F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C7294080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242C5B69A30>]}
[0m16:58:25.497701 [debug] [MainThread]: Flushing usage events
[0m16:58:26.652385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:53.969448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642D438AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642D438110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642D438200>]}


============================== 16:58:53.980573 | afec5fb0-0194-41f8-a609-d8e23cadf1b4 ==============================
[0m16:58:53.980573 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:58:53.980573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s rank_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:58:54.406705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afec5fb0-0194-41f8-a609-d8e23cadf1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642DDBB5C0>]}
[0m16:58:54.454209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afec5fb0-0194-41f8-a609-d8e23cadf1b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642C46EBD0>]}
[0m16:58:54.454209 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:58:54.788164 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:58:54.931418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:58:54.931418 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\Mart\CustomerChurn1Year.sql
[0m16:58:54.931418 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m16:58:55.130709 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Mini_Project.CustomerChurn1Year' (models\Mart\CustomerChurn1Year.sql) depends on a node named 'model1' which was not found
[0m16:58:55.130709 [debug] [MainThread]: Command `dbt run` failed at 16:58:55.130709 after 1.33 seconds
[0m16:58:55.130709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642D438E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642F60B320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001642E2AB920>]}
[0m16:58:55.130709 [debug] [MainThread]: Flushing usage events
[0m16:58:56.074410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:17.282838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1E44F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1E47F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1E44D70>]}


============================== 16:59:17.282838 | 5207be68-f2d8-453d-8000-e5057d1928f4 ==============================
[0m16:59:17.282838 [info ] [MainThread]: Running with dbt=1.9.3
[0m16:59:17.282838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s rank_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:59:17.737997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5207be68-f2d8-453d-8000-e5057d1928f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA28CAF90>]}
[0m16:59:17.803847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5207be68-f2d8-453d-8000-e5057d1928f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA13A20C0>]}
[0m16:59:17.803847 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:59:18.130104 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m16:59:18.283332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:18.288756 [debug] [MainThread]: Partial parsing: updated file: Mini_Project://models\Mart\rank_products.sql
[0m16:59:18.534690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training
- models.training.intermediate
- models.training.mart
- models.training.staging
[0m16:59:18.534690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5207be68-f2d8-453d-8000-e5057d1928f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA409B410>]}
[0m16:59:18.621711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:59:18.643176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:59:18.697402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5207be68-f2d8-453d-8000-e5057d1928f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA3F0C470>]}
[0m16:59:18.697402 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m16:59:18.697402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5207be68-f2d8-453d-8000-e5057d1928f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA40EE240>]}
[0m16:59:18.697402 [info ] [MainThread]: 
[0m16:59:18.697402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:18.697402 [info ] [MainThread]: 
[0m16:59:18.697402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:18.697402 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m16:59:21.619173 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m16:59:21.619173 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m16:59:21.619173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:22.846343 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.231 seconds
[0m16:59:22.872916 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m16:59:22.892604 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m16:59:22.892604 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m16:59:22.893639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:23.189103 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.311 seconds
[0m16:59:23.204614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5207be68-f2d8-453d-8000-e5057d1928f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA45E79E0>]}
[0m16:59:23.220797 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m16:59:23.220797 [info ] [Thread-1 (]: 1 of 1 START sql table model RAW.rank_products ................................. [RUN]
[0m16:59:23.220797 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_products'
[0m16:59:23.220797 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m16:59:23.237558 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m16:59:23.239506 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m16:59:23.257333 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."RANK_PRODUCTS" because it is a view and target relation MINI_PROJECT.RAW.rank_products is of type table.
[0m16:59:23.257333 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."RANK_PRODUCTS"
[0m16:59:23.273277 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m16:59:23.273277 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
drop view if exists "MINI_PROJECT"."RAW"."RANK_PRODUCTS" cascade
[0m16:59:23.273277 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:59:23.646069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.368 seconds
[0m16:59:23.667635 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m16:59:23.669609 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m16:59:23.669609 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m16:59:26.243676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.574 seconds
[0m16:59:26.269579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5207be68-f2d8-453d-8000-e5057d1928f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA1310D10>]}
[0m16:59:26.269579 [info ] [Thread-1 (]: 1 of 1 OK created sql table model RAW.rank_products ............................ [[32mSUCCESS 1[0m in 3.05s]
[0m16:59:26.270807 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m16:59:26.271821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:26.271821 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m16:59:26.272960 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m16:59:26.359326 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m16:59:26.359326 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m16:59:26.447834 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m16:59:26.448877 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m16:59:26.542618 [info ] [MainThread]: 
[0m16:59:26.544684 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m16:59:26.549314 [debug] [MainThread]: Command end result
[0m16:59:26.580921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m16:59:26.582311 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m16:59:26.582311 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m16:59:26.582311 [info ] [MainThread]: 
[0m16:59:26.582311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:26.582311 [info ] [MainThread]: 
[0m16:59:26.592222 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:59:26.594237 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:26.594237 after 9.50 seconds
[0m16:59:26.594872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA416D820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA416F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BA416E0F0>]}
[0m16:59:26.594872 [debug] [MainThread]: Flushing usage events
[0m16:59:27.847782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:02:37.889419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A19B5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A1818620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A19B51F0>]}


============================== 17:02:37.889419 | 7ea641c3-4c41-46a9-aeca-18211701d6dc ==============================
[0m17:02:37.889419 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:02:37.889419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s rank_customer', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:02:38.312270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ea641c3-4c41-46a9-aeca-18211701d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A2561400>]}
[0m17:02:38.375825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ea641c3-4c41-46a9-aeca-18211701d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A270B230>]}
[0m17:02:38.375825 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:02:38.705779 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:02:38.845249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:02:38.845249 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:02:38.845249 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training
- models.training.staging
- models.training.intermediate
- models.training.mart
[0m17:02:38.885413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ea641c3-4c41-46a9-aeca-18211701d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A383E270>]}
[0m17:02:38.951631 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:02:38.951631 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:02:38.983289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ea641c3-4c41-46a9-aeca-18211701d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A23E14C0>]}
[0m17:02:38.983289 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:02:38.983289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea641c3-4c41-46a9-aeca-18211701d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A382A030>]}
[0m17:02:38.983289 [info ] [MainThread]: 
[0m17:02:38.983289 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:38.983289 [info ] [MainThread]: 
[0m17:02:38.983289 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:02:38.983289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:02:39.084845 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:02:39.085945 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:02:39.085945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:40.060333 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.979 seconds
[0m17:02:40.060333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:02:40.082015 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:02:40.084024 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:02:40.084024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:40.402294 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.323 seconds
[0m17:02:40.418010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea641c3-4c41-46a9-aeca-18211701d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A3F18500>]}
[0m17:02:40.418010 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m17:02:40.418010 [info ] [Thread-1 (]: 1 of 1 START sql table model RAW.rank_customer ................................. [RUN]
[0m17:02:40.418010 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.rank_customer'
[0m17:02:40.418010 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m17:02:40.438565 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m17:02:40.439815 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m17:02:40.452986 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."RANK_CUSTOMER" because it is a view and target relation MINI_PROJECT.RAW.rank_customer is of type table.
[0m17:02:40.452986 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."RANK_CUSTOMER"
[0m17:02:40.470130 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m17:02:40.470130 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
drop view if exists "MINI_PROJECT"."RAW"."RANK_CUSTOMER" cascade
[0m17:02:40.470130 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:02:40.822973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m17:02:40.856265 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m17:02:40.858411 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m17:02:40.859591 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m17:02:41.600116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.750 seconds
[0m17:02:41.632401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ea641c3-4c41-46a9-aeca-18211701d6dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D99ED81A60>]}
[0m17:02:41.632401 [info ] [Thread-1 (]: 1 of 1 OK created sql table model RAW.rank_customer ............................ [[32mSUCCESS 1[0m in 1.21s]
[0m17:02:41.632401 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m17:02:41.632401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:41.632401 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:02:41.638778 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:02:41.721005 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:02:41.721005 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:02:41.801974 [debug] [MainThread]: Connection 'model.Mini_Project.rank_customer' was left open.
[0m17:02:41.801974 [debug] [MainThread]: On model.Mini_Project.rank_customer: Close
[0m17:02:41.898799 [info ] [MainThread]: 
[0m17:02:41.898799 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m17:02:41.915989 [debug] [MainThread]: Command end result
[0m17:02:41.944133 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:02:41.944133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:02:41.956051 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:02:41.956051 [info ] [MainThread]: 
[0m17:02:41.956051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:41.956051 [info ] [MainThread]: 
[0m17:02:41.956051 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:02:41.956051 [debug] [MainThread]: Command `dbt run` succeeded at 17:02:41.956051 after 4.23 seconds
[0m17:02:41.956051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D99F77E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A228B080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D9A2409A60>]}
[0m17:02:41.956051 [debug] [MainThread]: Flushing usage events
[0m17:02:42.892366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:08.360093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021006535100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021006534F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021006534260>]}


============================== 17:03:08.360093 | 442f2262-5d22-4537-a02a-56a2f1c5717c ==============================
[0m17:03:08.360093 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:03:08.360093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s new_customer', 'send_anonymous_usage_stats': 'True'}
[0m17:03:08.809446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '442f2262-5d22-4537-a02a-56a2f1c5717c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021006534B00>]}
[0m17:03:08.872339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '442f2262-5d22-4537-a02a-56a2f1c5717c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210055E9340>]}
[0m17:03:08.874814 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:03:09.186783 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:03:09.328816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:09.328816 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:09.328816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training
- models.training.intermediate
- models.training.mart
- models.training.staging
[0m17:03:09.366737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '442f2262-5d22-4537-a02a-56a2f1c5717c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210083CACC0>]}
[0m17:03:09.440313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:03:09.444330 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:03:09.468708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '442f2262-5d22-4537-a02a-56a2f1c5717c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210086E7E30>]}
[0m17:03:09.468708 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:03:09.468708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '442f2262-5d22-4537-a02a-56a2f1c5717c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210083C8950>]}
[0m17:03:09.468708 [info ] [MainThread]: 
[0m17:03:09.473488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:09.473488 [info ] [MainThread]: 
[0m17:03:09.473488 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:09.473488 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:03:09.569582 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:03:09.569582 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:03:09.570614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:10.623300 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.063 seconds
[0m17:03:10.639171 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:03:10.639171 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:03:10.639171 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:03:10.639171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:11.110205 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.470 seconds
[0m17:03:11.126189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '442f2262-5d22-4537-a02a-56a2f1c5717c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210083CB290>]}
[0m17:03:11.142002 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m17:03:11.142002 [info ] [Thread-1 (]: 1 of 1 START sql table model RAW.new_customer .................................. [RUN]
[0m17:03:11.142002 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.new_customer'
[0m17:03:11.157733 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m17:03:11.166814 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m17:03:11.166814 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m17:03:11.185298 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."NEW_CUSTOMER" because it is a view and target relation MINI_PROJECT.RAW.new_customer is of type table.
[0m17:03:11.185298 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."NEW_CUSTOMER"
[0m17:03:11.202135 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m17:03:11.203167 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
drop view if exists "MINI_PROJECT"."RAW"."NEW_CUSTOMER" cascade
[0m17:03:11.203167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:03:11.562171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.361 seconds
[0m17:03:11.577899 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m17:03:11.577899 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m17:03:11.577899 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m17:03:12.339648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m17:03:12.354050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '442f2262-5d22-4537-a02a-56a2f1c5717c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210039018E0>]}
[0m17:03:12.354050 [info ] [Thread-1 (]: 1 of 1 OK created sql table model RAW.new_customer ............................. [[32mSUCCESS 1[0m in 1.21s]
[0m17:03:12.354050 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m17:03:12.354050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:12.354050 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:03:12.354050 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:03:12.469111 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:03:12.469648 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:03:12.569441 [debug] [MainThread]: Connection 'model.Mini_Project.new_customer' was left open.
[0m17:03:12.569441 [debug] [MainThread]: On model.Mini_Project.new_customer: Close
[0m17:03:12.669626 [info ] [MainThread]: 
[0m17:03:12.669626 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m17:03:12.669626 [debug] [MainThread]: Command end result
[0m17:03:12.709206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:03:12.709206 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:03:12.720288 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:03:12.720288 [info ] [MainThread]: 
[0m17:03:12.720288 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:12.720288 [info ] [MainThread]: 
[0m17:03:12.720288 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:03:12.720288 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:12.720288 after 4.52 seconds
[0m17:03:12.720288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210071F2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002100689B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021006534560>]}
[0m17:03:12.720288 [debug] [MainThread]: Flushing usage events
[0m17:03:13.632260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:41.963287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7EAA7EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD03D0BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD049BF1D0>]}


============================== 17:03:41.976481 | 3c16afd6-2d3f-4ac2-9df9-490866507502 ==============================
[0m17:03:41.976481 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:03:41.976481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s product_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:03:42.414663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c16afd6-2d3f-4ac2-9df9-490866507502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD045BB320>]}
[0m17:03:42.464247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c16afd6-2d3f-4ac2-9df9-490866507502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06AF2C30>]}
[0m17:03:42.477759 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:03:42.809475 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:03:42.948932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:42.948932 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:42.948932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training.mart
- models.training.intermediate
- models.training
- models.training.staging
[0m17:03:42.982942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c16afd6-2d3f-4ac2-9df9-490866507502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06BE3B90>]}
[0m17:03:43.064338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:03:43.064338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:03:43.097707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c16afd6-2d3f-4ac2-9df9-490866507502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06F04110>]}
[0m17:03:43.097707 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:03:43.097707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c16afd6-2d3f-4ac2-9df9-490866507502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD04CF6D20>]}
[0m17:03:43.097707 [info ] [MainThread]: 
[0m17:03:43.097707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:43.097707 [info ] [MainThread]: 
[0m17:03:43.097707 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:43.097707 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:03:43.194674 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:03:43.194674 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:03:43.195705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:43.975503 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.780 seconds
[0m17:03:43.981526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:03:43.984501 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:03:43.984501 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:03:43.984501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:44.316940 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.324 seconds
[0m17:03:44.320955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c16afd6-2d3f-4ac2-9df9-490866507502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06BAE390>]}
[0m17:03:44.324970 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m17:03:44.324970 [info ] [Thread-1 (]: 1 of 1 START sql table model RAW.product_churn ................................. [RUN]
[0m17:03:44.326977 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.product_churn'
[0m17:03:44.326977 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m17:03:44.336626 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m17:03:44.339003 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m17:03:44.354570 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."PRODUCT_CHURN" because it is a view and target relation MINI_PROJECT.RAW.product_churn is of type table.
[0m17:03:44.354570 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."PRODUCT_CHURN"
[0m17:03:44.368646 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m17:03:44.368646 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
drop view if exists "MINI_PROJECT"."RAW"."PRODUCT_CHURN" cascade
[0m17:03:44.368646 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:03:44.716116 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m17:03:44.731919 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m17:03:44.733927 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m17:03:44.733927 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m17:03:45.684618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m17:03:45.710092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c16afd6-2d3f-4ac2-9df9-490866507502', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD02121A30>]}
[0m17:03:45.711266 [info ] [Thread-1 (]: 1 of 1 OK created sql table model RAW.product_churn ............................ [[32mSUCCESS 1[0m in 1.38s]
[0m17:03:45.712553 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m17:03:45.713598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:45.713598 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:03:45.713598 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:03:45.802516 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:03:45.802516 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:03:45.893214 [debug] [MainThread]: Connection 'model.Mini_Project.product_churn' was left open.
[0m17:03:45.893214 [debug] [MainThread]: On model.Mini_Project.product_churn: Close
[0m17:03:45.987988 [info ] [MainThread]: 
[0m17:03:45.987988 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m17:03:45.987988 [debug] [MainThread]: Command end result
[0m17:03:46.026306 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:03:46.026306 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:03:46.037989 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:03:46.037989 [info ] [MainThread]: 
[0m17:03:46.037989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:46.037989 [info ] [MainThread]: 
[0m17:03:46.037989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:03:46.037989 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:46.037989 after 4.23 seconds
[0m17:03:46.037989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD04CD7E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD02ADE4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD7EAA7EF0>]}
[0m17:03:46.037989 [debug] [MainThread]: Flushing usage events
[0m17:03:47.341496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:15.341649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DAC43260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DAC40B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DAC40470>]}


============================== 17:07:15.357765 | 83c9267c-3ef4-4da7-9146-0d711de1362a ==============================
[0m17:07:15.357765 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:07:15.357765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:07:15.791784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DAC401D0>]}
[0m17:07:15.851041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DADDC140>]}
[0m17:07:15.851041 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:07:16.165492 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:07:16.292434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:07:16.292434 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:07:16.308442 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training
- models.training.staging
- models.training.intermediate
- models.training.mart
[0m17:07:16.330517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DCA56C30>]}
[0m17:07:16.410253 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:07:16.410253 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:07:16.426005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DCA1B020>]}
[0m17:07:16.426005 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:07:16.441759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DCBA8680>]}
[0m17:07:16.441759 [info ] [MainThread]: 
[0m17:07:16.441759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:16.441759 [info ] [MainThread]: 
[0m17:07:16.446522 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:16.451958 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:07:16.544397 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:07:16.544397 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:07:16.544397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:17.627651 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.084 seconds
[0m17:07:17.627651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:07:17.637417 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:07:17.637417 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:07:17.637417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:18.191443 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.552 seconds
[0m17:07:18.197389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DB96FD10>]}
[0m17:07:18.204339 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m17:07:18.204339 [info ] [Thread-1 (]: 1 of 11 START sql view model RAW.stg_customers ................................. [RUN]
[0m17:07:18.204339 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m17:07:18.204339 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m17:07:18.215008 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m17:07:18.215008 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m17:07:18.247039 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m17:07:18.249662 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m17:07:18.249662 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m17:07:18.250698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:07:18.690448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m17:07:18.706451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D7FE1700>]}
[0m17:07:18.706451 [info ] [Thread-1 (]: 1 of 11 OK created sql view model RAW.stg_customers ............................ [[32mSUCCESS 1[0m in 0.50s]
[0m17:07:18.722202 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m17:07:18.722202 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m17:07:18.722202 [info ] [Thread-1 (]: 2 of 11 START sql view model RAW.stg_products .................................. [RUN]
[0m17:07:18.722202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m17:07:18.722202 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m17:07:18.722202 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m17:07:18.722202 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m17:07:18.722202 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m17:07:18.722202 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m17:07:18.722202 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m17:07:18.932987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m17:07:18.937008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD4271A0>]}
[0m17:07:18.937008 [info ] [Thread-1 (]: 2 of 11 OK created sql view model RAW.stg_products ............................. [[32mSUCCESS 1[0m in 0.21s]
[0m17:07:18.937008 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m17:07:18.937008 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m17:07:18.940595 [info ] [Thread-1 (]: 3 of 11 START sql view model RAW.stg_region .................................... [RUN]
[0m17:07:18.940595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m17:07:18.940595 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m17:07:18.948670 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m17:07:18.951234 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m17:07:18.951234 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m17:07:18.951234 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m17:07:18.951234 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m17:07:19.162429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.207 seconds
[0m17:07:19.162429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD426AE0>]}
[0m17:07:19.162429 [info ] [Thread-1 (]: 3 of 11 OK created sql view model RAW.stg_region ............................... [[32mSUCCESS 1[0m in 0.22s]
[0m17:07:19.162429 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m17:07:19.162429 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m17:07:19.162429 [info ] [Thread-1 (]: 4 of 11 START sql view model RAW.stg_transaction ............................... [RUN]
[0m17:07:19.162429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m17:07:19.162429 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m17:07:19.178557 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m17:07:19.180159 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m17:07:19.183636 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m17:07:19.184717 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m17:07:19.184717 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m17:07:19.491609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m17:07:19.491609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD43DEE0>]}
[0m17:07:19.491609 [info ] [Thread-1 (]: 4 of 11 OK created sql view model RAW.stg_transaction .......................... [[32mSUCCESS 1[0m in 0.33s]
[0m17:07:19.491609 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m17:07:19.491609 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m17:07:19.491609 [info ] [Thread-1 (]: 5 of 11 START sql view model RAW.master1 ....................................... [RUN]
[0m17:07:19.491609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m17:07:19.491609 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m17:07:19.491609 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m17:07:19.503937 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m17:07:19.508817 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m17:07:19.511346 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m17:07:19.511346 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m17:07:19.874126 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.369 seconds
[0m17:07:19.874126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD426E70>]}
[0m17:07:19.874126 [info ] [Thread-1 (]: 5 of 11 OK created sql view model RAW.master1 .................................. [[32mSUCCESS 1[0m in 0.38s]
[0m17:07:19.874126 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m17:07:19.874126 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m17:07:19.874126 [info ] [Thread-1 (]: 6 of 11 START sql view model RAW.CustomerChurn6Mon ............................. [RUN]
[0m17:07:19.874126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m17:07:19.874126 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m17:07:19.890116 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:07:19.891619 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m17:07:19.894202 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:07:19.895236 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m17:07:19.896734 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
  );
[0m17:07:20.285065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.389 seconds
[0m17:07:20.285065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD39F920>]}
[0m17:07:20.285065 [info ] [Thread-1 (]: 6 of 11 OK created sql view model RAW.CustomerChurn6Mon ........................ [[32mSUCCESS 1[0m in 0.41s]
[0m17:07:20.285065 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m17:07:20.285065 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m17:07:20.285065 [info ] [Thread-1 (]: 7 of 11 START sql view model RAW.churn ......................................... [RUN]
[0m17:07:20.285065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m17:07:20.285065 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m17:07:20.295973 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m17:07:20.295973 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m17:07:20.301325 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m17:07:20.304748 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m17:07:20.304748 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--         customer_id, 
--         customer_name,
--         product_sub_family
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year
--     FROM
--         LastTransaction
--     WHERE
--         last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
-- )
-- SELECT
--     last_transaction_year,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, customer_id, customer_name, last_transaction_date








WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id, 
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year,
        MONTH(last_transaction_date) AS last_transaction_month
    FROM
        LastTransaction
    WHERE
     IS NULL
        AND DATEDIFF(month last_transaction_date, CURRENT_DATE()) <> 0
        AND payment_month > last_transaction_dat
)
SELECT
    last_transaction_year,
    last_transaction_month,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
ORDER BY
    last_transaction_year, last_transaction_month
  );
[0m17:07:20.564805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0059-0001-429e-0008-511e0001dd7a
[0m17:07:20.564805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 90 at position 5 unexpected 'IS'.
syntax error line 91 at position 27 unexpected 'last_transaction_date'.
[0m17:07:20.595539 [debug] [Thread-1 (]: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 5 unexpected 'IS'.
  syntax error line 91 at position 27 unexpected 'last_transaction_date'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m17:07:20.596572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD4735F0>]}
[0m17:07:20.596572 [error] [Thread-1 (]: 7 of 11 ERROR creating sql view model RAW.churn ................................ [[31mERROR[0m in 0.31s]
[0m17:07:20.597659 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m17:07:20.597659 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m17:07:20.599444 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.churn' to be skipped because of status 'error'.  Reason: Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 5 unexpected 'IS'.
  syntax error line 91 at position 27 unexpected 'last_transaction_date'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql.
[0m17:07:20.598689 [info ] [Thread-1 (]: 8 of 11 START sql table model RAW.new_customer ................................. [RUN]
[0m17:07:20.599444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.new_customer)
[0m17:07:20.599444 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m17:07:20.599444 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m17:07:20.599444 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m17:07:20.623433 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m17:07:20.623433 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m17:07:20.623433 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m17:07:21.637818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.018 seconds
[0m17:07:21.651917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD5757F0>]}
[0m17:07:21.651917 [info ] [Thread-1 (]: 8 of 11 OK created sql table model RAW.new_customer ............................ [[32mSUCCESS 1[0m in 1.05s]
[0m17:07:21.651917 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m17:07:21.651917 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m17:07:21.651917 [info ] [Thread-1 (]: 9 of 11 START sql table model RAW.product_churn ................................ [RUN]
[0m17:07:21.651917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.product_churn)
[0m17:07:21.651917 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m17:07:21.704076 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m17:07:21.715270 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m17:07:21.721215 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m17:07:21.721215 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m17:07:21.721215 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m17:07:22.535136 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m17:07:22.535136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DCDD7770>]}
[0m17:07:22.535136 [info ] [Thread-1 (]: 9 of 11 OK created sql table model RAW.product_churn ........................... [[32mSUCCESS 1[0m in 0.88s]
[0m17:07:22.535136 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m17:07:22.535136 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m17:07:22.535136 [info ] [Thread-1 (]: 10 of 11 START sql table model RAW.rank_customer ............................... [RUN]
[0m17:07:22.535136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m17:07:22.535136 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m17:07:22.535136 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m17:07:22.535136 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m17:07:22.551102 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m17:07:22.553193 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m17:07:22.553193 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m17:07:23.355592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m17:07:23.368594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD450710>]}
[0m17:07:23.370151 [info ] [Thread-1 (]: 10 of 11 OK created sql table model RAW.rank_customer .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m17:07:23.370151 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m17:07:23.370151 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m17:07:23.370151 [info ] [Thread-1 (]: 11 of 11 START sql table model RAW.rank_products ............................... [RUN]
[0m17:07:23.370151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m17:07:23.370151 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m17:07:23.375545 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m17:07:23.375545 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m17:07:23.381363 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m17:07:23.382397 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m17:07:23.383442 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m17:07:24.103418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m17:07:24.115080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83c9267c-3ef4-4da7-9146-0d711de1362a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DD44C950>]}
[0m17:07:24.117089 [info ] [Thread-1 (]: 11 of 11 OK created sql table model RAW.rank_products .......................... [[32mSUCCESS 1[0m in 0.74s]
[0m17:07:24.117089 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m17:07:24.119334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:24.119334 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:07:24.120171 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:07:24.213265 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:07:24.213265 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:07:24.303427 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m17:07:24.303427 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m17:07:24.409190 [info ] [MainThread]: 
[0m17:07:24.410340 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 7.96 seconds (7.96s).
[0m17:07:24.418801 [debug] [MainThread]: Command end result
[0m17:07:24.455311 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:07:24.455311 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:07:24.455311 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:07:24.455311 [info ] [MainThread]: 
[0m17:07:24.455311 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:07:24.469999 [info ] [MainThread]: 
[0m17:07:24.471248 [error] [MainThread]:   Database Error in model churn (models\Mart\churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 90 at position 5 unexpected 'IS'.
  syntax error line 91 at position 27 unexpected 'last_transaction_date'.
  compiled code at target\run\Mini_Project\models\Mart\churn.sql
[0m17:07:24.471596 [info ] [MainThread]: 
[0m17:07:24.471596 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m17:07:24.471596 [debug] [MainThread]: Command `dbt run` failed at 17:07:24.471596 after 9.29 seconds
[0m17:07:24.475031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DA756690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8D8897620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8DA468260>]}
[0m17:07:24.475031 [debug] [MainThread]: Flushing usage events
[0m17:07:25.789668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:12.138004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1DEB8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1DEB8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1DEB8740>]}


============================== 17:09:12.142690 | 13362781-22be-441c-b855-66c89f260302 ==============================
[0m17:09:12.142690 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:09:12.144063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:12.170084 [info ] [MainThread]: dbt version: 1.9.3
[0m17:09:12.170084 [info ] [MainThread]: python version: 3.12.9
[0m17:09:12.170084 [info ] [MainThread]: python path: C:\Users\FahmidaSanabilSyedAb\AppData\Local\Programs\Python\Python312\python.exe
[0m17:09:12.170084 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m17:09:12.493800 [info ] [MainThread]: Using profiles dir at C:\Users\FahmidaSanabilSyedAb\.dbt
[0m17:09:12.493800 [info ] [MainThread]: Using profiles.yml file at C:\Users\FahmidaSanabilSyedAb\.dbt\profiles.yml
[0m17:09:12.493800 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\FahmidaSanabilSyedAb\Mini_Project\dbt_project.yml
[0m17:09:12.493800 [info ] [MainThread]: adapter type: snowflake
[0m17:09:12.493800 [info ] [MainThread]: adapter version: 1.9.2
[0m17:09:12.595330 [info ] [MainThread]: Configuration:
[0m17:09:12.595330 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:09:12.595330 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:09:12.595330 [info ] [MainThread]: Required dependencies:
[0m17:09:12.595330 [debug] [MainThread]: Executing "git --help"
[0m17:09:12.611925 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m17:09:12.611925 [info ] [MainThread]: Connection:
[0m17:09:12.617468 [info ] [MainThread]:   account: vitgxnh-vz45400
[0m17:09:12.617468 [info ] [MainThread]:   user: Fahmida
[0m17:09:12.618482 [info ] [MainThread]:   database: MINI_PROJECT
[0m17:09:12.618482 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:09:12.619615 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m17:09:12.619615 [info ] [MainThread]:   schema: RAW
[0m17:09:12.620638 [info ] [MainThread]:   authenticator: None
[0m17:09:12.620638 [info ] [MainThread]:   oauth_client_id: None
[0m17:09:12.620638 [info ] [MainThread]:   query_tag: None
[0m17:09:12.622008 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:09:12.622338 [info ] [MainThread]:   host: None
[0m17:09:12.622338 [info ] [MainThread]:   port: None
[0m17:09:12.622338 [info ] [MainThread]:   proxy_host: None
[0m17:09:12.622338 [info ] [MainThread]:   proxy_port: None
[0m17:09:12.622338 [info ] [MainThread]:   protocol: None
[0m17:09:12.622338 [info ] [MainThread]:   connect_retries: 1
[0m17:09:12.622338 [info ] [MainThread]:   connect_timeout: None
[0m17:09:12.622338 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:09:12.622338 [info ] [MainThread]:   retry_all: False
[0m17:09:12.622338 [info ] [MainThread]:   insecure_mode: False
[0m17:09:12.627375 [info ] [MainThread]:   reuse_connections: True
[0m17:09:12.628390 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:09:12.995744 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:09:13.079085 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:09:13.079085 [debug] [MainThread]: On debug: select 1 as id
[0m17:09:13.079085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:13.898038 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.824 seconds
[0m17:09:13.898038 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:09:13.898038 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:09:13.898038 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m17:09:13.898038 [debug] [MainThread]: Command `dbt debug` failed at 17:09:13.898038 after 1.94 seconds
[0m17:09:13.898038 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:09:13.898038 [debug] [MainThread]: On debug: Close
[0m17:09:13.985012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF2025BD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1EBAFC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF1DCEB1A0>]}
[0m17:09:13.985012 [debug] [MainThread]: Flushing usage events
[0m17:09:14.891178 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:23.092742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023566328D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023566328350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235663287D0>]}


============================== 17:13:23.108841 | cc1553c2-1b9e-4a91-a3f7-8680c13693d2 ==============================
[0m17:13:23.108841 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:13:23.108841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:13:23.765752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235670023C0>]}
[0m17:13:23.825936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023567000EC0>]}
[0m17:13:23.827943 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:13:24.256672 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:13:24.396905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:13:24.396905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:13:24.396905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.training.intermediate
- models.training
- models.training.staging
- models.training.mart
[0m17:13:24.431407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235681BAA50>]}
[0m17:13:24.497323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:13:24.515193 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:13:24.553261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356839E4B0>]}
[0m17:13:24.553261 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:13:24.553261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023566F6FFB0>]}
[0m17:13:24.558532 [info ] [MainThread]: 
[0m17:13:24.558532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:24.558532 [info ] [MainThread]: 
[0m17:13:24.560270 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:13:24.562308 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:13:27.270447 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:13:27.271445 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:13:27.271445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:28.218687 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.951 seconds
[0m17:13:28.225940 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:13:28.237629 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:13:28.237629 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:13:28.237629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:28.575194 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.350 seconds
[0m17:13:28.590872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235670BA810>]}
[0m17:13:28.590872 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m17:13:28.590872 [info ] [Thread-1 (]: 1 of 11 START sql view model RAW.stg_customers ................................. [RUN]
[0m17:13:28.590872 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m17:13:28.590872 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m17:13:28.610575 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m17:13:28.612583 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m17:13:28.635785 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m17:13:28.635785 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m17:13:28.635785 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m17:13:28.635785 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:13:29.121210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m17:13:29.136872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235636F17C0>]}
[0m17:13:29.136872 [info ] [Thread-1 (]: 1 of 11 OK created sql view model RAW.stg_customers ............................ [[32mSUCCESS 1[0m in 0.55s]
[0m17:13:29.136872 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m17:13:29.136872 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m17:13:29.136872 [info ] [Thread-1 (]: 2 of 11 START sql view model RAW.stg_products .................................. [RUN]
[0m17:13:29.136872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m17:13:29.136872 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m17:13:29.154733 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m17:13:29.154733 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m17:13:29.158750 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m17:13:29.158750 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m17:13:29.158750 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m17:13:29.380071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m17:13:29.390636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568B26390>]}
[0m17:13:29.392770 [info ] [Thread-1 (]: 2 of 11 OK created sql view model RAW.stg_products ............................. [[32mSUCCESS 1[0m in 0.25s]
[0m17:13:29.395914 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m17:13:29.398002 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m17:13:29.399438 [info ] [Thread-1 (]: 3 of 11 START sql view model RAW.stg_region .................................... [RUN]
[0m17:13:29.401569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m17:13:29.402596 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m17:13:29.406875 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m17:13:29.407906 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m17:13:29.407906 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m17:13:29.407906 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m17:13:29.407906 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m17:13:29.625306 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m17:13:29.630863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568AD4FB0>]}
[0m17:13:29.630863 [info ] [Thread-1 (]: 3 of 11 OK created sql view model RAW.stg_region ............................... [[32mSUCCESS 1[0m in 0.23s]
[0m17:13:29.630863 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m17:13:29.630863 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m17:13:29.630863 [info ] [Thread-1 (]: 4 of 11 START sql view model RAW.stg_transaction ............................... [RUN]
[0m17:13:29.630863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m17:13:29.630863 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m17:13:29.630863 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m17:13:29.630863 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m17:13:29.630863 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m17:13:29.630863 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m17:13:29.630863 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m17:13:29.936848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m17:13:29.936848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568B63110>]}
[0m17:13:29.936848 [info ] [Thread-1 (]: 4 of 11 OK created sql view model RAW.stg_transaction .......................... [[32mSUCCESS 1[0m in 0.31s]
[0m17:13:29.936848 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m17:13:29.936848 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m17:13:29.936848 [info ] [Thread-1 (]: 5 of 11 START sql view model RAW.master1 ....................................... [RUN]
[0m17:13:29.936848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m17:13:29.936848 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m17:13:29.936848 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m17:13:29.936848 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m17:13:29.950093 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m17:13:29.952279 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m17:13:29.952871 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m17:13:30.388085 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.443 seconds
[0m17:13:30.388085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356855A870>]}
[0m17:13:30.388085 [info ] [Thread-1 (]: 5 of 11 OK created sql view model RAW.master1 .................................. [[32mSUCCESS 1[0m in 0.45s]
[0m17:13:30.388085 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m17:13:30.388085 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m17:13:30.388085 [info ] [Thread-1 (]: 6 of 11 START sql view model RAW.CustomerChurn6Mon ............................. [RUN]
[0m17:13:30.388085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m17:13:30.388085 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m17:13:30.404207 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:13:30.404207 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m17:13:30.404207 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:13:30.404207 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m17:13:30.404207 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
  );
[0m17:13:30.761732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.362 seconds
[0m17:13:30.761732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568AFFCB0>]}
[0m17:13:30.761732 [info ] [Thread-1 (]: 6 of 11 OK created sql view model RAW.CustomerChurn6Mon ........................ [[32mSUCCESS 1[0m in 0.37s]
[0m17:13:30.777417 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m17:13:30.777417 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m17:13:30.777417 [info ] [Thread-1 (]: 7 of 11 START sql view model RAW.churn ......................................... [RUN]
[0m17:13:30.777417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m17:13:30.777417 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m17:13:30.777417 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m17:13:30.783979 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m17:13:30.783979 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m17:13:30.783979 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m17:13:30.783979 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name, last_transaction_date








-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     WHERE
--         revenue_type = 1
--     GROUP BY
--         customer_id, 
--         customer_name
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year,
--         MONTH(last_transaction_date) AS last_transaction_month
--     FROM
--         LastTransaction
--     WHERE
--      IS NULL
--         AND DATEDIFF(month last_transaction_date, CURRENT_DATE()) <> 0
--         AND payment_month > last_transaction_dat
-- )
-- SELECT
--     last_transaction_year,
--     last_transaction_month,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
-- ORDER BY
--     last_transaction_year, last_transaction_month
  );
[0m17:13:31.050397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m17:13:31.050397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568BA2BD0>]}
[0m17:13:31.050397 [info ] [Thread-1 (]: 7 of 11 OK created sql view model RAW.churn .................................... [[32mSUCCESS 1[0m in 0.27s]
[0m17:13:31.050397 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m17:13:31.066464 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m17:13:31.066464 [info ] [Thread-1 (]: 8 of 11 START sql table model RAW.new_customer ................................. [RUN]
[0m17:13:31.066464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.new_customer)
[0m17:13:31.066464 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m17:13:31.066464 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m17:13:31.066464 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m17:13:31.088552 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m17:13:31.088552 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m17:13:31.088552 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m17:13:31.857841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.773 seconds
[0m17:13:31.873691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568BDA840>]}
[0m17:13:31.873691 [info ] [Thread-1 (]: 8 of 11 OK created sql table model RAW.new_customer ............................ [[32mSUCCESS 1[0m in 0.81s]
[0m17:13:31.873691 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m17:13:31.873691 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m17:13:31.873691 [info ] [Thread-1 (]: 9 of 11 START sql table model RAW.product_churn ................................ [RUN]
[0m17:13:31.873691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.product_churn)
[0m17:13:31.873691 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m17:13:31.930142 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m17:13:31.932152 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m17:13:31.932152 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m17:13:31.932152 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m17:13:31.937330 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m17:13:32.667663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m17:13:32.667663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356810BF80>]}
[0m17:13:32.667663 [info ] [Thread-1 (]: 9 of 11 OK created sql table model RAW.product_churn ........................... [[32mSUCCESS 1[0m in 0.79s]
[0m17:13:32.667663 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m17:13:32.667663 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m17:13:32.667663 [info ] [Thread-1 (]: 10 of 11 START sql table model RAW.rank_customer ............................... [RUN]
[0m17:13:32.683400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m17:13:32.683400 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m17:13:32.685935 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m17:13:32.685935 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m17:13:32.685935 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m17:13:32.685935 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m17:13:32.685935 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m17:13:33.425940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m17:13:33.441927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568B838C0>]}
[0m17:13:33.441927 [info ] [Thread-1 (]: 10 of 11 OK created sql table model RAW.rank_customer .......................... [[32mSUCCESS 1[0m in 0.76s]
[0m17:13:33.441927 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m17:13:33.441927 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m17:13:33.441927 [info ] [Thread-1 (]: 11 of 11 START sql table model RAW.rank_products ............................... [RUN]
[0m17:13:33.441927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m17:13:33.458779 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m17:13:33.463603 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m17:13:33.463603 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m17:13:33.476374 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m17:13:33.478418 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m17:13:33.479874 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m17:13:34.253019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.779 seconds
[0m17:13:34.253019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1553c2-1b9e-4a91-a3f7-8680c13693d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023568AFC410>]}
[0m17:13:34.253019 [info ] [Thread-1 (]: 11 of 11 OK created sql table model RAW.rank_products .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m17:13:34.253019 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m17:13:34.253019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:34.253019 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:13:34.253019 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:13:34.356753 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:13:34.356753 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:13:34.453485 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m17:13:34.469315 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m17:13:34.582330 [info ] [MainThread]: 
[0m17:13:34.582330 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 10.01 seconds (10.01s).
[0m17:13:34.590600 [debug] [MainThread]: Command end result
[0m17:13:34.625461 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:13:34.625461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:13:34.633678 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:13:34.633678 [info ] [MainThread]: 
[0m17:13:34.633678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:34.633678 [info ] [MainThread]: 
[0m17:13:34.633678 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:13:34.633678 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:34.633678 after 11.71 seconds
[0m17:13:34.633678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023566307710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235657F15E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235657F0FB0>]}
[0m17:13:34.633678 [debug] [MainThread]: Flushing usage events
[0m17:13:36.158268 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:40.377903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719F04320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719F04260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719F04230>]}


============================== 17:14:40.382333 | ab0e0f75-298d-4958-b9c7-6075e6db7481 ==============================
[0m17:14:40.382333 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:14:40.383358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:14:40.831292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719F31C70>]}
[0m17:14:40.889992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E717A904A0>]}
[0m17:14:40.889992 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:14:41.220001 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:14:41.365230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:41.366271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:41.371430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.training
- models.training.mart
- models.training.staging
[0m17:14:41.397158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719F4A660>]}
[0m17:14:41.470261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:14:41.473541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:14:41.498140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C016210>]}
[0m17:14:41.498140 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:14:41.498140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719F49BE0>]}
[0m17:14:41.502517 [info ] [MainThread]: 
[0m17:14:41.502517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:41.502517 [info ] [MainThread]: 
[0m17:14:41.505411 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:41.509428 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:14:41.603226 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:14:41.604252 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:14:41.604252 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:42.524598 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.921 seconds
[0m17:14:42.529973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:14:42.541362 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:14:42.541362 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:14:42.541362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:42.900918 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.352 seconds
[0m17:14:42.906332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71AC5A9F0>]}
[0m17:14:42.911596 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m17:14:42.911596 [info ] [Thread-1 (]: 1 of 11 START sql view model RAW.stg_customers ................................. [RUN]
[0m17:14:42.911596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m17:14:42.911596 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m17:14:42.921793 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m17:14:42.921793 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m17:14:42.943032 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m17:14:42.943032 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m17:14:42.943032 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m17:14:42.943032 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:14:43.384599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m17:14:43.416446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7172D1610>]}
[0m17:14:43.416446 [info ] [Thread-1 (]: 1 of 11 OK created sql view model RAW.stg_customers ............................ [[32mSUCCESS 1[0m in 0.50s]
[0m17:14:43.416446 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m17:14:43.416446 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m17:14:43.416446 [info ] [Thread-1 (]: 2 of 11 START sql view model RAW.stg_products .................................. [RUN]
[0m17:14:43.416446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m17:14:43.416446 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m17:14:43.416446 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m17:14:43.432092 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m17:14:43.435187 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m17:14:43.436267 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m17:14:43.437635 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m17:14:43.609619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m17:14:43.620210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71BD5A750>]}
[0m17:14:43.622441 [info ] [Thread-1 (]: 2 of 11 OK created sql view model RAW.stg_products ............................. [[32mSUCCESS 1[0m in 0.20s]
[0m17:14:43.625843 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m17:14:43.627336 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m17:14:43.628554 [info ] [Thread-1 (]: 3 of 11 START sql view model RAW.stg_region .................................... [RUN]
[0m17:14:43.630608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m17:14:43.631954 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m17:14:43.637255 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m17:14:43.638376 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m17:14:43.640878 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m17:14:43.642283 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m17:14:43.643228 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m17:14:43.833874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m17:14:43.833874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C6E4110>]}
[0m17:14:43.841122 [info ] [Thread-1 (]: 3 of 11 OK created sql view model RAW.stg_region ............................... [[32mSUCCESS 1[0m in 0.20s]
[0m17:14:43.841122 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m17:14:43.841122 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m17:14:43.841122 [info ] [Thread-1 (]: 4 of 11 START sql view model RAW.stg_transaction ............................... [RUN]
[0m17:14:43.841122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m17:14:43.841122 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m17:14:43.841122 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m17:14:43.841122 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m17:14:43.841122 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m17:14:43.841122 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m17:14:43.841122 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m17:14:44.125020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m17:14:44.125020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C70B590>]}
[0m17:14:44.125020 [info ] [Thread-1 (]: 4 of 11 OK created sql view model RAW.stg_transaction .......................... [[32mSUCCESS 1[0m in 0.28s]
[0m17:14:44.125020 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m17:14:44.125020 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m17:14:44.125020 [info ] [Thread-1 (]: 5 of 11 START sql view model RAW.master1 ....................................... [RUN]
[0m17:14:44.125020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m17:14:44.125020 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m17:14:44.141837 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m17:14:44.143509 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m17:14:44.146498 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m17:14:44.148493 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m17:14:44.148493 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m17:14:44.519875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m17:14:44.526967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C671940>]}
[0m17:14:44.526967 [info ] [Thread-1 (]: 5 of 11 OK created sql view model RAW.master1 .................................. [[32mSUCCESS 1[0m in 0.40s]
[0m17:14:44.526967 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m17:14:44.526967 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m17:14:44.526967 [info ] [Thread-1 (]: 6 of 11 START sql view model RAW.CustomerChurn6Mon ............................. [RUN]
[0m17:14:44.526967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m17:14:44.526967 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m17:14:44.546779 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:14:44.547683 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m17:14:44.549783 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:14:44.549783 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m17:14:44.549783 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
  );
[0m17:14:44.877880 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m17:14:44.877880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C708D10>]}
[0m17:14:44.877880 [info ] [Thread-1 (]: 6 of 11 OK created sql view model RAW.CustomerChurn6Mon ........................ [[32mSUCCESS 1[0m in 0.35s]
[0m17:14:44.877880 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m17:14:44.891490 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m17:14:44.891490 [info ] [Thread-1 (]: 7 of 11 START sql view model RAW.churn ......................................... [RUN]
[0m17:14:44.891490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m17:14:44.891490 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m17:14:44.896392 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m17:14:44.896392 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m17:14:44.898401 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m17:14:44.900409 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m17:14:44.902417 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name, last_transaction_date








-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     WHERE
--         revenue_type = 1
--     GROUP BY
--         customer_id, 
--         customer_name
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year,
--         MONTH(last_transaction_date) AS last_transaction_month
--     FROM
--         LastTransaction
--     WHERE
--      IS NULL
--         AND DATEDIFF(month last_transaction_date, CURRENT_DATE()) <> 0
--         AND payment_month > last_transaction_dat
-- )
-- SELECT
--     last_transaction_year,
--     last_transaction_month,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
-- ORDER BY
--     last_transaction_year, last_transaction_month
  );
[0m17:14:45.191961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m17:14:45.191961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C73B380>]}
[0m17:14:45.191961 [info ] [Thread-1 (]: 7 of 11 OK created sql view model RAW.churn .................................... [[32mSUCCESS 1[0m in 0.30s]
[0m17:14:45.191961 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m17:14:45.191961 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m17:14:45.191961 [info ] [Thread-1 (]: 8 of 11 START sql table model RAW.new_customer ................................. [RUN]
[0m17:14:45.191961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.new_customer)
[0m17:14:45.191961 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m17:14:45.191961 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m17:14:45.191961 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m17:14:45.233674 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m17:14:45.233674 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m17:14:45.233674 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m17:14:45.940558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m17:14:45.942616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C78B5C0>]}
[0m17:14:45.942616 [info ] [Thread-1 (]: 8 of 11 OK created sql table model RAW.new_customer ............................ [[32mSUCCESS 1[0m in 0.75s]
[0m17:14:45.943641 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m17:14:45.944686 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m17:14:45.944686 [info ] [Thread-1 (]: 9 of 11 START sql table model RAW.product_churn ................................ [RUN]
[0m17:14:45.945823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.product_churn)
[0m17:14:45.945823 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m17:14:45.995952 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m17:14:45.995952 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m17:14:45.995952 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m17:14:45.995952 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m17:14:45.995952 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m17:14:46.790932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m17:14:46.792995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71BCA9460>]}
[0m17:14:46.792995 [info ] [Thread-1 (]: 9 of 11 OK created sql table model RAW.product_churn ........................... [[32mSUCCESS 1[0m in 0.85s]
[0m17:14:46.794341 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m17:14:46.794341 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m17:14:46.794341 [info ] [Thread-1 (]: 10 of 11 START sql table model RAW.rank_customer ............................... [RUN]
[0m17:14:46.795583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m17:14:46.795583 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m17:14:46.796902 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m17:14:46.796902 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m17:14:46.796902 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m17:14:46.796902 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m17:14:46.796902 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m17:14:47.546502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m17:14:47.546502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E719F06F00>]}
[0m17:14:47.546502 [info ] [Thread-1 (]: 10 of 11 OK created sql table model RAW.rank_customer .......................... [[32mSUCCESS 1[0m in 0.75s]
[0m17:14:47.546502 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m17:14:47.546502 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m17:14:47.546502 [info ] [Thread-1 (]: 11 of 11 START sql table model RAW.rank_products ............................... [RUN]
[0m17:14:47.546502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m17:14:47.546502 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m17:14:47.555907 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m17:14:47.558771 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m17:14:47.562948 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m17:14:47.564632 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m17:14:47.564632 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m17:14:48.447762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m17:14:48.447762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab0e0f75-298d-4958-b9c7-6075e6db7481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71C6CF590>]}
[0m17:14:48.447762 [info ] [Thread-1 (]: 11 of 11 OK created sql table model RAW.rank_products .......................... [[32mSUCCESS 1[0m in 0.90s]
[0m17:14:48.447762 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m17:14:48.461313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:48.461313 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:14:48.461313 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:14:48.546251 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:14:48.546251 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:14:48.647789 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m17:14:48.647789 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m17:14:48.764286 [info ] [MainThread]: 
[0m17:14:48.764286 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m17:14:48.782413 [debug] [MainThread]: Command end result
[0m17:14:48.800126 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:14:48.800126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:14:48.815819 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:14:48.815819 [info ] [MainThread]: 
[0m17:14:48.818782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:48.818782 [info ] [MainThread]: 
[0m17:14:48.818782 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:14:48.818782 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:48.818782 after 8.61 seconds
[0m17:14:48.818782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71AC7CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71AC7CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71AC7C2C0>]}
[0m17:14:48.818782 [debug] [MainThread]: Flushing usage events
[0m17:14:49.930336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:16:16.472685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3E472120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3DFB0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3DBC5A60>]}


============================== 17:16:16.478709 | e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36 ==============================
[0m17:16:16.478709 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:16:16.478709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:16:16.938642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3EF52720>]}
[0m17:16:17.002286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3F0EE6C0>]}
[0m17:16:17.002286 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:16:17.386083 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:16:17.519263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:16:17.519263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:16:17.535324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.training
- models.training.Mart
- models.training.Staging
[0m17:16:17.566150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40379970>]}
[0m17:16:17.637266 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:16:17.637266 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:16:17.668992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4055A060>]}
[0m17:16:17.668992 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:16:17.668992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB403BB680>]}
[0m17:16:17.671004 [info ] [MainThread]: 
[0m17:16:17.673012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:16:17.673012 [info ] [MainThread]: 
[0m17:16:17.673012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:16:17.679033 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:16:17.781878 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:16:17.781878 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:16:17.782899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:18.804562 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.035 seconds
[0m17:16:18.819964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:16:18.819964 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:16:18.819964 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:16:18.819964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:19.281893 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.455 seconds
[0m17:16:19.281893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3F282720>]}
[0m17:16:19.281893 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m17:16:19.299460 [info ] [Thread-1 (]: 1 of 11 START sql view model RAW.stg_customers ................................. [RUN]
[0m17:16:19.299460 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m17:16:19.299460 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m17:16:19.308889 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m17:16:19.308889 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m17:16:19.340087 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m17:16:19.341122 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m17:16:19.342585 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m17:16:19.342585 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:16:19.743756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m17:16:19.759578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3B941460>]}
[0m17:16:19.775660 [info ] [Thread-1 (]: 1 of 11 OK created sql view model RAW.stg_customers ............................ [[32mSUCCESS 1[0m in 0.46s]
[0m17:16:19.775660 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m17:16:19.775660 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m17:16:19.775660 [info ] [Thread-1 (]: 2 of 11 START sql view model RAW.stg_products .................................. [RUN]
[0m17:16:19.775660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m17:16:19.775660 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m17:16:19.775660 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m17:16:19.775660 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m17:16:19.775660 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m17:16:19.775660 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m17:16:19.775660 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m17:16:19.969278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m17:16:19.971285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40D87230>]}
[0m17:16:19.973302 [info ] [Thread-1 (]: 2 of 11 OK created sql view model RAW.stg_products ............................. [[32mSUCCESS 1[0m in 0.20s]
[0m17:16:19.973302 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m17:16:19.973302 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m17:16:19.975320 [info ] [Thread-1 (]: 3 of 11 START sql view model RAW.stg_region .................................... [RUN]
[0m17:16:19.975320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m17:16:19.975320 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m17:16:19.979334 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m17:16:19.979334 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m17:16:19.983349 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m17:16:19.985090 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m17:16:19.985090 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m17:16:20.169627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m17:16:20.169627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40DB65D0>]}
[0m17:16:20.169627 [info ] [Thread-1 (]: 3 of 11 OK created sql view model RAW.stg_region ............................... [[32mSUCCESS 1[0m in 0.19s]
[0m17:16:20.169627 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m17:16:20.169627 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m17:16:20.169627 [info ] [Thread-1 (]: 4 of 11 START sql view model RAW.stg_transaction ............................... [RUN]
[0m17:16:20.169627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m17:16:20.169627 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m17:16:20.169627 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m17:16:20.169627 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m17:16:20.185536 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m17:16:20.187551 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m17:16:20.188211 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m17:16:20.455911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m17:16:20.455911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3DA40770>]}
[0m17:16:20.455911 [info ] [Thread-1 (]: 4 of 11 OK created sql view model RAW.stg_transaction .......................... [[32mSUCCESS 1[0m in 0.29s]
[0m17:16:20.455911 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m17:16:20.455911 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m17:16:20.469177 [info ] [Thread-1 (]: 5 of 11 START sql view model RAW.master1 ....................................... [RUN]
[0m17:16:20.469177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m17:16:20.469177 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m17:16:20.473313 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m17:16:20.475336 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m17:16:20.477344 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m17:16:20.479353 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m17:16:20.479353 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m17:16:20.831370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m17:16:20.831370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40CCC5C0>]}
[0m17:16:20.831370 [info ] [Thread-1 (]: 5 of 11 OK created sql view model RAW.master1 .................................. [[32mSUCCESS 1[0m in 0.36s]
[0m17:16:20.831370 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m17:16:20.831370 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m17:16:20.831370 [info ] [Thread-1 (]: 6 of 11 START sql view model RAW.CustomerChurn6Mon ............................. [RUN]
[0m17:16:20.831370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m17:16:20.831370 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m17:16:20.831370 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:16:20.847406 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m17:16:20.850715 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:16:20.852832 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m17:16:20.852832 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace   view MINI_PROJECT.RAW.CustomerChurn6Mon
  
   as (
    WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
  );
[0m17:16:21.179692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m17:16:21.179692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40CF9490>]}
[0m17:16:21.179692 [info ] [Thread-1 (]: 6 of 11 OK created sql view model RAW.CustomerChurn6Mon ........................ [[32mSUCCESS 1[0m in 0.35s]
[0m17:16:21.179692 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m17:16:21.179692 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m17:16:21.179692 [info ] [Thread-1 (]: 7 of 11 START sql view model RAW.churn ......................................... [RUN]
[0m17:16:21.179692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m17:16:21.179692 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m17:16:21.195439 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m17:16:21.195439 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m17:16:21.195439 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m17:16:21.195439 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m17:16:21.195439 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    -- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name, last_transaction_date








-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     WHERE
--         revenue_type = 1
--     GROUP BY
--         customer_id, 
--         customer_name
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year,
--         MONTH(last_transaction_date) AS last_transaction_month
--     FROM
--         LastTransaction
--     WHERE
--      IS NULL
--         AND DATEDIFF(month last_transaction_date, CURRENT_DATE()) <> 0
--         AND payment_month > last_transaction_dat
-- )
-- SELECT
--     last_transaction_year,
--     last_transaction_month,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
-- ORDER BY
--     last_transaction_year, last_transaction_month
  );
[0m17:16:21.487625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m17:16:21.503677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40DAF2C0>]}
[0m17:16:21.503677 [info ] [Thread-1 (]: 7 of 11 OK created sql view model RAW.churn .................................... [[32mSUCCESS 1[0m in 0.32s]
[0m17:16:21.503677 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m17:16:21.503677 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m17:16:21.503677 [info ] [Thread-1 (]: 8 of 11 START sql table model RAW.new_customer ................................. [RUN]
[0m17:16:21.503677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.new_customer)
[0m17:16:21.503677 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m17:16:21.508654 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m17:16:21.510663 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m17:16:21.532382 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m17:16:21.532382 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m17:16:21.532382 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m17:16:22.202533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.674 seconds
[0m17:16:22.214982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40DFB2F0>]}
[0m17:16:22.214982 [info ] [Thread-1 (]: 8 of 11 OK created sql table model RAW.new_customer ............................ [[32mSUCCESS 1[0m in 0.71s]
[0m17:16:22.214982 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m17:16:22.214982 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m17:16:22.214982 [info ] [Thread-1 (]: 9 of 11 START sql table model RAW.product_churn ................................ [RUN]
[0m17:16:22.214982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.product_churn)
[0m17:16:22.214982 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m17:16:22.261245 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m17:16:22.261245 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m17:16:22.276678 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m17:16:22.276678 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m17:16:22.276678 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m17:16:22.991362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m17:16:22.991362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3E5746B0>]}
[0m17:16:22.991362 [info ] [Thread-1 (]: 9 of 11 OK created sql table model RAW.product_churn ........................... [[32mSUCCESS 1[0m in 0.78s]
[0m17:16:22.991362 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m17:16:22.991362 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m17:16:22.991362 [info ] [Thread-1 (]: 10 of 11 START sql table model RAW.rank_customer ............................... [RUN]
[0m17:16:22.991362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m17:16:22.991362 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m17:16:23.003571 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m17:16:23.005580 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m17:16:23.007589 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m17:16:23.009597 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m17:16:23.009597 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m17:16:24.007321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.007 seconds
[0m17:16:24.007321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB40DAD0A0>]}
[0m17:16:24.007321 [info ] [Thread-1 (]: 10 of 11 OK created sql table model RAW.rank_customer .......................... [[32mSUCCESS 1[0m in 1.02s]
[0m17:16:24.007321 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m17:16:24.007321 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m17:16:24.007321 [info ] [Thread-1 (]: 11 of 11 START sql table model RAW.rank_products ............................... [RUN]
[0m17:16:24.023021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m17:16:24.023021 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m17:16:24.023021 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m17:16:24.023021 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m17:16:24.023021 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m17:16:24.023021 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m17:16:24.023021 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m17:16:24.802584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.781 seconds
[0m17:16:24.813714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4b77fd5-9e6d-4090-9cd3-fc4ddbbc2d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB402CBAA0>]}
[0m17:16:24.815723 [info ] [Thread-1 (]: 11 of 11 OK created sql table model RAW.rank_products .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m17:16:24.815723 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m17:16:24.815723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:24.815723 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:16:24.818537 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:16:24.895069 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:16:24.895069 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:16:24.989437 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m17:16:24.989437 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m17:16:25.069389 [info ] [MainThread]: 
[0m17:16:25.071396 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m17:16:25.073403 [debug] [MainThread]: Command end result
[0m17:16:25.098457 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:16:25.100548 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:16:25.101897 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:16:25.101897 [info ] [MainThread]: 
[0m17:16:25.101897 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:16:25.101897 [info ] [MainThread]: 
[0m17:16:25.101897 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:16:25.110432 [debug] [MainThread]: Command `dbt run` succeeded at 17:16:25.110432 after 8.81 seconds
[0m17:16:25.110432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3C33E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3C33E420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB3C33E510>]}
[0m17:16:25.111463 [debug] [MainThread]: Flushing usage events
[0m17:16:26.305763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:33.474578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B669AC7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B668EC92E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B668ECA9C0>]}


============================== 17:18:33.474578 | eb64abd8-92ea-4777-b243-21f7d35b6188 ==============================
[0m17:18:33.474578 [info ] [MainThread]: Running with dbt=1.9.3
[0m17:18:33.474578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:33.914312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66A88E990>]}
[0m17:18:33.975968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B669809370>]}
[0m17:18:33.975968 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:18:34.290017 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m17:18:34.431714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:34.431714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:34.431714 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.training.Mart
- models.training
- models.training.Staging
[0m17:18:34.458891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66B8EAA50>]}
[0m17:18:34.540787 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:18:34.540787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:18:34.570329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66BC8FF20>]}
[0m17:18:34.570329 [info ] [MainThread]: Found 11 models, 4 sources, 474 macros
[0m17:18:34.570329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66B93B260>]}
[0m17:18:34.570329 [info ] [MainThread]: 
[0m17:18:34.570329 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:34.570329 [info ] [MainThread]: 
[0m17:18:34.570329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:34.570329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m17:18:34.674730 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m17:18:34.674730 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m17:18:34.674730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:35.858424 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.184 seconds
[0m17:18:35.858424 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m17:18:35.872418 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m17:18:35.872418 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m17:18:35.872418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:36.336631 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.472 seconds
[0m17:18:36.353535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66BBF2CF0>]}
[0m17:18:36.359498 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m17:18:36.360572 [info ] [Thread-1 (]: 1 of 11 START sql view model RAW.stg_customers ................................. [RUN]
[0m17:18:36.360572 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m17:18:36.362023 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m17:18:36.371991 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m17:18:36.373530 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m17:18:36.403668 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m17:18:36.404667 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m17:18:36.405663 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m17:18:36.405663 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:37.149491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.744 seconds
[0m17:18:37.165183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B666E615E0>]}
[0m17:18:37.165183 [info ] [Thread-1 (]: 1 of 11 OK created sql view model RAW.stg_customers ............................ [[32mSUCCESS 1[0m in 0.80s]
[0m17:18:37.165183 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m17:18:37.165183 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m17:18:37.165183 [info ] [Thread-1 (]: 2 of 11 START sql view model RAW.stg_products .................................. [RUN]
[0m17:18:37.165183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m17:18:37.165183 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m17:18:37.165183 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m17:18:37.181305 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m17:18:37.184736 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m17:18:37.186872 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m17:18:37.186872 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m17:18:37.360082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m17:18:37.360082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66C2D6D20>]}
[0m17:18:37.360082 [info ] [Thread-1 (]: 2 of 11 OK created sql view model RAW.stg_products ............................. [[32mSUCCESS 1[0m in 0.19s]
[0m17:18:37.360082 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m17:18:37.360082 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m17:18:37.360082 [info ] [Thread-1 (]: 3 of 11 START sql view model RAW.stg_region .................................... [RUN]
[0m17:18:37.367790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m17:18:37.367790 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m17:18:37.367790 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m17:18:37.367790 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m17:18:37.375470 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m17:18:37.378097 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m17:18:37.378097 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m17:18:37.596927 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.217 seconds
[0m17:18:37.596927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66C306660>]}
[0m17:18:37.596927 [info ] [Thread-1 (]: 3 of 11 OK created sql view model RAW.stg_region ............................... [[32mSUCCESS 1[0m in 0.23s]
[0m17:18:37.596927 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m17:18:37.601184 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m17:18:37.601184 [info ] [Thread-1 (]: 4 of 11 START sql view model RAW.stg_transaction ............................... [RUN]
[0m17:18:37.601184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m17:18:37.602954 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m17:18:37.602954 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m17:18:37.602954 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m17:18:37.602954 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m17:18:37.602954 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m17:18:37.602954 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m17:18:37.885528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m17:18:37.885528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66C2EDDC0>]}
[0m17:18:37.885528 [info ] [Thread-1 (]: 4 of 11 OK created sql view model RAW.stg_transaction .......................... [[32mSUCCESS 1[0m in 0.28s]
[0m17:18:37.885528 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m17:18:37.885528 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m17:18:37.885528 [info ] [Thread-1 (]: 5 of 11 START sql view model RAW.master1 ....................................... [RUN]
[0m17:18:37.885528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m17:18:37.885528 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m17:18:37.885528 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m17:18:37.885528 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m17:18:37.885528 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m17:18:37.901559 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m17:18:37.902412 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m17:18:38.329804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.430 seconds
[0m17:18:38.329804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66C308500>]}
[0m17:18:38.345538 [info ] [Thread-1 (]: 5 of 11 OK created sql view model RAW.master1 .................................. [[32mSUCCESS 1[0m in 0.44s]
[0m17:18:38.345538 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m17:18:38.349107 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m17:18:38.349107 [info ] [Thread-1 (]: 6 of 11 START sql table model RAW.CustomerChurn6Mon ............................ [RUN]
[0m17:18:38.349107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m17:18:38.353030 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m17:18:38.356509 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:18:38.356509 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m17:18:38.362341 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."CUSTOMERCHURN6MON" because it is a view and target relation MINI_PROJECT.RAW.CustomerChurn6Mon is of type table.
[0m17:18:38.362341 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."CUSTOMERCHURN6MON"
[0m17:18:38.381277 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m17:18:38.386970 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
drop view if exists "MINI_PROJECT"."RAW"."CUSTOMERCHURN6MON" cascade
[0m17:18:38.509295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m17:18:38.525399 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m17:18:38.525399 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m17:18:38.525399 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table MINI_PROJECT.RAW.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m17:18:39.408675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m17:18:39.408675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66C256840>]}
[0m17:18:39.408675 [info ] [Thread-1 (]: 6 of 11 OK created sql table model RAW.CustomerChurn6Mon ....................... [[32mSUCCESS 1[0m in 1.06s]
[0m17:18:39.408675 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m17:18:39.408675 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m17:18:39.408675 [info ] [Thread-1 (]: 7 of 11 START sql table model RAW.churn ........................................ [RUN]
[0m17:18:39.408675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m17:18:39.408675 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m17:18:39.426401 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m17:18:39.426401 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m17:18:39.426401 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."CHURN" because it is a view and target relation MINI_PROJECT.RAW.churn is of type table.
[0m17:18:39.426401 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."CHURN"
[0m17:18:39.426401 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m17:18:39.426401 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
drop view if exists "MINI_PROJECT"."RAW"."CHURN" cascade
[0m17:18:39.550954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.115 seconds
[0m17:18:39.550954 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m17:18:39.552963 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m17:18:39.555172 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace transient table MINI_PROJECT.RAW.churn
         as
        (-- WITH LastTransaction AS (
--     SELECT
       
--         customer_name,
--         MAX(payment_month) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     GROUP BY
--          customer_name
-- ),
-- Churn AS (
--     SELECT * FROM LastTransaction
--     WHERE last_transaction_date < DATEADD(month, -12, CURRENT_DATE())
--     ORDER BY last_transaction_date
-- )
-- SELECT * FROM Churn







WITH LastTransaction AS (
    SELECT
        customer_id, 
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id, 
        customer_name,
        product_sub_family
),
ChurnedCustomers AS (
    SELECT
        customer_id, 
        customer_name,
        last_transaction_date,
        YEAR(last_transaction_date) AS last_transaction_year
    FROM
        LastTransaction
    WHERE
        last_transaction_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_transaction_year,
    customer_id, 
    customer_name,
    last_transaction_date
FROM
    ChurnedCustomers
GROUP BY
    last_transaction_year, customer_id, customer_name, last_transaction_date








-- WITH LastTransaction AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         CAST(MAX(payment_month) AS DATE) AS last_transaction_date
--     FROM
--         MINI_PROJECT.RAW.master1
--     WHERE
--         revenue_type = 1
--     GROUP BY
--         customer_id, 
--         customer_name
-- ),
-- ChurnedCustomers AS (
--     SELECT
--         customer_id, 
--         customer_name,
--         last_transaction_date,
--         YEAR(last_transaction_date) AS last_transaction_year,
--         MONTH(last_transaction_date) AS last_transaction_month
--     FROM
--         LastTransaction
--     WHERE
--      IS NULL
--         AND DATEDIFF(month last_transaction_date, CURRENT_DATE()) <> 0
--         AND payment_month > last_transaction_dat
-- )
-- SELECT
--     last_transaction_year,
--     last_transaction_month,
--     customer_id, 
--     customer_name,
--     last_transaction_date
-- FROM
--     ChurnedCustomers
-- GROUP BY
--     last_transaction_year, last_transaction_month, customer_id, customer_name, last_transaction_date
-- ORDER BY
--     last_transaction_year, last_transaction_month
        );
[0m17:18:40.429761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.875 seconds
[0m17:18:40.429761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66C3583B0>]}
[0m17:18:40.429761 [info ] [Thread-1 (]: 7 of 11 OK created sql table model RAW.churn ................................... [[32mSUCCESS 1[0m in 1.02s]
[0m17:18:40.429761 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m17:18:40.429761 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m17:18:40.429761 [info ] [Thread-1 (]: 8 of 11 START sql table model RAW.new_customer ................................. [RUN]
[0m17:18:40.429761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.new_customer)
[0m17:18:40.429761 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m17:18:40.490019 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m17:18:40.490019 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m17:18:40.490019 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m17:18:40.494946 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m17:18:40.495831 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m17:18:41.241531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m17:18:41.241531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66B880CE0>]}
[0m17:18:41.241531 [info ] [Thread-1 (]: 8 of 11 OK created sql table model RAW.new_customer ............................ [[32mSUCCESS 1[0m in 0.81s]
[0m17:18:41.241531 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m17:18:41.241531 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m17:18:41.241531 [info ] [Thread-1 (]: 9 of 11 START sql table model RAW.product_churn ................................ [RUN]
[0m17:18:41.241531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.product_churn)
[0m17:18:41.241531 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m17:18:41.251676 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m17:18:41.253686 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m17:18:41.257124 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m17:18:41.260110 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m17:18:41.260110 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m17:18:42.109623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m17:18:42.109623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66B881280>]}
[0m17:18:42.109623 [info ] [Thread-1 (]: 9 of 11 OK created sql table model RAW.product_churn ........................... [[32mSUCCESS 1[0m in 0.87s]
[0m17:18:42.109623 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m17:18:42.109623 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m17:18:42.109623 [info ] [Thread-1 (]: 10 of 11 START sql table model RAW.rank_customer ............................... [RUN]
[0m17:18:42.125678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m17:18:42.125678 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m17:18:42.125678 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m17:18:42.125678 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m17:18:42.125678 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m17:18:42.125678 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m17:18:42.125678 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m17:18:42.843098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m17:18:42.843098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66C2C6480>]}
[0m17:18:42.843098 [info ] [Thread-1 (]: 10 of 11 OK created sql table model RAW.rank_customer .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m17:18:42.843098 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m17:18:42.843098 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m17:18:42.843098 [info ] [Thread-1 (]: 11 of 11 START sql table model RAW.rank_products ............................... [RUN]
[0m17:18:42.843098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m17:18:42.843098 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m17:18:42.843098 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m17:18:42.843098 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m17:18:42.860553 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m17:18:42.862057 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m17:18:42.862057 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m17:18:43.641212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m17:18:43.657120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb64abd8-92ea-4777-b243-21f7d35b6188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B66B8C3A40>]}
[0m17:18:43.657120 [info ] [Thread-1 (]: 11 of 11 OK created sql table model RAW.rank_products .......................... [[32mSUCCESS 1[0m in 0.81s]
[0m17:18:43.657120 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m17:18:43.657120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:43.657120 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m17:18:43.657120 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m17:18:43.749526 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m17:18:43.757038 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m17:18:43.832862 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m17:18:43.844085 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m17:18:43.975447 [info ] [MainThread]: 
[0m17:18:43.979286 [info ] [MainThread]: Finished running 6 table models, 5 view models in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m17:18:43.979286 [debug] [MainThread]: Command end result
[0m17:18:44.005975 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m17:18:44.007250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m17:18:44.014690 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m17:18:44.016003 [info ] [MainThread]: 
[0m17:18:44.017004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:44.018027 [info ] [MainThread]: 
[0m17:18:44.018027 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:18:44.018027 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:44.018027 after 10.71 seconds
[0m17:18:44.018027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6698F8530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6688806B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6693E7740>]}
[0m17:18:44.018027 [debug] [MainThread]: Flushing usage events
[0m17:18:45.506791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:20.050810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011AE68320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011AE68410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011AE682F0>]}


============================== 18:30:20.050810 | a7ef42a2-2373-4304-97b1-4f027e504c48 ==============================
[0m18:30:20.050810 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:30:20.050810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:30:20.462124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011A333E00>]}
[0m18:30:20.525284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011CCBE6F0>]}
[0m18:30:20.525284 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:30:21.047597 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:30:21.222170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:21.222170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:21.231110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.training.Staging
- models.training
- models.training.Mart
[0m18:30:21.412554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B10F710>]}
[0m18:30:21.489054 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:30:21.507070 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:30:21.538534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011CD3B260>]}
[0m18:30:21.538534 [info ] [MainThread]: Found 12 models, 4 sources, 474 macros
[0m18:30:21.542096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011CD59910>]}
[0m18:30:21.544105 [info ] [MainThread]: 
[0m18:30:21.544105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:21.544105 [info ] [MainThread]: 
[0m18:30:21.544105 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:21.550205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m18:30:21.653329 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m18:30:21.653329 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m18:30:21.653329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:22.580932 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.933 seconds
[0m18:30:22.592291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m18:30:22.597675 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m18:30:22.597675 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m18:30:22.597675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:23.104926 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.493 seconds
[0m18:30:23.120780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011BC3AA20>]}
[0m18:30:23.129493 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m18:30:23.129493 [info ] [Thread-1 (]: 1 of 12 START sql view model RAW.stg_customers ................................. [RUN]
[0m18:30:23.130901 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m18:30:23.131523 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m18:30:23.139589 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m18:30:23.141159 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m18:30:23.171381 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m18:30:23.173431 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m18:30:23.174429 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m18:30:23.174429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:30:23.584487 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m18:30:23.601817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201182314F0>]}
[0m18:30:23.601817 [info ] [Thread-1 (]: 1 of 12 OK created sql view model RAW.stg_customers ............................ [[32mSUCCESS 1[0m in 0.47s]
[0m18:30:23.601817 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m18:30:23.601817 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m18:30:23.601817 [info ] [Thread-1 (]: 2 of 12 START sql view model RAW.stg_products .................................. [RUN]
[0m18:30:23.601817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m18:30:23.614822 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m18:30:23.617706 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m18:30:23.619985 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m18:30:23.623539 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m18:30:23.624577 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m18:30:23.625611 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m18:30:23.800849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m18:30:23.806867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D6C75C0>]}
[0m18:30:23.808290 [info ] [Thread-1 (]: 2 of 12 OK created sql view model RAW.stg_products ............................. [[32mSUCCESS 1[0m in 0.21s]
[0m18:30:23.810556 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m18:30:23.811611 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m18:30:23.812504 [info ] [Thread-1 (]: 3 of 12 START sql view model RAW.stg_region .................................... [RUN]
[0m18:30:23.814503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m18:30:23.814973 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m18:30:23.821514 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m18:30:23.821514 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m18:30:23.821514 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m18:30:23.821514 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m18:30:23.821514 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m18:30:24.086342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m18:30:24.088491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D6AC680>]}
[0m18:30:24.088491 [info ] [Thread-1 (]: 3 of 12 OK created sql view model RAW.stg_region ............................... [[32mSUCCESS 1[0m in 0.28s]
[0m18:30:24.088491 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m18:30:24.088491 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m18:30:24.092867 [info ] [Thread-1 (]: 4 of 12 START sql view model RAW.stg_transaction ............................... [RUN]
[0m18:30:24.092867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m18:30:24.092867 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m18:30:24.092867 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m18:30:24.098757 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m18:30:24.103189 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m18:30:24.105239 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m18:30:24.107301 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m18:30:24.391833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m18:30:24.393900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D703020>]}
[0m18:30:24.393900 [info ] [Thread-1 (]: 4 of 12 OK created sql view model RAW.stg_transaction .......................... [[32mSUCCESS 1[0m in 0.30s]
[0m18:30:24.395345 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m18:30:24.396364 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m18:30:24.396364 [info ] [Thread-1 (]: 5 of 12 START sql view model RAW.master1 ....................................... [RUN]
[0m18:30:24.397259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m18:30:24.397259 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m18:30:24.400352 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m18:30:24.402653 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m18:30:24.404728 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m18:30:24.407265 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m18:30:24.407265 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m18:30:24.763680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m18:30:24.767406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D6700E0>]}
[0m18:30:24.767831 [info ] [Thread-1 (]: 5 of 12 OK created sql view model RAW.master1 .................................. [[32mSUCCESS 1[0m in 0.37s]
[0m18:30:24.769956 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m18:30:24.771021 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:30:24.772023 [info ] [Thread-1 (]: 6 of 12 START sql table model RAW.CustomerChurn6Mon ............................ [RUN]
[0m18:30:24.772687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m18:30:24.773755 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:30:24.777909 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:30:24.780348 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:30:24.805555 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:30:24.807746 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:30:24.807746 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table MINI_PROJECT.RAW.CustomerChurn6Mon
         as
        (
wi
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:30:24.993523 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00ac-0001-429b-0008-511e0002108a
[0m18:30:24.994805 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 0 unexpected 'wi'.
syntax error line 9 at position 32 unexpected 'AS'.
[0m18:30:24.998352 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'wi'.
  syntax error line 9 at position 32 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql
[0m18:30:24.998352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D6E7530>]}
[0m18:30:24.999350 [error] [Thread-1 (]: 6 of 12 ERROR creating sql table model RAW.CustomerChurn6Mon ................... [[31mERROR[0m in 0.23s]
[0m18:30:25.000343 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:30:25.000343 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m18:30:25.001383 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'wi'.
  syntax error line 9 at position 32 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql.
[0m18:30:25.001383 [info ] [Thread-1 (]: 7 of 12 START sql view model RAW.churn ......................................... [RUN]
[0m18:30:25.003626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m18:30:25.003626 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m18:30:25.006415 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m18:30:25.007438 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m18:30:25.015755 [debug] [Thread-1 (]: Dropping relation "MINI_PROJECT"."RAW"."CHURN" because it is of type table
[0m18:30:25.023041 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."CHURN"
[0m18:30:25.030465 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:30:25.031633 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
drop table if exists "MINI_PROJECT"."RAW"."CHURN" cascade
[0m18:30:25.416002 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.396 seconds
[0m18:30:25.416002 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m18:30:25.431976 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:30:25.431976 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
  );
[0m18:30:25.690061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m18:30:25.690061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D7FD490>]}
[0m18:30:25.705948 [info ] [Thread-1 (]: 7 of 12 OK created sql view model RAW.churn .................................... [[32mSUCCESS 1[0m in 0.69s]
[0m18:30:25.705948 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m18:30:25.705948 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m18:30:25.705948 [info ] [Thread-1 (]: 8 of 12 START sql view model RAW.cross_Sell .................................... [RUN]
[0m18:30:25.705948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m18:30:25.705948 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m18:30:25.712540 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m18:30:25.714547 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m18:30:25.768228 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m18:30:25.768228 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:30:25.768228 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace   view MINI_PROJECT.RAW.cross_Sell
  
   as (
    WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        MINI_PROJECT.RAW.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
  );
[0m18:30:26.347834 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m18:30:26.351375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D815DF0>]}
[0m18:30:26.352375 [info ] [Thread-1 (]: 8 of 12 OK created sql view model RAW.cross_Sell ............................... [[32mSUCCESS 1[0m in 0.64s]
[0m18:30:26.353373 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m18:30:26.353373 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m18:30:26.354521 [info ] [Thread-1 (]: 9 of 12 START sql table model RAW.new_customer ................................. [RUN]
[0m18:30:26.355536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m18:30:26.355536 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m18:30:26.358763 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m18:30:26.360208 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m18:30:26.362701 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m18:30:26.364695 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m18:30:26.365693 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m18:30:27.979037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.613 seconds
[0m18:30:27.981466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D8171D0>]}
[0m18:30:27.982508 [info ] [Thread-1 (]: 9 of 12 OK created sql table model RAW.new_customer ............................ [[32mSUCCESS 1[0m in 1.63s]
[0m18:30:27.983572 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m18:30:27.983572 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m18:30:27.984629 [info ] [Thread-1 (]: 10 of 12 START sql table model RAW.product_churn ............................... [RUN]
[0m18:30:27.985844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.product_churn)
[0m18:30:27.985844 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m18:30:27.989194 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m18:30:27.991254 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m18:30:27.994644 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m18:30:27.998526 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m18:30:27.998526 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m18:30:29.308037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.315 seconds
[0m18:30:29.308037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D816FF0>]}
[0m18:30:29.308037 [info ] [Thread-1 (]: 10 of 12 OK created sql table model RAW.product_churn .......................... [[32mSUCCESS 1[0m in 1.32s]
[0m18:30:29.308037 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m18:30:29.308037 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m18:30:29.308037 [info ] [Thread-1 (]: 11 of 12 START sql table model RAW.rank_customer ............................... [RUN]
[0m18:30:29.308037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m18:30:29.308037 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m18:30:29.321236 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m18:30:29.321236 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m18:30:29.321236 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m18:30:29.321236 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m18:30:29.321236 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m18:30:31.558414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.230 seconds
[0m18:30:31.558414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011BC5E510>]}
[0m18:30:31.558414 [info ] [Thread-1 (]: 11 of 12 OK created sql table model RAW.rank_customer .......................... [[32mSUCCESS 1[0m in 2.25s]
[0m18:30:31.558414 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m18:30:31.558414 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m18:30:31.558414 [info ] [Thread-1 (]: 12 of 12 START sql table model RAW.rank_products ............................... [RUN]
[0m18:30:31.558414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m18:30:31.558414 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m18:30:31.558414 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m18:30:31.558414 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m18:30:31.573153 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m18:30:31.573153 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m18:30:31.573153 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m18:30:32.323698 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.746 seconds
[0m18:30:32.327588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ef42a2-2373-4304-97b1-4f027e504c48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D816000>]}
[0m18:30:32.327588 [info ] [Thread-1 (]: 12 of 12 OK created sql table model RAW.rank_products .......................... [[32mSUCCESS 1[0m in 0.77s]
[0m18:30:32.328912 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m18:30:32.329913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:32.330991 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m18:30:32.330991 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m18:30:32.408137 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m18:30:32.408137 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m18:30:32.509406 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m18:30:32.509406 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m18:30:32.574745 [info ] [MainThread]: 
[0m18:30:32.574745 [info ] [MainThread]: Finished running 5 table models, 7 view models in 0 hours 0 minutes and 11.03 seconds (11.03s).
[0m18:30:32.591209 [debug] [MainThread]: Command end result
[0m18:30:32.625241 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:30:32.625241 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:30:32.643059 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:30:32.643059 [info ] [MainThread]: 
[0m18:30:32.643059 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:30:32.643059 [info ] [MainThread]: 
[0m18:30:32.643059 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 0 unexpected 'wi'.
  syntax error line 9 at position 32 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql
[0m18:30:32.643059 [info ] [MainThread]: 
[0m18:30:32.643059 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m18:30:32.643059 [debug] [MainThread]: Command `dbt run` failed at 18:30:32.643059 after 12.80 seconds
[0m18:30:32.643059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011AD33440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011D7FCC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020117828500>]}
[0m18:30:32.643059 [debug] [MainThread]: Flushing usage events
[0m18:30:33.816368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:27.101652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020658F98EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020658F981D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020658F98890>]}


============================== 18:31:27.119302 | 0468108f-7e3a-4563-98ed-936836733119 ==============================
[0m18:31:27.119302 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:31:27.119302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:31:27.496454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020659CC9C40>]}
[0m18:31:27.557619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020658F7B170>]}
[0m18:31:27.559627 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:31:27.863038 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:31:28.006620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:28.008628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:28.012644 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.training
- models.training.Mart
- models.training.Staging
[0m18:31:28.040834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020659D4F380>]}
[0m18:31:28.116272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:31:28.120289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:31:28.127907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065AD82D20>]}
[0m18:31:28.127907 [info ] [MainThread]: Found 12 models, 4 sources, 475 macros
[0m18:31:28.127907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020659C40F80>]}
[0m18:31:28.143999 [info ] [MainThread]: 
[0m18:31:28.143999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:28.143999 [info ] [MainThread]: 
[0m18:31:28.143999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:28.143999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT'
[0m18:31:28.244166 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT"
[0m18:31:28.244166 [debug] [ThreadPool]: On list_MINI_PROJECT: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT"} */
show terse schemas in database MINI_PROJECT
    limit 10000
[0m18:31:28.245209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:29.228770 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.984 seconds
[0m18:31:29.228770 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MINI_PROJECT_RAW'
[0m18:31:29.241771 [debug] [ThreadPool]: Using snowflake connection "list_MINI_PROJECT_RAW"
[0m18:31:29.241771 [debug] [ThreadPool]: On list_MINI_PROJECT_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_MINI_PROJECT_RAW"} */
show objects in MINI_PROJECT.RAW limit 10000;
[0m18:31:29.241771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:29.671127 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.435 seconds
[0m18:31:29.678901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B5D8650>]}
[0m18:31:29.686830 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m18:31:29.686830 [info ] [Thread-1 (]: 1 of 12 START sql view model RAW.stg_customers ................................. [RUN]
[0m18:31:29.686830 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m18:31:29.686830 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m18:31:29.686830 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m18:31:29.686830 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m18:31:29.715060 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m18:31:29.730760 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m18:31:29.732145 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace   view MINI_PROJECT.RAW.stg_customers
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
  );
[0m18:31:29.732145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:30.250501 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m18:31:30.281971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656361670>]}
[0m18:31:30.281971 [info ] [Thread-1 (]: 1 of 12 OK created sql view model RAW.stg_customers ............................ [[32mSUCCESS 1[0m in 0.60s]
[0m18:31:30.281971 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m18:31:30.281971 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m18:31:30.281971 [info ] [Thread-1 (]: 2 of 12 START sql view model RAW.stg_products .................................. [RUN]
[0m18:31:30.281971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m18:31:30.281971 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m18:31:30.290648 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m18:31:30.292657 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m18:31:30.294665 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m18:31:30.296674 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m18:31:30.296674 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace   view MINI_PROJECT.RAW.stg_products
  
   as (
    


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
  );
[0m18:31:30.468987 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m18:31:30.471977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B7ABB30>]}
[0m18:31:30.473114 [info ] [Thread-1 (]: 2 of 12 OK created sql view model RAW.stg_products ............................. [[32mSUCCESS 1[0m in 0.19s]
[0m18:31:30.475189 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m18:31:30.475189 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m18:31:30.476223 [info ] [Thread-1 (]: 3 of 12 START sql view model RAW.stg_region .................................... [RUN]
[0m18:31:30.477264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m18:31:30.478276 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m18:31:30.482594 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m18:31:30.483766 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m18:31:30.486882 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m18:31:30.487885 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m18:31:30.487885 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace   view MINI_PROJECT.RAW.stg_region
  
   as (
    


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
  );
[0m18:31:30.667274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m18:31:30.667274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B7E2F60>]}
[0m18:31:30.667274 [info ] [Thread-1 (]: 3 of 12 OK created sql view model RAW.stg_region ............................... [[32mSUCCESS 1[0m in 0.19s]
[0m18:31:30.667274 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m18:31:30.667274 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m18:31:30.667274 [info ] [Thread-1 (]: 4 of 12 START sql view model RAW.stg_transaction ............................... [RUN]
[0m18:31:30.667274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m18:31:30.667274 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m18:31:30.667274 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m18:31:30.667274 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m18:31:30.681438 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m18:31:30.683969 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m18:31:30.685056 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace   view MINI_PROJECT.RAW.stg_transaction
  
   as (
    with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
  );
[0m18:31:30.971517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m18:31:30.979678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B7B7B00>]}
[0m18:31:30.979678 [info ] [Thread-1 (]: 4 of 12 OK created sql view model RAW.stg_transaction .......................... [[32mSUCCESS 1[0m in 0.31s]
[0m18:31:30.981686 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m18:31:30.981686 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m18:31:30.981686 [info ] [Thread-1 (]: 5 of 12 START sql view model RAW.master1 ....................................... [RUN]
[0m18:31:30.981686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m18:31:30.981686 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m18:31:30.987931 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m18:31:30.988748 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m18:31:30.990840 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m18:31:30.993003 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m18:31:30.993003 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace   view MINI_PROJECT.RAW.master1
  
   as (
    WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        MINI_PROJECT.RAW.stg_customers c
    FULL JOIN
        MINI_PROJECT.RAW.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        MINI_PROJECT.RAW.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
  );
[0m18:31:31.651794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m18:31:31.651794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B718EC0>]}
[0m18:31:31.651794 [info ] [Thread-1 (]: 5 of 12 OK created sql view model RAW.master1 .................................. [[32mSUCCESS 1[0m in 0.67s]
[0m18:31:31.651794 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m18:31:31.659443 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:31:31.659443 [info ] [Thread-1 (]: 6 of 12 START sql table model RAW.CustomerChurn6Mon ............................ [RUN]
[0m18:31:31.659443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m18:31:31.659443 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:31:31.659443 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:31:31.665114 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:31:31.688891 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:31:31.690188 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:31:31.690188 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table MINI_PROJECT.RAW.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:31:32.473792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m18:31:32.473792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B720CB0>]}
[0m18:31:32.473792 [info ] [Thread-1 (]: 6 of 12 OK created sql table model RAW.CustomerChurn6Mon ....................... [[32mSUCCESS 1[0m in 0.81s]
[0m18:31:32.473792 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:31:32.473792 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m18:31:32.473792 [info ] [Thread-1 (]: 7 of 12 START sql view model RAW.churn ......................................... [RUN]
[0m18:31:32.482616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m18:31:32.482616 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m18:31:32.482616 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m18:31:32.482616 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m18:31:32.489885 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m18:31:32.492062 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:31:32.492557 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace   view MINI_PROJECT.RAW.churn
  
   as (
    WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        MINI_PROJECT.RAW.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
  );
[0m18:31:32.801135 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.310 seconds
[0m18:31:32.801135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B7D0410>]}
[0m18:31:32.801135 [info ] [Thread-1 (]: 7 of 12 OK created sql view model RAW.churn .................................... [[32mSUCCESS 1[0m in 0.32s]
[0m18:31:32.801135 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m18:31:32.801135 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m18:31:32.801135 [info ] [Thread-1 (]: 8 of 12 START sql view model RAW.cross_Sell .................................... [RUN]
[0m18:31:32.801135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m18:31:32.801135 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m18:31:32.809266 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m18:31:32.809266 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m18:31:32.809266 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m18:31:32.809266 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:31:32.809266 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace   view MINI_PROJECT.RAW.cross_Sell
  
   as (
    WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        MINI_PROJECT.RAW.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
  );
[0m18:31:33.324589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m18:31:33.324589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B829C10>]}
[0m18:31:33.324589 [info ] [Thread-1 (]: 8 of 12 OK created sql view model RAW.cross_Sell ............................... [[32mSUCCESS 1[0m in 0.52s]
[0m18:31:33.340342 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m18:31:33.340342 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m18:31:33.340342 [info ] [Thread-1 (]: 9 of 12 START sql table model RAW.new_customer ................................. [RUN]
[0m18:31:33.342350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m18:31:33.342350 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m18:31:33.386790 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m18:31:33.403154 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m18:31:33.403154 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m18:31:33.403154 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m18:31:33.403154 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table MINI_PROJECT.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       MINI_PROJECT.RAW.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m18:31:34.118592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.712 seconds
[0m18:31:34.118592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B1AD0D0>]}
[0m18:31:34.118592 [info ] [Thread-1 (]: 9 of 12 OK created sql table model RAW.new_customer ............................ [[32mSUCCESS 1[0m in 0.78s]
[0m18:31:34.133343 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m18:31:34.133343 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m18:31:34.133343 [info ] [Thread-1 (]: 10 of 12 START sql table model RAW.product_churn ............................... [RUN]
[0m18:31:34.133343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.product_churn)
[0m18:31:34.133343 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m18:31:34.141873 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m18:31:34.144098 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m18:31:34.145327 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m18:31:34.145327 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m18:31:34.145327 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table MINI_PROJECT.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        MINI_PROJECT.RAW.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m18:31:34.911955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m18:31:34.911955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B7B9880>]}
[0m18:31:34.911955 [info ] [Thread-1 (]: 10 of 12 OK created sql table model RAW.product_churn .......................... [[32mSUCCESS 1[0m in 0.78s]
[0m18:31:34.911955 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m18:31:34.911955 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m18:31:34.911955 [info ] [Thread-1 (]: 11 of 12 START sql table model RAW.rank_customer ............................... [RUN]
[0m18:31:34.911955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m18:31:34.911955 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m18:31:34.927776 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m18:31:34.927776 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m18:31:34.927776 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m18:31:34.927776 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m18:31:34.927776 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table MINI_PROJECT.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m18:31:35.738477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m18:31:35.740486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B7B9430>]}
[0m18:31:35.740486 [info ] [Thread-1 (]: 11 of 12 OK created sql table model RAW.rank_customer .......................... [[32mSUCCESS 1[0m in 0.83s]
[0m18:31:35.742493 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m18:31:35.742493 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m18:31:35.742493 [info ] [Thread-1 (]: 12 of 12 START sql table model RAW.rank_products ............................... [RUN]
[0m18:31:35.744500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m18:31:35.744500 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m18:31:35.746507 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m18:31:35.748515 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m18:31:35.752432 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m18:31:35.754853 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m18:31:35.755601 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table MINI_PROJECT.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM MINI_PROJECT.RAW.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m18:31:36.465847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m18:31:36.465847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0468108f-7e3a-4563-98ed-936836733119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B7BA690>]}
[0m18:31:36.465847 [info ] [Thread-1 (]: 12 of 12 OK created sql table model RAW.rank_products .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m18:31:36.465847 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m18:31:36.465847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:36.465847 [debug] [MainThread]: Connection 'list_MINI_PROJECT' was left open.
[0m18:31:36.465847 [debug] [MainThread]: On list_MINI_PROJECT: Close
[0m18:31:36.537811 [debug] [MainThread]: Connection 'list_MINI_PROJECT_RAW' was left open.
[0m18:31:36.549592 [debug] [MainThread]: On list_MINI_PROJECT_RAW: Close
[0m18:31:36.616954 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m18:31:36.625911 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m18:31:36.698550 [info ] [MainThread]: 
[0m18:31:36.698550 [info ] [MainThread]: Finished running 5 table models, 7 view models in 0 hours 0 minutes and 8.55 seconds (8.55s).
[0m18:31:36.698550 [debug] [MainThread]: Command end result
[0m18:31:36.725848 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:31:36.728226 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:31:36.729657 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:31:36.729657 [info ] [MainThread]: 
[0m18:31:36.729657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:36.729657 [info ] [MainThread]: 
[0m18:31:36.729657 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m18:31:36.737760 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:36.737760 after 9.79 seconds
[0m18:31:36.738774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206588C3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206598CF740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065B0B5DC0>]}
[0m18:31:36.739792 [debug] [MainThread]: Flushing usage events
[0m18:31:38.228026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:37:18.425203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C60EAD7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C630B1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C630B2600>]}


============================== 18:37:18.440437 | a4f4ac69-95c2-4c8d-adf6-154962267e4d ==============================
[0m18:37:18.440437 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:37:18.440437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:37:18.814536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4f4ac69-95c2-4c8d-adf6-154962267e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C649EF9B0>]}
[0m18:37:18.878075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4f4ac69-95c2-4c8d-adf6-154962267e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C61388FE0>]}
[0m18:37:18.879107 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:37:19.186756 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:37:19.330309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:19.330309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:19.330309 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:37:19.369396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4f4ac69-95c2-4c8d-adf6-154962267e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C65AEB950>]}
[0m18:37:19.441647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:37:19.446112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:37:19.464949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4f4ac69-95c2-4c8d-adf6-154962267e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C65E6D2E0>]}
[0m18:37:19.464949 [info ] [MainThread]: Found 12 models, 4 sources, 475 macros
[0m18:37:19.464949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f4ac69-95c2-4c8d-adf6-154962267e4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C65B07200>]}
[0m18:37:19.464949 [info ] [MainThread]: 
[0m18:37:19.464949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:37:19.464949 [info ] [MainThread]: 
[0m18:37:19.464949 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:19.464949 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:37:19.566477 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:37:19.567513 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:37:19.567513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:20.487623 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.919 seconds
[0m18:37:20.489631 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:37:20.489631 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:37:20.560489 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.079 seconds
[0m18:37:20.573888 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:37:20.573888 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:37:20.641555 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.072 seconds
[0m18:37:20.641555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_)
[0m18:37:20.656961 [debug] [ThreadPool]: Creating schema "database: "mini_project"
"
[0m18:37:20.656961 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_"
[0m18:37:20.656961 [debug] [ThreadPool]: On create_mini_project_: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_"} */
create schema if not exists mini_project.
[0m18:37:20.816961 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b3-0001-429a-0008-511e0001e90a
[0m18:37:20.816961 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 41 unexpected '<EOF>'.
syntax error line 1 at position 40 unexpected '.'.
[0m18:37:20.816961 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:37:20.816961 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:37:20.816961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mini_project_, now create_mini_project_staging)
[0m18:37:20.816961 [debug] [ThreadPool]: Creating schema "database: "mini_project"
schema: "staging"
"
[0m18:37:20.832609 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_staging"
[0m18:37:20.832609 [debug] [ThreadPool]: On create_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_staging"} */
create schema if not exists mini_project.staging
[0m18:37:20.912496 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m18:37:20.919700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_mini_project_staging, now create_mini_project_intermediate)
[0m18:37:20.919700 [debug] [ThreadPool]: Creating schema "database: "mini_project"
schema: "intermediate"
"
[0m18:37:20.921708 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_intermediate"
[0m18:37:20.921708 [debug] [ThreadPool]: On create_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_intermediate"} */
create schema if not exists mini_project.intermediate
[0m18:37:21.022378 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m18:37:21.024386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:21.024386 [debug] [MainThread]: Connection 'create_mini_project_intermediate' was left open.
[0m18:37:21.024386 [debug] [MainThread]: On create_mini_project_intermediate: Close
[0m18:37:21.094423 [info ] [MainThread]: 
[0m18:37:21.094423 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m18:37:21.094423 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 41 unexpected '<EOF>'.
  syntax error line 1 at position 40 unexpected '.'.
[0m18:37:21.094423 [debug] [MainThread]: Command `dbt run` failed at 18:37:21.094423 after 2.84 seconds
[0m18:37:21.094423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C610F5A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C663CEDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016C64678200>]}
[0m18:37:21.094423 [debug] [MainThread]: Flushing usage events
[0m18:37:22.011474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:38:15.802315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1335D86B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1335BBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1335B8E90>]}


============================== 18:38:15.806332 | 5fa6d374-1a6d-4e8a-992d-c6c350fa9407 ==============================
[0m18:38:15.806332 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:38:15.806332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:38:16.173387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fa6d374-1a6d-4e8a-992d-c6c350fa9407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1335B81D0>]}
[0m18:38:16.236720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fa6d374-1a6d-4e8a-992d-c6c350fa9407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C132B15DF0>]}
[0m18:38:16.236720 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:38:16.559254 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:38:16.708456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:16.708456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:16.714476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:38:16.742040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fa6d374-1a6d-4e8a-992d-c6c350fa9407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1341DF080>]}
[0m18:38:16.806377 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:38:16.822888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:38:16.841806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fa6d374-1a6d-4e8a-992d-c6c350fa9407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1357C2420>]}
[0m18:38:16.841806 [info ] [MainThread]: Found 12 models, 4 sources, 475 macros
[0m18:38:16.842709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fa6d374-1a6d-4e8a-992d-c6c350fa9407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C13449AE70>]}
[0m18:38:16.844977 [info ] [MainThread]: 
[0m18:38:16.845377 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:16.845884 [info ] [MainThread]: 
[0m18:38:16.846459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:16.851459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:38:16.938715 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:38:16.938715 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:38:16.938715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:17.859755 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.917 seconds
[0m18:38:17.859755 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:38:17.859755 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:38:17.942596 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.086 seconds
[0m18:38:17.955491 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:38:17.955491 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:38:18.051011 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.083 seconds
[0m18:38:18.057574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_)
[0m18:38:18.060074 [debug] [ThreadPool]: Creating schema "database: "mini_project"
"
[0m18:38:18.073172 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_"
[0m18:38:18.075183 [debug] [ThreadPool]: On create_mini_project_: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_"} */
create schema if not exists mini_project.
[0m18:38:18.165884 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b4-0001-429e-0008-511e00020206
[0m18:38:18.165884 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 41 unexpected '<EOF>'.
syntax error line 1 at position 40 unexpected '.'.
[0m18:38:18.167900 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:38:18.169914 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:38:18.169914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:18.169914 [debug] [MainThread]: Connection 'create_mini_project_' was left open.
[0m18:38:18.169914 [debug] [MainThread]: On create_mini_project_: Close
[0m18:38:18.257809 [info ] [MainThread]: 
[0m18:38:18.257809 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.41 seconds (1.41s).
[0m18:38:18.257809 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 41 unexpected '<EOF>'.
  syntax error line 1 at position 40 unexpected '.'.
[0m18:38:18.257809 [debug] [MainThread]: Command `dbt run` failed at 18:38:18.257809 after 2.63 seconds
[0m18:38:18.257809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1335B83E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C135B62480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C133597AA0>]}
[0m18:38:18.262575 [debug] [MainThread]: Flushing usage events
[0m18:38:19.162702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:39:56.048691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC81608410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC81608170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC81609760>]}


============================== 18:39:56.055153 | bc67c244-e466-47cd-ac7b-5e3d301bcbb2 ==============================
[0m18:39:56.055153 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:39:56.055153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:39:56.480381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc67c244-e466-47cd-ac7b-5e3d301bcbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC833BFBF0>]}
[0m18:39:56.542384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc67c244-e466-47cd-ac7b-5e3d301bcbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC83382FC0>]}
[0m18:39:56.543427 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:39:56.859044 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:39:57.004624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:39:57.005007 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\mart\nrr_grr.sql
[0m18:39:57.256433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:39:57.269789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc67c244-e466-47cd-ac7b-5e3d301bcbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8395AD50>]}
[0m18:39:57.341131 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:39:57.344888 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:39:57.357709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc67c244-e466-47cd-ac7b-5e3d301bcbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8382CDD0>]}
[0m18:39:57.357709 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:39:57.357709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc67c244-e466-47cd-ac7b-5e3d301bcbb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC83930230>]}
[0m18:39:57.357709 [info ] [MainThread]: 
[0m18:39:57.357709 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:57.357709 [info ] [MainThread]: 
[0m18:39:57.357709 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:39:57.376266 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:39:57.461647 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:39:57.462681 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:39:57.462681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:58.337774 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.875 seconds
[0m18:39:58.342208 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:39:58.342208 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:39:58.425304 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.081 seconds
[0m18:39:58.428624 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:39:58.429627 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:39:58.508980 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.079 seconds
[0m18:39:58.509977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_)
[0m18:39:58.510974 [debug] [ThreadPool]: Creating schema "database: "mini_project"
"
[0m18:39:58.514963 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_"
[0m18:39:58.514963 [debug] [ThreadPool]: On create_mini_project_: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_"} */
create schema if not exists mini_project.
[0m18:39:58.589758 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b5-0001-429e-0008-511e0002020e
[0m18:39:58.589758 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 41 unexpected '<EOF>'.
syntax error line 1 at position 40 unexpected '.'.
[0m18:39:58.591515 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:39:58.592644 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:39:58.593684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:58.594726 [debug] [MainThread]: Connection 'create_mini_project_' was left open.
[0m18:39:58.594726 [debug] [MainThread]: On create_mini_project_: Close
[0m18:39:58.667733 [info ] [MainThread]: 
[0m18:39:58.668729 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m18:39:58.670091 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 41 unexpected '<EOF>'.
  syntax error line 1 at position 40 unexpected '.'.
[0m18:39:58.671183 [debug] [MainThread]: Command `dbt run` failed at 18:39:58.671183 after 2.80 seconds
[0m18:39:58.672246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC812EAC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8382F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC83907FE0>]}
[0m18:39:58.673031 [debug] [MainThread]: Flushing usage events
[0m18:39:59.610224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:43:35.563178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CC0840B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CB790560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CC084620>]}


============================== 18:43:35.571495 | 0c9c77eb-bc7d-4a49-b05f-81c4b3f9e1f9 ==============================
[0m18:43:35.571495 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:43:35.571495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s nrr_grr', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:43:36.095945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c9c77eb-bc7d-4a49-b05f-81c4b3f9e1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CCD6F4A0>]}
[0m18:43:36.154721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c9c77eb-bc7d-4a49-b05f-81c4b3f9e1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C9220740>]}
[0m18:43:36.154721 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:43:36.835720 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:43:36.993375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:43:36.993375 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:43:37.008953 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:43:37.041248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c9c77eb-bc7d-4a49-b05f-81c4b3f9e1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CE024680>]}
[0m18:43:37.108594 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:43:37.141877 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:43:37.175372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c9c77eb-bc7d-4a49-b05f-81c4b3f9e1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CE22CE90>]}
[0m18:43:37.175372 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:43:37.175372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c9c77eb-bc7d-4a49-b05f-81c4b3f9e1f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CDE23260>]}
[0m18:43:37.175372 [info ] [MainThread]: 
[0m18:43:37.184391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:37.184391 [info ] [MainThread]: 
[0m18:43:37.184391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:43:37.184391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:43:40.038884 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:43:40.038884 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:43:40.038884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:41.153431 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.120 seconds
[0m18:43:41.153431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_)
[0m18:43:41.153431 [debug] [ThreadPool]: Creating schema "database: "mini_project"
"
[0m18:43:41.153431 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_"
[0m18:43:41.153431 [debug] [ThreadPool]: On create_mini_project_: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_"} */
create schema if not exists mini_project.
[0m18:43:41.390027 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00b9-0001-429b-0008-511e0002115a
[0m18:43:41.390027 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 41 unexpected '<EOF>'.
syntax error line 1 at position 40 unexpected '.'.
[0m18:43:41.401069 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:43:41.401069 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:43:41.401069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:41.401069 [debug] [MainThread]: Connection 'create_mini_project_' was left open.
[0m18:43:41.401069 [debug] [MainThread]: On create_mini_project_: Close
[0m18:43:41.480782 [info ] [MainThread]: 
[0m18:43:41.480782 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m18:43:41.480782 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 41 unexpected '<EOF>'.
  syntax error line 1 at position 40 unexpected '.'.
[0m18:43:41.492038 [debug] [MainThread]: Command `dbt run` failed at 18:43:41.492038 after 6.11 seconds
[0m18:43:41.495098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CC084CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CBA2BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CE518290>]}
[0m18:43:41.497186 [debug] [MainThread]: Flushing usage events
[0m18:43:42.644831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:44:52.074251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37AE58CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37AE58DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37AE58FB0>]}


============================== 18:44:52.083514 | 91141466-545c-40eb-af51-0764a89468a9 ==============================
[0m18:44:52.083514 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:44:52.083514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:44:52.544326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91141466-545c-40eb-af51-0764a89468a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37AE7ACF0>]}
[0m18:44:52.625359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91141466-545c-40eb-af51-0764a89468a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37BBAFC20>]}
[0m18:44:52.625359 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:44:53.017796 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:44:53.167459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:53.167459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:53.167459 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:44:53.202796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91141466-545c-40eb-af51-0764a89468a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37CCDABA0>]}
[0m18:44:53.277738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:44:53.280094 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:44:53.309516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91141466-545c-40eb-af51-0764a89468a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37CD1B800>]}
[0m18:44:53.309516 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:44:53.310516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91141466-545c-40eb-af51-0764a89468a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37CCDB1D0>]}
[0m18:44:53.312700 [info ] [MainThread]: 
[0m18:44:53.313604 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:53.314234 [info ] [MainThread]: 
[0m18:44:53.314824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:44:53.320239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:44:53.403420 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:44:53.403420 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:44:53.403420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:54.241255 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.825 seconds
[0m18:44:54.247285 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:44:54.247285 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:44:54.335249 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.086 seconds
[0m18:44:54.349742 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:44:54.350898 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:44:54.444971 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.094 seconds
[0m18:44:54.448092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_)
[0m18:44:54.449131 [debug] [ThreadPool]: Creating schema "database: "mini_project"
"
[0m18:44:54.452133 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_"
[0m18:44:54.452133 [debug] [ThreadPool]: On create_mini_project_: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_"} */
create schema if not exists mini_project.
[0m18:44:54.534075 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01bb00ba-0001-429a-0008-511e0001e91e
[0m18:44:54.534075 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 41 unexpected '<EOF>'.
syntax error line 1 at position 40 unexpected '.'.
[0m18:44:54.535360 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro create_schema
[0m18:44:54.535932 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m18:44:54.536746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:54.536746 [debug] [MainThread]: Connection 'create_mini_project_' was left open.
[0m18:44:54.536746 [debug] [MainThread]: On create_mini_project_: Close
[0m18:44:54.617897 [info ] [MainThread]: 
[0m18:44:54.618946 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m18:44:54.621269 [error] [MainThread]: Encountered an error:
Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 41 unexpected '<EOF>'.
  syntax error line 1 at position 40 unexpected '.'.
[0m18:44:54.621269 [debug] [MainThread]: Command `dbt run` failed at 18:44:54.621269 after 2.75 seconds
[0m18:44:54.621269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37AD23FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37CE67440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E37BC2FBF0>]}
[0m18:44:54.621269 [debug] [MainThread]: Flushing usage events
[0m18:44:55.536530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:32.479364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAED417F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAC4B9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAED407A0>]}


============================== 18:45:32.484537 | 180e20f8-dea1-4869-9152-dcc0597ca5cd ==============================
[0m18:45:32.484537 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:45:32.485618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:45:32.924878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAF0B83E0>]}
[0m18:45:32.999045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAC0E0EC0>]}
[0m18:45:33.000997 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:45:33.324685 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:45:33.461198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:33.461198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:33.479650 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:45:33.508670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB0BCAA50>]}
[0m18:45:33.576477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:45:33.591121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:45:33.609370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB0B33CE0>]}
[0m18:45:33.609370 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:45:33.609370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAED43A10>]}
[0m18:45:33.626014 [info ] [MainThread]: 
[0m18:45:33.626014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:33.626014 [info ] [MainThread]: 
[0m18:45:33.626014 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:33.633112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:45:33.726224 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:45:33.726224 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:45:33.726224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:34.613049 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.882 seconds
[0m18:45:34.614626 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:45:34.614626 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:45:34.701258 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.082 seconds
[0m18:45:34.714947 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:45:34.714947 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:45:34.805612 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.087 seconds
[0m18:45:34.810151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m18:45:34.822144 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:45:34.823179 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:45:34.823179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:35.146237 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.324 seconds
[0m18:45:35.146237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate)
[0m18:45:35.146237 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:45:35.146237 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:45:35.260965 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.121 seconds
[0m18:45:35.260965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate, now list_mini_project_RAW)
[0m18:45:35.277856 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m18:45:35.277856 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m18:45:35.377143 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.100 seconds
[0m18:45:35.384687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB12AE900>]}
[0m18:45:35.394470 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m18:45:35.394470 [info ] [Thread-1 (]: 1 of 13 START sql table model mini_project.staging.stg_customers ............... [RUN]
[0m18:45:35.394470 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m18:45:35.394470 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m18:45:35.394470 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m18:45:35.394470 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m18:45:35.428364 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m18:45:35.428364 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m18:45:35.428364 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace transient table mini_project.staging.stg_customers
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
        );
[0m18:45:35.428364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:45:38.081444 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.640 seconds
[0m18:45:38.102902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB0BAAF30>]}
[0m18:45:38.102902 [info ] [Thread-1 (]: 1 of 13 OK created sql table model mini_project.staging.stg_customers .......... [[32mSUCCESS 1[0m in 2.71s]
[0m18:45:38.102902 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m18:45:38.102902 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m18:45:38.102902 [info ] [Thread-1 (]: 2 of 13 START sql table model mini_project.staging.stg_products ................ [RUN]
[0m18:45:38.102902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m18:45:38.102902 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m18:45:38.102902 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m18:45:38.102902 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m18:45:38.114655 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m18:45:38.116826 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m18:45:38.116826 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace transient table mini_project.staging.stg_products
         as
        (


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
        );
[0m18:45:38.731140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m18:45:38.731140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB158E510>]}
[0m18:45:38.731140 [info ] [Thread-1 (]: 2 of 13 OK created sql table model mini_project.staging.stg_products ........... [[32mSUCCESS 1[0m in 0.63s]
[0m18:45:38.731140 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m18:45:38.731140 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m18:45:38.731140 [info ] [Thread-1 (]: 3 of 13 START sql table model mini_project.staging.stg_region .................. [RUN]
[0m18:45:38.731140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m18:45:38.731140 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m18:45:38.749850 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m18:45:38.751895 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m18:45:38.753349 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m18:45:38.753349 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m18:45:38.753349 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace transient table mini_project.staging.stg_region
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
        );
[0m18:45:39.750905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m18:45:39.752976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAC173470>]}
[0m18:45:39.754021 [info ] [Thread-1 (]: 3 of 13 OK created sql table model mini_project.staging.stg_region ............. [[32mSUCCESS 1[0m in 1.02s]
[0m18:45:39.755028 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m18:45:39.756137 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m18:45:39.756137 [info ] [Thread-1 (]: 4 of 13 START sql table model mini_project.staging.stg_transaction ............. [RUN]
[0m18:45:39.756137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m18:45:39.757438 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m18:45:39.759501 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m18:45:39.760532 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m18:45:39.763150 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m18:45:39.766942 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m18:45:39.766942 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace transient table mini_project.staging.stg_transaction
         as
        (with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
        );
[0m18:45:40.537316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m18:45:40.538312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB14B7F50>]}
[0m18:45:40.539309 [info ] [Thread-1 (]: 4 of 13 OK created sql table model mini_project.staging.stg_transaction ........ [[32mSUCCESS 1[0m in 0.78s]
[0m18:45:40.540013 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m18:45:40.541013 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m18:45:40.541013 [info ] [Thread-1 (]: 5 of 13 START sql table model mini_project.intermediate.master1 ................ [RUN]
[0m18:45:40.542113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m18:45:40.542113 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m18:45:40.545211 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m18:45:40.546347 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m18:45:40.549467 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m18:45:40.550676 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m18:45:40.551890 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace transient table mini_project.intermediate.master1
         as
        (WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        mini_project.staging.stg_customers c
    FULL JOIN
        mini_project.staging.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        mini_project.staging.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
        );
[0m18:45:41.408179 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m18:45:41.410247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB15986B0>]}
[0m18:45:41.410247 [info ] [Thread-1 (]: 5 of 13 OK created sql table model mini_project.intermediate.master1 ........... [[32mSUCCESS 1[0m in 0.87s]
[0m18:45:41.412317 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m18:45:41.413320 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:45:41.413320 [info ] [Thread-1 (]: 6 of 13 START sql table model mini_project.RAW.CustomerChurn6Mon ............... [RUN]
[0m18:45:41.414317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m18:45:41.414317 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:45:41.419365 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:45:41.420462 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:45:41.424742 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:45:41.425745 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:45:41.426743 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.RAW.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:45:41.972050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m18:45:41.983979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB15AC560>]}
[0m18:45:41.983979 [info ] [Thread-1 (]: 6 of 13 OK created sql table model mini_project.RAW.CustomerChurn6Mon .......... [[32mSUCCESS 1[0m in 0.57s]
[0m18:45:41.983979 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:45:41.983979 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m18:45:41.983979 [info ] [Thread-1 (]: 7 of 13 START sql table model mini_project.RAW.churn ........................... [RUN]
[0m18:45:41.983979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m18:45:41.983979 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m18:45:41.991877 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m18:45:41.991877 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m18:45:41.994683 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."CHURN" because it is a view and target relation mini_project.RAW.churn is of type table.
[0m18:45:42.054899 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."CHURN"
[0m18:45:42.065588 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:45:42.066599 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
drop view if exists "MINI_PROJECT"."RAW"."CHURN" cascade
[0m18:45:42.195830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m18:45:42.198981 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m18:45:42.202944 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:45:42.204658 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace transient table mini_project.RAW.churn
         as
        (
WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
        );
[0m18:45:42.718290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m18:45:42.718290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB0F61640>]}
[0m18:45:42.718290 [info ] [Thread-1 (]: 7 of 13 OK created sql table model mini_project.RAW.churn ...................... [[32mSUCCESS 1[0m in 0.73s]
[0m18:45:42.718290 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m18:45:42.718290 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m18:45:42.718290 [info ] [Thread-1 (]: 8 of 13 START sql table model mini_project.RAW.cross_Sell ...................... [RUN]
[0m18:45:42.718290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m18:45:42.718290 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m18:45:42.734626 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m18:45:42.734626 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m18:45:42.734626 [debug] [Thread-1 (]:  adapter: Dropping relation "MINI_PROJECT"."RAW"."CROSS_SELL" because it is a view and target relation mini_project.RAW.cross_Sell is of type table.
[0m18:45:42.734626 [debug] [Thread-1 (]: Applying DROP to: "MINI_PROJECT"."RAW"."CROSS_SELL"
[0m18:45:42.734626 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:45:42.734626 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
drop view if exists "MINI_PROJECT"."RAW"."CROSS_SELL" cascade
[0m18:45:42.853596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m18:45:42.867065 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m18:45:42.870769 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:45:42.870769 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace transient table mini_project.RAW.cross_Sell
         as
        (
WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        mini_project.intermediate.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
        );
[0m18:45:43.949695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m18:45:43.952609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAED405C0>]}
[0m18:45:43.954134 [info ] [Thread-1 (]: 8 of 13 OK created sql table model mini_project.RAW.cross_Sell ................. [[32mSUCCESS 1[0m in 1.23s]
[0m18:45:43.955313 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m18:45:43.955313 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m18:45:43.955313 [info ] [Thread-1 (]: 9 of 13 START sql table model mini_project.RAW.new_customer .................... [RUN]
[0m18:45:43.955313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m18:45:43.955313 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m18:45:43.961095 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m18:45:43.961095 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m18:45:43.963104 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m18:45:43.965112 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m18:45:43.965112 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table mini_project.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       mini_project.intermediate.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m18:45:44.424250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.465 seconds
[0m18:45:44.435371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB14E9A00>]}
[0m18:45:44.436453 [info ] [Thread-1 (]: 9 of 13 OK created sql table model mini_project.RAW.new_customer ............... [[32mSUCCESS 1[0m in 0.48s]
[0m18:45:44.436453 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m18:45:44.436453 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m18:45:44.436453 [info ] [Thread-1 (]: 10 of 13 START sql table model mini_project.RAW.nrr_grr ........................ [RUN]
[0m18:45:44.436453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.nrr_grr)
[0m18:45:44.436453 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m18:45:44.436453 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m18:45:44.436453 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m18:45:44.436453 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m18:45:44.436453 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m18:45:44.436453 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.RAW.nrr_grr
         as
        (WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', payment_month) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        DATE_TRUNC('month', payment_month)
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m18:45:44.580775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00bb-0001-429e-0008-511e00020252
[0m18:45:44.580775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function DATE_TRUNC does not support VARCHAR(255) argument type
[0m18:45:44.599112 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\mart\nrr_grr.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\mart\nrr_grr.sql
[0m18:45:44.599112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAEBE5BE0>]}
[0m18:45:44.602125 [error] [Thread-1 (]: 10 of 13 ERROR creating sql table model mini_project.RAW.nrr_grr ............... [[31mERROR[0m in 0.16s]
[0m18:45:44.603126 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m18:45:44.604124 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m18:45:44.604124 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model nrr_grr (models\mart\nrr_grr.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\mart\nrr_grr.sql.
[0m18:45:44.604124 [info ] [Thread-1 (]: 11 of 13 START sql table model mini_project.RAW.product_churn .................. [RUN]
[0m18:45:44.605565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.nrr_grr, now model.Mini_Project.product_churn)
[0m18:45:44.606599 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m18:45:44.609705 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m18:45:44.610709 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m18:45:44.614368 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m18:45:44.616616 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m18:45:44.616616 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table mini_project.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m18:45:45.143850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m18:45:45.143850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB163B020>]}
[0m18:45:45.152946 [info ] [Thread-1 (]: 11 of 13 OK created sql table model mini_project.RAW.product_churn ............. [[32mSUCCESS 1[0m in 0.54s]
[0m18:45:45.154806 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m18:45:45.154806 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m18:45:45.154806 [info ] [Thread-1 (]: 12 of 13 START sql table model mini_project.RAW.rank_customer .................. [RUN]
[0m18:45:45.154806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m18:45:45.154806 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m18:45:45.154806 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m18:45:45.154806 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m18:45:45.154806 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m18:45:45.154806 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m18:45:45.154806 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table mini_project.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m18:45:45.620664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.454 seconds
[0m18:45:45.622890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDB163B920>]}
[0m18:45:45.622890 [info ] [Thread-1 (]: 12 of 13 OK created sql table model mini_project.RAW.rank_customer ............. [[32mSUCCESS 1[0m in 0.47s]
[0m18:45:45.623886 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m18:45:45.624937 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m18:45:45.624937 [info ] [Thread-1 (]: 13 of 13 START sql table model mini_project.RAW.rank_products .................. [RUN]
[0m18:45:45.625941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m18:45:45.627120 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m18:45:45.630343 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m18:45:45.632323 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m18:45:45.634318 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m18:45:45.636863 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m18:45:45.637860 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table mini_project.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m18:45:46.118129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.481 seconds
[0m18:45:46.121242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180e20f8-dea1-4869-9152-dcc0597ca5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAFACD1F0>]}
[0m18:45:46.122529 [info ] [Thread-1 (]: 13 of 13 OK created sql table model mini_project.RAW.rank_products ............. [[32mSUCCESS 1[0m in 0.50s]
[0m18:45:46.125751 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m18:45:46.125751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:46.125751 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:45:46.125751 [debug] [MainThread]: On list_mini_project: Close
[0m18:45:46.205115 [debug] [MainThread]: Connection 'list_mini_project_RAW' was left open.
[0m18:45:46.214935 [debug] [MainThread]: On list_mini_project_RAW: Close
[0m18:45:46.291021 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m18:45:46.292055 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m18:45:46.373845 [info ] [MainThread]: 
[0m18:45:46.374730 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 12.75 seconds (12.75s).
[0m18:45:46.392172 [debug] [MainThread]: Command end result
[0m18:45:46.423499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:45:46.423499 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:45:46.423499 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:45:46.423499 [info ] [MainThread]: 
[0m18:45:46.423499 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:45:46.423499 [info ] [MainThread]: 
[0m18:45:46.423499 [error] [MainThread]:   Database Error in model nrr_grr (models\mart\nrr_grr.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\mart\nrr_grr.sql
[0m18:45:46.423499 [info ] [MainThread]: 
[0m18:45:46.423499 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m18:45:46.423499 [debug] [MainThread]: Command `dbt run` failed at 18:45:46.423499 after 14.13 seconds
[0m18:45:46.437253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAC3797C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDACADE330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDACADE720>]}
[0m18:45:46.437253 [debug] [MainThread]: Flushing usage events
[0m18:45:47.573448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:45:58.264141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C75F9A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C75FBB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C75FAED0>]}


============================== 18:45:58.269517 | 4df76b07-cc9d-47b3-9539-24edba24a73c ==============================
[0m18:45:58.269517 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:45:58.270648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s nrr_grr', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:45:58.701904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4df76b07-cc9d-47b3-9539-24edba24a73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C838FD70>]}
[0m18:45:58.773500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4df76b07-cc9d-47b3-9539-24edba24a73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C6B31EB0>]}
[0m18:45:58.774498 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:45:59.100455 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:45:59.243709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:45:59.244740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:45:59.250543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:45:59.270157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4df76b07-cc9d-47b3-9539-24edba24a73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C739BD70>]}
[0m18:45:59.353511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:45:59.357384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:45:59.385132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4df76b07-cc9d-47b3-9539-24edba24a73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C821E0C0>]}
[0m18:45:59.386179 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:45:59.386179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df76b07-cc9d-47b3-9539-24edba24a73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C836B1A0>]}
[0m18:45:59.388187 [info ] [MainThread]: 
[0m18:45:59.388726 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:59.389330 [info ] [MainThread]: 
[0m18:45:59.389900 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:45:59.391047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:45:59.480347 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:45:59.481381 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:45:59.481381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:00.386725 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.905 seconds
[0m18:46:00.392708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_RAW'
[0m18:46:00.402629 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m18:46:00.402629 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m18:46:00.402629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:00.980206 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.575 seconds
[0m18:46:00.982315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_staging)
[0m18:46:00.985226 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:46:00.988223 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:46:01.091591 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.103 seconds
[0m18:46:01.093479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate)
[0m18:46:01.093479 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:46:01.093479 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:46:01.204843 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.113 seconds
[0m18:46:01.204843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4df76b07-cc9d-47b3-9539-24edba24a73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C9412C00>]}
[0m18:46:01.204843 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m18:46:01.204843 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.RAW.nrr_grr .......................... [RUN]
[0m18:46:01.218737 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.nrr_grr'
[0m18:46:01.218737 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m18:46:01.227206 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m18:46:01.228234 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m18:46:01.258102 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m18:46:01.258102 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m18:46:01.258102 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.RAW.nrr_grr
         as
        (WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', payment_month) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        DATE_TRUNC('month', payment_month)
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m18:46:01.258102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:46:01.613087 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00bc-0001-429e-0008-511e00020262
[0m18:46:01.619137 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002016 (22000): SQL compilation error:
Function DATE_TRUNC does not support VARCHAR(255) argument type
[0m18:46:01.622734 [debug] [Thread-1 (]: Database Error in model nrr_grr (models\mart\nrr_grr.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\mart\nrr_grr.sql
[0m18:46:01.624550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4df76b07-cc9d-47b3-9539-24edba24a73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C6AA0380>]}
[0m18:46:01.624550 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mini_project.RAW.nrr_grr ................. [[31mERROR[0m in 0.40s]
[0m18:46:01.625592 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m18:46:01.626593 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.nrr_grr' to be skipped because of status 'error'.  Reason: Database Error in model nrr_grr (models\mart\nrr_grr.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\mart\nrr_grr.sql.
[0m18:46:01.627678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:01.628804 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:46:01.628804 [debug] [MainThread]: On list_mini_project: Close
[0m18:46:01.706663 [debug] [MainThread]: Connection 'list_mini_project_intermediate' was left open.
[0m18:46:01.706663 [debug] [MainThread]: On list_mini_project_intermediate: Close
[0m18:46:01.804546 [debug] [MainThread]: Connection 'model.Mini_Project.nrr_grr' was left open.
[0m18:46:01.805549 [debug] [MainThread]: On model.Mini_Project.nrr_grr: Close
[0m18:46:01.894398 [info ] [MainThread]: 
[0m18:46:01.897502 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m18:46:01.901083 [debug] [MainThread]: Command end result
[0m18:46:01.924223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:46:01.924223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:46:01.940458 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:46:01.940458 [info ] [MainThread]: 
[0m18:46:01.941539 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:46:01.942738 [info ] [MainThread]: 
[0m18:46:01.942738 [error] [MainThread]:   Database Error in model nrr_grr (models\mart\nrr_grr.sql)
  002016 (22000): SQL compilation error:
  Function DATE_TRUNC does not support VARCHAR(255) argument type
  compiled code at target\run\Mini_Project\models\mart\nrr_grr.sql
[0m18:46:01.942738 [info ] [MainThread]: 
[0m18:46:01.942738 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:46:01.942738 [debug] [MainThread]: Command `dbt run` failed at 18:46:01.942738 after 3.85 seconds
[0m18:46:01.947260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C71159D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C6B0CF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C6EB6A20>]}
[0m18:46:01.947260 [debug] [MainThread]: Flushing usage events
[0m18:46:03.222599 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:46.138588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2B2F2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2CCF8F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2CCF89E0>]}


============================== 18:46:46.138588 | 9c592953-2c7b-4619-9f9f-70f0e39f897c ==============================
[0m18:46:46.138588 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:46:46.138588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s nrr_grr', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:46:46.576496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c592953-2c7b-4619-9f9f-70f0e39f897c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2FCB4B00>]}
[0m18:46:46.634192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c592953-2c7b-4619-9f9f-70f0e39f897c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2E4F5D90>]}
[0m18:46:46.636201 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:46:46.937049 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:46:47.079742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:46:47.079742 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:46:47.095484 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:46:47.117876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c592953-2c7b-4619-9f9f-70f0e39f897c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2FD6FB00>]}
[0m18:46:47.181660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:46:47.181660 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:46:47.213087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c592953-2c7b-4619-9f9f-70f0e39f897c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2CCC59D0>]}
[0m18:46:47.213087 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:46:47.213087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c592953-2c7b-4619-9f9f-70f0e39f897c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2EFC3680>]}
[0m18:46:47.213087 [info ] [MainThread]: 
[0m18:46:47.213087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:46:47.213087 [info ] [MainThread]: 
[0m18:46:47.213087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:46:47.213087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:46:47.324626 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:46:47.324626 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:46:47.324626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:48.178835 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.855 seconds
[0m18:46:48.182857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_RAW'
[0m18:46:48.194724 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m18:46:48.194724 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m18:46:48.194724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:48.649600 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.457 seconds
[0m18:46:48.649600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_intermediate)
[0m18:46:48.664774 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:46:48.680747 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:46:48.769963 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m18:46:48.776910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate, now list_mini_project_staging)
[0m18:46:48.776910 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:46:48.792865 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:46:48.893749 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.103 seconds
[0m18:46:48.905482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c592953-2c7b-4619-9f9f-70f0e39f897c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD30DA2780>]}
[0m18:46:48.909174 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m18:46:48.913567 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.RAW.nrr_grr .......................... [RUN]
[0m18:46:48.913567 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.nrr_grr'
[0m18:46:48.913567 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m18:46:48.922065 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m18:46:48.923434 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m18:46:48.954274 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m18:46:48.956476 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m18:46:48.957534 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.RAW.nrr_grr
         as
        (WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m18:46:48.957534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:46:49.959978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.014 seconds
[0m18:46:50.007236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c592953-2c7b-4619-9f9f-70f0e39f897c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2C361670>]}
[0m18:46:50.007236 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mini_project.RAW.nrr_grr ..................... [[32mSUCCESS 1[0m in 1.09s]
[0m18:46:50.007236 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m18:46:50.007236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:50.007236 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:46:50.007236 [debug] [MainThread]: On list_mini_project: Close
[0m18:46:50.085603 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m18:46:50.085603 [debug] [MainThread]: On list_mini_project_staging: Close
[0m18:46:50.172392 [debug] [MainThread]: Connection 'model.Mini_Project.nrr_grr' was left open.
[0m18:46:50.181616 [debug] [MainThread]: On model.Mini_Project.nrr_grr: Close
[0m18:46:50.249733 [info ] [MainThread]: 
[0m18:46:50.249733 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m18:46:50.249733 [debug] [MainThread]: Command end result
[0m18:46:50.288023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:46:50.288023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:46:50.301305 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:46:50.301612 [info ] [MainThread]: 
[0m18:46:50.303010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:46:50.304854 [info ] [MainThread]: 
[0m18:46:50.305472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:46:50.306019 [debug] [MainThread]: Command `dbt run` succeeded at 18:46:50.306019 after 4.33 seconds
[0m18:46:50.306019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2B2F2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2EF77650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CD2EE92C00>]}
[0m18:46:50.307115 [debug] [MainThread]: Flushing usage events
[0m18:46:51.252324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:47:18.845376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E7509FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E76A9DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E76C03530>]}


============================== 18:47:18.850281 | 94777287-e6ea-4ffa-80cb-f99c8439a875 ==============================
[0m18:47:18.850281 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:47:18.850650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m18:47:19.308163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E774CE6F0>]}
[0m18:47:19.357761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E774CDCA0>]}
[0m18:47:19.357761 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:47:19.702742 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:47:19.830830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:47:19.830830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:47:19.846023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Mini_Project.Mart
[0m18:47:19.878208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79178710>]}
[0m18:47:19.951363 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:47:19.951363 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:47:20.031090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E794F6A50>]}
[0m18:47:20.031090 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:47:20.031090 [info ] [MainThread]: 
[0m18:47:20.031090 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:20.031090 [info ] [MainThread]: 
[0m18:47:20.031090 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:20.050328 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:47:20.131736 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:47:20.131736 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:47:20.131736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:20.997110 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.858 seconds
[0m18:47:21.005766 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:47:21.005766 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:47:21.076754 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.074 seconds
[0m18:47:21.076754 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:47:21.076754 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:47:21.155765 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.076 seconds
[0m18:47:21.171538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m18:47:21.187654 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:47:21.187654 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:47:21.187654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:21.525673 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.335 seconds
[0m18:47:21.529380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_RAW)
[0m18:47:21.535245 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_RAW"
[0m18:47:21.535245 [debug] [ThreadPool]: On list_mini_project_RAW: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_RAW"} */
show objects in mini_project.RAW limit 10000;
[0m18:47:21.644442 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 0.108 seconds
[0m18:47:21.646259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_RAW, now list_mini_project_intermediate)
[0m18:47:21.648552 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:47:21.650984 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:47:21.750087 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m18:47:21.754153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79A5B620>]}
[0m18:47:21.754153 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m18:47:21.754153 [info ] [Thread-1 (]: 1 of 13 START sql table model mini_project.staging.stg_customers ............... [RUN]
[0m18:47:21.754153 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m18:47:21.754153 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m18:47:21.766884 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m18:47:21.766884 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m18:47:21.800281 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m18:47:21.800281 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m18:47:21.800281 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace transient table mini_project.staging.stg_customers
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
        );
[0m18:47:21.800281 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:47:22.636331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m18:47:22.673840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E767A08F0>]}
[0m18:47:22.673840 [info ] [Thread-1 (]: 1 of 13 OK created sql table model mini_project.staging.stg_customers .......... [[32mSUCCESS 1[0m in 0.92s]
[0m18:47:22.673840 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m18:47:22.677581 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m18:47:22.677581 [info ] [Thread-1 (]: 2 of 13 START sql table model mini_project.staging.stg_products ................ [RUN]
[0m18:47:22.677581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m18:47:22.679591 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m18:47:22.683520 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m18:47:22.686336 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m18:47:22.691001 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m18:47:22.693041 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m18:47:22.693041 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace transient table mini_project.staging.stg_products
         as
        (


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
        );
[0m18:47:23.149845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.455 seconds
[0m18:47:23.151887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79C2E7B0>]}
[0m18:47:23.151887 [info ] [Thread-1 (]: 2 of 13 OK created sql table model mini_project.staging.stg_products ........... [[32mSUCCESS 1[0m in 0.47s]
[0m18:47:23.153264 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m18:47:23.153264 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m18:47:23.153264 [info ] [Thread-1 (]: 3 of 13 START sql table model mini_project.staging.stg_region .................. [RUN]
[0m18:47:23.154790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m18:47:23.154790 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m18:47:23.158921 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m18:47:23.159922 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m18:47:23.162140 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m18:47:23.163152 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m18:47:23.164269 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace transient table mini_project.staging.stg_region
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
        );
[0m18:47:24.018798 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.869 seconds
[0m18:47:24.035998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79CCEB10>]}
[0m18:47:24.035998 [info ] [Thread-1 (]: 3 of 13 OK created sql table model mini_project.staging.stg_region ............. [[32mSUCCESS 1[0m in 0.88s]
[0m18:47:24.035998 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m18:47:24.035998 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m18:47:24.035998 [info ] [Thread-1 (]: 4 of 13 START sql table model mini_project.staging.stg_transaction ............. [RUN]
[0m18:47:24.035998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m18:47:24.035998 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m18:47:24.035998 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m18:47:24.035998 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m18:47:24.035998 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m18:47:24.035998 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m18:47:24.035998 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace transient table mini_project.staging.stg_transaction
         as
        (with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
        );
[0m18:47:24.738112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m18:47:24.738112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79CE0800>]}
[0m18:47:24.738112 [info ] [Thread-1 (]: 4 of 13 OK created sql table model mini_project.staging.stg_transaction ........ [[32mSUCCESS 1[0m in 0.70s]
[0m18:47:24.738112 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m18:47:24.738112 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m18:47:24.738112 [info ] [Thread-1 (]: 5 of 13 START sql table model mini_project.intermediate.master1 ................ [RUN]
[0m18:47:24.738112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m18:47:24.738112 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m18:47:24.738112 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m18:47:24.738112 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m18:47:24.754480 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m18:47:24.756417 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m18:47:24.757353 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace transient table mini_project.intermediate.master1
         as
        (WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        mini_project.staging.stg_customers c
    FULL JOIN
        mini_project.staging.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        mini_project.staging.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
        );
[0m18:47:25.722341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.973 seconds
[0m18:47:25.722341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79D0A210>]}
[0m18:47:25.722341 [info ] [Thread-1 (]: 5 of 13 OK created sql table model mini_project.intermediate.master1 ........... [[32mSUCCESS 1[0m in 0.98s]
[0m18:47:25.722341 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m18:47:25.722341 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:47:25.722341 [info ] [Thread-1 (]: 6 of 13 START sql table model mini_project.RAW.CustomerChurn6Mon ............... [RUN]
[0m18:47:25.736554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m18:47:25.736554 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:47:25.790357 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:47:25.790357 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:47:25.806059 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:47:25.806059 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:47:25.806059 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.RAW.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:47:26.320155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m18:47:26.321163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79D08EC0>]}
[0m18:47:26.321163 [info ] [Thread-1 (]: 6 of 13 OK created sql table model mini_project.RAW.CustomerChurn6Mon .......... [[32mSUCCESS 1[0m in 0.58s]
[0m18:47:26.321163 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:47:26.321163 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m18:47:26.321163 [info ] [Thread-1 (]: 7 of 13 START sql table model mini_project.RAW.churn ........................... [RUN]
[0m18:47:26.327044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m18:47:26.327044 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m18:47:26.327044 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m18:47:26.327044 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m18:47:26.327044 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m18:47:26.336844 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:47:26.337253 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace transient table mini_project.RAW.churn
         as
        (
WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
        );
[0m18:47:26.889898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.557 seconds
[0m18:47:26.889898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79C5D970>]}
[0m18:47:26.889898 [info ] [Thread-1 (]: 7 of 13 OK created sql table model mini_project.RAW.churn ...................... [[32mSUCCESS 1[0m in 0.56s]
[0m18:47:26.889898 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m18:47:26.889898 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m18:47:26.889898 [info ] [Thread-1 (]: 8 of 13 START sql table model mini_project.RAW.cross_Sell ...................... [RUN]
[0m18:47:26.889898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m18:47:26.889898 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m18:47:26.907051 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m18:47:26.909084 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m18:47:26.912462 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m18:47:26.912462 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:47:26.912462 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace transient table mini_project.RAW.cross_Sell
         as
        (
WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        mini_project.intermediate.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
        );
[0m18:47:28.055833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.140 seconds
[0m18:47:28.061011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79C5CFE0>]}
[0m18:47:28.061011 [info ] [Thread-1 (]: 8 of 13 OK created sql table model mini_project.RAW.cross_Sell ................. [[32mSUCCESS 1[0m in 1.17s]
[0m18:47:28.061011 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m18:47:28.061011 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m18:47:28.061011 [info ] [Thread-1 (]: 9 of 13 START sql table model mini_project.RAW.new_customer .................... [RUN]
[0m18:47:28.061011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m18:47:28.061011 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m18:47:28.061011 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m18:47:28.061011 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m18:47:28.061011 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m18:47:28.074118 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m18:47:28.074118 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table mini_project.RAW.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       mini_project.intermediate.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m18:47:28.549365 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m18:47:28.551438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79C7E060>]}
[0m18:47:28.551438 [info ] [Thread-1 (]: 9 of 13 OK created sql table model mini_project.RAW.new_customer ............... [[32mSUCCESS 1[0m in 0.49s]
[0m18:47:28.553475 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m18:47:28.553475 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m18:47:28.554508 [info ] [Thread-1 (]: 10 of 13 START sql table model mini_project.RAW.nrr_grr ........................ [RUN]
[0m18:47:28.554508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.nrr_grr)
[0m18:47:28.555511 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m18:47:28.557013 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m18:47:28.557013 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m18:47:28.557013 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m18:47:28.566222 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m18:47:28.566988 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.RAW.nrr_grr
         as
        (WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m18:47:29.108091 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m18:47:29.108091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79CB7B60>]}
[0m18:47:29.108091 [info ] [Thread-1 (]: 10 of 13 OK created sql table model mini_project.RAW.nrr_grr ................... [[32mSUCCESS 1[0m in 0.55s]
[0m18:47:29.108091 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m18:47:29.108091 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m18:47:29.108091 [info ] [Thread-1 (]: 11 of 13 START sql table model mini_project.RAW.product_churn .................. [RUN]
[0m18:47:29.108091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.nrr_grr, now model.Mini_Project.product_churn)
[0m18:47:29.108091 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m18:47:29.129834 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m18:47:29.129834 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m18:47:29.133422 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m18:47:29.134703 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m18:47:29.134703 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table mini_project.RAW.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m18:47:29.646335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.512 seconds
[0m18:47:29.646335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79C2CD40>]}
[0m18:47:29.646335 [info ] [Thread-1 (]: 11 of 13 OK created sql table model mini_project.RAW.product_churn ............. [[32mSUCCESS 1[0m in 0.54s]
[0m18:47:29.646335 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m18:47:29.646335 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m18:47:29.646335 [info ] [Thread-1 (]: 12 of 13 START sql table model mini_project.RAW.rank_customer .................. [RUN]
[0m18:47:29.646335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m18:47:29.646335 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m18:47:29.658915 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m18:47:29.659967 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m18:47:29.663725 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m18:47:29.663725 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m18:47:29.665906 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table mini_project.RAW.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m18:47:30.128776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.464 seconds
[0m18:47:30.128776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79C903E0>]}
[0m18:47:30.128776 [info ] [Thread-1 (]: 12 of 13 OK created sql table model mini_project.RAW.rank_customer ............. [[32mSUCCESS 1[0m in 0.48s]
[0m18:47:30.128776 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m18:47:30.128776 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m18:47:30.128776 [info ] [Thread-1 (]: 13 of 13 START sql table model mini_project.RAW.rank_products .................. [RUN]
[0m18:47:30.128776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m18:47:30.128776 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m18:47:30.141988 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m18:47:30.143685 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m18:47:30.146796 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m18:47:30.148118 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m18:47:30.148118 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table mini_project.RAW.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m18:47:30.597252 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m18:47:30.597252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94777287-e6ea-4ffa-80cb-f99c8439a875', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E79C90E90>]}
[0m18:47:30.597252 [info ] [Thread-1 (]: 13 of 13 OK created sql table model mini_project.RAW.rank_products ............. [[32mSUCCESS 1[0m in 0.47s]
[0m18:47:30.597252 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m18:47:30.597252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:30.597252 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:47:30.597252 [debug] [MainThread]: On list_mini_project: Close
[0m18:47:30.681618 [debug] [MainThread]: Connection 'list_mini_project_intermediate' was left open.
[0m18:47:30.681618 [debug] [MainThread]: On list_mini_project_intermediate: Close
[0m18:47:30.760475 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m18:47:30.765062 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m18:47:30.838641 [info ] [MainThread]: 
[0m18:47:30.840648 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 10.81 seconds (10.81s).
[0m18:47:30.842656 [debug] [MainThread]: Command end result
[0m18:47:30.860484 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:47:30.860484 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:47:30.879887 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:47:30.879887 [info ] [MainThread]: 
[0m18:47:30.880995 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:30.882128 [info ] [MainThread]: 
[0m18:47:30.883150 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m18:47:30.884205 [debug] [MainThread]: Command `dbt build` succeeded at 18:47:30.884205 after 12.21 seconds
[0m18:47:30.884205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E748DFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E77C0FFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E790A2BA0>]}
[0m18:47:30.884205 [debug] [MainThread]: Flushing usage events
[0m18:47:32.328929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:43.415902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650CDEE270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650CDEE300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650CDEE2D0>]}


============================== 18:50:43.415902 | 78ecbfac-acc0-4285-be9d-3a4ca09f70f8 ==============================
[0m18:50:43.415902 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:50:43.415902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m18:50:43.866696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78ecbfac-acc0-4285-be9d-3a4ca09f70f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650CFC83E0>]}
[0m18:50:43.914225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78ecbfac-acc0-4285-be9d-3a4ca09f70f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650DC3BFB0>]}
[0m18:50:43.914225 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:50:44.241075 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:50:44.368483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:44.368483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:44.403840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78ecbfac-acc0-4285-be9d-3a4ca09f70f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650DC39730>]}
[0m18:50:44.479647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:50:44.486236 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:50:44.511423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78ecbfac-acc0-4285-be9d-3a4ca09f70f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650F12D220>]}
[0m18:50:44.511423 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:50:44.511423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ecbfac-acc0-4285-be9d-3a4ca09f70f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650CDEE300>]}
[0m18:50:44.511423 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:50:44.511423 [debug] [MainThread]: Command end result
[0m18:50:44.542158 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:50:44.543500 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:50:44.546641 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:50:44.546641 [info ] [MainThread]: 
[0m18:50:44.546641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:44.546641 [info ] [MainThread]: 
[0m18:50:44.552032 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m18:50:44.553048 [debug] [MainThread]: Command `dbt seed` succeeded at 18:50:44.553048 after 1.32 seconds
[0m18:50:44.554336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650C793FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650CA37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002650CA36870>]}
[0m18:50:44.554878 [debug] [MainThread]: Flushing usage events
[0m18:50:45.772004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:53.182083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1ABAC8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AB993F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1ABAC82F0>]}


============================== 18:50:53.188282 | d39ac6be-33eb-45db-b17a-748d5297b647 ==============================
[0m18:50:53.188282 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:50:53.188282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:50:53.627809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AC517830>]}
[0m18:50:53.690168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AB3635C0>]}
[0m18:50:53.690168 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:50:54.000164 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:50:54.144196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:50:54.144196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:50:54.176654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AD8C1E20>]}
[0m18:50:54.241414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:50:54.241414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:50:54.280337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AC88C0E0>]}
[0m18:50:54.280337 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:50:54.280337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1ADCCDBB0>]}
[0m18:50:54.285475 [info ] [MainThread]: 
[0m18:50:54.285475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:50:54.285475 [info ] [MainThread]: 
[0m18:50:54.285475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:50:54.292933 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:50:54.380006 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:50:54.380006 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:50:54.380006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:55.744750 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.357 seconds
[0m18:50:55.752783 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:50:55.752783 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:50:55.843172 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.088 seconds
[0m18:50:55.858874 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:50:55.858874 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:50:55.939924 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.089 seconds
[0m18:50:55.956041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project, now create_mini_project_mart)
[0m18:50:55.956041 [debug] [ThreadPool]: Creating schema "database: "mini_project"
schema: "mart"
"
[0m18:50:55.971832 [debug] [ThreadPool]: Using snowflake connection "create_mini_project_mart"
[0m18:50:55.971832 [debug] [ThreadPool]: On create_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "create_mini_project_mart"} */
create schema if not exists mini_project.mart
[0m18:50:56.061053 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.093 seconds
[0m18:50:56.074705 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m18:50:56.085226 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m18:50:56.085226 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m18:50:56.085226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:56.506052 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.418 seconds
[0m18:50:56.506052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_intermediate)
[0m18:50:56.506052 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:50:56.506052 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:50:56.604677 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.092 seconds
[0m18:50:56.606419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate, now list_mini_project_staging)
[0m18:50:56.608429 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:50:56.608429 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:50:56.699574 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.096 seconds
[0m18:50:56.715227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AD93B290>]}
[0m18:50:56.715227 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m18:50:56.715227 [info ] [Thread-1 (]: 1 of 13 START sql table model mini_project.staging.stg_customers ............... [RUN]
[0m18:50:56.715227 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m18:50:56.715227 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m18:50:56.732054 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m18:50:56.734233 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m18:50:56.765386 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m18:50:56.767715 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m18:50:56.767715 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace transient table mini_project.staging.stg_customers
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
        );
[0m18:50:56.767715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:50:57.461742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m18:50:57.493244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AAF90710>]}
[0m18:50:57.493244 [info ] [Thread-1 (]: 1 of 13 OK created sql table model mini_project.staging.stg_customers .......... [[32mSUCCESS 1[0m in 0.78s]
[0m18:50:57.493244 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m18:50:57.493244 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m18:50:57.493244 [info ] [Thread-1 (]: 2 of 13 START sql table model mini_project.staging.stg_products ................ [RUN]
[0m18:50:57.493244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m18:50:57.493244 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m18:50:57.493244 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m18:50:57.493244 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m18:50:57.510709 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m18:50:57.512470 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m18:50:57.513535 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace transient table mini_project.staging.stg_products
         as
        (


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
        );
[0m18:50:57.993879 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m18:50:57.993879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE285850>]}
[0m18:50:57.993879 [info ] [Thread-1 (]: 2 of 13 OK created sql table model mini_project.staging.stg_products ........... [[32mSUCCESS 1[0m in 0.50s]
[0m18:50:57.993879 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m18:50:57.993879 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m18:50:57.993879 [info ] [Thread-1 (]: 3 of 13 START sql table model mini_project.staging.stg_region .................. [RUN]
[0m18:50:57.993879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m18:50:57.993879 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m18:50:58.009725 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m18:50:58.009725 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m18:50:58.009725 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m18:50:58.009725 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m18:50:58.009725 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace transient table mini_project.staging.stg_region
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
        );
[0m18:50:58.486174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.470 seconds
[0m18:50:58.486174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE0ED9A0>]}
[0m18:50:58.486174 [info ] [Thread-1 (]: 3 of 13 OK created sql table model mini_project.staging.stg_region ............. [[32mSUCCESS 1[0m in 0.49s]
[0m18:50:58.486174 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m18:50:58.486174 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m18:50:58.486174 [info ] [Thread-1 (]: 4 of 13 START sql table model mini_project.staging.stg_transaction ............. [RUN]
[0m18:50:58.486174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m18:50:58.486174 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m18:50:58.496061 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m18:50:58.496863 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m18:50:58.501364 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m18:50:58.501906 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m18:50:58.504898 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace transient table mini_project.staging.stg_transaction
         as
        (with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
        );
[0m18:50:59.127122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m18:50:59.133480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE2CAED0>]}
[0m18:50:59.133480 [info ] [Thread-1 (]: 4 of 13 OK created sql table model mini_project.staging.stg_transaction ........ [[32mSUCCESS 1[0m in 0.65s]
[0m18:50:59.133480 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m18:50:59.133480 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m18:50:59.133480 [info ] [Thread-1 (]: 5 of 13 START sql table model mini_project.intermediate.master1 ................ [RUN]
[0m18:50:59.133480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m18:50:59.133480 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m18:50:59.133480 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m18:50:59.143661 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m18:50:59.147331 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m18:50:59.148533 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m18:50:59.149821 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace transient table mini_project.intermediate.master1
         as
        (WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        mini_project.staging.stg_customers c
    FULL JOIN
        mini_project.staging.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        mini_project.staging.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
        );
[0m18:51:00.467994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.322 seconds
[0m18:51:00.467994 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE323200>]}
[0m18:51:00.467994 [info ] [Thread-1 (]: 5 of 13 OK created sql table model mini_project.intermediate.master1 ........... [[32mSUCCESS 1[0m in 1.33s]
[0m18:51:00.467994 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m18:51:00.467994 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:00.467994 [info ] [Thread-1 (]: 6 of 13 START sql table model mini_project.mart.CustomerChurn6Mon .............. [RUN]
[0m18:51:00.467994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m18:51:00.467994 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:51:00.467994 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:00.467994 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:51:00.485708 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:00.486740 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:00.488184 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.mart.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = "True"
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:51:00.579604 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c1-0001-429a-0008-511e0001e9ea
[0m18:51:00.579604 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 23
invalid identifier '"True"'
[0m18:51:00.582794 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  000904 (42000): SQL compilation error: error line 13 at position 23
  invalid identifier '"True"'
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql
[0m18:51:00.582794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE34B4A0>]}
[0m18:51:00.584268 [error] [Thread-1 (]: 6 of 13 ERROR creating sql table model mini_project.mart.CustomerChurn6Mon ..... [[31mERROR[0m in 0.11s]
[0m18:51:00.585043 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:00.585043 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m18:51:00.586102 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  000904 (42000): SQL compilation error: error line 13 at position 23
  invalid identifier '"True"'
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql.
[0m18:51:00.586102 [info ] [Thread-1 (]: 7 of 13 START sql table model mini_project.mart.churn .......................... [RUN]
[0m18:51:00.587291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m18:51:00.588397 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m18:51:00.645342 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m18:51:00.645342 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m18:51:00.645342 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m18:51:00.651441 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:51:00.651441 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace transient table mini_project.mart.churn
         as
        (
WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
        );
[0m18:51:01.260990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m18:51:01.260990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AD888860>]}
[0m18:51:01.260990 [info ] [Thread-1 (]: 7 of 13 OK created sql table model mini_project.mart.churn ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m18:51:01.260990 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m18:51:01.260990 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m18:51:01.260990 [info ] [Thread-1 (]: 8 of 13 START sql table model mini_project.mart.cross_Sell ..................... [RUN]
[0m18:51:01.260990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m18:51:01.260990 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m18:51:01.260990 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m18:51:01.260990 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m18:51:01.260990 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m18:51:01.279074 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:51:01.279074 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace transient table mini_project.mart.cross_Sell
         as
        (
WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        mini_project.intermediate.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
        );
[0m18:51:02.312167 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.046 seconds
[0m18:51:02.327962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AC6EDE20>]}
[0m18:51:02.327962 [info ] [Thread-1 (]: 8 of 13 OK created sql table model mini_project.mart.cross_Sell ................ [[32mSUCCESS 1[0m in 1.07s]
[0m18:51:02.327962 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m18:51:02.327962 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m18:51:02.327962 [info ] [Thread-1 (]: 9 of 13 START sql table model mini_project.mart.new_customer ................... [RUN]
[0m18:51:02.327962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m18:51:02.327962 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m18:51:02.327962 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m18:51:02.327962 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m18:51:02.327962 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m18:51:02.338681 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m18:51:02.338681 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table mini_project.mart.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       mini_project.intermediate.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m18:51:02.867152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m18:51:02.883567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE243080>]}
[0m18:51:02.885583 [info ] [Thread-1 (]: 9 of 13 OK created sql table model mini_project.mart.new_customer .............. [[32mSUCCESS 1[0m in 0.55s]
[0m18:51:02.890053 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m18:51:02.892070 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m18:51:02.892070 [info ] [Thread-1 (]: 10 of 13 START sql table model mini_project.mart.nrr_grr ....................... [RUN]
[0m18:51:02.895528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.nrr_grr)
[0m18:51:02.898707 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m18:51:02.904761 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m18:51:02.906330 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m18:51:02.909382 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m18:51:02.910379 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m18:51:02.910379 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.mart.nrr_grr
         as
        (WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m18:51:03.348579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.437 seconds
[0m18:51:03.348579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE259640>]}
[0m18:51:03.348579 [info ] [Thread-1 (]: 10 of 13 OK created sql table model mini_project.mart.nrr_grr .................. [[32mSUCCESS 1[0m in 0.45s]
[0m18:51:03.363634 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m18:51:03.364649 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m18:51:03.366668 [info ] [Thread-1 (]: 11 of 13 START sql table model mini_project.mart.product_churn ................. [RUN]
[0m18:51:03.366668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.nrr_grr, now model.Mini_Project.product_churn)
[0m18:51:03.372725 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m18:51:03.377305 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m18:51:03.377305 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m18:51:03.377305 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m18:51:03.377305 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m18:51:03.377305 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table mini_project.mart.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m18:51:03.865381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.489 seconds
[0m18:51:03.875254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE321B20>]}
[0m18:51:03.875254 [info ] [Thread-1 (]: 11 of 13 OK created sql table model mini_project.mart.product_churn ............ [[32mSUCCESS 1[0m in 0.51s]
[0m18:51:03.875254 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m18:51:03.875254 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m18:51:03.875254 [info ] [Thread-1 (]: 12 of 13 START sql table model mini_project.mart.rank_customer ................. [RUN]
[0m18:51:03.875254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m18:51:03.875254 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m18:51:03.882739 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m18:51:03.884747 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m18:51:03.886756 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m18:51:03.886756 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m18:51:03.888764 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table mini_project.mart.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m18:51:04.432693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m18:51:04.432693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE262030>]}
[0m18:51:04.432693 [info ] [Thread-1 (]: 12 of 13 OK created sql table model mini_project.mart.rank_customer ............ [[32mSUCCESS 1[0m in 0.56s]
[0m18:51:04.432693 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m18:51:04.432693 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m18:51:04.432693 [info ] [Thread-1 (]: 13 of 13 START sql table model mini_project.mart.rank_products ................. [RUN]
[0m18:51:04.432693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m18:51:04.432693 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m18:51:04.432693 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m18:51:04.448396 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m18:51:04.451724 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m18:51:04.452773 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m18:51:04.453982 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table mini_project.mart.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m18:51:04.901201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.457 seconds
[0m18:51:04.901201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd39ac6be-33eb-45db-b17a-748d5297b647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AE2893D0>]}
[0m18:51:04.901201 [info ] [Thread-1 (]: 13 of 13 OK created sql table model mini_project.mart.rank_products ............ [[32mSUCCESS 1[0m in 0.47s]
[0m18:51:04.901201 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m18:51:04.901201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:04.901201 [debug] [MainThread]: Connection 'create_mini_project_mart' was left open.
[0m18:51:04.901201 [debug] [MainThread]: On create_mini_project_mart: Close
[0m18:51:05.165683 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m18:51:05.165683 [debug] [MainThread]: On list_mini_project_staging: Close
[0m18:51:05.263319 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m18:51:05.263319 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m18:51:05.363069 [info ] [MainThread]: 
[0m18:51:05.365080 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 11.08 seconds (11.08s).
[0m18:51:05.367957 [debug] [MainThread]: Command end result
[0m18:51:05.391818 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:51:05.391818 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:51:05.391818 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:51:05.391818 [info ] [MainThread]: 
[0m18:51:05.391818 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:51:05.404011 [info ] [MainThread]: 
[0m18:51:05.405012 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  000904 (42000): SQL compilation error: error line 13 at position 23
  invalid identifier '"True"'
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql
[0m18:51:05.406380 [info ] [MainThread]: 
[0m18:51:05.407646 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=1 SKIP=0 TOTAL=13
[0m18:51:05.410333 [debug] [MainThread]: Command `dbt run` failed at 18:51:05.409271 after 12.39 seconds
[0m18:51:05.410333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1AB53BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A58C7E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1A596FFE0>]}
[0m18:51:05.411427 [debug] [MainThread]: Flushing usage events
[0m18:51:06.521592 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:18.951449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3188D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC25EDFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC218E8A0>]}


============================== 18:51:18.958753 | 57702b40-5ee5-4951-b607-c5b0463939a2 ==============================
[0m18:51:18.958753 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:51:18.958753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'send_anonymous_usage_stats': 'True'}
[0m18:51:19.393942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57702b40-5ee5-4951-b607-c5b0463939a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC255F950>]}
[0m18:51:19.449133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57702b40-5ee5-4951-b607-c5b0463939a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3EEFD70>]}
[0m18:51:19.449133 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:51:19.778255 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:51:19.920488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:19.920488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:19.955469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57702b40-5ee5-4951-b607-c5b0463939a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3147B30>]}
[0m18:51:20.024678 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:51:20.026686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:51:20.052599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57702b40-5ee5-4951-b607-c5b0463939a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC53ACE00>]}
[0m18:51:20.052599 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:51:20.052599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57702b40-5ee5-4951-b607-c5b0463939a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC3D712E0>]}
[0m18:51:20.052599 [info ] [MainThread]: 
[0m18:51:20.057688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:20.057688 [info ] [MainThread]: 
[0m18:51:20.057688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:51:20.057688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:51:20.154987 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:51:20.154987 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:51:20.154987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:21.084301 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.926 seconds
[0m18:51:21.084301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m18:51:21.100367 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:51:21.100367 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:51:21.100367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:21.506516 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.404 seconds
[0m18:51:21.506516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_mart)
[0m18:51:21.506516 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m18:51:21.522485 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m18:51:21.619240 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.106 seconds
[0m18:51:21.619240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_intermediate)
[0m18:51:21.635218 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:51:21.635218 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:51:21.722165 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m18:51:21.722165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57702b40-5ee5-4951-b607-c5b0463939a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC57F3DA0>]}
[0m18:51:21.722165 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:21.733859 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.mart.CustomerChurn6Mon ............... [RUN]
[0m18:51:21.733859 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m18:51:21.733859 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:51:21.737908 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:21.737908 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:51:21.773361 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:21.773361 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:21.773361 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.mart.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = "True"
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:51:21.773361 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:51:22.093177 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00c1-0001-429b-0008-511e00021252
[0m18:51:22.093804 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 23
invalid identifier '"True"'
[0m18:51:22.096895 [debug] [Thread-1 (]: Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  000904 (42000): SQL compilation error: error line 13 at position 23
  invalid identifier '"True"'
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql
[0m18:51:22.099818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57702b40-5ee5-4951-b607-c5b0463939a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC2630A70>]}
[0m18:51:22.099818 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mini_project.mart.CustomerChurn6Mon ...... [[31mERROR[0m in 0.36s]
[0m18:51:22.099818 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:22.099818 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.CustomerChurn6Mon' to be skipped because of status 'error'.  Reason: Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  000904 (42000): SQL compilation error: error line 13 at position 23
  invalid identifier '"True"'
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql.
[0m18:51:22.104815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:22.104815 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:51:22.107638 [debug] [MainThread]: On list_mini_project: Close
[0m18:51:22.185948 [debug] [MainThread]: Connection 'list_mini_project_intermediate' was left open.
[0m18:51:22.185948 [debug] [MainThread]: On list_mini_project_intermediate: Close
[0m18:51:22.258386 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m18:51:22.258386 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m18:51:22.341411 [info ] [MainThread]: 
[0m18:51:22.341411 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m18:51:22.352124 [debug] [MainThread]: Command end result
[0m18:51:22.396875 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:51:22.396875 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:51:22.408867 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:51:22.408867 [info ] [MainThread]: 
[0m18:51:22.408867 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:51:22.408867 [info ] [MainThread]: 
[0m18:51:22.408867 [error] [MainThread]:   Database Error in model CustomerChurn6Mon (models\mart\CustomerChurn6Mon.sql)
  000904 (42000): SQL compilation error: error line 13 at position 23
  invalid identifier '"True"'
  compiled code at target\run\Mini_Project\models\mart\CustomerChurn6Mon.sql
[0m18:51:22.408867 [info ] [MainThread]: 
[0m18:51:22.408867 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:51:22.408867 [debug] [MainThread]: Command `dbt run` failed at 18:51:22.408867 after 3.62 seconds
[0m18:51:22.408867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC2631640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC2630EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0E99BE0>]}
[0m18:51:22.408867 [debug] [MainThread]: Flushing usage events
[0m18:51:23.295170 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:38.401594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFAED2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFA5D9EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFA758BC0>]}


============================== 18:51:38.410417 | f29dc43d-777d-407b-ab55-d6cc56a46297 ==============================
[0m18:51:38.410417 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:51:38.410417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s CustomerChurn6Mon', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:38.834303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f29dc43d-777d-407b-ab55-d6cc56a46297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFB8736E0>]}
[0m18:51:38.881351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f29dc43d-777d-407b-ab55-d6cc56a46297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFBB7FDA0>]}
[0m18:51:38.881351 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:51:39.195347 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:51:39.336819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:39.336819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:39.373696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f29dc43d-777d-407b-ab55-d6cc56a46297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFCCBEFF0>]}
[0m18:51:39.447090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:51:39.447090 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:51:39.476071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f29dc43d-777d-407b-ab55-d6cc56a46297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFCCBF380>]}
[0m18:51:39.476071 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:51:39.478807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f29dc43d-777d-407b-ab55-d6cc56a46297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFCCC94C0>]}
[0m18:51:39.478807 [info ] [MainThread]: 
[0m18:51:39.481199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:39.481819 [info ] [MainThread]: 
[0m18:51:39.481819 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:51:39.481819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:51:39.576072 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:51:39.576072 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:51:39.576072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:40.375024 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.800 seconds
[0m18:51:40.375024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m18:51:40.388122 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m18:51:40.388122 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m18:51:40.388122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:40.807105 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.416 seconds
[0m18:51:40.807105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_intermediate)
[0m18:51:40.823239 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:51:40.823239 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:51:40.922396 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m18:51:40.922396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate, now list_mini_project_staging)
[0m18:51:40.922396 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:51:40.922396 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:51:41.018879 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.085 seconds
[0m18:51:41.018879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f29dc43d-777d-407b-ab55-d6cc56a46297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFBBAAB40>]}
[0m18:51:41.018879 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:41.018879 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.mart.CustomerChurn6Mon ............... [RUN]
[0m18:51:41.018879 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.CustomerChurn6Mon'
[0m18:51:41.018879 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:51:41.035689 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:41.037768 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:51:41.069802 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:41.070835 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:41.072138 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.mart.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:51:41.072138 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:51:41.650876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m18:51:41.676425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f29dc43d-777d-407b-ab55-d6cc56a46297', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFF82717C0>]}
[0m18:51:41.676425 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mini_project.mart.CustomerChurn6Mon .......... [[32mSUCCESS 1[0m in 0.66s]
[0m18:51:41.682936 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:41.682936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:41.682936 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:51:41.682936 [debug] [MainThread]: On list_mini_project: Close
[0m18:51:41.760844 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m18:51:41.760844 [debug] [MainThread]: On list_mini_project_staging: Close
[0m18:51:41.841206 [debug] [MainThread]: Connection 'model.Mini_Project.CustomerChurn6Mon' was left open.
[0m18:51:41.841206 [debug] [MainThread]: On model.Mini_Project.CustomerChurn6Mon: Close
[0m18:51:41.925693 [info ] [MainThread]: 
[0m18:51:41.925693 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.44 seconds (2.44s).
[0m18:51:41.941603 [debug] [MainThread]: Command end result
[0m18:51:41.979339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:51:41.979339 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:51:41.979339 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:51:41.979339 [info ] [MainThread]: 
[0m18:51:41.979339 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:51:41.979339 [info ] [MainThread]: 
[0m18:51:41.979339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:51:41.979339 [debug] [MainThread]: Command `dbt run` succeeded at 18:51:41.979339 after 3.75 seconds
[0m18:51:41.979339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFA077E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFCEFBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFFB899A60>]}
[0m18:51:41.979339 [debug] [MainThread]: Flushing usage events
[0m18:51:42.863153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:47.484810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCB040260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCB040AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCB043440>]}


============================== 18:51:47.484810 | 72dff14e-c140-4325-8b9a-0ec03a5d402e ==============================
[0m18:51:47.484810 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:51:47.499023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:51:47.944586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCBDCF590>]}
[0m18:51:48.007603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC873B830>]}
[0m18:51:48.008733 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:51:48.328826 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:51:48.471783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:51:48.471783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:51:48.503287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCCE01280>]}
[0m18:51:48.566453 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:51:48.582528 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:51:48.600470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCCDC9970>]}
[0m18:51:48.600470 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:51:48.600470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCBDCCFB0>]}
[0m18:51:48.600470 [info ] [MainThread]: 
[0m18:51:48.600470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:51:48.600470 [info ] [MainThread]: 
[0m18:51:48.600470 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:51:48.617905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:51:48.708563 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:51:48.708563 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:51:48.708563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:49.186992 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.490 seconds
[0m18:51:49.202963 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:51:49.202963 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:51:49.270190 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.069 seconds
[0m18:51:49.270190 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:51:49.270190 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:51:49.351874 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.074 seconds
[0m18:51:49.363006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate'
[0m18:51:49.394261 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:51:49.394261 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:51:49.394261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:49.688668 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.299 seconds
[0m18:51:49.688668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate, now list_mini_project_mart)
[0m18:51:49.704603 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m18:51:49.704603 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m18:51:49.820926 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.110 seconds
[0m18:51:49.820926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m18:51:49.832954 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:51:49.842221 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:51:49.947068 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.104 seconds
[0m18:51:49.947068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD7C61E0>]}
[0m18:51:49.962912 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m18:51:49.962912 [info ] [Thread-1 (]: 1 of 13 START sql table model mini_project.staging.stg_customers ............... [RUN]
[0m18:51:49.962912 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m18:51:49.962912 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m18:51:49.962912 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m18:51:49.962912 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m18:51:50.007010 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m18:51:50.008508 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m18:51:50.008508 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace transient table mini_project.staging.stg_customers
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
        );
[0m18:51:50.009543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:51:50.691344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m18:51:50.714396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC83E1790>]}
[0m18:51:50.718519 [info ] [Thread-1 (]: 1 of 13 OK created sql table model mini_project.staging.stg_customers .......... [[32mSUCCESS 1[0m in 0.75s]
[0m18:51:50.718519 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m18:51:50.718519 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m18:51:50.718519 [info ] [Thread-1 (]: 2 of 13 START sql table model mini_project.staging.stg_products ................ [RUN]
[0m18:51:50.718519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m18:51:50.718519 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m18:51:50.718519 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m18:51:50.718519 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m18:51:50.728978 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m18:51:50.730485 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m18:51:50.730485 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace transient table mini_project.staging.stg_products
         as
        (


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
        );
[0m18:51:51.225897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.498 seconds
[0m18:51:51.225897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD8394C0>]}
[0m18:51:51.225897 [info ] [Thread-1 (]: 2 of 13 OK created sql table model mini_project.staging.stg_products ........... [[32mSUCCESS 1[0m in 0.51s]
[0m18:51:51.225897 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m18:51:51.225897 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m18:51:51.225897 [info ] [Thread-1 (]: 3 of 13 START sql table model mini_project.staging.stg_region .................. [RUN]
[0m18:51:51.225897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m18:51:51.225897 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m18:51:51.237788 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m18:51:51.239797 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m18:51:51.242554 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m18:51:51.244945 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m18:51:51.244945 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace transient table mini_project.staging.stg_region
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
        );
[0m18:51:51.691418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.446 seconds
[0m18:51:51.691418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD7F7F80>]}
[0m18:51:51.691418 [info ] [Thread-1 (]: 3 of 13 OK created sql table model mini_project.staging.stg_region ............. [[32mSUCCESS 1[0m in 0.47s]
[0m18:51:51.691418 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m18:51:51.691418 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m18:51:51.691418 [info ] [Thread-1 (]: 4 of 13 START sql table model mini_project.staging.stg_transaction ............. [RUN]
[0m18:51:51.691418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m18:51:51.691418 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m18:51:51.691418 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m18:51:51.691418 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m18:51:51.691418 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m18:51:51.707177 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m18:51:51.707944 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace transient table mini_project.staging.stg_transaction
         as
        (with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
        );
[0m18:51:52.357784 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m18:51:52.357784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD7F22A0>]}
[0m18:51:52.357784 [info ] [Thread-1 (]: 4 of 13 OK created sql table model mini_project.staging.stg_transaction ........ [[32mSUCCESS 1[0m in 0.67s]
[0m18:51:52.373661 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m18:51:52.373661 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m18:51:52.373661 [info ] [Thread-1 (]: 5 of 13 START sql table model mini_project.intermediate.master1 ................ [RUN]
[0m18:51:52.373661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m18:51:52.373661 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m18:51:52.373661 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m18:51:52.373661 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m18:51:52.373661 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m18:51:52.373661 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m18:51:52.373661 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace transient table mini_project.intermediate.master1
         as
        (WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        mini_project.staging.stg_customers c
    FULL JOIN
        mini_project.staging.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        mini_project.staging.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
        );
[0m18:51:53.295380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.911 seconds
[0m18:51:53.295380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD7E1190>]}
[0m18:51:53.295380 [info ] [Thread-1 (]: 5 of 13 OK created sql table model mini_project.intermediate.master1 ........... [[32mSUCCESS 1[0m in 0.92s]
[0m18:51:53.295380 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m18:51:53.295380 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:53.295380 [info ] [Thread-1 (]: 6 of 13 START sql table model mini_project.mart.CustomerChurn6Mon .............. [RUN]
[0m18:51:53.295380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m18:51:53.295380 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:51:53.295380 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:53.295380 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:51:53.295380 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:53.295380 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:51:53.311203 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.mart.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:51:53.730673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m18:51:53.732733 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD7F1AC0>]}
[0m18:51:53.732733 [info ] [Thread-1 (]: 6 of 13 OK created sql table model mini_project.mart.CustomerChurn6Mon ......... [[32mSUCCESS 1[0m in 0.44s]
[0m18:51:53.732733 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:51:53.732733 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m18:51:53.732733 [info ] [Thread-1 (]: 7 of 13 START sql table model mini_project.mart.churn .......................... [RUN]
[0m18:51:53.732733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m18:51:53.732733 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m18:51:53.732733 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m18:51:53.732733 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m18:51:53.732733 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m18:51:53.732733 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:51:53.732733 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace transient table mini_project.mart.churn
         as
        (
WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
        );
[0m18:51:54.321528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m18:51:54.321528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD8706E0>]}
[0m18:51:54.321528 [info ] [Thread-1 (]: 7 of 13 OK created sql table model mini_project.mart.churn ..................... [[32mSUCCESS 1[0m in 0.59s]
[0m18:51:54.331822 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m18:51:54.331822 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m18:51:54.331822 [info ] [Thread-1 (]: 8 of 13 START sql table model mini_project.mart.cross_Sell ..................... [RUN]
[0m18:51:54.331822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m18:51:54.331822 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m18:51:54.374322 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m18:51:54.390589 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m18:51:54.390589 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m18:51:54.390589 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:51:54.390589 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace transient table mini_project.mart.cross_Sell
         as
        (
WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        mini_project.intermediate.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
        );
[0m18:51:55.447666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.059 seconds
[0m18:51:55.447666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCB040BC0>]}
[0m18:51:55.447666 [info ] [Thread-1 (]: 8 of 13 OK created sql table model mini_project.mart.cross_Sell ................ [[32mSUCCESS 1[0m in 1.12s]
[0m18:51:55.461443 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m18:51:55.461443 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m18:51:55.461443 [info ] [Thread-1 (]: 9 of 13 START sql table model mini_project.mart.new_customer ................... [RUN]
[0m18:51:55.463454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m18:51:55.463454 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m18:51:55.465461 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m18:51:55.467468 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m18:51:55.467468 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m18:51:55.467468 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m18:51:55.467468 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table mini_project.mart.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       mini_project.intermediate.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m18:51:55.963690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m18:51:55.963690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD718350>]}
[0m18:51:55.963690 [info ] [Thread-1 (]: 9 of 13 OK created sql table model mini_project.mart.new_customer .............. [[32mSUCCESS 1[0m in 0.50s]
[0m18:51:55.963690 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m18:51:55.963690 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m18:51:55.963690 [info ] [Thread-1 (]: 10 of 13 START sql table model mini_project.mart.nrr_grr ....................... [RUN]
[0m18:51:55.963690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.nrr_grr)
[0m18:51:55.963690 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m18:51:55.977734 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m18:51:55.980397 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m18:51:55.984031 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m18:51:55.986170 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m18:51:55.986170 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.mart.nrr_grr
         as
        (WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m18:51:56.625077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m18:51:56.625077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD766300>]}
[0m18:51:56.625077 [info ] [Thread-1 (]: 10 of 13 OK created sql table model mini_project.mart.nrr_grr .................. [[32mSUCCESS 1[0m in 0.66s]
[0m18:51:56.625077 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m18:51:56.625077 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m18:51:56.625077 [info ] [Thread-1 (]: 11 of 13 START sql table model mini_project.mart.product_churn ................. [RUN]
[0m18:51:56.625077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.nrr_grr, now model.Mini_Project.product_churn)
[0m18:51:56.625077 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m18:51:56.641499 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m18:51:56.641499 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m18:51:56.641499 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m18:51:56.641499 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m18:51:56.641499 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table mini_project.mart.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m18:51:58.047434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.398 seconds
[0m18:51:58.049453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD825400>]}
[0m18:51:58.051465 [info ] [Thread-1 (]: 11 of 13 OK created sql table model mini_project.mart.product_churn ............ [[32mSUCCESS 1[0m in 1.42s]
[0m18:51:58.051465 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m18:51:58.051465 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m18:51:58.051465 [info ] [Thread-1 (]: 12 of 13 START sql table model mini_project.mart.rank_customer ................. [RUN]
[0m18:51:58.051465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m18:51:58.051465 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m18:51:58.051465 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m18:51:58.051465 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m18:51:58.051465 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m18:51:58.051465 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m18:51:58.051465 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table mini_project.mart.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m18:51:58.535843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m18:51:58.544531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD78C770>]}
[0m18:51:58.544531 [info ] [Thread-1 (]: 12 of 13 OK created sql table model mini_project.mart.rank_customer ............ [[32mSUCCESS 1[0m in 0.49s]
[0m18:51:58.544531 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m18:51:58.544531 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m18:51:58.544531 [info ] [Thread-1 (]: 13 of 13 START sql table model mini_project.mart.rank_products ................. [RUN]
[0m18:51:58.544531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m18:51:58.544531 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m18:51:58.551672 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m18:51:58.552405 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m18:51:58.556523 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m18:51:58.557620 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m18:51:58.557620 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table mini_project.mart.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m18:51:59.035097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m18:51:59.035097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72dff14e-c140-4325-8b9a-0ec03a5d402e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCD7E8860>]}
[0m18:51:59.035097 [info ] [Thread-1 (]: 13 of 13 OK created sql table model mini_project.mart.rank_products ............ [[32mSUCCESS 1[0m in 0.49s]
[0m18:51:59.035097 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m18:51:59.035097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:59.035097 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:51:59.035097 [debug] [MainThread]: On list_mini_project: Close
[0m18:52:00.025837 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m18:52:00.025837 [debug] [MainThread]: On list_mini_project_staging: Close
[0m18:52:00.109674 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m18:52:00.109674 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m18:52:00.202206 [info ] [MainThread]: 
[0m18:52:00.202206 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 11.60 seconds (11.60s).
[0m18:52:00.224274 [debug] [MainThread]: Command end result
[0m18:52:00.247884 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:52:00.247884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:52:00.262694 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:52:00.263209 [info ] [MainThread]: 
[0m18:52:00.263209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:52:00.265458 [info ] [MainThread]: 
[0m18:52:00.266077 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m18:52:00.266699 [debug] [MainThread]: Command `dbt run` succeeded at 18:52:00.266699 after 12.93 seconds
[0m18:52:00.266699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCA7BBFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CC78BC260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCA4E1100>]}
[0m18:52:00.266699 [debug] [MainThread]: Flushing usage events
[0m18:52:01.704192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:23.288825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867EBD1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860181B140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860181B590>]}


============================== 18:54:23.288825 | 28bcff2a-c003-4aa8-94fe-04676b787e93 ==============================
[0m18:54:23.288825 [info ] [MainThread]: Running with dbt=1.9.3
[0m18:54:23.288825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:54:23.727464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018601A10380>]}
[0m18:54:23.790257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186024274D0>]}
[0m18:54:23.790257 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m18:54:24.117956 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m18:54:24.261875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:24.261875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:24.293275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860388B3E0>]}
[0m18:54:24.372379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:54:24.372379 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:54:24.409602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867F6357C0>]}
[0m18:54:24.409602 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m18:54:24.409602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860388B800>]}
[0m18:54:24.417190 [info ] [MainThread]: 
[0m18:54:24.417190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:54:24.417190 [info ] [MainThread]: 
[0m18:54:24.417190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:54:24.424653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m18:54:24.522824 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:54:24.522824 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:54:24.522824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:25.340440 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.828 seconds
[0m18:54:25.356664 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:54:25.356664 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:54:25.428281 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.077 seconds
[0m18:54:25.441108 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m18:54:25.441108 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m18:54:25.524524 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.084 seconds
[0m18:54:25.547755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m18:54:25.556826 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m18:54:25.556826 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m18:54:25.556826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:25.986555 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.431 seconds
[0m18:54:25.986555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m18:54:25.998709 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m18:54:25.998709 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m18:54:26.096025 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.101 seconds
[0m18:54:26.096025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate)
[0m18:54:26.117726 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m18:54:26.117726 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m18:54:26.190144 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.086 seconds
[0m18:54:26.205935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860384AAB0>]}
[0m18:54:26.211962 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m18:54:26.211962 [info ] [Thread-1 (]: 1 of 13 START sql table model mini_project.staging.stg_customers ............... [RUN]
[0m18:54:26.213969 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m18:54:26.213969 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m18:54:26.221813 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m18:54:26.223751 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m18:54:26.241144 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m18:54:26.257930 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m18:54:26.259947 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace transient table mini_project.staging.stg_customers
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
        );
[0m18:54:26.259947 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:27.141897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.889 seconds
[0m18:54:27.173481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867ECD1790>]}
[0m18:54:27.174573 [info ] [Thread-1 (]: 1 of 13 OK created sql table model mini_project.staging.stg_customers .......... [[32mSUCCESS 1[0m in 0.96s]
[0m18:54:27.175156 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m18:54:27.175156 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m18:54:27.175156 [info ] [Thread-1 (]: 2 of 13 START sql table model mini_project.staging.stg_products ................ [RUN]
[0m18:54:27.177304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m18:54:27.177304 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m18:54:27.181321 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m18:54:27.181321 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m18:54:27.181321 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m18:54:27.181321 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m18:54:27.181321 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace transient table mini_project.staging.stg_products
         as
        (


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
        );
[0m18:54:27.639406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.466 seconds
[0m18:54:27.655214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860420B980>]}
[0m18:54:27.655214 [info ] [Thread-1 (]: 2 of 13 OK created sql table model mini_project.staging.stg_products ........... [[32mSUCCESS 1[0m in 0.48s]
[0m18:54:27.655214 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m18:54:27.670914 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m18:54:27.670914 [info ] [Thread-1 (]: 3 of 13 START sql table model mini_project.staging.stg_region .................. [RUN]
[0m18:54:27.670914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m18:54:27.677089 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m18:54:27.682670 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m18:54:27.682670 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m18:54:27.692969 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m18:54:27.695575 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m18:54:27.697103 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace transient table mini_project.staging.stg_region
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
        );
[0m18:54:28.226342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m18:54:28.226342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860420ABD0>]}
[0m18:54:28.226342 [info ] [Thread-1 (]: 3 of 13 OK created sql table model mini_project.staging.stg_region ............. [[32mSUCCESS 1[0m in 0.56s]
[0m18:54:28.226342 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m18:54:28.226342 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m18:54:28.226342 [info ] [Thread-1 (]: 4 of 13 START sql table model mini_project.staging.stg_transaction ............. [RUN]
[0m18:54:28.226342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m18:54:28.226342 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m18:54:28.226342 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m18:54:28.226342 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m18:54:28.242355 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m18:54:28.245352 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m18:54:28.245352 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace transient table mini_project.staging.stg_transaction
         as
        (with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
        );
[0m18:54:28.915490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m18:54:28.915490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018604171A90>]}
[0m18:54:28.915490 [info ] [Thread-1 (]: 4 of 13 OK created sql table model mini_project.staging.stg_transaction ........ [[32mSUCCESS 1[0m in 0.69s]
[0m18:54:28.915490 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m18:54:28.915490 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m18:54:28.915490 [info ] [Thread-1 (]: 5 of 13 START sql table model mini_project.intermediate.master1 ................ [RUN]
[0m18:54:28.922756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m18:54:28.922756 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m18:54:28.926313 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m18:54:28.928313 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m18:54:28.931303 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m18:54:28.933282 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m18:54:28.933282 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace transient table mini_project.intermediate.master1
         as
        (WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        mini_project.staging.stg_customers c
    FULL JOIN
        mini_project.staging.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        mini_project.staging.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
        );
[0m18:54:29.878101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m18:54:29.878101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186041B4740>]}
[0m18:54:29.878101 [info ] [Thread-1 (]: 5 of 13 OK created sql table model mini_project.intermediate.master1 ........... [[32mSUCCESS 1[0m in 0.96s]
[0m18:54:29.878101 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m18:54:29.878101 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m18:54:29.878101 [info ] [Thread-1 (]: 6 of 13 START sql table model mini_project.mart.CustomerChurn6Mon .............. [RUN]
[0m18:54:29.878101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.CustomerChurn6Mon)
[0m18:54:29.884984 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m18:54:29.884984 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:54:29.884984 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m18:54:29.884984 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m18:54:29.893122 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m18:54:29.893978 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.mart.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m18:54:30.315074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m18:54:30.330840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860420ACF0>]}
[0m18:54:30.330840 [info ] [Thread-1 (]: 6 of 13 OK created sql table model mini_project.mart.CustomerChurn6Mon ......... [[32mSUCCESS 1[0m in 0.45s]
[0m18:54:30.334957 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m18:54:30.334957 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m18:54:30.334957 [info ] [Thread-1 (]: 7 of 13 START sql table model mini_project.mart.churn .......................... [RUN]
[0m18:54:30.334957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m18:54:30.344739 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m18:54:30.349152 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m18:54:30.349152 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m18:54:30.364178 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m18:54:30.367386 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m18:54:30.368423 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace transient table mini_project.mart.churn
         as
        (
WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
        );
[0m18:54:30.935701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.569 seconds
[0m18:54:30.944062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018604240AA0>]}
[0m18:54:30.946267 [info ] [Thread-1 (]: 7 of 13 OK created sql table model mini_project.mart.churn ..................... [[32mSUCCESS 1[0m in 0.60s]
[0m18:54:30.947803 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m18:54:30.947803 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m18:54:30.947803 [info ] [Thread-1 (]: 8 of 13 START sql table model mini_project.mart.cross_Sell ..................... [RUN]
[0m18:54:30.947803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m18:54:30.954812 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m18:54:31.019142 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m18:54:31.021182 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m18:54:31.024317 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m18:54:31.027314 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m18:54:31.028312 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace transient table mini_project.mart.cross_Sell
         as
        (
WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        mini_project.intermediate.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
        );
[0m18:54:32.013224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.992 seconds
[0m18:54:32.022208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186037911F0>]}
[0m18:54:32.022208 [info ] [Thread-1 (]: 8 of 13 OK created sql table model mini_project.mart.cross_Sell ................ [[32mSUCCESS 1[0m in 1.07s]
[0m18:54:32.024216 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m18:54:32.024216 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m18:54:32.024216 [info ] [Thread-1 (]: 9 of 13 START sql table model mini_project.mart.new_customer ................... [RUN]
[0m18:54:32.024216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m18:54:32.026223 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m18:54:32.029464 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m18:54:32.030038 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m18:54:32.033758 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m18:54:32.034853 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m18:54:32.035912 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table mini_project.mart.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       mini_project.intermediate.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m18:54:32.546915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m18:54:32.546915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186041C09E0>]}
[0m18:54:32.546915 [info ] [Thread-1 (]: 9 of 13 OK created sql table model mini_project.mart.new_customer .............. [[32mSUCCESS 1[0m in 0.52s]
[0m18:54:32.546915 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m18:54:32.546915 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m18:54:32.546915 [info ] [Thread-1 (]: 10 of 13 START sql table model mini_project.mart.nrr_grr ....................... [RUN]
[0m18:54:32.546915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.nrr_grr)
[0m18:54:32.546915 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m18:54:32.546915 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m18:54:32.546915 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m18:54:32.546915 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m18:54:32.561759 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m18:54:32.562585 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.mart.nrr_grr
         as
        (
WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m18:54:32.967650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.419 seconds
[0m18:54:32.983775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186041C1F40>]}
[0m18:54:32.983775 [info ] [Thread-1 (]: 10 of 13 OK created sql table model mini_project.mart.nrr_grr .................. [[32mSUCCESS 1[0m in 0.44s]
[0m18:54:32.983775 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m18:54:32.983775 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m18:54:32.983775 [info ] [Thread-1 (]: 11 of 13 START sql table model mini_project.mart.product_churn ................. [RUN]
[0m18:54:32.983775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.nrr_grr, now model.Mini_Project.product_churn)
[0m18:54:32.983775 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m18:54:32.983775 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m18:54:32.999449 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m18:54:33.004998 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m18:54:33.008880 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m18:54:33.008880 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table mini_project.mart.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m18:54:33.480666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.485 seconds
[0m18:54:33.496453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018601A10BC0>]}
[0m18:54:33.496453 [info ] [Thread-1 (]: 11 of 13 OK created sql table model mini_project.mart.product_churn ............ [[32mSUCCESS 1[0m in 0.51s]
[0m18:54:33.496453 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m18:54:33.496453 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m18:54:33.496453 [info ] [Thread-1 (]: 12 of 13 START sql table model mini_project.mart.rank_customer ................. [RUN]
[0m18:54:33.496453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m18:54:33.496453 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m18:54:33.496453 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m18:54:33.496453 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m18:54:33.496453 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m18:54:33.496453 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m18:54:33.496453 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table mini_project.mart.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m18:54:33.988274 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.490 seconds
[0m18:54:33.988274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018604163CE0>]}
[0m18:54:33.988274 [info ] [Thread-1 (]: 12 of 13 OK created sql table model mini_project.mart.rank_customer ............ [[32mSUCCESS 1[0m in 0.49s]
[0m18:54:33.988274 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m18:54:33.988274 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m18:54:33.988274 [info ] [Thread-1 (]: 13 of 13 START sql table model mini_project.mart.rank_products ................. [RUN]
[0m18:54:34.003941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m18:54:34.003941 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m18:54:34.003941 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m18:54:34.003941 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m18:54:34.003941 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m18:54:34.003941 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m18:54:34.003941 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table mini_project.mart.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m18:54:34.500877 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.488 seconds
[0m18:54:34.500877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28bcff2a-c003-4aa8-94fe-04676b787e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018604163440>]}
[0m18:54:34.500877 [info ] [Thread-1 (]: 13 of 13 OK created sql table model mini_project.mart.rank_products ............ [[32mSUCCESS 1[0m in 0.50s]
[0m18:54:34.500877 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m18:54:34.500877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:34.500877 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m18:54:34.500877 [debug] [MainThread]: On list_mini_project: Close
[0m18:54:34.582507 [debug] [MainThread]: Connection 'list_mini_project_intermediate' was left open.
[0m18:54:34.582507 [debug] [MainThread]: On list_mini_project_intermediate: Close
[0m18:54:34.681761 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m18:54:34.681761 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m18:54:34.778041 [info ] [MainThread]: 
[0m18:54:34.778041 [info ] [MainThread]: Finished running 13 table models in 0 hours 0 minutes and 10.36 seconds (10.36s).
[0m18:54:34.778041 [debug] [MainThread]: Command end result
[0m18:54:34.817770 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m18:54:34.817770 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m18:54:34.817770 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m18:54:34.817770 [info ] [MainThread]: 
[0m18:54:34.817770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:34.817770 [info ] [MainThread]: 
[0m18:54:34.817770 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
[0m18:54:34.832245 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:34.832245 after 11.70 seconds
[0m18:54:34.832245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867FDE2DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867FDE0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001867FDE0F20>]}
[0m18:54:34.833261 [debug] [MainThread]: Flushing usage events
[0m18:54:36.035242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:17.781354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CD99EA450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDBB1D5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDBB1C140>]}


============================== 19:22:17.786205 | 5c1f21f1-b313-41c4-9e95-9a49ca00e58f ==============================
[0m19:22:17.786205 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:22:17.786205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:22:17.900149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c1f21f1-b313-41c4-9e95-9a49ca00e58f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDC4A01A0>]}
[0m19:22:17.937230 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:22:17.938627 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:22:17.939913 [debug] [MainThread]: Command `cli deps` succeeded at 19:22:17.938627 after 0.33 seconds
[0m19:22:17.939913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDC484770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDC7142C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CDC714080>]}
[0m19:22:17.939913 [debug] [MainThread]: Flushing usage events
[0m19:22:18.916970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:24:53.705682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8D348C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8D347A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8D34620>]}


============================== 19:24:53.714148 | 3a8b41de-cf70-4f89-a8d0-533dba6a3890 ==============================
[0m19:24:53.714148 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:24:53.714907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s Churn_LTM', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:24:54.306962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a8b41de-cf70-4f89-a8d0-533dba6a3890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F9A323C0>]}
[0m19:24:54.356767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a8b41de-cf70-4f89-a8d0-533dba6a3890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FAB32F30>]}
[0m19:24:54.356767 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:24:54.840213 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:24:55.021733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:24:55.021733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:24:55.065561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a8b41de-cf70-4f89-a8d0-533dba6a3890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F995F200>]}
[0m19:24:55.132784 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:24:55.164433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:24:55.196380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a8b41de-cf70-4f89-a8d0-533dba6a3890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FAF89AF0>]}
[0m19:24:55.196380 [info ] [MainThread]: Found 13 models, 4 sources, 475 macros
[0m19:24:55.196380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a8b41de-cf70-4f89-a8d0-533dba6a3890', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F9B10EC0>]}
[0m19:24:55.196380 [warn ] [MainThread]: The selection criterion 'Churn_LTM' does not match any enabled nodes
[0m19:24:55.196380 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:24:55.208698 [debug] [MainThread]: Command end result
[0m19:24:55.229381 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:24:55.229381 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:24:55.229381 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m19:24:55.229381 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:55.229381 after 1.70 seconds
[0m19:24:55.240794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F8974530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0F9B10EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0FAE305C0>]}
[0m19:24:55.240794 [debug] [MainThread]: Flushing usage events
[0m19:24:56.494374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:37.186993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C900E18410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C900E18320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C900E18110>]}


============================== 19:25:37.192853 | b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e ==============================
[0m19:25:37.192853 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:25:37.192853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s Churn_LTM', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:25:37.570729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C902BC39E0>]}
[0m19:25:37.652075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C901A54F80>]}
[0m19:25:37.652075 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:25:38.001396 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:25:38.132297 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:25:38.132297 [debug] [MainThread]: Partial parsing: added file: Mini_Project://models\mart\Churn_LTM.sql
[0m19:25:38.400820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9002F3D70>]}
[0m19:25:38.472264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:25:38.472264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:25:38.500821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9030F44D0>]}
[0m19:25:38.502830 [info ] [MainThread]: Found 14 models, 4 sources, 475 macros
[0m19:25:38.503353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C903132870>]}
[0m19:25:38.503353 [info ] [MainThread]: 
[0m19:25:38.503353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:38.503353 [info ] [MainThread]: 
[0m19:25:38.503353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:25:38.503353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m19:25:41.220581 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:25:41.220581 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:25:41.220581 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:42.532549 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.323 seconds
[0m19:25:42.548358 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m19:25:42.567748 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m19:25:42.567748 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m19:25:42.567748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:42.919844 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.360 seconds
[0m19:25:42.935573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_intermediate)
[0m19:25:42.935573 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m19:25:42.935573 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m19:25:43.138221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.191 seconds
[0m19:25:43.138221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate, now list_mini_project_staging)
[0m19:25:43.138221 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m19:25:43.138221 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m19:25:43.238129 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.096 seconds
[0m19:25:43.238129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9034E1520>]}
[0m19:25:43.251574 [debug] [Thread-1 (]: Began running node model.Mini_Project.Churn_LTM
[0m19:25:43.251574 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.mart.Churn_LTM ....................... [RUN]
[0m19:25:43.251574 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.Churn_LTM'
[0m19:25:43.251574 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.Churn_LTM
[0m19:25:43.251574 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.Churn_LTM"
[0m19:25:43.267413 [debug] [Thread-1 (]: Began executing node model.Mini_Project.Churn_LTM
[0m19:25:43.339868 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.Churn_LTM"
[0m19:25:43.339868 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.Churn_LTM"
[0m19:25:43.339868 [debug] [Thread-1 (]: On model.Mini_Project.Churn_LTM: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.Churn_LTM"} */
create or replace transient table mini_project.mart.Churn_LTM
         as
        (
WITH customer_year_churn_calculation
AS(
    SELECT
        customer_id,
        Revenue_type,
        revenue,
        payment_month,
         CAST(MAX(payment_month) AS DATE) AS  OVER(PARTITION BY customer_id ORDER BY payment_month DESC) AS last_payment_month
    FROM
        mini_project.intermediate.master1
    WHERE
        Revenue_type='True'
),
compare AS(
    SELECT
        *,
        DATEDIFF(year,last_payment_month,'2020-01-05') AS Churn_year_period,
        CASE
            WHEN
                DATEDIFF(year,last_payment_month,'2020-01-05')>1
            THEN
                'Customer_churn'
            ELSE
                'Active_customer'
        END
         AS LTM_Churn
    FROM
        customer_year_churn_calculation
 
),
final_year AS(
    SELECT
       
        LTM_Churn,
        SUM(revenue) AS LTM_Revenue,
        COUNT(LTM_Churn)  AS LTM_Count
    FROM
        compare
    GROUP BY
        LTM_Churn
       
 )
 SELECT
    *
FROM
    final_year
        );
[0m19:25:43.339868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:25:43.807855 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e3-0001-429a-0008-511e0001eaf6
[0m19:25:43.807855 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 50 unexpected '('.
syntax error line 11 at position 51 unexpected 'PARTITION'.
syntax error line 11 at position 105 unexpected 'AS'.
[0m19:25:43.823602 [debug] [Thread-1 (]: Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 50 unexpected '('.
  syntax error line 11 at position 51 unexpected 'PARTITION'.
  syntax error line 11 at position 105 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql
[0m19:25:43.823602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b20bc8b0-4b7b-4200-96aa-d0eb7f74e69e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C90374FDD0>]}
[0m19:25:43.823602 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mini_project.mart.Churn_LTM .............. [[31mERROR[0m in 0.57s]
[0m19:25:43.823602 [debug] [Thread-1 (]: Finished running node model.Mini_Project.Churn_LTM
[0m19:25:43.823602 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.Churn_LTM' to be skipped because of status 'error'.  Reason: Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 50 unexpected '('.
  syntax error line 11 at position 51 unexpected 'PARTITION'.
  syntax error line 11 at position 105 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql.
[0m19:25:43.823602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:43.823602 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m19:25:43.823602 [debug] [MainThread]: On list_mini_project: Close
[0m19:25:43.906793 [debug] [MainThread]: Connection 'list_mini_project_staging' was left open.
[0m19:25:43.906793 [debug] [MainThread]: On list_mini_project_staging: Close
[0m19:25:43.987056 [debug] [MainThread]: Connection 'model.Mini_Project.Churn_LTM' was left open.
[0m19:25:43.987056 [debug] [MainThread]: On model.Mini_Project.Churn_LTM: Close
[0m19:25:44.053314 [info ] [MainThread]: 
[0m19:25:44.069436 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m19:25:44.071453 [debug] [MainThread]: Command end result
[0m19:25:44.097427 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:25:44.097427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:25:44.108246 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m19:25:44.108246 [info ] [MainThread]: 
[0m19:25:44.108246 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:25:44.108246 [info ] [MainThread]: 
[0m19:25:44.108246 [error] [MainThread]:   Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 50 unexpected '('.
  syntax error line 11 at position 51 unexpected 'PARTITION'.
  syntax error line 11 at position 105 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql
[0m19:25:44.108246 [info ] [MainThread]: 
[0m19:25:44.108246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:25:44.108246 [debug] [MainThread]: Command `dbt run` failed at 19:25:44.108246 after 7.10 seconds
[0m19:25:44.108246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9034483B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C902FABDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C902FA8E90>]}
[0m19:25:44.108246 [debug] [MainThread]: Flushing usage events
[0m19:25:44.995670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:13.790448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E458920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0DD15A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E4590A0>]}


============================== 19:26:13.794405 | 494baba0-ae6c-410a-a562-6f5cb4b1d4a1 ==============================
[0m19:26:13.794405 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:26:13.795529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s Churn_LTM', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:26:14.282347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '494baba0-ae6c-410a-a562-6f5cb4b1d4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0F19C710>]}
[0m19:26:14.336694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '494baba0-ae6c-410a-a562-6f5cb4b1d4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0EE7B650>]}
[0m19:26:14.353372 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:26:14.776871 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:26:14.903981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:26:14.919856 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:26:14.953951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '494baba0-ae6c-410a-a562-6f5cb4b1d4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC10298A40>]}
[0m19:26:15.020690 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:26:15.036827 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:26:15.061731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '494baba0-ae6c-410a-a562-6f5cb4b1d4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E4594C0>]}
[0m19:26:15.061731 [info ] [MainThread]: Found 14 models, 4 sources, 475 macros
[0m19:26:15.061731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '494baba0-ae6c-410a-a562-6f5cb4b1d4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1050BEF0>]}
[0m19:26:15.061731 [info ] [MainThread]: 
[0m19:26:15.061731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:15.061731 [info ] [MainThread]: 
[0m19:26:15.061731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:15.068965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m19:26:17.957560 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:26:17.971499 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:26:17.971499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:18.928093 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.956 seconds
[0m19:26:18.935688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m19:26:18.944782 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m19:26:18.946790 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m19:26:18.946790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:19.573828 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.639 seconds
[0m19:26:19.573828 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m19:26:19.589460 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m19:26:19.589460 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m19:26:19.687719 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.094 seconds
[0m19:26:19.694844 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate)
[0m19:26:19.705056 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m19:26:19.707194 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m19:26:19.797078 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.090 seconds
[0m19:26:19.805142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '494baba0-ae6c-410a-a562-6f5cb4b1d4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0D8EB710>]}
[0m19:26:19.805142 [debug] [Thread-1 (]: Began running node model.Mini_Project.Churn_LTM
[0m19:26:19.805142 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.mart.Churn_LTM ....................... [RUN]
[0m19:26:19.805142 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.Churn_LTM'
[0m19:26:19.805142 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.Churn_LTM
[0m19:26:19.821745 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.Churn_LTM"
[0m19:26:19.822811 [debug] [Thread-1 (]: Began executing node model.Mini_Project.Churn_LTM
[0m19:26:19.848450 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.Churn_LTM"
[0m19:26:19.848450 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.Churn_LTM"
[0m19:26:19.848450 [debug] [Thread-1 (]: On model.Mini_Project.Churn_LTM: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.Churn_LTM"} */
create or replace transient table mini_project.mart.Churn_LTM
         as
        (
WITH customer_year_churn_calculation
AS(
    SELECT
        customer_id,
        revenue_type,
        revenue,
        payment_month,
         CAST(MAX(payment_month) AS DATE) AS  OVER(PARTITION BY customer_id ORDER BY payment_month DESC) AS last_payment_month
    FROM
        mini_project.intermediate.master1
    WHERE
        Revenue_type='True'
),
compare AS(
    SELECT
        *,
        DATEDIFF(year,last_payment_month,'2020-01-05') AS Churn_year_period,
        CASE
            WHEN
                DATEDIFF(year,last_payment_month,'2020-01-05')>1
            THEN
                'Customer_churn'
            ELSE
                'Active_customer'
        END
         AS LTM_Churn
    FROM
        customer_year_churn_calculation
 
),
final_year AS(
    SELECT
       
        LTM_Churn,
        SUM(revenue) AS LTM_Revenue,
        COUNT(LTM_Churn)  AS LTM_Count
    FROM
        compare
    GROUP BY
        LTM_Churn
       
 )
 SELECT
    *
FROM
    final_year
        );
[0m19:26:19.848450 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:20.288980 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e4-0001-429a-0008-511e0001eb02
[0m19:26:20.288980 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 50 unexpected '('.
syntax error line 11 at position 51 unexpected 'PARTITION'.
syntax error line 11 at position 105 unexpected 'AS'.
[0m19:26:20.305113 [debug] [Thread-1 (]: Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 50 unexpected '('.
  syntax error line 11 at position 51 unexpected 'PARTITION'.
  syntax error line 11 at position 105 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql
[0m19:26:20.305113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '494baba0-ae6c-410a-a562-6f5cb4b1d4a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC10BAB140>]}
[0m19:26:20.305113 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mini_project.mart.Churn_LTM .............. [[31mERROR[0m in 0.50s]
[0m19:26:20.305113 [debug] [Thread-1 (]: Finished running node model.Mini_Project.Churn_LTM
[0m19:26:20.305113 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.Churn_LTM' to be skipped because of status 'error'.  Reason: Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 50 unexpected '('.
  syntax error line 11 at position 51 unexpected 'PARTITION'.
  syntax error line 11 at position 105 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql.
[0m19:26:20.305113 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:20.305113 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m19:26:20.305113 [debug] [MainThread]: On list_mini_project: Close
[0m19:26:20.392481 [debug] [MainThread]: Connection 'list_mini_project_intermediate' was left open.
[0m19:26:20.392481 [debug] [MainThread]: On list_mini_project_intermediate: Close
[0m19:26:20.472764 [debug] [MainThread]: Connection 'model.Mini_Project.Churn_LTM' was left open.
[0m19:26:20.472764 [debug] [MainThread]: On model.Mini_Project.Churn_LTM: Close
[0m19:26:20.574828 [info ] [MainThread]: 
[0m19:26:20.575824 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.51 seconds (5.51s).
[0m19:26:20.577021 [debug] [MainThread]: Command end result
[0m19:26:20.598976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:26:20.598976 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:26:20.611383 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m19:26:20.612018 [info ] [MainThread]: 
[0m19:26:20.613109 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:26:20.613109 [info ] [MainThread]: 
[0m19:26:20.613109 [error] [MainThread]:   Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 50 unexpected '('.
  syntax error line 11 at position 51 unexpected 'PARTITION'.
  syntax error line 11 at position 105 unexpected 'AS'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql
[0m19:26:20.613109 [info ] [MainThread]: 
[0m19:26:20.613109 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:26:20.613109 [debug] [MainThread]: Command `dbt run` failed at 19:26:20.613109 after 6.99 seconds
[0m19:26:20.613109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0D45EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E618C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0E0DBE90>]}
[0m19:26:20.613109 [debug] [MainThread]: Flushing usage events
[0m19:26:21.836282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:35.818423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CFB806B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CF8E83B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CFB81F40>]}


============================== 19:27:35.822866 | 95a85f73-3d58-4dc6-be36-2778bcf68b69 ==============================
[0m19:27:35.822866 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:27:35.822866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s Churn_LTM', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:36.275853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95a85f73-3d58-4dc6-be36-2778bcf68b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CFBC6EA0>]}
[0m19:27:36.338703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95a85f73-3d58-4dc6-be36-2778bcf68b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D043B230>]}
[0m19:27:36.338703 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:27:36.669160 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:27:36.818978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:36.818978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:36.852449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95a85f73-3d58-4dc6-be36-2778bcf68b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CFB83440>]}
[0m19:27:36.919071 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:27:36.935165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:27:36.957960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95a85f73-3d58-4dc6-be36-2778bcf68b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D1B44980>]}
[0m19:27:36.957960 [info ] [MainThread]: Found 14 models, 4 sources, 475 macros
[0m19:27:36.957960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a85f73-3d58-4dc6-be36-2778bcf68b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D19D80B0>]}
[0m19:27:36.957960 [info ] [MainThread]: 
[0m19:27:36.957960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:36.957960 [info ] [MainThread]: 
[0m19:27:36.957960 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:36.957960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m19:27:37.052529 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:27:37.052529 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:27:37.052529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:37.952897 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.889 seconds
[0m19:27:37.959053 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_staging'
[0m19:27:37.970137 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m19:27:37.970137 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m19:27:37.970137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:38.274997 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.303 seconds
[0m19:27:38.274997 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_mart)
[0m19:27:38.286625 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m19:27:38.287711 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m19:27:38.386298 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.106 seconds
[0m19:27:38.402332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_intermediate)
[0m19:27:38.402332 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m19:27:38.402332 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m19:27:38.486907 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.080 seconds
[0m19:27:38.486907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95a85f73-3d58-4dc6-be36-2778bcf68b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CF480740>]}
[0m19:27:38.486907 [debug] [Thread-1 (]: Began running node model.Mini_Project.Churn_LTM
[0m19:27:38.486907 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.mart.Churn_LTM ....................... [RUN]
[0m19:27:38.486907 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.Churn_LTM'
[0m19:27:38.486907 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.Churn_LTM
[0m19:27:38.501795 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.Churn_LTM"
[0m19:27:38.501795 [debug] [Thread-1 (]: Began executing node model.Mini_Project.Churn_LTM
[0m19:27:38.542290 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.Churn_LTM"
[0m19:27:38.542290 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.Churn_LTM"
[0m19:27:38.542290 [debug] [Thread-1 (]: On model.Mini_Project.Churn_LTM: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.Churn_LTM"} */
create or replace transient table mini_project.mart.Churn_LTM
         as
        (WITH customer_year_churn_calculation AS (
    SELECT
        customer_id,
        revenue_type,
        revenue,
        payment_month,
        MAX(payment_month) OVER (PARTITION BY customer_id ORDER BY payment_month DESC) AS last_payment_month
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
),
compare AS (
    SELECT
        *,
        DATEDIFF(year, last_payment_month, '2020-01-05') AS Churn_year_period,
        CASE
            WHEN DATEDIFF(year, last_payment_month, '2020-01-05') > 1 THEN 'Customer_churn'
            ELSE 'Active_customer'
        END AS LTM_Churn
    FROM
        customer_year_churn_calculation
),
final_year AS (
    SELECT
        LTM_Churn,
        SUM(revenue) AS LTM_Revenue,
        COUNT(LTM_Churn) AS LTM_Count
    FROM
        compare
    GROUP BY
        LTM_Churn
)
SELECT
    *
FROM
    final_year;
[0m19:27:38.542290 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:39.032869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e5-0001-42fa-0008-511e00023006
[0m19:27:39.032869 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 39 at position 14 unexpected ';'.
[0m19:27:39.037428 [debug] [Thread-1 (]: Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql
[0m19:27:39.038906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95a85f73-3d58-4dc6-be36-2778bcf68b69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D22E7C50>]}
[0m19:27:39.038906 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model mini_project.mart.Churn_LTM .............. [[31mERROR[0m in 0.55s]
[0m19:27:39.038906 [debug] [Thread-1 (]: Finished running node model.Mini_Project.Churn_LTM
[0m19:27:39.038906 [debug] [Thread-4 (]: Marking all children of 'model.Mini_Project.Churn_LTM' to be skipped because of status 'error'.  Reason: Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql.
[0m19:27:39.038906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:39.038906 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m19:27:39.038906 [debug] [MainThread]: On list_mini_project: Close
[0m19:27:39.122496 [debug] [MainThread]: Connection 'list_mini_project_intermediate' was left open.
[0m19:27:39.123493 [debug] [MainThread]: On list_mini_project_intermediate: Close
[0m19:27:39.203039 [debug] [MainThread]: Connection 'model.Mini_Project.Churn_LTM' was left open.
[0m19:27:39.203039 [debug] [MainThread]: On model.Mini_Project.Churn_LTM: Close
[0m19:27:39.299969 [info ] [MainThread]: 
[0m19:27:39.299969 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m19:27:39.313687 [debug] [MainThread]: Command end result
[0m19:27:39.340116 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:27:39.342111 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:27:39.344564 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m19:27:39.344564 [info ] [MainThread]: 
[0m19:27:39.344564 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:27:39.344564 [info ] [MainThread]: 
[0m19:27:39.344564 [error] [MainThread]:   Database Error in model Churn_LTM (models\mart\Churn_LTM.sql)
  001003 (42000): SQL compilation error:
  syntax error line 39 at position 14 unexpected ';'.
  compiled code at target\run\Mini_Project\models\mart\Churn_LTM.sql
[0m19:27:39.344564 [info ] [MainThread]: 
[0m19:27:39.344564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:27:39.354254 [debug] [MainThread]: Command `dbt run` failed at 19:27:39.354254 after 3.71 seconds
[0m19:27:39.354254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CF6464B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161D20E8A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000161CFD0E3C0>]}
[0m19:27:39.355876 [debug] [MainThread]: Flushing usage events
[0m19:27:40.603148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:47.464692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBEB88E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBEB88FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBEB883B0>]}


============================== 19:27:47.482875 | c853ffca-fa88-4a0b-b7b6-f2fce65d4208 ==============================
[0m19:27:47.482875 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:27:47.482875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s Churn_LTM', 'send_anonymous_usage_stats': 'True'}
[0m19:27:47.954466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c853ffca-fa88-4a0b-b7b6-f2fce65d4208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBBF526F0>]}
[0m19:27:48.015057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c853ffca-fa88-4a0b-b7b6-f2fce65d4208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBF8E7B00>]}
[0m19:27:48.015057 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:27:48.345416 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:27:48.489590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:27:48.489590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:27:48.521594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c853ffca-fa88-4a0b-b7b6-f2fce65d4208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBF61A660>]}
[0m19:27:48.597414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:27:48.597414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:27:48.630800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c853ffca-fa88-4a0b-b7b6-f2fce65d4208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC0D464B0>]}
[0m19:27:48.630800 [info ] [MainThread]: Found 14 models, 4 sources, 475 macros
[0m19:27:48.630800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c853ffca-fa88-4a0b-b7b6-f2fce65d4208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBF6194C0>]}
[0m19:27:48.630800 [info ] [MainThread]: 
[0m19:27:48.630800 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:48.630800 [info ] [MainThread]: 
[0m19:27:48.630800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:48.630800 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m19:27:48.730562 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:27:48.730562 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:27:48.730562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:49.249820 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.522 seconds
[0m19:27:49.249820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_intermediate'
[0m19:27:49.266234 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m19:27:49.266234 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m19:27:49.266234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:49.658155 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.393 seconds
[0m19:27:49.664571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_intermediate, now list_mini_project_staging)
[0m19:27:49.667582 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m19:27:49.668578 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m19:27:49.754751 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.086 seconds
[0m19:27:49.754751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_mart)
[0m19:27:49.754751 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m19:27:49.754751 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m19:27:49.851621 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.092 seconds
[0m19:27:49.851621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c853ffca-fa88-4a0b-b7b6-f2fce65d4208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC0932FF0>]}
[0m19:27:49.851621 [debug] [Thread-1 (]: Began running node model.Mini_Project.Churn_LTM
[0m19:27:49.851621 [info ] [Thread-1 (]: 1 of 1 START sql table model mini_project.mart.Churn_LTM ....................... [RUN]
[0m19:27:49.851621 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.Churn_LTM'
[0m19:27:49.851621 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.Churn_LTM
[0m19:27:49.870721 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.Churn_LTM"
[0m19:27:49.871759 [debug] [Thread-1 (]: Began executing node model.Mini_Project.Churn_LTM
[0m19:27:49.904273 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.Churn_LTM"
[0m19:27:49.904273 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.Churn_LTM"
[0m19:27:49.904273 [debug] [Thread-1 (]: On model.Mini_Project.Churn_LTM: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.Churn_LTM"} */
create or replace transient table mini_project.mart.Churn_LTM
         as
        (WITH customer_year_churn_calculation AS (
    SELECT
        customer_id,
        revenue_type,
        revenue,
        payment_month,
        MAX(payment_month) OVER (PARTITION BY customer_id ORDER BY payment_month DESC) AS last_payment_month
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
),
compare AS (
    SELECT
        *,
        DATEDIFF(year, last_payment_month, '2020-01-05') AS Churn_year_period,
        CASE
            WHEN DATEDIFF(year, last_payment_month, '2020-01-05') > 1 THEN 'Customer_churn'
            ELSE 'Active_customer'
        END AS LTM_Churn
    FROM
        customer_year_churn_calculation
),
final_year AS (
    SELECT
        LTM_Churn,
        SUM(revenue) AS LTM_Revenue,
        COUNT(LTM_Churn) AS LTM_Count
    FROM
        compare
    GROUP BY
        LTM_Churn
)
SELECT
    *
FROM
    final_year
        );
[0m19:27:49.904273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:52.031734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.130 seconds
[0m19:27:52.057695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c853ffca-fa88-4a0b-b7b6-f2fce65d4208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC12C7F80>]}
[0m19:27:52.057695 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mini_project.mart.Churn_LTM .................. [[32mSUCCESS 1[0m in 2.21s]
[0m19:27:52.057695 [debug] [Thread-1 (]: Finished running node model.Mini_Project.Churn_LTM
[0m19:27:52.057695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:52.057695 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m19:27:52.057695 [debug] [MainThread]: On list_mini_project: Close
[0m19:27:52.150661 [debug] [MainThread]: Connection 'list_mini_project_mart' was left open.
[0m19:27:52.150661 [debug] [MainThread]: On list_mini_project_mart: Close
[0m19:27:52.244167 [debug] [MainThread]: Connection 'model.Mini_Project.Churn_LTM' was left open.
[0m19:27:52.245239 [debug] [MainThread]: On model.Mini_Project.Churn_LTM: Close
[0m19:27:52.331261 [info ] [MainThread]: 
[0m19:27:52.331261 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m19:27:52.338900 [debug] [MainThread]: Command end result
[0m19:27:52.359357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:27:52.368299 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:27:52.369668 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m19:27:52.369668 [info ] [MainThread]: 
[0m19:27:52.369668 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:27:52.369668 [info ] [MainThread]: 
[0m19:27:52.378148 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:27:52.378148 [debug] [MainThread]: Command `dbt run` succeeded at 19:27:52.378148 after 5.07 seconds
[0m19:27:52.378148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBE82BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECC0D5E9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBEA827E0>]}
[0m19:27:52.380157 [debug] [MainThread]: Flushing usage events
[0m19:27:53.304780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:31.676088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B334F98F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B334F99310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B334F98110>]}


============================== 19:28:31.676088 | be75e47d-fa82-49d7-96d1-045653cdaf7a ==============================
[0m19:28:31.676088 [info ] [MainThread]: Running with dbt=1.9.3
[0m19:28:31.676088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs', 'profiles_dir': 'C:\\Users\\FahmidaSanabilSyedAb\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:32.192550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B334FD5AC0>]}
[0m19:28:32.275918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B335CA8F50>]}
[0m19:28:32.278247 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m19:28:32.652325 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m19:28:32.842350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:28:32.842350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:28:32.874954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B336D2E210>]}
[0m19:28:32.966662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:28:32.966662 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:28:32.990280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B337125A90>]}
[0m19:28:32.990280 [info ] [MainThread]: Found 14 models, 4 sources, 475 macros
[0m19:28:32.990280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B334F9B890>]}
[0m19:28:33.006086 [info ] [MainThread]: 
[0m19:28:33.008000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:33.008859 [info ] [MainThread]: 
[0m19:28:33.008859 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:33.016658 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project'
[0m19:28:33.112996 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:28:33.112996 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:28:33.112996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:33.998367 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.876 seconds
[0m19:28:33.998367 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:28:33.998367 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:28:34.096225 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.104 seconds
[0m19:28:34.112315 [debug] [ThreadPool]: Using snowflake connection "list_mini_project"
[0m19:28:34.112315 [debug] [ThreadPool]: On list_mini_project: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project"} */
show terse schemas in database mini_project
    limit 10000
[0m19:28:34.197122 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.074 seconds
[0m19:28:34.203151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_mini_project_mart'
[0m19:28:34.219647 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_mart"
[0m19:28:34.219647 [debug] [ThreadPool]: On list_mini_project_mart: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_mart"} */
show objects in mini_project.mart limit 10000;
[0m19:28:34.219647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:34.664857 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.451 seconds
[0m19:28:34.682987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_mart, now list_mini_project_staging)
[0m19:28:34.694223 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_staging"
[0m19:28:34.694223 [debug] [ThreadPool]: On list_mini_project_staging: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_staging"} */
show objects in mini_project.staging limit 10000;
[0m19:28:34.777790 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.091 seconds
[0m19:28:34.777790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_mini_project_staging, now list_mini_project_intermediate)
[0m19:28:34.777790 [debug] [ThreadPool]: Using snowflake connection "list_mini_project_intermediate"
[0m19:28:34.777790 [debug] [ThreadPool]: On list_mini_project_intermediate: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "connection_name": "list_mini_project_intermediate"} */
show objects in mini_project.intermediate limit 10000;
[0m19:28:34.861210 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.084 seconds
[0m19:28:34.881100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3374F3920>]}
[0m19:28:34.896702 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_customers
[0m19:28:34.896702 [info ] [Thread-1 (]: 1 of 14 START sql table model mini_project.staging.stg_customers ............... [RUN]
[0m19:28:34.896702 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Mini_Project.stg_customers'
[0m19:28:34.896702 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_customers
[0m19:28:34.918736 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_customers"
[0m19:28:34.928407 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_customers
[0m19:28:34.960419 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_customers"
[0m19:28:34.960419 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_customers"
[0m19:28:34.960419 [debug] [Thread-1 (]: On model.Mini_Project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_customers"} */
create or replace transient table mini_project.staging.stg_customers
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id                
        , customer_name
        , company

    FROM MINI_PROJECT.RAW.CUSTOMERS
    WHERE
    customer_id is not null

),

datatype_conversion AS (

    SELECT 

        CAST(customer_id AS INT)    AS customer_id
        , customer_name
        , company

    FROM required_fields

),

optimized AS(
    SELECT
        DISTINCT customer_id
        , customer_name
        , company

    FROM datatype_conversion
)
SELECT
    *
FROM optimized
        );
[0m19:28:34.960419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:37.047255 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.088 seconds
[0m19:28:37.079139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B332361550>]}
[0m19:28:37.079139 [info ] [Thread-1 (]: 1 of 14 OK created sql table model mini_project.staging.stg_customers .......... [[32mSUCCESS 1[0m in 2.18s]
[0m19:28:37.079139 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_customers
[0m19:28:37.079139 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_products
[0m19:28:37.079139 [info ] [Thread-1 (]: 2 of 14 START sql table model mini_project.staging.stg_products ................ [RUN]
[0m19:28:37.079139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_customers, now model.Mini_Project.stg_products)
[0m19:28:37.079139 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_products
[0m19:28:37.079139 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_products"
[0m19:28:37.079139 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_products
[0m19:28:37.095216 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_products"
[0m19:28:37.098570 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_products"
[0m19:28:37.099608 [debug] [Thread-1 (]: On model.Mini_Project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_products"} */
create or replace transient table mini_project.staging.stg_products
         as
        (


WITH

required_fields AS (

    SELECT

        product_id                
        , product_family
        , product_sub_family

    FROM MINI_PROJECT.RAW.PRODUCTS
    WHERE
    product_id is not null

),

optimized AS(
    SELECT
        product_id                
        , product_family
        , product_sub_family

    FROM required_fields
)
SELECT
    *
FROM optimized
        );
[0m19:28:38.677782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.578 seconds
[0m19:28:38.680529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3377592E0>]}
[0m19:28:38.680529 [info ] [Thread-1 (]: 2 of 14 OK created sql table model mini_project.staging.stg_products ........... [[32mSUCCESS 1[0m in 1.60s]
[0m19:28:38.680529 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_products
[0m19:28:38.682540 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_region
[0m19:28:38.682540 [info ] [Thread-1 (]: 3 of 14 START sql table model mini_project.staging.stg_region .................. [RUN]
[0m19:28:38.682540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_products, now model.Mini_Project.stg_region)
[0m19:28:38.682540 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_region
[0m19:28:38.686340 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_region"
[0m19:28:38.688350 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_region
[0m19:28:38.690359 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_region"
[0m19:28:38.692373 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_region"
[0m19:28:38.692373 [debug] [Thread-1 (]: On model.Mini_Project.stg_region: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_region"} */
create or replace transient table mini_project.staging.stg_region
         as
        (


WITH

required_fields AS (

    SELECT

        customer_id             
        , country
        , region

    FROM MINI_PROJECT.RAW.REGION

),

optimized AS(
    SELECT
        CAST(customer_id AS INT)     AS customer_id            
        , country
        , region

    FROM required_fields

)
SELECT
    *
FROM optimized
        );
[0m19:28:39.225898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m19:28:39.227906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33770D1F0>]}
[0m19:28:39.227906 [info ] [Thread-1 (]: 3 of 14 OK created sql table model mini_project.staging.stg_region ............. [[32mSUCCESS 1[0m in 0.55s]
[0m19:28:39.229921 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_region
[0m19:28:39.229921 [debug] [Thread-1 (]: Began running node model.Mini_Project.stg_transaction
[0m19:28:39.230702 [info ] [Thread-1 (]: 4 of 14 START sql table model mini_project.staging.stg_transaction ............. [RUN]
[0m19:28:39.232485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_region, now model.Mini_Project.stg_transaction)
[0m19:28:39.232485 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.stg_transaction
[0m19:28:39.232485 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.stg_transaction"
[0m19:28:39.232485 [debug] [Thread-1 (]: Began executing node model.Mini_Project.stg_transaction
[0m19:28:39.232485 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.stg_transaction"
[0m19:28:39.232485 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.stg_transaction"
[0m19:28:39.232485 [debug] [Thread-1 (]: On model.Mini_Project.stg_transaction: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.stg_transaction"} */
create or replace transient table mini_project.staging.stg_transaction
         as
        (with required_fields as (
  select *
  from MINI_PROJECT.RAW.TRANSACTION
),
 
cleaned_transations as (
  select DISTINCT
    trim(customer) as customer_id,
    trim(product_id) as product_id,
    payment_month,
    revenue_type,
    cast(revenue as numeric) as revenue,
    quantity,
    trim(dimension1) as dimension1,
    trim(dimension2) as dimension2,
    trim(dimension3) as dimension3,
    trim(dimension4) as dimension4,
    trim(dimension5) as dimension5,
    trim(dimension6) as dimension6,
    trim(dimension7) as dimension7,
    trim(dimension8) as dimension8,
    trim(dimension9) as dimension9,
    trim(dimension10) as dimension10,
    trim(companies) as companies
   
  from required_fields
  where customer_id is not null
)
 
select *
from cleaned_transations
        );
[0m19:28:39.915705 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m19:28:39.915705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B337787770>]}
[0m19:28:39.915705 [info ] [Thread-1 (]: 4 of 14 OK created sql table model mini_project.staging.stg_transaction ........ [[32mSUCCESS 1[0m in 0.68s]
[0m19:28:39.915705 [debug] [Thread-1 (]: Finished running node model.Mini_Project.stg_transaction
[0m19:28:39.915705 [debug] [Thread-1 (]: Began running node model.Mini_Project.master1
[0m19:28:39.915705 [info ] [Thread-1 (]: 5 of 14 START sql table model mini_project.intermediate.master1 ................ [RUN]
[0m19:28:39.915705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.stg_transaction, now model.Mini_Project.master1)
[0m19:28:39.915705 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.master1
[0m19:28:39.915705 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.master1"
[0m19:28:39.915705 [debug] [Thread-1 (]: Began executing node model.Mini_Project.master1
[0m19:28:39.932408 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.master1"
[0m19:28:39.934539 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.master1"
[0m19:28:39.934539 [debug] [Thread-1 (]: On model.Mini_Project.master1: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.master1"} */
create or replace transient table mini_project.intermediate.master1
         as
        (WITH required_fields AS (
    SELECT
        c.customer_id,
        c.customer_name,
        t.payment_month,
        t.revenue_type,
        t.revenue,
        t.quantity,
        p.product_id,
        p.product_family,
        p.product_sub_family

    FROM 
        mini_project.staging.stg_customers c
    FULL JOIN
        mini_project.staging.stg_transaction t ON t.customer_id = c.customer_id
    FULL JOIN
        mini_project.staging.stg_products p ON p.product_id = t.product_id
)
SELECT * 
FROM required_fields
        );
[0m19:28:40.806758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.871 seconds
[0m19:28:40.806758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3377F2840>]}
[0m19:28:40.806758 [info ] [Thread-1 (]: 5 of 14 OK created sql table model mini_project.intermediate.master1 ........... [[32mSUCCESS 1[0m in 0.89s]
[0m19:28:40.806758 [debug] [Thread-1 (]: Finished running node model.Mini_Project.master1
[0m19:28:40.806758 [debug] [Thread-1 (]: Began running node model.Mini_Project.Churn_LTM
[0m19:28:40.806758 [info ] [Thread-1 (]: 6 of 14 START sql table model mini_project.mart.Churn_LTM ...................... [RUN]
[0m19:28:40.806758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.master1, now model.Mini_Project.Churn_LTM)
[0m19:28:40.806758 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.Churn_LTM
[0m19:28:40.816130 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.Churn_LTM"
[0m19:28:40.817250 [debug] [Thread-1 (]: Began executing node model.Mini_Project.Churn_LTM
[0m19:28:40.820368 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.Churn_LTM"
[0m19:28:40.821675 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.Churn_LTM"
[0m19:28:40.822707 [debug] [Thread-1 (]: On model.Mini_Project.Churn_LTM: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.Churn_LTM"} */
create or replace transient table mini_project.mart.Churn_LTM
         as
        (
WITH customer_year_churn_calculation AS (
    SELECT
        customer_id,
        revenue_type,
        revenue,
        payment_month,
        MAX(payment_month) OVER (PARTITION BY customer_id ORDER BY payment_month DESC) AS last_payment_month
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
),
compare AS (
    SELECT
        *,
        DATEDIFF(year, last_payment_month, '2020-01-05') AS Churn_year_period,
        CASE
            WHEN DATEDIFF(year, last_payment_month, '2020-01-05') > 1 THEN 'Customer_churn'
            ELSE 'Active_customer'
        END AS LTM_Churn
    FROM
        customer_year_churn_calculation
),
final_year AS (
    SELECT
        LTM_Churn,
        SUM(revenue) AS LTM_Revenue,
        COUNT(LTM_Churn) AS LTM_Count
    FROM
        compare
    GROUP BY
        LTM_Churn
)
SELECT
    *
FROM
    final_year
        );
[0m19:28:41.251850 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.434 seconds
[0m19:28:41.251850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33781B650>]}
[0m19:28:41.251850 [info ] [Thread-1 (]: 6 of 14 OK created sql table model mini_project.mart.Churn_LTM ................. [[32mSUCCESS 1[0m in 0.45s]
[0m19:28:41.251850 [debug] [Thread-1 (]: Finished running node model.Mini_Project.Churn_LTM
[0m19:28:41.251850 [debug] [Thread-1 (]: Began running node model.Mini_Project.CustomerChurn6Mon
[0m19:28:41.251850 [info ] [Thread-1 (]: 7 of 14 START sql table model mini_project.mart.CustomerChurn6Mon .............. [RUN]
[0m19:28:41.251850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.Churn_LTM, now model.Mini_Project.CustomerChurn6Mon)
[0m19:28:41.251850 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.CustomerChurn6Mon
[0m19:28:41.266691 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.CustomerChurn6Mon"
[0m19:28:41.266691 [debug] [Thread-1 (]: Began executing node model.Mini_Project.CustomerChurn6Mon
[0m19:28:41.319287 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.CustomerChurn6Mon"
[0m19:28:41.335295 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.CustomerChurn6Mon"
[0m19:28:41.335295 [debug] [Thread-1 (]: On model.Mini_Project.CustomerChurn6Mon: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.CustomerChurn6Mon"} */
create or replace transient table mini_project.mart.CustomerChurn6Mon
         as
        (
WITH Churne AS (
    SELECT 
        customer_id,
        customer_name,
        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,
        
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        customer_name
    HAVING
        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)
)
SELECT
    *
FROM
    Churne
        );
[0m19:28:41.734713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m19:28:41.749916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B337806870>]}
[0m19:28:41.750960 [info ] [Thread-1 (]: 7 of 14 OK created sql table model mini_project.mart.CustomerChurn6Mon ......... [[32mSUCCESS 1[0m in 0.50s]
[0m19:28:41.750960 [debug] [Thread-1 (]: Finished running node model.Mini_Project.CustomerChurn6Mon
[0m19:28:41.750960 [debug] [Thread-1 (]: Began running node model.Mini_Project.churn
[0m19:28:41.754012 [info ] [Thread-1 (]: 8 of 14 START sql table model mini_project.mart.churn .......................... [RUN]
[0m19:28:41.754012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.CustomerChurn6Mon, now model.Mini_Project.churn)
[0m19:28:41.754012 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.churn
[0m19:28:41.754012 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.churn"
[0m19:28:41.754012 [debug] [Thread-1 (]: Began executing node model.Mini_Project.churn
[0m19:28:41.754012 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.churn"
[0m19:28:41.754012 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.churn"
[0m19:28:41.754012 [debug] [Thread-1 (]: On model.Mini_Project.churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.churn"} */
create or replace transient table mini_project.mart.churn
         as
        (
WITH LastTransaction AS (
    SELECT
 customer_id,
        customer_name,
        MAX(payment_month) AS last_transaction_date
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 1
    GROUP BY
        customer_id,
        customer_name
),
ChurnedCustomers AS (
    SELECT
        customer_id,
        customer_name,
        last_transaction_date,
        CASE
            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'
            ELSE 'No'
        END AS is_churned
    FROM
        LastTransaction
)
SELECT
    customer_id,
    customer_name,
    last_transaction_date,
    is_churned
FROM
    ChurnedCustomers
WHERE
    is_churned = 'Yes'
ORDER BY
    last_transaction_date
        );
[0m19:28:42.268339 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m19:28:42.268339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3378044A0>]}
[0m19:28:42.268339 [info ] [Thread-1 (]: 8 of 14 OK created sql table model mini_project.mart.churn ..................... [[32mSUCCESS 1[0m in 0.51s]
[0m19:28:42.268339 [debug] [Thread-1 (]: Finished running node model.Mini_Project.churn
[0m19:28:42.268339 [debug] [Thread-1 (]: Began running node model.Mini_Project.cross_Sell
[0m19:28:42.268339 [info ] [Thread-1 (]: 9 of 14 START sql table model mini_project.mart.cross_Sell ..................... [RUN]
[0m19:28:42.284146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.churn, now model.Mini_Project.cross_Sell)
[0m19:28:42.284146 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.cross_Sell
[0m19:28:42.288138 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.cross_Sell"
[0m19:28:42.288138 [debug] [Thread-1 (]: Began executing node model.Mini_Project.cross_Sell
[0m19:28:42.291320 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.cross_Sell"
[0m19:28:42.294631 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.cross_Sell"
[0m19:28:42.294631 [debug] [Thread-1 (]: On model.Mini_Project.cross_Sell: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.cross_Sell"} */
create or replace transient table mini_project.mart.cross_Sell
         as
        (
WITH InitialPurchase AS (
    SELECT
        customer_id,
        product_family,
        MIN(CAST(payment_month AS DATE)) AS first_purchase_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family
),
ProductSubFamilyCount AS (
    SELECT
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,
        COUNT(DISTINCT product_sub_family) AS sub_family_count
    FROM
        mini_project.intermediate.master1
    GROUP BY
        customer_id,
        product_family,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
CrossSell AS (
    SELECT
        t.customer_id,
        t.customer_name,
        t.product_id,
        t.product_family,
        t.product_sub_family,
        t.payment_month,
        psf.sub_family_count,
        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count
    FROM
        mini_project.intermediate.master1 t
    JOIN
        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family
    JOIN
        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month
    WHERE
        t.payment_month >= ip.first_purchase_date
)
SELECT
    customer_id,
    customer_name,
    product_id,
    product_family,
    product_sub_family,
    payment_month,
    sub_family_count,
    prev_sub_family_count,
    CASE
        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'
        ELSE 'No'
    END AS is_cross_sell
FROM
    CrossSell
WHERE
    prev_sub_family_count IS NOT NULL
ORDER BY
    customer_id,
    product_family,
    payment_month
        );
[0m19:28:43.386612 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.092 seconds
[0m19:28:43.386612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B337785280>]}
[0m19:28:43.386612 [info ] [Thread-1 (]: 9 of 14 OK created sql table model mini_project.mart.cross_Sell ................ [[32mSUCCESS 1[0m in 1.10s]
[0m19:28:43.386612 [debug] [Thread-1 (]: Finished running node model.Mini_Project.cross_Sell
[0m19:28:43.386612 [debug] [Thread-1 (]: Began running node model.Mini_Project.new_customer
[0m19:28:43.386612 [info ] [Thread-1 (]: 10 of 14 START sql table model mini_project.mart.new_customer .................. [RUN]
[0m19:28:43.386612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.cross_Sell, now model.Mini_Project.new_customer)
[0m19:28:43.386612 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.new_customer
[0m19:28:43.394103 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.new_customer"
[0m19:28:43.396112 [debug] [Thread-1 (]: Began executing node model.Mini_Project.new_customer
[0m19:28:43.398554 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.new_customer"
[0m19:28:43.400564 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.new_customer"
[0m19:28:43.401550 [debug] [Thread-1 (]: On model.Mini_Project.new_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.new_customer"} */
create or replace transient table mini_project.mart.new_customer
         as
        (
WITH new_customer AS (
    SELECT
        customer_id,
        customer_name,
        CAST(MIN(payment_month) AS DATE) AS first_order_date
    FROM
       mini_project.intermediate.master1
    GROUP BY
        customer_id,
        customer_name
)
SELECT
    YEAR(first_order_date) AS fiscal_year,
    COUNT(customer_id) AS No_of_new_customers
FROM
    new_customer
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:28:43.878150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.476 seconds
[0m19:28:43.882139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B337709BE0>]}
[0m19:28:43.884069 [info ] [Thread-1 (]: 10 of 14 OK created sql table model mini_project.mart.new_customer ............. [[32mSUCCESS 1[0m in 0.50s]
[0m19:28:43.885579 [debug] [Thread-1 (]: Finished running node model.Mini_Project.new_customer
[0m19:28:43.886569 [debug] [Thread-1 (]: Began running node model.Mini_Project.nrr_grr
[0m19:28:43.886973 [info ] [Thread-1 (]: 11 of 14 START sql table model mini_project.mart.nrr_grr ....................... [RUN]
[0m19:28:43.889078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.new_customer, now model.Mini_Project.nrr_grr)
[0m19:28:43.890075 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.nrr_grr
[0m19:28:43.896478 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.nrr_grr"
[0m19:28:43.898527 [debug] [Thread-1 (]: Began executing node model.Mini_Project.nrr_grr
[0m19:28:43.903190 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.nrr_grr"
[0m19:28:43.908029 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.nrr_grr"
[0m19:28:43.908029 [debug] [Thread-1 (]: On model.Mini_Project.nrr_grr: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.nrr_grr"} */
create or replace transient table mini_project.mart.nrr_grr
         as
        (
WITH RevenueData AS (
    SELECT
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS month,
        SUM(revenue) AS total_revenue
    FROM
        mini_project.intermediate.master1
    WHERE
        revenue_type = 'True'
    GROUP BY
        customer_id,
        DATE_TRUNC('month', CAST(payment_month AS DATE))
),
MonthlyRevenue AS (
    SELECT
        month,
        SUM(total_revenue) AS monthly_revenue
    FROM
        RevenueData
    GROUP BY
        month
),
PreviousMonthRevenue AS (
    SELECT
        month,
        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue
    FROM
        MonthlyRevenue
),
NRR_GRR_Calculation AS (
    SELECT
        mr.month,
        mr.monthly_revenue,
        pmr.previous_month_revenue,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,
        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR
    FROM
        MonthlyRevenue mr
    JOIN
        PreviousMonthRevenue pmr ON mr.month = pmr.month
    WHERE
        pmr.previous_month_revenue IS NOT NULL
)
SELECT
    month,
    monthly_revenue,
    previous_month_revenue,
    NRR,
    GRR
FROM
    NRR_GRR_Calculation
ORDER BY
    month
        );
[0m19:28:44.286478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.392 seconds
[0m19:28:44.304393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33782BFB0>]}
[0m19:28:44.304393 [info ] [Thread-1 (]: 11 of 14 OK created sql table model mini_project.mart.nrr_grr .................. [[32mSUCCESS 1[0m in 0.42s]
[0m19:28:44.307533 [debug] [Thread-1 (]: Finished running node model.Mini_Project.nrr_grr
[0m19:28:44.307533 [debug] [Thread-1 (]: Began running node model.Mini_Project.product_churn
[0m19:28:44.307533 [info ] [Thread-1 (]: 12 of 14 START sql table model mini_project.mart.product_churn ................. [RUN]
[0m19:28:44.309543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.nrr_grr, now model.Mini_Project.product_churn)
[0m19:28:44.309543 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.product_churn
[0m19:28:44.313562 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.product_churn"
[0m19:28:44.315571 [debug] [Thread-1 (]: Began executing node model.Mini_Project.product_churn
[0m19:28:44.322340 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.product_churn"
[0m19:28:44.324407 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.product_churn"
[0m19:28:44.325440 [debug] [Thread-1 (]: On model.Mini_Project.product_churn: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.product_churn"} */
create or replace transient table mini_project.mart.product_churn
         as
        (
WITH LastSale AS (
    SELECT
        product_id, 
        product_family,
        product_sub_family,
        CAST(MAX(payment_month) AS DATE) AS last_sale_date
    FROM
        mini_project.intermediate.master1
    GROUP BY
        product_id,
        product_family, 
        product_sub_family
),
ChurnedProducts AS (
    SELECT
        product_id,
        product_family, 
        product_sub_family,
        last_sale_date,
        YEAR(last_sale_date) AS last_sale_year
    FROM
        LastSale
    WHERE
        last_sale_date < DATEADD(year, -1, CURRENT_DATE())
)
SELECT
    last_sale_year AS fiscal_year,
    product_family, 
    product_sub_family,
    COUNT(product_id) AS No_of_churned_products
FROM
    ChurnedProducts
GROUP BY
    fiscal_year, product_family, product_sub_family
ORDER BY
    fiscal_year
        );
[0m19:28:44.825767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.501 seconds
[0m19:28:44.831810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B335CCDF10>]}
[0m19:28:44.831810 [info ] [Thread-1 (]: 12 of 14 OK created sql table model mini_project.mart.product_churn ............ [[32mSUCCESS 1[0m in 0.52s]
[0m19:28:44.833822 [debug] [Thread-1 (]: Finished running node model.Mini_Project.product_churn
[0m19:28:44.836408 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_customer
[0m19:28:44.837440 [info ] [Thread-1 (]: 13 of 14 START sql table model mini_project.mart.rank_customer ................. [RUN]
[0m19:28:44.838369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.product_churn, now model.Mini_Project.rank_customer)
[0m19:28:44.838369 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_customer
[0m19:28:44.838369 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_customer"
[0m19:28:44.838369 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_customer
[0m19:28:44.838369 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_customer"
[0m19:28:44.838369 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_customer"
[0m19:28:44.838369 [debug] [Thread-1 (]: On model.Mini_Project.rank_customer: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_customer"} */
create or replace transient table mini_project.mart.rank_customer
         as
        (
WITH ranking AS (
    SELECT
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue,
        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY customer_id, customer_name
    having customer_id is not null
)
SELECT * FROM ranking
        );
[0m19:28:45.289158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.445 seconds
[0m19:28:45.289158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B335CCE990>]}
[0m19:28:45.289158 [info ] [Thread-1 (]: 13 of 14 OK created sql table model mini_project.mart.rank_customer ............ [[32mSUCCESS 1[0m in 0.45s]
[0m19:28:45.289158 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_customer
[0m19:28:45.289158 [debug] [Thread-1 (]: Began running node model.Mini_Project.rank_products
[0m19:28:45.304163 [info ] [Thread-1 (]: 14 of 14 START sql table model mini_project.mart.rank_products ................. [RUN]
[0m19:28:45.305393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Mini_Project.rank_customer, now model.Mini_Project.rank_products)
[0m19:28:45.305393 [debug] [Thread-1 (]: Began compiling node model.Mini_Project.rank_products
[0m19:28:45.311529 [debug] [Thread-1 (]: Writing injected SQL for node "model.Mini_Project.rank_products"
[0m19:28:45.311529 [debug] [Thread-1 (]: Began executing node model.Mini_Project.rank_products
[0m19:28:45.315550 [debug] [Thread-1 (]: Writing runtime sql for node "model.Mini_Project.rank_products"
[0m19:28:45.317559 [debug] [Thread-1 (]: Using snowflake connection "model.Mini_Project.rank_products"
[0m19:28:45.319569 [debug] [Thread-1 (]: On model.Mini_Project.rank_products: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "Mini_Project", "target_name": "dev", "node_id": "model.Mini_Project.rank_products"} */
create or replace transient table mini_project.mart.rank_products
         as
        (
WITH ranking AS (
    SELECT
        product_id,product_family,
        COALESCE(SUM(revenue), 0) AS total_revenue,
        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank
    FROM mini_project.intermediate.master1
    GROUP BY product_id,product_family
)
SELECT * FROM ranking
        );
[0m19:28:45.837766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m19:28:45.837766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be75e47d-fa82-49d7-96d1-045653cdaf7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33768DC10>]}
[0m19:28:45.837766 [info ] [Thread-1 (]: 14 of 14 OK created sql table model mini_project.mart.rank_products ............ [[32mSUCCESS 1[0m in 0.53s]
[0m19:28:45.837766 [debug] [Thread-1 (]: Finished running node model.Mini_Project.rank_products
[0m19:28:45.837766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:45.837766 [debug] [MainThread]: Connection 'list_mini_project' was left open.
[0m19:28:45.837766 [debug] [MainThread]: On list_mini_project: Close
[0m19:28:45.921724 [debug] [MainThread]: Connection 'list_mini_project_intermediate' was left open.
[0m19:28:45.921724 [debug] [MainThread]: On list_mini_project_intermediate: Close
[0m19:28:46.008548 [debug] [MainThread]: Connection 'model.Mini_Project.rank_products' was left open.
[0m19:28:46.008548 [debug] [MainThread]: On model.Mini_Project.rank_products: Close
[0m19:28:46.089593 [info ] [MainThread]: 
[0m19:28:46.089593 [info ] [MainThread]: Finished running 14 table models in 0 hours 0 minutes and 13.08 seconds (13.08s).
[0m19:28:46.089593 [debug] [MainThread]: Command end result
[0m19:28:46.113357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\manifest.json
[0m19:28:46.119851 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\semantic_manifest.json
[0m19:28:46.121862 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\FahmidaSanabilSyedAb\Mini_Project\target\run_results.json
[0m19:28:46.121862 [info ] [MainThread]: 
[0m19:28:46.121862 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:46.121862 [info ] [MainThread]: 
[0m19:28:46.121862 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m19:28:46.121862 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:46.121862 after 14.68 seconds
[0m19:28:46.121862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B33592BE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B336D2CA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B336D2CCE0>]}
[0m19:28:46.121862 [debug] [MainThread]: Flushing usage events
[0m19:28:47.302483 [debug] [MainThread]: An error was encountered while trying to flush usage events
