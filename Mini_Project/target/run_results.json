{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-14T13:58:46.089593Z", "invocation_id": "be75e47d-fa82-49d7-96d1-045653cdaf7a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:34.896702Z", "completed_at": "2025-03-14T13:58:34.928407Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:34.928407Z", "completed_at": "2025-03-14T13:58:37.079139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.1824374198913574, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-42f8-0008-511e00022036"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.stg_customers", "compiled": true, "compiled_code": "\n\n\nWITH\n\nrequired_fields AS (\n\n    SELECT\n\n        customer_id                \n        , customer_name\n        , company\n\n    FROM MINI_PROJECT.RAW.CUSTOMERS\n    WHERE\n    customer_id is not null\n\n),\n\ndatatype_conversion AS (\n\n    SELECT \n\n        CAST(customer_id AS INT)    AS customer_id\n        , customer_name\n        , company\n\n    FROM required_fields\n\n),\n\noptimized AS(\n    SELECT\n        DISTINCT customer_id\n        , customer_name\n        , company\n\n    FROM datatype_conversion\n)\nSELECT\n    *\nFROM optimized", "relation_name": "mini_project.staging.stg_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:37.079139Z", "completed_at": "2025-03-14T13:58:37.079139Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:37.079139Z", "completed_at": "2025-03-14T13:58:38.679523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.600383996963501, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-429a-0008-511e0001eb1a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.stg_products", "compiled": true, "compiled_code": "\n\n\nWITH\n\nrequired_fields AS (\n\n    SELECT\n\n        product_id                \n        , product_family\n        , product_sub_family\n\n    FROM MINI_PROJECT.RAW.PRODUCTS\n    WHERE\n    product_id is not null\n\n),\n\noptimized AS(\n    SELECT\n        product_id                \n        , product_family\n        , product_sub_family\n\n    FROM required_fields\n)\nSELECT\n    *\nFROM optimized", "relation_name": "mini_project.staging.stg_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:38.682540Z", "completed_at": "2025-03-14T13:58:38.688350Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:38.688350Z", "completed_at": "2025-03-14T13:58:39.227906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5453653335571289, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-42f8-0008-511e0002203a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.stg_region", "compiled": true, "compiled_code": "\n\n\nWITH\n\nrequired_fields AS (\n\n    SELECT\n\n        customer_id             \n        , country\n        , region\n\n    FROM MINI_PROJECT.RAW.REGION\n\n),\n\noptimized AS(\n    SELECT\n        CAST(customer_id AS INT)     AS customer_id            \n        , country\n        , region\n\n    FROM required_fields\n\n)\nSELECT\n    *\nFROM optimized", "relation_name": "mini_project.staging.stg_region", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:39.232485Z", "completed_at": "2025-03-14T13:58:39.232485Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:39.232485Z", "completed_at": "2025-03-14T13:58:39.915705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6832201480865479, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-429a-0008-511e0001eb1e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.stg_transaction", "compiled": true, "compiled_code": "with required_fields as (\n  select *\n  from MINI_PROJECT.RAW.TRANSACTION\n),\n \ncleaned_transations as (\n  select DISTINCT\n    trim(customer) as customer_id,\n    trim(product_id) as product_id,\n    payment_month,\n    revenue_type,\n    cast(revenue as numeric) as revenue,\n    quantity,\n    trim(dimension1) as dimension1,\n    trim(dimension2) as dimension2,\n    trim(dimension3) as dimension3,\n    trim(dimension4) as dimension4,\n    trim(dimension5) as dimension5,\n    trim(dimension6) as dimension6,\n    trim(dimension7) as dimension7,\n    trim(dimension8) as dimension8,\n    trim(dimension9) as dimension9,\n    trim(dimension10) as dimension10,\n    trim(companies) as companies\n   \n  from required_fields\n  where customer_id is not null\n)\n \nselect *\nfrom cleaned_transations", "relation_name": "mini_project.staging.stg_transaction", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:39.915705Z", "completed_at": "2025-03-14T13:58:39.915705Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:39.930530Z", "completed_at": "2025-03-14T13:58:40.806758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8910536766052246, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-42f8-0008-511e0002203e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.master1", "compiled": true, "compiled_code": "WITH required_fields AS (\n    SELECT\n        c.customer_id,\n        c.customer_name,\n        t.payment_month,\n        t.revenue_type,\n        t.revenue,\n        t.quantity,\n        p.product_id,\n        p.product_family,\n        p.product_sub_family\n\n    FROM \n        mini_project.staging.stg_customers c\n    FULL JOIN\n        mini_project.staging.stg_transaction t ON t.customer_id = c.customer_id\n    FULL JOIN\n        mini_project.staging.stg_products p ON p.product_id = t.product_id\n)\nSELECT * \nFROM required_fields", "relation_name": "mini_project.intermediate.master1", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:40.806758Z", "completed_at": "2025-03-14T13:58:40.817250Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:40.817250Z", "completed_at": "2025-03-14T13:58:41.251850Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.44509220123291016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-429a-0008-511e0001eb22"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.Churn_LTM", "compiled": true, "compiled_code": "\nWITH customer_year_churn_calculation AS (\n    SELECT\n        customer_id,\n        revenue_type,\n        revenue,\n        payment_month,\n        MAX(payment_month) OVER (PARTITION BY customer_id ORDER BY payment_month DESC) AS last_payment_month\n    FROM\n        mini_project.intermediate.master1\n    WHERE\n        revenue_type = 'True'\n),\ncompare AS (\n    SELECT\n        *,\n        DATEDIFF(year, last_payment_month, '2020-01-05') AS Churn_year_period,\n        CASE\n            WHEN DATEDIFF(year, last_payment_month, '2020-01-05') > 1 THEN 'Customer_churn'\n            ELSE 'Active_customer'\n        END AS LTM_Churn\n    FROM\n        customer_year_churn_calculation\n),\nfinal_year AS (\n    SELECT\n        LTM_Churn,\n        SUM(revenue) AS LTM_Revenue,\n        COUNT(LTM_Churn) AS LTM_Count\n    FROM\n        compare\n    GROUP BY\n        LTM_Churn\n)\nSELECT\n    *\nFROM\n    final_year", "relation_name": "mini_project.mart.Churn_LTM", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:41.251850Z", "completed_at": "2025-03-14T13:58:41.266691Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:41.266691Z", "completed_at": "2025-03-14T13:58:41.734713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4980647563934326, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-42f8-0008-511e00022042"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.CustomerChurn6Mon", "compiled": true, "compiled_code": "\nWITH Churne AS (\n    SELECT \n        customer_id,\n        customer_name,\n        CAST(MAX(payment_month) AS DATE) AS last_transaction_date,\n        \n    FROM\n        mini_project.intermediate.master1\n    WHERE\n        revenue_type = 'True'\n    GROUP BY\n        customer_id,\n        customer_name\n    HAVING\n        last_transaction_date < ADD_MONTHS(CURRENT_DATE, -6)\n)\nSELECT\n    *\nFROM\n    Churne", "relation_name": "mini_project.mart.CustomerChurn6Mon", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:41.754012Z", "completed_at": "2025-03-14T13:58:41.754012Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:41.754012Z", "completed_at": "2025-03-14T13:58:42.268339Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5143260955810547, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-429a-0008-511e0001eb26"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.churn", "compiled": true, "compiled_code": "\nWITH LastTransaction AS (\n    SELECT\n customer_id,\n        customer_name,\n        MAX(payment_month) AS last_transaction_date\n    FROM\n        mini_project.intermediate.master1\n    WHERE\n        revenue_type = 1\n    GROUP BY\n        customer_id,\n        customer_name\n),\nChurnedCustomers AS (\n    SELECT\n        customer_id,\n        customer_name,\n        last_transaction_date,\n        CASE\n            WHEN last_transaction_date < DATEADD(month, -6, CURRENT_DATE()) THEN 'Yes'\n            ELSE 'No'\n        END AS is_churned\n    FROM\n        LastTransaction\n)\nSELECT\n    customer_id,\n    customer_name,\n    last_transaction_date,\n    is_churned\nFROM\n    ChurnedCustomers\nWHERE\n    is_churned = 'Yes'\nORDER BY\n    last_transaction_date", "relation_name": "mini_project.mart.churn", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:42.284146Z", "completed_at": "2025-03-14T13:58:42.288138Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:42.288138Z", "completed_at": "2025-03-14T13:58:43.386612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.102466106414795, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-42f8-0008-511e00022046"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.cross_Sell", "compiled": true, "compiled_code": "\nWITH InitialPurchase AS (\n    SELECT\n        customer_id,\n        product_family,\n        MIN(CAST(payment_month AS DATE)) AS first_purchase_date\n    FROM\n        mini_project.intermediate.master1\n    GROUP BY\n        customer_id,\n        product_family\n),\nProductSubFamilyCount AS (\n    SELECT\n        customer_id,\n        product_family,\n        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS payment_month,\n        COUNT(DISTINCT product_sub_family) AS sub_family_count\n    FROM\n        mini_project.intermediate.master1\n    GROUP BY\n        customer_id,\n        product_family,\n        DATE_TRUNC('month', CAST(payment_month AS DATE))\n),\nCrossSell AS (\n    SELECT\n        t.customer_id,\n        t.customer_name,\n        t.product_id,\n        t.product_family,\n        t.product_sub_family,\n        t.payment_month,\n        psf.sub_family_count,\n        LAG(psf.sub_family_count) OVER (PARTITION BY t.customer_id, t.product_family ORDER BY t.payment_month) AS prev_sub_family_count\n    FROM\n        mini_project.intermediate.master1 t\n    JOIN\n        InitialPurchase ip ON t.customer_id = ip.customer_id AND t.product_family = ip.product_family\n    JOIN\n        ProductSubFamilyCount psf ON t.customer_id = psf.customer_id AND t.product_family = psf.product_family AND DATE_TRUNC('month', CAST(t.payment_month AS DATE)) = psf.payment_month\n    WHERE\n        t.payment_month >= ip.first_purchase_date\n)\nSELECT\n    customer_id,\n    customer_name,\n    product_id,\n    product_family,\n    product_sub_family,\n    payment_month,\n    sub_family_count,\n    prev_sub_family_count,\n    CASE\n        WHEN sub_family_count > prev_sub_family_count THEN 'Yes'\n        ELSE 'No'\n    END AS is_cross_sell\nFROM\n    CrossSell\nWHERE\n    prev_sub_family_count IS NOT NULL\nORDER BY\n    customer_id,\n    product_family,\n    payment_month", "relation_name": "mini_project.mart.cross_Sell", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:43.386612Z", "completed_at": "2025-03-14T13:58:43.396112Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:43.396112Z", "completed_at": "2025-03-14T13:58:43.882139Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4955265522003174, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-429a-0008-511e0001eb2a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.new_customer", "compiled": true, "compiled_code": "\nWITH new_customer AS (\n    SELECT\n        customer_id,\n        customer_name,\n        CAST(MIN(payment_month) AS DATE) AS first_order_date\n    FROM\n       mini_project.intermediate.master1\n    GROUP BY\n        customer_id,\n        customer_name\n)\nSELECT\n    YEAR(first_order_date) AS fiscal_year,\n    COUNT(customer_id) AS No_of_new_customers\nFROM\n    new_customer\nGROUP BY\n    fiscal_year\nORDER BY\n    fiscal_year", "relation_name": "mini_project.mart.new_customer", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:43.890075Z", "completed_at": "2025-03-14T13:58:43.898527Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:43.898527Z", "completed_at": "2025-03-14T13:58:44.304393Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4153151512145996, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-42f8-0008-511e0002204a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.nrr_grr", "compiled": true, "compiled_code": "\nWITH RevenueData AS (\n    SELECT\n        customer_id,\n        DATE_TRUNC('month', CAST(payment_month AS DATE)) AS month,\n        SUM(revenue) AS total_revenue\n    FROM\n        mini_project.intermediate.master1\n    WHERE\n        revenue_type = 'True'\n    GROUP BY\n        customer_id,\n        DATE_TRUNC('month', CAST(payment_month AS DATE))\n),\nMonthlyRevenue AS (\n    SELECT\n        month,\n        SUM(total_revenue) AS monthly_revenue\n    FROM\n        RevenueData\n    GROUP BY\n        month\n),\nPreviousMonthRevenue AS (\n    SELECT\n        month,\n        LAG(monthly_revenue) OVER (ORDER BY month) AS previous_month_revenue\n    FROM\n        MonthlyRevenue\n),\nNRR_GRR_Calculation AS (\n    SELECT\n        mr.month,\n        mr.monthly_revenue,\n        pmr.previous_month_revenue,\n        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS NRR,\n        (mr.monthly_revenue / pmr.previous_month_revenue) * 100 AS GRR\n    FROM\n        MonthlyRevenue mr\n    JOIN\n        PreviousMonthRevenue pmr ON mr.month = pmr.month\n    WHERE\n        pmr.previous_month_revenue IS NOT NULL\n)\nSELECT\n    month,\n    monthly_revenue,\n    previous_month_revenue,\n    NRR,\n    GRR\nFROM\n    NRR_GRR_Calculation\nORDER BY\n    month", "relation_name": "mini_project.mart.nrr_grr", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:44.309543Z", "completed_at": "2025-03-14T13:58:44.315571Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:44.315571Z", "completed_at": "2025-03-14T13:58:44.829796Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5222666263580322, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-429a-0008-511e0001eb2e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.product_churn", "compiled": true, "compiled_code": "\nWITH LastSale AS (\n    SELECT\n        product_id, \n        product_family,\n        product_sub_family,\n        CAST(MAX(payment_month) AS DATE) AS last_sale_date\n    FROM\n        mini_project.intermediate.master1\n    GROUP BY\n        product_id,\n        product_family, \n        product_sub_family\n),\nChurnedProducts AS (\n    SELECT\n        product_id,\n        product_family, \n        product_sub_family,\n        last_sale_date,\n        YEAR(last_sale_date) AS last_sale_year\n    FROM\n        LastSale\n    WHERE\n        last_sale_date < DATEADD(year, -1, CURRENT_DATE())\n)\nSELECT\n    last_sale_year AS fiscal_year,\n    product_family, \n    product_sub_family,\n    COUNT(product_id) AS No_of_churned_products\nFROM\n    ChurnedProducts\nGROUP BY\n    fiscal_year, product_family, product_sub_family\nORDER BY\n    fiscal_year", "relation_name": "mini_project.mart.product_churn", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:44.838369Z", "completed_at": "2025-03-14T13:58:44.838369Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:44.838369Z", "completed_at": "2025-03-14T13:58:45.289158Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4507894515991211, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-42f8-0008-511e0002204e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.rank_customer", "compiled": true, "compiled_code": "\nWITH ranking AS (\n    SELECT\n        customer_id,\n        customer_name,\n        SUM(revenue) AS total_revenue,\n        RANK() OVER (ORDER BY SUM(revenue) DESC) AS revenue_rank\n    FROM mini_project.intermediate.master1\n    GROUP BY customer_id, customer_name\n    having customer_id is not null\n)\nSELECT * FROM ranking", "relation_name": "mini_project.mart.rank_customer", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-14T13:58:45.307508Z", "completed_at": "2025-03-14T13:58:45.311529Z"}, {"name": "execute", "started_at": "2025-03-14T13:58:45.313540Z", "completed_at": "2025-03-14T13:58:45.837766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5323727130889893, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb00e6-0001-429a-0008-511e0001eb32"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.Mini_Project.rank_products", "compiled": true, "compiled_code": "\nWITH ranking AS (\n    SELECT\n        product_id,product_family,\n        COALESCE(SUM(revenue), 0) AS total_revenue,\n        RANK() OVER (ORDER BY(total_revenue) DESC) AS revenue_rank\n    FROM mini_project.intermediate.master1\n    GROUP BY product_id,product_family\n)\nSELECT * FROM ranking", "relation_name": "mini_project.mart.rank_products", "batch_results": null}], "elapsed_time": 13.080734968185425, "args": {"state_modified_compare_more_unrendered_values": false, "version_check": true, "log_level_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "print": true, "static_parser": true, "source_freshness_run_project_hooks": false, "exclude": [], "require_batched_execution_for_custom_microbatch_strategy": false, "require_nested_cumulative_type_params": false, "which": "run", "state_modified_compare_vars": false, "write_json": true, "invocation_command": "dbt run", "partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "introspect": true, "printer_width": 80, "quiet": false, "show_resource_report": false, "select": [], "indirect_selection": "eager", "cache_selected_only": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "skip_nodes_if_on_run_start_fails": false, "log_format_file": "debug", "populate_cache": true, "log_format": "default", "log_file_max_bytes": 10485760, "require_yaml_configuration_for_mf_time_spines": false, "project_dir": "C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project", "vars": {}, "require_resource_names_without_spaces": false, "macro_debugging": false, "log_path": "C:\\Users\\FahmidaSanabilSyedAb\\Mini_Project\\logs", "profiles_dir": "C:\\Users\\FahmidaSanabilSyedAb\\.dbt", "empty": false, "favor_state": false, "use_colors": true, "partial_parse": true, "strict_mode": false, "defer": false, "log_level": "info"}}